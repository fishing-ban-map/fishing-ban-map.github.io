function $1(i,o){for(var m=0;m<o.length;m++){const v=o[m];if(typeof v!="string"&&!Array.isArray(v)){for(const C in v)if(C!=="default"&&!(C in i)){const N=Object.getOwnPropertyDescriptor(v,C);N&&Object.defineProperty(i,C,N.get?N:{enumerable:!0,get:()=>v[C]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const C of document.querySelectorAll('link[rel="modulepreload"]'))v(C);new MutationObserver(C=>{for(const N of C)if(N.type==="childList")for(const M of N.addedNodes)M.tagName==="LINK"&&M.rel==="modulepreload"&&v(M)}).observe(document,{childList:!0,subtree:!0});function m(C){const N={};return C.integrity&&(N.integrity=C.integrity),C.referrerPolicy&&(N.referrerPolicy=C.referrerPolicy),C.crossOrigin==="use-credentials"?N.credentials="include":C.crossOrigin==="anonymous"?N.credentials="omit":N.credentials="same-origin",N}function v(C){if(C.ep)return;C.ep=!0;const N=m(C);fetch(C.href,N)}})();function A_(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Am={exports:{}},N0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cg;function X1(){if(Cg)return N0;Cg=1;var i=Symbol.for("react.transitional.element"),o=Symbol.for("react.fragment");function m(v,C,N){var M=null;if(N!==void 0&&(M=""+N),C.key!==void 0&&(M=""+C.key),"key"in C){N={};for(var d in C)d!=="key"&&(N[d]=C[d])}else N=C;return C=N.ref,{$$typeof:i,type:v,key:M,ref:C!==void 0?C:null,props:N}}return N0.Fragment=o,N0.jsx=m,N0.jsxs=m,N0}var Mg;function Q1(){return Mg||(Mg=1,Am.exports=X1()),Am.exports}var Dt=Q1(),Sm={exports:{}},gi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ig;function K1(){if(Ig)return gi;Ig=1;var i=Symbol.for("react.transitional.element"),o=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),M=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),W=Symbol.for("react.memo"),we=Symbol.for("react.lazy"),Pe=Symbol.iterator;function Me(Te){return Te===null||typeof Te!="object"?null:(Te=Pe&&Te[Pe]||Te["@@iterator"],typeof Te=="function"?Te:null)}var fe={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Qe=Object.assign,ai={};function li(Te,ut,xt){this.props=Te,this.context=ut,this.refs=ai,this.updater=xt||fe}li.prototype.isReactComponent={},li.prototype.setState=function(Te,ut){if(typeof Te!="object"&&typeof Te!="function"&&Te!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Te,ut,"setState")},li.prototype.forceUpdate=function(Te){this.updater.enqueueForceUpdate(this,Te,"forceUpdate")};function ei(){}ei.prototype=li.prototype;function Ci(Te,ut,xt){this.props=Te,this.context=ut,this.refs=ai,this.updater=xt||fe}var ni=Ci.prototype=new ei;ni.constructor=Ci,Qe(ni,li.prototype),ni.isPureReactComponent=!0;var Mt=Array.isArray,Et={H:null,A:null,T:null,S:null,V:null},Ut=Object.prototype.hasOwnProperty;function Ii(Te,ut,xt,At,Ot,Xt){return xt=Xt.ref,{$$typeof:i,type:Te,key:ut,ref:xt!==void 0?xt:null,props:Xt}}function bi(Te,ut){return Ii(Te.type,ut,void 0,void 0,void 0,Te.props)}function nr(Te){return typeof Te=="object"&&Te!==null&&Te.$$typeof===i}function Ms(Te){var ut={"=":"=0",":":"=2"};return"$"+Te.replace(/[=:]/g,function(xt){return ut[xt]})}var mn=/\/+/g;function ia(Te,ut){return typeof Te=="object"&&Te!==null&&Te.key!=null?Ms(""+Te.key):ut.toString(36)}function sn(){}function xa(Te){switch(Te.status){case"fulfilled":return Te.value;case"rejected":throw Te.reason;default:switch(typeof Te.status=="string"?Te.then(sn,sn):(Te.status="pending",Te.then(function(ut){Te.status==="pending"&&(Te.status="fulfilled",Te.value=ut)},function(ut){Te.status==="pending"&&(Te.status="rejected",Te.reason=ut)})),Te.status){case"fulfilled":return Te.value;case"rejected":throw Te.reason}}throw Te}function Fa(Te,ut,xt,At,Ot){var Xt=typeof Te;(Xt==="undefined"||Xt==="boolean")&&(Te=null);var Vt=!1;if(Te===null)Vt=!0;else switch(Xt){case"bigint":case"string":case"number":Vt=!0;break;case"object":switch(Te.$$typeof){case i:case o:Vt=!0;break;case we:return Vt=Te._init,Fa(Vt(Te._payload),ut,xt,At,Ot)}}if(Vt)return Ot=Ot(Te),Vt=At===""?"."+ia(Te,0):At,Mt(Ot)?(xt="",Vt!=null&&(xt=Vt.replace(mn,"$&/")+"/"),Fa(Ot,ut,xt,"",function(qn){return qn})):Ot!=null&&(nr(Ot)&&(Ot=bi(Ot,xt+(Ot.key==null||Te&&Te.key===Ot.key?"":(""+Ot.key).replace(mn,"$&/")+"/")+Vt)),ut.push(Ot)),1;Vt=0;var aa=At===""?".":At+":";if(Mt(Te))for(var Ni=0;Ni<Te.length;Ni++)At=Te[Ni],Xt=aa+ia(At,Ni),Vt+=Fa(At,ut,xt,Xt,Ot);else if(Ni=Me(Te),typeof Ni=="function")for(Te=Ni.call(Te),Ni=0;!(At=Te.next()).done;)At=At.value,Xt=aa+ia(At,Ni++),Vt+=Fa(At,ut,xt,Xt,Ot);else if(Xt==="object"){if(typeof Te.then=="function")return Fa(xa(Te),ut,xt,At,Ot);throw ut=String(Te),Error("Objects are not valid as a React child (found: "+(ut==="[object Object]"?"object with keys {"+Object.keys(Te).join(", ")+"}":ut)+"). If you meant to render a collection of children, use an array instead.")}return Vt}function Je(Te,ut,xt){if(Te==null)return Te;var At=[],Ot=0;return Fa(Te,At,"","",function(Xt){return ut.call(xt,Xt,Ot++)}),At}function wt(Te){if(Te._status===-1){var ut=Te._result;ut=ut(),ut.then(function(xt){(Te._status===0||Te._status===-1)&&(Te._status=1,Te._result=xt)},function(xt){(Te._status===0||Te._status===-1)&&(Te._status=2,Te._result=xt)}),Te._status===-1&&(Te._status=0,Te._result=ut)}if(Te._status===1)return Te._result.default;throw Te._result}var bt=typeof reportError=="function"?reportError:function(Te){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ut=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Te=="object"&&Te!==null&&typeof Te.message=="string"?String(Te.message):String(Te),error:Te});if(!window.dispatchEvent(ut))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Te);return}console.error(Te)};function xi(){}return gi.Children={map:Je,forEach:function(Te,ut,xt){Je(Te,function(){ut.apply(this,arguments)},xt)},count:function(Te){var ut=0;return Je(Te,function(){ut++}),ut},toArray:function(Te){return Je(Te,function(ut){return ut})||[]},only:function(Te){if(!nr(Te))throw Error("React.Children.only expected to receive a single React element child.");return Te}},gi.Component=li,gi.Fragment=m,gi.Profiler=C,gi.PureComponent=Ci,gi.StrictMode=v,gi.Suspense=K,gi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Et,gi.__COMPILER_RUNTIME={__proto__:null,c:function(Te){return Et.H.useMemoCache(Te)}},gi.cache=function(Te){return function(){return Te.apply(null,arguments)}},gi.cloneElement=function(Te,ut,xt){if(Te==null)throw Error("The argument must be a React element, but you passed "+Te+".");var At=Qe({},Te.props),Ot=Te.key,Xt=void 0;if(ut!=null)for(Vt in ut.ref!==void 0&&(Xt=void 0),ut.key!==void 0&&(Ot=""+ut.key),ut)!Ut.call(ut,Vt)||Vt==="key"||Vt==="__self"||Vt==="__source"||Vt==="ref"&&ut.ref===void 0||(At[Vt]=ut[Vt]);var Vt=arguments.length-2;if(Vt===1)At.children=xt;else if(1<Vt){for(var aa=Array(Vt),Ni=0;Ni<Vt;Ni++)aa[Ni]=arguments[Ni+2];At.children=aa}return Ii(Te.type,Ot,void 0,void 0,Xt,At)},gi.createContext=function(Te){return Te={$$typeof:M,_currentValue:Te,_currentValue2:Te,_threadCount:0,Provider:null,Consumer:null},Te.Provider=Te,Te.Consumer={$$typeof:N,_context:Te},Te},gi.createElement=function(Te,ut,xt){var At,Ot={},Xt=null;if(ut!=null)for(At in ut.key!==void 0&&(Xt=""+ut.key),ut)Ut.call(ut,At)&&At!=="key"&&At!=="__self"&&At!=="__source"&&(Ot[At]=ut[At]);var Vt=arguments.length-2;if(Vt===1)Ot.children=xt;else if(1<Vt){for(var aa=Array(Vt),Ni=0;Ni<Vt;Ni++)aa[Ni]=arguments[Ni+2];Ot.children=aa}if(Te&&Te.defaultProps)for(At in Vt=Te.defaultProps,Vt)Ot[At]===void 0&&(Ot[At]=Vt[At]);return Ii(Te,Xt,void 0,void 0,null,Ot)},gi.createRef=function(){return{current:null}},gi.forwardRef=function(Te){return{$$typeof:d,render:Te}},gi.isValidElement=nr,gi.lazy=function(Te){return{$$typeof:we,_payload:{_status:-1,_result:Te},_init:wt}},gi.memo=function(Te,ut){return{$$typeof:W,type:Te,compare:ut===void 0?null:ut}},gi.startTransition=function(Te){var ut=Et.T,xt={};Et.T=xt;try{var At=Te(),Ot=Et.S;Ot!==null&&Ot(xt,At),typeof At=="object"&&At!==null&&typeof At.then=="function"&&At.then(xi,bt)}catch(Xt){bt(Xt)}finally{Et.T=ut}},gi.unstable_useCacheRefresh=function(){return Et.H.useCacheRefresh()},gi.use=function(Te){return Et.H.use(Te)},gi.useActionState=function(Te,ut,xt){return Et.H.useActionState(Te,ut,xt)},gi.useCallback=function(Te,ut){return Et.H.useCallback(Te,ut)},gi.useContext=function(Te){return Et.H.useContext(Te)},gi.useDebugValue=function(){},gi.useDeferredValue=function(Te,ut){return Et.H.useDeferredValue(Te,ut)},gi.useEffect=function(Te,ut,xt){var At=Et.H;if(typeof xt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return At.useEffect(Te,ut)},gi.useId=function(){return Et.H.useId()},gi.useImperativeHandle=function(Te,ut,xt){return Et.H.useImperativeHandle(Te,ut,xt)},gi.useInsertionEffect=function(Te,ut){return Et.H.useInsertionEffect(Te,ut)},gi.useLayoutEffect=function(Te,ut){return Et.H.useLayoutEffect(Te,ut)},gi.useMemo=function(Te,ut){return Et.H.useMemo(Te,ut)},gi.useOptimistic=function(Te,ut){return Et.H.useOptimistic(Te,ut)},gi.useReducer=function(Te,ut,xt){return Et.H.useReducer(Te,ut,xt)},gi.useRef=function(Te){return Et.H.useRef(Te)},gi.useState=function(Te){return Et.H.useState(Te)},gi.useSyncExternalStore=function(Te,ut,xt){return Et.H.useSyncExternalStore(Te,ut,xt)},gi.useTransition=function(){return Et.H.useTransition()},gi.version="19.1.0",gi}var Dg;function ng(){return Dg||(Dg=1,Sm.exports=K1()),Sm.exports}var vt=ng(),Cm={exports:{}},O0={},Mm={exports:{}},Im={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rg;function W1(){return Rg||(Rg=1,function(i){function o(Je,wt){var bt=Je.length;Je.push(wt);e:for(;0<bt;){var xi=bt-1>>>1,Te=Je[xi];if(0<C(Te,wt))Je[xi]=wt,Je[bt]=Te,bt=xi;else break e}}function m(Je){return Je.length===0?null:Je[0]}function v(Je){if(Je.length===0)return null;var wt=Je[0],bt=Je.pop();if(bt!==wt){Je[0]=bt;e:for(var xi=0,Te=Je.length,ut=Te>>>1;xi<ut;){var xt=2*(xi+1)-1,At=Je[xt],Ot=xt+1,Xt=Je[Ot];if(0>C(At,bt))Ot<Te&&0>C(Xt,At)?(Je[xi]=Xt,Je[Ot]=bt,xi=Ot):(Je[xi]=At,Je[xt]=bt,xi=xt);else if(Ot<Te&&0>C(Xt,bt))Je[xi]=Xt,Je[Ot]=bt,xi=Ot;else break e}}return wt}function C(Je,wt){var bt=Je.sortIndex-wt.sortIndex;return bt!==0?bt:Je.id-wt.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var N=performance;i.unstable_now=function(){return N.now()}}else{var M=Date,d=M.now();i.unstable_now=function(){return M.now()-d}}var K=[],W=[],we=1,Pe=null,Me=3,fe=!1,Qe=!1,ai=!1,li=!1,ei=typeof setTimeout=="function"?setTimeout:null,Ci=typeof clearTimeout=="function"?clearTimeout:null,ni=typeof setImmediate<"u"?setImmediate:null;function Mt(Je){for(var wt=m(W);wt!==null;){if(wt.callback===null)v(W);else if(wt.startTime<=Je)v(W),wt.sortIndex=wt.expirationTime,o(K,wt);else break;wt=m(W)}}function Et(Je){if(ai=!1,Mt(Je),!Qe)if(m(K)!==null)Qe=!0,Ut||(Ut=!0,ia());else{var wt=m(W);wt!==null&&Fa(Et,wt.startTime-Je)}}var Ut=!1,Ii=-1,bi=5,nr=-1;function Ms(){return li?!0:!(i.unstable_now()-nr<bi)}function mn(){if(li=!1,Ut){var Je=i.unstable_now();nr=Je;var wt=!0;try{e:{Qe=!1,ai&&(ai=!1,Ci(Ii),Ii=-1),fe=!0;var bt=Me;try{t:{for(Mt(Je),Pe=m(K);Pe!==null&&!(Pe.expirationTime>Je&&Ms());){var xi=Pe.callback;if(typeof xi=="function"){Pe.callback=null,Me=Pe.priorityLevel;var Te=xi(Pe.expirationTime<=Je);if(Je=i.unstable_now(),typeof Te=="function"){Pe.callback=Te,Mt(Je),wt=!0;break t}Pe===m(K)&&v(K),Mt(Je)}else v(K);Pe=m(K)}if(Pe!==null)wt=!0;else{var ut=m(W);ut!==null&&Fa(Et,ut.startTime-Je),wt=!1}}break e}finally{Pe=null,Me=bt,fe=!1}wt=void 0}}finally{wt?ia():Ut=!1}}}var ia;if(typeof ni=="function")ia=function(){ni(mn)};else if(typeof MessageChannel<"u"){var sn=new MessageChannel,xa=sn.port2;sn.port1.onmessage=mn,ia=function(){xa.postMessage(null)}}else ia=function(){ei(mn,0)};function Fa(Je,wt){Ii=ei(function(){Je(i.unstable_now())},wt)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Je){Je.callback=null},i.unstable_forceFrameRate=function(Je){0>Je||125<Je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):bi=0<Je?Math.floor(1e3/Je):5},i.unstable_getCurrentPriorityLevel=function(){return Me},i.unstable_next=function(Je){switch(Me){case 1:case 2:case 3:var wt=3;break;default:wt=Me}var bt=Me;Me=wt;try{return Je()}finally{Me=bt}},i.unstable_requestPaint=function(){li=!0},i.unstable_runWithPriority=function(Je,wt){switch(Je){case 1:case 2:case 3:case 4:case 5:break;default:Je=3}var bt=Me;Me=Je;try{return wt()}finally{Me=bt}},i.unstable_scheduleCallback=function(Je,wt,bt){var xi=i.unstable_now();switch(typeof bt=="object"&&bt!==null?(bt=bt.delay,bt=typeof bt=="number"&&0<bt?xi+bt:xi):bt=xi,Je){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=bt+Te,Je={id:we++,callback:wt,priorityLevel:Je,startTime:bt,expirationTime:Te,sortIndex:-1},bt>xi?(Je.sortIndex=bt,o(W,Je),m(K)===null&&Je===m(W)&&(ai?(Ci(Ii),Ii=-1):ai=!0,Fa(Et,bt-xi))):(Je.sortIndex=Te,o(K,Je),Qe||fe||(Qe=!0,Ut||(Ut=!0,ia()))),Je},i.unstable_shouldYield=Ms,i.unstable_wrapCallback=function(Je){var wt=Me;return function(){var bt=Me;Me=wt;try{return Je.apply(this,arguments)}finally{Me=bt}}}}(Im)),Im}var Pg;function J1(){return Pg||(Pg=1,Mm.exports=W1()),Mm.exports}var Dm={exports:{}},kr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lg;function ey(){if(Lg)return kr;Lg=1;var i=ng();function o(K){var W="https://react.dev/errors/"+K;if(1<arguments.length){W+="?args[]="+encodeURIComponent(arguments[1]);for(var we=2;we<arguments.length;we++)W+="&args[]="+encodeURIComponent(arguments[we])}return"Minified React error #"+K+"; visit "+W+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function m(){}var v={d:{f:m,r:function(){throw Error(o(522))},D:m,C:m,L:m,m,X:m,S:m,M:m},p:0,findDOMNode:null},C=Symbol.for("react.portal");function N(K,W,we){var Pe=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:C,key:Pe==null?null:""+Pe,children:K,containerInfo:W,implementation:we}}var M=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(K,W){if(K==="font")return"";if(typeof W=="string")return W==="use-credentials"?W:""}return kr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=v,kr.createPortal=function(K,W){var we=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!W||W.nodeType!==1&&W.nodeType!==9&&W.nodeType!==11)throw Error(o(299));return N(K,W,null,we)},kr.flushSync=function(K){var W=M.T,we=v.p;try{if(M.T=null,v.p=2,K)return K()}finally{M.T=W,v.p=we,v.d.f()}},kr.preconnect=function(K,W){typeof K=="string"&&(W?(W=W.crossOrigin,W=typeof W=="string"?W==="use-credentials"?W:"":void 0):W=null,v.d.C(K,W))},kr.prefetchDNS=function(K){typeof K=="string"&&v.d.D(K)},kr.preinit=function(K,W){if(typeof K=="string"&&W&&typeof W.as=="string"){var we=W.as,Pe=d(we,W.crossOrigin),Me=typeof W.integrity=="string"?W.integrity:void 0,fe=typeof W.fetchPriority=="string"?W.fetchPriority:void 0;we==="style"?v.d.S(K,typeof W.precedence=="string"?W.precedence:void 0,{crossOrigin:Pe,integrity:Me,fetchPriority:fe}):we==="script"&&v.d.X(K,{crossOrigin:Pe,integrity:Me,fetchPriority:fe,nonce:typeof W.nonce=="string"?W.nonce:void 0})}},kr.preinitModule=function(K,W){if(typeof K=="string")if(typeof W=="object"&&W!==null){if(W.as==null||W.as==="script"){var we=d(W.as,W.crossOrigin);v.d.M(K,{crossOrigin:we,integrity:typeof W.integrity=="string"?W.integrity:void 0,nonce:typeof W.nonce=="string"?W.nonce:void 0})}}else W==null&&v.d.M(K)},kr.preload=function(K,W){if(typeof K=="string"&&typeof W=="object"&&W!==null&&typeof W.as=="string"){var we=W.as,Pe=d(we,W.crossOrigin);v.d.L(K,we,{crossOrigin:Pe,integrity:typeof W.integrity=="string"?W.integrity:void 0,nonce:typeof W.nonce=="string"?W.nonce:void 0,type:typeof W.type=="string"?W.type:void 0,fetchPriority:typeof W.fetchPriority=="string"?W.fetchPriority:void 0,referrerPolicy:typeof W.referrerPolicy=="string"?W.referrerPolicy:void 0,imageSrcSet:typeof W.imageSrcSet=="string"?W.imageSrcSet:void 0,imageSizes:typeof W.imageSizes=="string"?W.imageSizes:void 0,media:typeof W.media=="string"?W.media:void 0})}},kr.preloadModule=function(K,W){if(typeof K=="string")if(W){var we=d(W.as,W.crossOrigin);v.d.m(K,{as:typeof W.as=="string"&&W.as!=="script"?W.as:void 0,crossOrigin:we,integrity:typeof W.integrity=="string"?W.integrity:void 0})}else v.d.m(K)},kr.requestFormReset=function(K){v.d.r(K)},kr.unstable_batchedUpdates=function(K,W){return K(W)},kr.useFormState=function(K,W,we){return M.H.useFormState(K,W,we)},kr.useFormStatus=function(){return M.H.useHostTransitionStatus()},kr.version="19.1.0",kr}var Ng;function S_(){if(Ng)return Dm.exports;Ng=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(o){console.error(o)}}return i(),Dm.exports=ey(),Dm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Og;function ty(){if(Og)return O0;Og=1;var i=J1(),o=ng(),m=S_();function v(a){var u="https://react.dev/errors/"+a;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+a+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function C(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function N(a){var u=a,h=a;if(a.alternate)for(;u.return;)u=u.return;else{a=u;do u=a,(u.flags&4098)!==0&&(h=u.return),a=u.return;while(a)}return u.tag===3?h:null}function M(a){if(a.tag===13){var u=a.memoizedState;if(u===null&&(a=a.alternate,a!==null&&(u=a.memoizedState)),u!==null)return u.dehydrated}return null}function d(a){if(N(a)!==a)throw Error(v(188))}function K(a){var u=a.alternate;if(!u){if(u=N(a),u===null)throw Error(v(188));return u!==a?null:a}for(var h=a,_=u;;){var w=h.return;if(w===null)break;var D=w.alternate;if(D===null){if(_=w.return,_!==null){h=_;continue}break}if(w.child===D.child){for(D=w.child;D;){if(D===h)return d(w),a;if(D===_)return d(w),u;D=D.sibling}throw Error(v(188))}if(h.return!==_.return)h=w,_=D;else{for(var q=!1,Q=w.child;Q;){if(Q===h){q=!0,h=w,_=D;break}if(Q===_){q=!0,_=w,h=D;break}Q=Q.sibling}if(!q){for(Q=D.child;Q;){if(Q===h){q=!0,h=D,_=w;break}if(Q===_){q=!0,_=D,h=w;break}Q=Q.sibling}if(!q)throw Error(v(189))}}if(h.alternate!==_)throw Error(v(190))}if(h.tag!==3)throw Error(v(188));return h.stateNode.current===h?a:u}function W(a){var u=a.tag;if(u===5||u===26||u===27||u===6)return a;for(a=a.child;a!==null;){if(u=W(a),u!==null)return u;a=a.sibling}return null}var we=Object.assign,Pe=Symbol.for("react.element"),Me=Symbol.for("react.transitional.element"),fe=Symbol.for("react.portal"),Qe=Symbol.for("react.fragment"),ai=Symbol.for("react.strict_mode"),li=Symbol.for("react.profiler"),ei=Symbol.for("react.provider"),Ci=Symbol.for("react.consumer"),ni=Symbol.for("react.context"),Mt=Symbol.for("react.forward_ref"),Et=Symbol.for("react.suspense"),Ut=Symbol.for("react.suspense_list"),Ii=Symbol.for("react.memo"),bi=Symbol.for("react.lazy"),nr=Symbol.for("react.activity"),Ms=Symbol.for("react.memo_cache_sentinel"),mn=Symbol.iterator;function ia(a){return a===null||typeof a!="object"?null:(a=mn&&a[mn]||a["@@iterator"],typeof a=="function"?a:null)}var sn=Symbol.for("react.client.reference");function xa(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===sn?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case Qe:return"Fragment";case li:return"Profiler";case ai:return"StrictMode";case Et:return"Suspense";case Ut:return"SuspenseList";case nr:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case fe:return"Portal";case ni:return(a.displayName||"Context")+".Provider";case Ci:return(a._context.displayName||"Context")+".Consumer";case Mt:var u=a.render;return a=a.displayName,a||(a=u.displayName||u.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Ii:return u=a.displayName||null,u!==null?u:xa(a.type)||"Memo";case bi:u=a._payload,a=a._init;try{return xa(a(u))}catch{}}return null}var Fa=Array.isArray,Je=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,wt=m.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,bt={pending:!1,data:null,method:null,action:null},xi=[],Te=-1;function ut(a){return{current:a}}function xt(a){0>Te||(a.current=xi[Te],xi[Te]=null,Te--)}function At(a,u){Te++,xi[Te]=a.current,a.current=u}var Ot=ut(null),Xt=ut(null),Vt=ut(null),aa=ut(null);function Ni(a,u){switch(At(Vt,u),At(Xt,a),At(Ot,null),u.nodeType){case 9:case 11:a=(a=u.documentElement)&&(a=a.namespaceURI)?M0(a):0;break;default:if(a=u.tagName,u=u.namespaceURI)u=M0(u),a=I0(u,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}xt(Ot),At(Ot,a)}function qn(){xt(Ot),xt(Xt),xt(Vt)}function Bo(a){a.memoizedState!==null&&At(aa,a);var u=Ot.current,h=I0(u,a.type);u!==h&&(At(Xt,a),At(Ot,h))}function gn(a){Xt.current===a&&(xt(Ot),xt(Xt)),aa.current===a&&(xt(aa),ue._currentValue=bt)}var Rn=Object.prototype.hasOwnProperty,on=i.unstable_scheduleCallback,Oi=i.unstable_cancelCallback,Jr=i.unstable_shouldYield,ro=i.unstable_requestPaint,Ra=i.unstable_now,Sl=i.unstable_getCurrentPriorityLevel,Du=i.unstable_ImmediatePriority,Vn=i.unstable_UserBlockingPriority,rr=i.unstable_NormalPriority,zo=i.unstable_LowPriority,so=i.unstable_IdlePriority,Is=i.log,Ru=i.unstable_setDisableYieldValue,es=null,Ka=null;function _n(a){if(typeof Is=="function"&&Ru(a),Ka&&typeof Ka.setStrictMode=="function")try{Ka.setStrictMode(es,a)}catch{}}var Pa=Math.clz32?Math.clz32:wr,oo=Math.log,Pu=Math.LN2;function wr(a){return a>>>=0,a===0?32:31-(oo(a)/Pu|0)|0}var un=256,sr=4194304;function Ce(a){var u=a&42;if(u!==0)return u;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function $(a,u,h){var _=a.pendingLanes;if(_===0)return 0;var w=0,D=a.suspendedLanes,q=a.pingedLanes;a=a.warmLanes;var Q=_&134217727;return Q!==0?(_=Q&~D,_!==0?w=Ce(_):(q&=Q,q!==0?w=Ce(q):h||(h=Q&~a,h!==0&&(w=Ce(h))))):(Q=_&~D,Q!==0?w=Ce(Q):q!==0?w=Ce(q):h||(h=_&~a,h!==0&&(w=Ce(h)))),w===0?0:u!==0&&u!==w&&(u&D)===0&&(D=w&-w,h=u&-u,D>=h||D===32&&(h&4194048)!==0)?u:w}function X(a,u){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&u)===0}function ie(a,u){switch(a){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function he(){var a=un;return un<<=1,(un&4194048)===0&&(un=256),a}function ve(){var a=sr;return sr<<=1,(sr&62914560)===0&&(sr=4194304),a}function te(a){for(var u=[],h=0;31>h;h++)u.push(a);return u}function Le(a,u){a.pendingLanes|=u,u!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Ae(a,u,h,_,w,D){var q=a.pendingLanes;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=h,a.entangledLanes&=h,a.errorRecoveryDisabledLanes&=h,a.shellSuspendCounter=0;var Q=a.entanglements,ge=a.expirationTimes,ze=a.hiddenUpdates;for(h=q&~h;0<h;){var tt=31-Pa(h),nt=1<<tt;Q[tt]=0,ge[tt]=-1;var qe=ze[tt];if(qe!==null)for(ze[tt]=null,tt=0;tt<qe.length;tt++){var Ze=qe[tt];Ze!==null&&(Ze.lane&=-536870913)}h&=~nt}_!==0&&Re(a,_,0),D!==0&&w===0&&a.tag!==0&&(a.suspendedLanes|=D&~(q&~u))}function Re(a,u,h){a.pendingLanes|=u,a.suspendedLanes&=~u;var _=31-Pa(u);a.entangledLanes|=u,a.entanglements[_]=a.entanglements[_]|1073741824|h&4194090}function Fe(a,u){var h=a.entangledLanes|=u;for(a=a.entanglements;h;){var _=31-Pa(h),w=1<<_;w&u|a[_]&u&&(a[_]|=u),h&=~w}}function Ie(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function et(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function pt(){var a=wt.p;return a!==0?a:(a=window.event,a===void 0?32:Ct(a.type))}function _t(a,u){var h=wt.p;try{return wt.p=a,u()}finally{wt.p=h}}var It=Math.random().toString(36).slice(2),kt="__reactFiber$"+It,Rt="__reactProps$"+It,Ve="__reactContainer$"+It,vi="__reactEvents$"+It,fi="__reactListeners$"+It,Ti="__reactHandles$"+It,jt="__reactResources$"+It,We="__reactMarker$"+It;function Ft(a){delete a[kt],delete a[Rt],delete a[vi],delete a[fi],delete a[Ti]}function Gt(a){var u=a[kt];if(u)return u;for(var h=a.parentNode;h;){if(u=h[Ve]||h[kt]){if(h=u.alternate,u.child!==null||h!==null&&h.child!==null)for(a=Cu(a);a!==null;){if(h=a[kt])return h;a=Cu(a)}return u}a=h,h=a.parentNode}return null}function Fi(a){if(a=a[kt]||a[Ve]){var u=a.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return a}return null}function Gi(a){var u=a.tag;if(u===5||u===26||u===27||u===6)return a.stateNode;throw Error(v(33))}function qa(a){var u=a[jt];return u||(u=a[jt]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Bt(a){a[We]=!0}var Fo=new Set,Lu={};function or(a,u){ts(a,u),ts(a+"Capture",u)}function ts(a,u){for(Lu[a]=u,a=0;a<u.length;a++)Fo.add(u[a])}var Ds=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),uo={},va={};function ur(a){return Rn.call(va,a)?!0:Rn.call(uo,a)?!1:Ds.test(a)?va[a]=!0:(uo[a]=!0,!1)}function Ui(a,u,h){if(ur(u))if(h===null)a.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":a.removeAttribute(u);return;case"boolean":var _=u.toLowerCase().slice(0,5);if(_!=="data-"&&_!=="aria-"){a.removeAttribute(u);return}}a.setAttribute(u,""+h)}}function lo(a,u,h){if(h===null)a.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(u);return}a.setAttribute(u,""+h)}}function Gn(a,u,h,_){if(_===null)a.removeAttribute(h);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}a.setAttributeNS(u,h,""+_)}}var Cl,co;function Zn(a){if(Cl===void 0)try{throw Error()}catch(h){var u=h.stack.trim().match(/\n( *(at )?)/);Cl=u&&u[1]||"",co=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Cl+a+co}var _c=!1;function Ml(a,u){if(!a||_c)return"";_c=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var _={DetermineComponentFrameRoot:function(){try{if(u){var nt=function(){throw Error()};if(Object.defineProperty(nt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(nt,[])}catch(Ze){var qe=Ze}Reflect.construct(a,[],nt)}else{try{nt.call()}catch(Ze){qe=Ze}a.call(nt.prototype)}}else{try{throw Error()}catch(Ze){qe=Ze}(nt=a())&&typeof nt.catch=="function"&&nt.catch(function(){})}}catch(Ze){if(Ze&&qe&&typeof Ze.stack=="string")return[Ze.stack,qe.stack]}return[null,null]}};_.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(_.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(_.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=_.DetermineComponentFrameRoot(),q=D[0],Q=D[1];if(q&&Q){var ge=q.split(`
`),ze=Q.split(`
`);for(w=_=0;_<ge.length&&!ge[_].includes("DetermineComponentFrameRoot");)_++;for(;w<ze.length&&!ze[w].includes("DetermineComponentFrameRoot");)w++;if(_===ge.length||w===ze.length)for(_=ge.length-1,w=ze.length-1;1<=_&&0<=w&&ge[_]!==ze[w];)w--;for(;1<=_&&0<=w;_--,w--)if(ge[_]!==ze[w]){if(_!==1||w!==1)do if(_--,w--,0>w||ge[_]!==ze[w]){var tt=`
`+ge[_].replace(" at new "," at ");return a.displayName&&tt.includes("<anonymous>")&&(tt=tt.replace("<anonymous>",a.displayName)),tt}while(1<=_&&0<=w);break}}}finally{_c=!1,Error.prepareStackTrace=h}return(h=a?a.displayName||a.name:"")?Zn(h):""}function xd(a){switch(a.tag){case 26:case 27:case 5:return Zn(a.type);case 16:return Zn("Lazy");case 13:return Zn("Suspense");case 19:return Zn("SuspenseList");case 0:case 15:return Ml(a.type,!1);case 11:return Ml(a.type.render,!1);case 1:return Ml(a.type,!0);case 31:return Zn("Activity");default:return""}}function Uo(a){try{var u="";do u+=xd(a),a=a.return;while(a);return u}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function lr(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function vd(a){var u=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function Ff(a){var u=vd(a)?"checked":"value",h=Object.getOwnPropertyDescriptor(a.constructor.prototype,u),_=""+a[u];if(!a.hasOwnProperty(u)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var w=h.get,D=h.set;return Object.defineProperty(a,u,{configurable:!0,get:function(){return w.call(this)},set:function(q){_=""+q,D.call(this,q)}}),Object.defineProperty(a,u,{enumerable:h.enumerable}),{getValue:function(){return _},setValue:function(q){_=""+q},stopTracking:function(){a._valueTracker=null,delete a[u]}}}}function yc(a){a._valueTracker||(a._valueTracker=Ff(a))}function Eh(a){if(!a)return!1;var u=a._valueTracker;if(!u)return!0;var h=u.getValue(),_="";return a&&(_=vd(a)?a.checked?"true":"false":a.value),a=_,a!==h?(u.setValue(a),!0):!1}function Nu(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Ho=/[\n"\\]/g;function Yn(a){return a.replace(Ho,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function bc(a,u,h,_,w,D,q,Q){a.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?a.type=q:a.removeAttribute("type"),u!=null?q==="number"?(u===0&&a.value===""||a.value!=u)&&(a.value=""+lr(u)):a.value!==""+lr(u)&&(a.value=""+lr(u)):q!=="submit"&&q!=="reset"||a.removeAttribute("value"),u!=null?Il(a,q,lr(u)):h!=null?Il(a,q,lr(h)):_!=null&&a.removeAttribute("value"),w==null&&D!=null&&(a.defaultChecked=!!D),w!=null&&(a.checked=w&&typeof w!="function"&&typeof w!="symbol"),Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?a.name=""+lr(Q):a.removeAttribute("name")}function ho(a,u,h,_,w,D,q,Q){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(a.type=D),u!=null||h!=null){if(!(D!=="submit"&&D!=="reset"||u!=null))return;h=h!=null?""+lr(h):"",u=u!=null?""+lr(u):h,Q||u===a.value||(a.value=u),a.defaultValue=u}_=_??w,_=typeof _!="function"&&typeof _!="symbol"&&!!_,a.checked=Q?a.checked:!!_,a.defaultChecked=!!_,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(a.name=q)}function Il(a,u,h){u==="number"&&Nu(a.ownerDocument)===a||a.defaultValue===""+h||(a.defaultValue=""+h)}function Ou(a,u,h,_){if(a=a.options,u){u={};for(var w=0;w<h.length;w++)u["$"+h[w]]=!0;for(h=0;h<a.length;h++)w=u.hasOwnProperty("$"+a[h].value),a[h].selected!==w&&(a[h].selected=w),w&&_&&(a[h].defaultSelected=!0)}else{for(h=""+lr(h),u=null,w=0;w<a.length;w++){if(a[w].value===h){a[w].selected=!0,_&&(a[w].defaultSelected=!0);return}u!==null||a[w].disabled||(u=a[w])}u!==null&&(u.selected=!0)}}function ku(a,u,h){if(u!=null&&(u=""+lr(u),u!==a.value&&(a.value=u),h==null)){a.defaultValue!==u&&(a.defaultValue=u);return}a.defaultValue=h!=null?""+lr(h):""}function Bu(a,u,h,_){if(u==null){if(_!=null){if(h!=null)throw Error(v(92));if(Fa(_)){if(1<_.length)throw Error(v(93));_=_[0]}h=_}h==null&&(h=""),u=h}h=lr(u),a.defaultValue=h,_=a.textContent,_===h&&_!==""&&_!==null&&(a.value=_)}function fo(a,u){if(u){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=u;return}}a.textContent=u}var Pn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function mi(a,u,h){var _=u.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?_?a.setProperty(u,""):u==="float"?a.cssFloat="":a[u]="":_?a.setProperty(u,h):typeof h!="number"||h===0||Pn.has(u)?u==="float"?a.cssFloat=h:a[u]=(""+h).trim():a[u]=h+"px"}function jo(a,u,h){if(u!=null&&typeof u!="object")throw Error(v(62));if(a=a.style,h!=null){for(var _ in h)!h.hasOwnProperty(_)||u!=null&&u.hasOwnProperty(_)||(_.indexOf("--")===0?a.setProperty(_,""):_==="float"?a.cssFloat="":a[_]="");for(var w in u)_=u[w],u.hasOwnProperty(w)&&h[w]!==_&&mi(a,w,_)}else for(var D in u)u.hasOwnProperty(D)&&mi(a,D,u[D])}function ln(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),pi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function po(a){return pi.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var Vo=null;function mo(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Va=null,Ta=null;function Ea(a){var u=Fi(a);if(u&&(a=u.stateNode)){var h=a[Rt]||null;e:switch(a=u.stateNode,u.type){case"input":if(bc(a,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),u=h.name,h.type==="radio"&&u!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Yn(""+u)+'"][type="radio"]'),u=0;u<h.length;u++){var _=h[u];if(_!==a&&_.form===a.form){var w=_[Rt]||null;if(!w)throw Error(v(90));bc(_,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(u=0;u<h.length;u++)_=h[u],_.form===a.form&&Eh(_)}break e;case"textarea":ku(a,h.value,h.defaultValue);break e;case"select":u=h.value,u!=null&&Ou(a,!!h.multiple,u,!1)}}}var Ga=!1;function Zi(a,u,h){if(Ga)return a(u,h);Ga=!0;try{var _=a(u);return _}finally{if(Ga=!1,(Va!==null||Ta!==null)&&(Mn(),Va&&(u=Va,a=Ta,Ta=Va=null,Ea(u),a)))for(u=0;u<a.length;u++)Ea(a[u])}}function is(a,u){var h=a.stateNode;if(h===null)return null;var _=h[Rt]||null;if(_===null)return null;h=_[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(a=a.type,_=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!_;break e;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(v(231,u,typeof h));return h}var ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ln=!1;if(ma)try{var Wa={};Object.defineProperty(Wa,"passive",{get:function(){Ln=!0}}),window.addEventListener("test",Wa,Wa),window.removeEventListener("test",Wa,Wa)}catch{Ln=!1}var Ar=null,Di=null,Wi=null;function ci(){if(Wi)return Wi;var a,u=Di,h=u.length,_,w="value"in Ar?Ar.value:Ar.textContent,D=w.length;for(a=0;a<h&&u[a]===w[a];a++);var q=h-a;for(_=1;_<=q&&u[h-_]===w[D-_];_++);return Wi=w.slice(a,1<_?1-_:void 0)}function Zt(a){var u=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&u===13&&(a=13)):a=u,a===10&&(a=13),32<=a||a===13?a:0}function Rs(){return!0}function ti(){return!1}function cn(a){function u(h,_,w,D,q){this._reactName=h,this._targetInst=w,this.type=_,this.nativeEvent=D,this.target=q,this.currentTarget=null;for(var Q in a)a.hasOwnProperty(Q)&&(h=a[Q],this[Q]=h?h(D):D[Q]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?Rs:ti,this.isPropagationStopped=ti,this}return we(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Rs)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Rs)},persist:function(){},isPersistent:Rs}),u}var wa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zu=cn(wa),Go=we({},wa,{view:0,detail:0}),Dl=cn(Go),go,Zo,Yo,$o=we({},Go,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jo,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Yo&&(Yo&&a.type==="mousemove"?(go=a.screenX-Yo.screenX,Zo=a.screenY-Yo.screenY):Zo=go=0,Yo=a),go)},movementY:function(a){return"movementY"in a?a.movementY:Zo}}),Fu=cn($o),Xo=we({},$o,{dataTransfer:0}),Ja=cn(Xo),Qo=we({},Go,{relatedTarget:0}),Ko=cn(Qo),_o=we({},wa,{animationName:0,elapsedTime:0,pseudoElement:0}),en=cn(_o),xc=we({},wa,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),vc=cn(xc),Td=we({},wa,{data:0}),Ed=cn(Td),yn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},as={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wo(a){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(a):(a=as[a])?!!u[a]:!1}function Jo(){return Wo}var Sr=we({},Go,{key:function(a){if(a.key){var u=yn[a.key]||a.key;if(u!=="Unidentified")return u}return a.type==="keypress"?(a=Zt(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Rl[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jo,charCode:function(a){return a.type==="keypress"?Zt(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Zt(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),eu=cn(Sr),Tc=we({},$o,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wd=cn(Tc),wh=we({},Go,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jo}),Uf=cn(wh),Hf=we({},wa,{propertyName:0,elapsedTime:0,pseudoElement:0}),jf=cn(Hf),Ec=we({},$o,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Uu=cn(Ec),wc=we({},wa,{newState:0,oldState:0}),Ac=cn(wc),Sc=[9,13,27,32],Cr=ma&&"CompositionEvent"in window,Hu=null;ma&&"documentMode"in document&&(Hu=document.documentMode);var Ah=ma&&"TextEvent"in window&&!Hu,ju=ma&&(!Cr||Hu&&8<Hu&&11>=Hu),qu=" ",Ad=!1;function Pl(a,u){switch(a){case"keyup":return Sc.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sh(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Mr=!1;function Sd(a,u){switch(a){case"compositionend":return Sh(u);case"keypress":return u.which!==32?null:(Ad=!0,qu);case"textInput":return a=u.data,a===qu&&Ad?null:a;default:return null}}function Cd(a,u){if(Mr)return a==="compositionend"||!Cr&&Pl(a,u)?(a=ci(),Wi=Di=Ar=null,Mr=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return ju&&u.locale!=="ko"?null:u.data;default:return null}}var qf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ch(a){var u=a&&a.nodeName&&a.nodeName.toLowerCase();return u==="input"?!!qf[a.type]:u==="textarea"}function Vu(a,u,h,_){Va?Ta?Ta.push(_):Ta=[_]:Va=_,u=yl(u,"onChange"),0<u.length&&(h=new zu("onChange","change",null,h,_),a.push({event:h,listeners:u}))}var Gu=null,Zu=null;function Md(a){Au(a,0)}function Yu(a){var u=Gi(a);if(Eh(u))return a}function Ps(a,u){if(a==="change")return u}var Mh=!1;if(ma){var Cc;if(ma){var yo="oninput"in document;if(!yo){var Ih=document.createElement("div");Ih.setAttribute("oninput","return;"),yo=typeof Ih.oninput=="function"}Cc=yo}else Cc=!1;Mh=Cc&&(!document.documentMode||9<document.documentMode)}function Ll(){Gu&&(Gu.detachEvent("onpropertychange",Id),Zu=Gu=null)}function Id(a){if(a.propertyName==="value"&&Yu(Zu)){var u=[];Vu(u,Zu,a,mo(a)),Zi(Md,u)}}function Vf(a,u,h){a==="focusin"?(Ll(),Gu=u,Zu=h,Gu.attachEvent("onpropertychange",Id)):a==="focusout"&&Ll()}function Dh(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Yu(Zu)}function Dd(a,u){if(a==="click")return Yu(u)}function Rd(a,u){if(a==="input"||a==="change")return Yu(u)}function Rh(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}var $n=typeof Object.is=="function"?Object.is:Rh;function hi(a,u){if($n(a,u))return!0;if(typeof a!="object"||a===null||typeof u!="object"||u===null)return!1;var h=Object.keys(a),_=Object.keys(u);if(h.length!==_.length)return!1;for(_=0;_<h.length;_++){var w=h[_];if(!Rn.call(u,w)||!$n(a[w],u[w]))return!1}return!0}function ns(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Mc(a,u){var h=ns(a);a=0;for(var _;h;){if(h.nodeType===3){if(_=a+h.textContent.length,a<=u&&_>=u)return{node:h,offset:u-a};a=_}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=ns(h)}}function Ic(a,u){return a&&u?a===u?!0:a&&a.nodeType===3?!1:u&&u.nodeType===3?Ic(a,u.parentNode):"contains"in a?a.contains(u):a.compareDocumentPosition?!!(a.compareDocumentPosition(u)&16):!1:!1}function Dc(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var u=Nu(a.document);u instanceof a.HTMLIFrameElement;){try{var h=typeof u.contentWindow.location.href=="string"}catch{h=!1}if(h)a=u.contentWindow;else break;u=Nu(a.document)}return u}function Rc(a){var u=a&&a.nodeName&&a.nodeName.toLowerCase();return u&&(u==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||u==="textarea"||a.contentEditable==="true")}var Ph=ma&&"documentMode"in document&&11>=document.documentMode,Ir=null,Nl=null,Ol=null,Lh=!1;function Pd(a,u,h){var _=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Lh||Ir==null||Ir!==Nu(_)||(_=Ir,"selectionStart"in _&&Rc(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),Ol&&hi(Ol,_)||(Ol=_,_=yl(Nl,"onSelect"),0<_.length&&(u=new zu("onSelect","select",null,u,h),a.push({event:u,listeners:_}),u.target=Ir)))}function tu(a,u){var h={};return h[a.toLowerCase()]=u.toLowerCase(),h["Webkit"+a]="webkit"+u,h["Moz"+a]="moz"+u,h}var iu={animationend:tu("Animation","AnimationEnd"),animationiteration:tu("Animation","AnimationIteration"),animationstart:tu("Animation","AnimationStart"),transitionrun:tu("Transition","TransitionRun"),transitionstart:tu("Transition","TransitionStart"),transitioncancel:tu("Transition","TransitionCancel"),transitionend:tu("Transition","TransitionEnd")},Nh={},Oh={};ma&&(Oh=document.createElement("div").style,"AnimationEvent"in window||(delete iu.animationend.animation,delete iu.animationiteration.animation,delete iu.animationstart.animation),"TransitionEvent"in window||delete iu.transitionend.transition);function rs(a){if(Nh[a])return Nh[a];if(!iu[a])return a;var u=iu[a],h;for(h in u)if(u.hasOwnProperty(h)&&h in Oh)return Nh[a]=u[h];return a}var kl=rs("animationend"),Bl=rs("animationiteration"),Pc=rs("animationstart"),au=rs("transitionrun"),Lc=rs("transitionstart"),$u=rs("transitioncancel"),cr=rs("transitionend"),kh=new Map,Nc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Nc.push("scrollEnd");function hr(a,u){kh.set(a,u),or(u,[a])}var bo=new WeakMap;function Nn(a,u){if(typeof a=="object"&&a!==null){var h=bo.get(a);return h!==void 0?h:(u={value:a,source:u,stack:Uo(u)},bo.set(a,u),u)}return{value:a,source:u,stack:Uo(u)}}var On=[],ss=0,Xu=0;function nu(){for(var a=ss,u=Xu=ss=0;u<a;){var h=On[u];On[u++]=null;var _=On[u];On[u++]=null;var w=On[u];On[u++]=null;var D=On[u];if(On[u++]=null,_!==null&&w!==null){var q=_.pending;q===null?w.next=w:(w.next=q.next,q.next=w),_.pending=w}D!==0&&zl(h,w,D)}}function Ls(a,u,h,_){On[ss++]=a,On[ss++]=u,On[ss++]=h,On[ss++]=_,Xu|=_,a.lanes|=_,a=a.alternate,a!==null&&(a.lanes|=_)}function xo(a,u,h,_){return Ls(a,u,h,_),si(a)}function ru(a,u){return Ls(a,null,null,u),si(a)}function zl(a,u,h){a.lanes|=h;var _=a.alternate;_!==null&&(_.lanes|=h);for(var w=!1,D=a.return;D!==null;)D.childLanes|=h,_=D.alternate,_!==null&&(_.childLanes|=h),D.tag===22&&(a=D.stateNode,a===null||a._visibility&1||(w=!0)),a=D,D=D.return;return a.tag===3?(D=a.stateNode,w&&u!==null&&(w=31-Pa(h),a=D.hiddenUpdates,_=a[w],_===null?a[w]=[u]:_.push(u),u.lane=h|536870912),D):null}function si(a){if(50<Jh)throw Jh=0,nf=null,Error(v(185));for(var u=a.return;u!==null;)a=u,u=a.return;return a.tag===3?a.stateNode:null}var Ns={};function Oc(a,u,h,_){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(a,u,h,_){return new Oc(a,u,h,_)}function su(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Os(a,u){var h=a.alternate;return h===null?(h=kn(a.tag,u,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=u,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&65011712,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,u=a.dependencies,h.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h.refCleanup=a.refCleanup,h}function Ld(a,u){a.flags&=65011714;var h=a.alternate;return h===null?(a.childLanes=0,a.lanes=u,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,u=h.dependencies,a.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),a}function Fl(a,u,h,_,w,D){var q=0;if(_=a,typeof a=="function")su(a)&&(q=1);else if(typeof a=="string")q=R(a,h,Ot.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case nr:return a=kn(31,h,u,w),a.elementType=nr,a.lanes=D,a;case Qe:return ou(h.children,w,D,u);case ai:q=8,w|=24;break;case li:return a=kn(12,h,u,w|2),a.elementType=li,a.lanes=D,a;case Et:return a=kn(13,h,u,w),a.elementType=Et,a.lanes=D,a;case Ut:return a=kn(19,h,u,w),a.elementType=Ut,a.lanes=D,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case ei:case ni:q=10;break e;case Ci:q=9;break e;case Mt:q=11;break e;case Ii:q=14;break e;case bi:q=16,_=null;break e}q=29,h=Error(v(130,a===null?"null":typeof a,"")),_=null}return u=kn(q,h,u,w),u.elementType=a,u.type=_,u.lanes=D,u}function ou(a,u,h,_){return a=kn(7,a,_,u),a.lanes=h,a}function Qu(a,u,h){return a=kn(6,a,null,u),a.lanes=h,a}function uu(a,u,h){return u=kn(4,a.children!==null?a.children:[],a.key,u),u.lanes=h,u.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},u}var ks=[],vo=0,lu=null,Ku=0,bn=[],xn=0,zr=null,Fr=1,dr="";function os(a,u){ks[vo++]=Ku,ks[vo++]=lu,lu=a,Ku=u}function Bh(a,u,h){bn[xn++]=Fr,bn[xn++]=dr,bn[xn++]=zr,zr=a;var _=Fr;a=dr;var w=32-Pa(_)-1;_&=~(1<<w),h+=1;var D=32-Pa(u)+w;if(30<D){var q=w-w%5;D=(_&(1<<q)-1).toString(32),_>>=q,w-=q,Fr=1<<32-Pa(u)+w|h<<w|_,dr=D+a}else Fr=1<<D|h<<w|_,dr=a}function Wu(a){a.return!==null&&(os(a,1),Bh(a,1,0))}function Ul(a){for(;a===lu;)lu=ks[--vo],ks[vo]=null,Ku=ks[--vo],ks[vo]=null;for(;a===zr;)zr=bn[--xn],bn[xn]=null,dr=bn[--xn],bn[xn]=null,Fr=bn[--xn],bn[xn]=null}var vn=null,ga=null,Ei=!1,us=null,Ur=!1,cu=Error(v(519));function Hi(a){var u=Error(v(418,""));throw Qn(Nn(u,a)),cu}function Bs(a){var u=a.stateNode,h=a.type,_=a.memoizedProps;switch(u[kt]=a,u[Rt]=_,h){case"dialog":yi("cancel",u),yi("close",u);break;case"iframe":case"object":case"embed":yi("load",u);break;case"video":case"audio":for(h=0;h<nd.length;h++)yi(nd[h],u);break;case"source":yi("error",u);break;case"img":case"image":case"link":yi("error",u),yi("load",u);break;case"details":yi("toggle",u);break;case"input":yi("invalid",u),ho(u,_.value,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name,!0),yc(u);break;case"select":yi("invalid",u);break;case"textarea":yi("invalid",u),Bu(u,_.value,_.defaultValue,_.children),yc(u)}h=_.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||u.textContent===""+h||_.suppressHydrationWarning===!0||S0(u.textContent,h)?(_.popover!=null&&(yi("beforetoggle",u),yi("toggle",u)),_.onScroll!=null&&yi("scroll",u),_.onScrollEnd!=null&&yi("scrollend",u),_.onClick!=null&&(u.onclick=od),u=!0):u=!1,u||Hi(a)}function Xn(a){for(vn=a.return;vn;)switch(vn.tag){case 5:case 13:Ur=!1;return;case 27:case 3:Ur=!0;return;default:vn=vn.return}}function hu(a){if(a!==vn)return!1;if(!Ei)return Xn(a),Ei=!0,!1;var u=a.tag,h;if((h=u!==3&&u!==27)&&((h=u===5)&&(h=a.type,h=!(h!=="form"&&h!=="button")||bf(a.type,a.memoizedProps)),h=!h),h&&ga&&Hi(a),Xn(a),u===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(v(317));e:{for(a=a.nextSibling,u=0;a;){if(a.nodeType===8)if(h=a.data,h==="/$"){if(u===0){ga=Wn(a.nextSibling);break e}u--}else h!=="$"&&h!=="$!"&&h!=="$?"||u++;a=a.nextSibling}ga=null}}else u===27?(u=ga,Su(a.type)?(a=rn,rn=null,ga=a):ga=u):ga=vn?Wn(a.stateNode.nextSibling):null;return!0}function zs(){ga=vn=null,Ei=!1}function kc(){var a=us;return a!==null&&(xr===null?xr=a:xr.push.apply(xr,a),us=null),a}function Qn(a){us===null?us=[a]:us.push(a)}var Hl=ut(null),Hr=null,jr=null;function Fs(a,u,h){At(Hl,u._currentValue),u._currentValue=h}function ls(a){a._currentValue=Hl.current,xt(Hl)}function Bc(a,u,h){for(;a!==null;){var _=a.alternate;if((a.childLanes&u)!==u?(a.childLanes|=u,_!==null&&(_.childLanes|=u)):_!==null&&(_.childLanes&u)!==u&&(_.childLanes|=u),a===h)break;a=a.return}}function To(a,u,h,_){var w=a.child;for(w!==null&&(w.return=a);w!==null;){var D=w.dependencies;if(D!==null){var q=w.child;D=D.firstContext;e:for(;D!==null;){var Q=D;D=w;for(var ge=0;ge<u.length;ge++)if(Q.context===u[ge]){D.lanes|=h,Q=D.alternate,Q!==null&&(Q.lanes|=h),Bc(D.return,h,a),_||(q=null);break e}D=Q.next}}else if(w.tag===18){if(q=w.return,q===null)throw Error(v(341));q.lanes|=h,D=q.alternate,D!==null&&(D.lanes|=h),Bc(q,h,a),q=null}else q=w.child;if(q!==null)q.return=w;else for(q=w;q!==null;){if(q===a){q=null;break}if(w=q.sibling,w!==null){w.return=q.return,q=w;break}q=q.return}w=q}}function cs(a,u,h,_){a=null;for(var w=u,D=!1;w!==null;){if(!D){if((w.flags&524288)!==0)D=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var q=w.alternate;if(q===null)throw Error(v(387));if(q=q.memoizedProps,q!==null){var Q=w.type;$n(w.pendingProps.value,q.value)||(a!==null?a.push(Q):a=[Q])}}else if(w===aa.current){if(q=w.alternate,q===null)throw Error(v(387));q.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(a!==null?a.push(ue):a=[ue])}w=w.return}a!==null&&To(u,a,h,_),u.flags|=262144}function Aa(a){for(a=a.firstContext;a!==null;){if(!$n(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Dr(a){Hr=a,jr=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function tn(a){return zh(Hr,a)}function jl(a,u){return Hr===null&&Dr(a),zh(a,u)}function zh(a,u){var h=u._currentValue;if(u={context:u,memoizedValue:h,next:null},jr===null){if(a===null)throw Error(v(308));jr=u,a.dependencies={lanes:0,firstContext:u},a.flags|=524288}else jr=jr.next=u;return h}var Ju=typeof AbortController<"u"?AbortController:function(){var a=[],u=this.signal={aborted:!1,addEventListener:function(h,_){a.push(_)}};this.abort=function(){u.aborted=!0,a.forEach(function(h){return h()})}},Fh=i.unstable_scheduleCallback,zc=i.unstable_NormalPriority,Ua={$$typeof:ni,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Eo(){return{controller:new Ju,data:new Map,refCount:0}}function el(a){a.refCount--,a.refCount===0&&Fh(zc,function(){a.controller.abort()})}var Ha=null,fr=0,qr=0,Tn=null;function tl(a,u){if(Ha===null){var h=Ha=[];fr=0,qr=ff(),Tn={status:"pending",value:void 0,then:function(_){h.push(_)}}}return fr++,u.then(ql,ql),u}function ql(){if(--fr===0&&Ha!==null){Tn!==null&&(Tn.status="fulfilled");var a=Ha;Ha=null,qr=0,Tn=null;for(var u=0;u<a.length;u++)(0,a[u])()}}function Gf(a,u){var h=[],_={status:"pending",value:null,reason:null,then:function(w){h.push(w)}};return a.then(function(){_.status="fulfilled",_.value=u;for(var w=0;w<h.length;w++)(0,h[w])(u)},function(w){for(_.status="rejected",_.reason=w,w=0;w<h.length;w++)(0,h[w])(void 0)}),_}var Fc=Je.S;Je.S=function(a,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&tl(a,u),Fc!==null&&Fc(a,u)};var hs=ut(null);function Vl(){var a=hs.current;return a!==null?a:qi.pooledCache}function Us(a,u){u===null?At(hs,hs.current):At(hs,u.pool)}function Vr(){var a=Vl();return a===null?null:{parent:Ua._currentValue,pool:a}}var yt=Error(v(460)),Gl=Error(v(474)),du=Error(v(542)),Uc={then:function(){}};function fu(a){return a=a.status,a==="fulfilled"||a==="rejected"}function wo(){}function Hc(a,u,h){switch(h=a[h],h===void 0?a.push(u):h!==u&&(u.then(wo,wo),u=h),u.status){case"fulfilled":return u.value;case"rejected":throw a=u.reason,Nd(a),a;default:if(typeof u.status=="string")u.then(wo,wo);else{if(a=qi,a!==null&&100<a.shellSuspendCounter)throw Error(v(482));a=u,a.status="pending",a.then(function(_){if(u.status==="pending"){var w=u;w.status="fulfilled",w.value=_}},function(_){if(u.status==="pending"){var w=u;w.status="rejected",w.reason=_}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw a=u.reason,Nd(a),a}throw ri=u,yt}}var ri=null;function Zl(){if(ri===null)throw Error(v(459));var a=ri;return ri=null,a}function Nd(a){if(a===yt||a===du)throw Error(v(483))}var ds=!1;function jc(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qc(a,u){a=a.updateQueue,u.updateQueue===a&&(u.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function fs(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Gr(a,u,h){var _=a.updateQueue;if(_===null)return null;if(_=_.shared,($i&2)!==0){var w=_.pending;return w===null?u.next=u:(u.next=w.next,w.next=u),_.pending=u,u=si(a),zl(a,null,h),u}return Ls(a,_,u,h),si(a)}function Hs(a,u,h){if(u=u.updateQueue,u!==null&&(u=u.shared,(h&4194048)!==0)){var _=u.lanes;_&=a.pendingLanes,h|=_,u.lanes=h,Fe(a,h)}}function Uh(a,u){var h=a.updateQueue,_=a.alternate;if(_!==null&&(_=_.updateQueue,h===_)){var w=null,D=null;if(h=h.firstBaseUpdate,h!==null){do{var q={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};D===null?w=D=q:D=D.next=q,h=h.next}while(h!==null);D===null?w=D=u:D=D.next=u}else w=D=u;h={baseState:_.baseState,firstBaseUpdate:w,lastBaseUpdate:D,shared:_.shared,callbacks:_.callbacks},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=u}var il=!1;function Yl(){if(il){var a=Tn;if(a!==null)throw a}}function $l(a,u,h,_){il=!1;var w=a.updateQueue;ds=!1;var D=w.firstBaseUpdate,q=w.lastBaseUpdate,Q=w.shared.pending;if(Q!==null){w.shared.pending=null;var ge=Q,ze=ge.next;ge.next=null,q===null?D=ze:q.next=ze,q=ge;var tt=a.alternate;tt!==null&&(tt=tt.updateQueue,Q=tt.lastBaseUpdate,Q!==q&&(Q===null?tt.firstBaseUpdate=ze:Q.next=ze,tt.lastBaseUpdate=ge))}if(D!==null){var nt=w.baseState;q=0,tt=ze=ge=null,Q=D;do{var qe=Q.lane&-536870913,Ze=qe!==Q.lane;if(Ze?(Mi&qe)===qe:(_&qe)===qe){qe!==0&&qe===qr&&(il=!0),tt!==null&&(tt=tt.next={lane:0,tag:Q.tag,payload:Q.payload,callback:null,next:null});e:{var Wt=a,Yt=Q;qe=u;var ta=h;switch(Yt.tag){case 1:if(Wt=Yt.payload,typeof Wt=="function"){nt=Wt.call(ta,nt,qe);break e}nt=Wt;break e;case 3:Wt.flags=Wt.flags&-65537|128;case 0:if(Wt=Yt.payload,qe=typeof Wt=="function"?Wt.call(ta,nt,qe):Wt,qe==null)break e;nt=we({},nt,qe);break e;case 2:ds=!0}}qe=Q.callback,qe!==null&&(a.flags|=64,Ze&&(a.flags|=8192),Ze=w.callbacks,Ze===null?w.callbacks=[qe]:Ze.push(qe))}else Ze={lane:qe,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},tt===null?(ze=tt=Ze,ge=nt):tt=tt.next=Ze,q|=qe;if(Q=Q.next,Q===null){if(Q=w.shared.pending,Q===null)break;Ze=Q,Q=Ze.next,Ze.next=null,w.lastBaseUpdate=Ze,w.shared.pending=null}}while(!0);tt===null&&(ge=nt),w.baseState=ge,w.firstBaseUpdate=ze,w.lastBaseUpdate=tt,D===null&&(w.shared.lanes=0),vu|=q,a.lanes=q,a.memoizedState=nt}}function ps(a,u){if(typeof a!="function")throw Error(v(191,a));a.call(u)}function Yi(a,u){var h=a.callbacks;if(h!==null)for(a.callbacks=null,a=0;a<h.length;a++)ps(h[a],u)}var ms=ut(null),al=ut(0);function Hh(a,u){a=Lo,At(al,a),At(ms,u),Lo=a|u.baseLanes}function Vc(){At(al,Lo),At(ms,ms.current)}function Gc(){Lo=al.current,xt(ms),xt(al)}var Ao=0,qt=null,Ri=null,gt=null,zt=!1,gs=!1,js=!1,nl=0,ca=0,So=null,Rr=0;function Sa(){throw Error(v(321))}function qs(a,u){if(u===null)return!1;for(var h=0;h<u.length&&h<a.length;h++)if(!$n(a[h],u[h]))return!1;return!0}function na(a,u,h,_,w,D){return Ao=D,qt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Je.H=a===null||a.memoizedState===null?Wl:jh,js=!1,D=h(_,w),js=!1,gs&&(D=pu(u,h,_,w)),ra(a),D}function ra(a){Je.H=Bi;var u=Ri!==null&&Ri.next!==null;if(Ao=0,gt=Ri=qt=null,zt=!1,ca=0,So=null,u)throw Error(v(300));a===null||hn||(a=a.dependencies,a!==null&&Aa(a)&&(hn=!0))}function pu(a,u,h,_){qt=a;var w=0;do{if(gs&&(So=null),ca=0,gs=!1,25<=w)throw Error(v(301));if(w+=1,gt=Ri=null,a.updateQueue!=null){var D=a.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Je.H=Od,D=u(h,_)}while(gs);return D}function Xl(){var a=Je.H,u=a.useState()[0];return u=typeof u.then=="function"?g(u):u,a=a.useState()[0],(Ri!==null?Ri.memoizedState:null)!==a&&(qt.flags|=1024),u}function mu(){var a=nl!==0;return nl=0,a}function Vs(a,u,h){u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~h}function Ql(a){if(zt){for(a=a.memoizedState;a!==null;){var u=a.queue;u!==null&&(u.pending=null),a=a.next}zt=!1}Ao=0,gt=Ri=qt=null,gs=!1,ca=nl=0,So=null}function En(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?qt.memoizedState=gt=a:gt=gt.next=a,gt}function sa(){if(Ri===null){var a=qt.alternate;a=a!==null?a.memoizedState:null}else a=Ri.next;var u=gt===null?qt.memoizedState:gt.next;if(u!==null)gt=u,Ri=a;else{if(a===null)throw qt.alternate===null?Error(v(467)):Error(v(310));Ri=a,a={memoizedState:Ri.memoizedState,baseState:Ri.baseState,baseQueue:Ri.baseQueue,queue:Ri.queue,next:null},gt===null?qt.memoizedState=gt=a:gt=gt.next=a}return gt}function Kl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function g(a){var u=ca;return ca+=1,So===null&&(So=[]),a=Hc(So,a,u),u=qt,(gt===null?u.memoizedState:gt.next)===null&&(u=u.alternate,Je.H=u===null||u.memoizedState===null?Wl:jh),a}function e(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return g(a);if(a.$$typeof===ni)return tn(a)}throw Error(v(438,String(a)))}function n(a){var u=null,h=qt.updateQueue;if(h!==null&&(u=h.memoCache),u==null){var _=qt.alternate;_!==null&&(_=_.updateQueue,_!==null&&(_=_.memoCache,_!=null&&(u={data:_.data.map(function(w){return w.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),h===null&&(h=Kl(),qt.updateQueue=h),h.memoCache=u,h=u.data[u.index],h===void 0)for(h=u.data[u.index]=Array(a),_=0;_<a;_++)h[_]=Ms;return u.index++,h}function c(a,u){return typeof u=="function"?u(a):u}function f(a){var u=sa();return y(u,Ri,a)}function y(a,u,h){var _=a.queue;if(_===null)throw Error(v(311));_.lastRenderedReducer=h;var w=a.baseQueue,D=_.pending;if(D!==null){if(w!==null){var q=w.next;w.next=D.next,D.next=q}u.baseQueue=w=D,_.pending=null}if(D=a.baseState,w===null)a.memoizedState=D;else{u=w.next;var Q=q=null,ge=null,ze=u,tt=!1;do{var nt=ze.lane&-536870913;if(nt!==ze.lane?(Mi&nt)===nt:(Ao&nt)===nt){var qe=ze.revertLane;if(qe===0)ge!==null&&(ge=ge.next={lane:0,revertLane:0,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null}),nt===qr&&(tt=!0);else if((Ao&qe)===qe){ze=ze.next,qe===qr&&(tt=!0);continue}else nt={lane:0,revertLane:ze.revertLane,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},ge===null?(Q=ge=nt,q=D):ge=ge.next=nt,qt.lanes|=qe,vu|=qe;nt=ze.action,js&&h(D,nt),D=ze.hasEagerState?ze.eagerState:h(D,nt)}else qe={lane:nt,revertLane:ze.revertLane,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},ge===null?(Q=ge=qe,q=D):ge=ge.next=qe,qt.lanes|=nt,vu|=nt;ze=ze.next}while(ze!==null&&ze!==u);if(ge===null?q=D:ge.next=Q,!$n(D,a.memoizedState)&&(hn=!0,tt&&(h=Tn,h!==null)))throw h;a.memoizedState=D,a.baseState=q,a.baseQueue=ge,_.lastRenderedState=D}return w===null&&(_.lanes=0),[a.memoizedState,_.dispatch]}function T(a){var u=sa(),h=u.queue;if(h===null)throw Error(v(311));h.lastRenderedReducer=a;var _=h.dispatch,w=h.pending,D=u.memoizedState;if(w!==null){h.pending=null;var q=w=w.next;do D=a(D,q.action),q=q.next;while(q!==w);$n(D,u.memoizedState)||(hn=!0),u.memoizedState=D,u.baseQueue===null&&(u.baseState=D),h.lastRenderedState=D}return[D,_]}function A(a,u,h){var _=qt,w=sa(),D=Ei;if(D){if(h===void 0)throw Error(v(407));h=h()}else h=u();var q=!$n((Ri||w).memoizedState,h);q&&(w.memoizedState=h,hn=!0),w=w.queue;var Q=k.bind(null,_,w,a);if(it(2048,8,Q,[a]),w.getSnapshot!==u||q||gt!==null&&gt.memoizedState.tag&1){if(_.flags|=2048,He(9,Ge(),L.bind(null,_,w,h,u),null),qi===null)throw Error(v(349));D||(Ao&124)!==0||I(_,u,h)}return h}function I(a,u,h){a.flags|=16384,a={getSnapshot:u,value:h},u=qt.updateQueue,u===null?(u=Kl(),qt.updateQueue=u,u.stores=[a]):(h=u.stores,h===null?u.stores=[a]:h.push(a))}function L(a,u,h,_){u.value=h,u.getSnapshot=_,F(u)&&z(a)}function k(a,u,h){return h(function(){F(u)&&z(a)})}function F(a){var u=a.getSnapshot;a=a.value;try{var h=u();return!$n(a,h)}catch{return!0}}function z(a){var u=ru(a,2);u!==null&&Qr(u,a,2)}function G(a){var u=En();if(typeof a=="function"){var h=a;if(a=h(),js){_n(!0);try{h()}finally{_n(!1)}}}return u.memoizedState=u.baseState=a,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:a},u}function Z(a,u,h,_){return a.baseState=h,y(a,Ri,typeof _=="function"?_:c)}function ne(a,u,h,_,w){if(_a(a))throw Error(v(485));if(a=u.action,a!==null){var D={payload:w,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){D.listeners.push(q)}};Je.T!==null?h(!0):D.isTransition=!1,_(D),h=u.pending,h===null?(D.next=u.pending=D,ae(u,D)):(D.next=h.next,u.pending=h.next=D)}}function ae(a,u){var h=u.action,_=u.payload,w=a.state;if(u.isTransition){var D=Je.T,q={};Je.T=q;try{var Q=h(w,_),ge=Je.S;ge!==null&&ge(q,Q),re(a,u,Q)}catch(ze){me(a,u,ze)}finally{Je.T=D}}else try{D=h(w,_),re(a,u,D)}catch(ze){me(a,u,ze)}}function re(a,u,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(_){le(a,u,_)},function(_){return me(a,u,_)}):le(a,u,h)}function le(a,u,h){u.status="fulfilled",u.value=h,pe(u),a.state=h,u=a.pending,u!==null&&(h=u.next,h===u?a.pending=null:(h=h.next,u.next=h,ae(a,h)))}function me(a,u,h){var _=a.pending;if(a.pending=null,_!==null){_=_.next;do u.status="rejected",u.reason=h,pe(u),u=u.next;while(u!==_)}a.action=null}function pe(a){a=a.listeners;for(var u=0;u<a.length;u++)(0,a[u])()}function ye(a,u){return u}function Ee(a,u){if(Ei){var h=qi.formState;if(h!==null){e:{var _=qt;if(Ei){if(ga){t:{for(var w=ga,D=Ur;w.nodeType!==8;){if(!D){w=null;break t}if(w=Wn(w.nextSibling),w===null){w=null;break t}}D=w.data,w=D==="F!"||D==="F"?w:null}if(w){ga=Wn(w.nextSibling),_=w.data==="F!";break e}}Hi(_)}_=!1}_&&(u=h[0])}}return h=En(),h.memoizedState=h.baseState=u,_={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ye,lastRenderedState:u},h.queue=_,h=$s.bind(null,qt,_),_.dispatch=h,_=G(!1),D=ys.bind(null,qt,!1,_.queue),_=En(),w={state:u,dispatch:null,action:a,pending:null},_.queue=w,h=ne.bind(null,qt,w,D,h),w.dispatch=h,_.memoizedState=a,[u,h,!1]}function be(a){var u=sa();return Ne(u,Ri,a)}function Ne(a,u,h){if(u=y(a,u,ye)[0],a=f(c)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var _=g(u)}catch(q){throw q===yt?du:q}else _=u;u=sa();var w=u.queue,D=w.dispatch;return h!==u.memoizedState&&(qt.flags|=2048,He(9,Ge(),$e.bind(null,w,h),null)),[_,D,a]}function $e(a,u){a.action=u}function je(a){var u=sa(),h=Ri;if(h!==null)return Ne(u,h,a);sa(),u=u.memoizedState,h=sa();var _=h.queue.dispatch;return h.memoizedState=a,[u,_,!1]}function He(a,u,h,_){return a={tag:a,create:h,deps:_,inst:u,next:null},u=qt.updateQueue,u===null&&(u=Kl(),qt.updateQueue=u),h=u.lastEffect,h===null?u.lastEffect=a.next=a:(_=h.next,h.next=a,a.next=_,u.lastEffect=a),a}function Ge(){return{destroy:void 0,resource:void 0}}function ft(){return sa().memoizedState}function ht(a,u,h,_){var w=En();_=_===void 0?null:_,qt.flags|=a,w.memoizedState=He(1|u,Ge(),h,_)}function it(a,u,h,_){var w=sa();_=_===void 0?null:_;var D=w.memoizedState.inst;Ri!==null&&_!==null&&qs(_,Ri.memoizedState.deps)?w.memoizedState=He(u,D,h,_):(qt.flags|=a,w.memoizedState=He(1|u,D,h,_))}function St(a,u){ht(8390656,8,a,u)}function ii(a,u){it(2048,8,a,u)}function di(a,u){return it(4,2,a,u)}function oa(a,u){return it(4,4,a,u)}function ki(a,u){if(typeof u=="function"){a=a();var h=u(a);return function(){typeof h=="function"?h():u(null)}}if(u!=null)return a=a(),u.current=a,function(){u.current=null}}function ua(a,u,h){h=h!=null?h.concat([a]):null,it(4,4,ki.bind(null,u,a),h)}function Ji(){}function ji(a,u){var h=sa();u=u===void 0?null:u;var _=h.memoizedState;return u!==null&&qs(u,_[1])?_[0]:(h.memoizedState=[a,u],a)}function wi(a,u){var h=sa();u=u===void 0?null:u;var _=h.memoizedState;if(u!==null&&qs(u,_[1]))return _[0];if(_=a(),js){_n(!0);try{a()}finally{_n(!1)}}return h.memoizedState=[_,u],_}function La(a,u,h){return h===void 0||(Ao&1073741824)!==0?a.memoizedState=u:(a.memoizedState=h,a=rf(),qt.lanes|=a,vu|=a,h)}function Za(a,u,h,_){return $n(h,u)?h:ms.current!==null?(a=La(a,h,_),$n(a,u)||(hn=!0),a):(Ao&42)===0?(hn=!0,a.memoizedState=h):(a=rf(),qt.lanes|=a,vu|=a,u)}function an(a,u,h,_,w){var D=wt.p;wt.p=D!==0&&8>D?D:8;var q=Je.T,Q={};Je.T=Q,ys(a,!1,u,h);try{var ge=w(),ze=Je.S;if(ze!==null&&ze(Q,ge),ge!==null&&typeof ge=="object"&&typeof ge.then=="function"){var tt=Gf(ge,_);mr(a,u,tt,vr(a))}else mr(a,u,_,vr(a))}catch(nt){mr(a,u,{then:function(){},status:"rejected",reason:nt},vr())}finally{wt.p=D,Je.T=q}}function Si(){}function _s(a,u,h,_){if(a.tag!==5)throw Error(v(476));var w=Zr(a).queue;an(a,w,u,bt,h===null?Si:function(){return Gs(a),h(_)})}function Zr(a){var u=a.memoizedState;if(u!==null)return u;u={memoizedState:bt,baseState:bt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:bt},next:null};var h={};return u.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:h},next:null},a.memoizedState=u,a=a.alternate,a!==null&&(a.memoizedState=u),u}function Gs(a){var u=Zr(a).next.queue;mr(a,u,{},vr())}function Zs(){return tn(ue)}function rl(){return sa().memoizedState}function Ys(){return sa().memoizedState}function gu(a){for(var u=a.return;u!==null;){switch(u.tag){case 24:case 3:var h=vr();a=fs(h);var _=Gr(u,a,h);_!==null&&(Qr(_,u,h),Hs(_,u,h)),u={cache:Eo()},a.payload=u;return}u=u.return}}function pr(a,u,h){var _=vr();h={lane:_,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},_a(a)?Na(u,h):(h=xo(a,u,h,_),h!==null&&(Qr(h,a,_),wn(h,u,_)))}function $s(a,u,h){var _=vr();mr(a,u,h,_)}function mr(a,u,h,_){var w={lane:_,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(_a(a))Na(u,w);else{var D=a.alternate;if(a.lanes===0&&(D===null||D.lanes===0)&&(D=u.lastRenderedReducer,D!==null))try{var q=u.lastRenderedState,Q=D(q,h);if(w.hasEagerState=!0,w.eagerState=Q,$n(Q,q))return Ls(a,u,w,0),qi===null&&nu(),!1}catch{}finally{}if(h=xo(a,u,w,_),h!==null)return Qr(h,a,_),wn(h,u,_),!0}return!1}function ys(a,u,h,_){if(_={lane:2,revertLane:ff(),action:_,hasEagerState:!1,eagerState:null,next:null},_a(a)){if(u)throw Error(v(479))}else u=xo(a,h,_,2),u!==null&&Qr(u,a,2)}function _a(a){var u=a.alternate;return a===qt||u!==null&&u===qt}function Na(a,u){gs=zt=!0;var h=a.pending;h===null?u.next=u:(u.next=h.next,h.next=u),a.pending=u}function wn(a,u,h){if((h&4194048)!==0){var _=u.lanes;_&=a.pendingLanes,h|=_,u.lanes=h,Fe(a,h)}}var Bi={readContext:tn,use:e,useCallback:Sa,useContext:Sa,useEffect:Sa,useImperativeHandle:Sa,useLayoutEffect:Sa,useInsertionEffect:Sa,useMemo:Sa,useReducer:Sa,useRef:Sa,useState:Sa,useDebugValue:Sa,useDeferredValue:Sa,useTransition:Sa,useSyncExternalStore:Sa,useId:Sa,useHostTransitionStatus:Sa,useFormState:Sa,useActionState:Sa,useOptimistic:Sa,useMemoCache:Sa,useCacheRefresh:Sa},Wl={readContext:tn,use:e,useCallback:function(a,u){return En().memoizedState=[a,u===void 0?null:u],a},useContext:tn,useEffect:St,useImperativeHandle:function(a,u,h){h=h!=null?h.concat([a]):null,ht(4194308,4,ki.bind(null,u,a),h)},useLayoutEffect:function(a,u){return ht(4194308,4,a,u)},useInsertionEffect:function(a,u){ht(4,2,a,u)},useMemo:function(a,u){var h=En();u=u===void 0?null:u;var _=a();if(js){_n(!0);try{a()}finally{_n(!1)}}return h.memoizedState=[_,u],_},useReducer:function(a,u,h){var _=En();if(h!==void 0){var w=h(u);if(js){_n(!0);try{h(u)}finally{_n(!1)}}}else w=u;return _.memoizedState=_.baseState=w,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:w},_.queue=a,a=a.dispatch=pr.bind(null,qt,a),[_.memoizedState,a]},useRef:function(a){var u=En();return a={current:a},u.memoizedState=a},useState:function(a){a=G(a);var u=a.queue,h=$s.bind(null,qt,u);return u.dispatch=h,[a.memoizedState,h]},useDebugValue:Ji,useDeferredValue:function(a,u){var h=En();return La(h,a,u)},useTransition:function(){var a=G(!1);return a=an.bind(null,qt,a.queue,!0,!1),En().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,u,h){var _=qt,w=En();if(Ei){if(h===void 0)throw Error(v(407));h=h()}else{if(h=u(),qi===null)throw Error(v(349));(Mi&124)!==0||I(_,u,h)}w.memoizedState=h;var D={value:h,getSnapshot:u};return w.queue=D,St(k.bind(null,_,D,a),[a]),_.flags|=2048,He(9,Ge(),L.bind(null,_,D,h,u),null),h},useId:function(){var a=En(),u=qi.identifierPrefix;if(Ei){var h=dr,_=Fr;h=(_&~(1<<32-Pa(_)-1)).toString(32)+h,u=""+u+"R"+h,h=nl++,0<h&&(u+="H"+h.toString(32)),u+=""}else h=Rr++,u=""+u+"r"+h.toString(32)+"";return a.memoizedState=u},useHostTransitionStatus:Zs,useFormState:Ee,useActionState:Ee,useOptimistic:function(a){var u=En();u.memoizedState=u.baseState=a;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=h,u=ys.bind(null,qt,!0,h),h.dispatch=u,[a,u]},useMemoCache:n,useCacheRefresh:function(){return En().memoizedState=gu.bind(null,qt)}},jh={readContext:tn,use:e,useCallback:ji,useContext:tn,useEffect:ii,useImperativeHandle:ua,useInsertionEffect:di,useLayoutEffect:oa,useMemo:wi,useReducer:f,useRef:ft,useState:function(){return f(c)},useDebugValue:Ji,useDeferredValue:function(a,u){var h=sa();return Za(h,Ri.memoizedState,a,u)},useTransition:function(){var a=f(c)[0],u=sa().memoizedState;return[typeof a=="boolean"?a:g(a),u]},useSyncExternalStore:A,useId:rl,useHostTransitionStatus:Zs,useFormState:be,useActionState:be,useOptimistic:function(a,u){var h=sa();return Z(h,Ri,a,u)},useMemoCache:n,useCacheRefresh:Ys},Od={readContext:tn,use:e,useCallback:ji,useContext:tn,useEffect:ii,useImperativeHandle:ua,useInsertionEffect:di,useLayoutEffect:oa,useMemo:wi,useReducer:T,useRef:ft,useState:function(){return T(c)},useDebugValue:Ji,useDeferredValue:function(a,u){var h=sa();return Ri===null?La(h,a,u):Za(h,Ri.memoizedState,a,u)},useTransition:function(){var a=T(c)[0],u=sa().memoizedState;return[typeof a=="boolean"?a:g(a),u]},useSyncExternalStore:A,useId:rl,useHostTransitionStatus:Zs,useFormState:je,useActionState:je,useOptimistic:function(a,u){var h=sa();return Ri!==null?Z(h,Ri,a,u):(h.baseState=a,[a,h.queue.dispatch])},useMemoCache:n,useCacheRefresh:Ys},sl=null,_u=0;function Co(a){var u=_u;return _u+=1,sl===null&&(sl=[]),Hc(sl,a,u)}function An(a,u){u=u.props.ref,a.ref=u!==void 0?u:null}function gr(a,u){throw u.$$typeof===Pe?Error(v(525)):(a=Object.prototype.toString.call(u),Error(v(31,a==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":a)))}function _r(a){var u=a._init;return u(a._payload)}function bs(a){function u(De,Se){if(a){var ke=De.deletions;ke===null?(De.deletions=[Se],De.flags|=16):ke.push(Se)}}function h(De,Se){if(!a)return null;for(;Se!==null;)u(De,Se),Se=Se.sibling;return null}function _(De){for(var Se=new Map;De!==null;)De.key!==null?Se.set(De.key,De):Se.set(De.index,De),De=De.sibling;return Se}function w(De,Se){return De=Os(De,Se),De.index=0,De.sibling=null,De}function D(De,Se,ke){return De.index=ke,a?(ke=De.alternate,ke!==null?(ke=ke.index,ke<Se?(De.flags|=67108866,Se):ke):(De.flags|=67108866,Se)):(De.flags|=1048576,Se)}function q(De){return a&&De.alternate===null&&(De.flags|=67108866),De}function Q(De,Se,ke,st){return Se===null||Se.tag!==6?(Se=Qu(ke,De.mode,st),Se.return=De,Se):(Se=w(Se,ke),Se.return=De,Se)}function ge(De,Se,ke,st){var Nt=ke.type;return Nt===Qe?tt(De,Se,ke.props.children,st,ke.key):Se!==null&&(Se.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===bi&&_r(Nt)===Se.type)?(Se=w(Se,ke.props),An(Se,ke),Se.return=De,Se):(Se=Fl(ke.type,ke.key,ke.props,null,De.mode,st),An(Se,ke),Se.return=De,Se)}function ze(De,Se,ke,st){return Se===null||Se.tag!==4||Se.stateNode.containerInfo!==ke.containerInfo||Se.stateNode.implementation!==ke.implementation?(Se=uu(ke,De.mode,st),Se.return=De,Se):(Se=w(Se,ke.children||[]),Se.return=De,Se)}function tt(De,Se,ke,st,Nt){return Se===null||Se.tag!==7?(Se=ou(ke,De.mode,st,Nt),Se.return=De,Se):(Se=w(Se,ke),Se.return=De,Se)}function nt(De,Se,ke){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return Se=Qu(""+Se,De.mode,ke),Se.return=De,Se;if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case Me:return ke=Fl(Se.type,Se.key,Se.props,null,De.mode,ke),An(ke,Se),ke.return=De,ke;case fe:return Se=uu(Se,De.mode,ke),Se.return=De,Se;case bi:var st=Se._init;return Se=st(Se._payload),nt(De,Se,ke)}if(Fa(Se)||ia(Se))return Se=ou(Se,De.mode,ke,null),Se.return=De,Se;if(typeof Se.then=="function")return nt(De,Co(Se),ke);if(Se.$$typeof===ni)return nt(De,jl(De,Se),ke);gr(De,Se)}return null}function qe(De,Se,ke,st){var Nt=Se!==null?Se.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return Nt!==null?null:Q(De,Se,""+ke,st);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case Me:return ke.key===Nt?ge(De,Se,ke,st):null;case fe:return ke.key===Nt?ze(De,Se,ke,st):null;case bi:return Nt=ke._init,ke=Nt(ke._payload),qe(De,Se,ke,st)}if(Fa(ke)||ia(ke))return Nt!==null?null:tt(De,Se,ke,st,null);if(typeof ke.then=="function")return qe(De,Se,Co(ke),st);if(ke.$$typeof===ni)return qe(De,Se,jl(De,ke),st);gr(De,ke)}return null}function Ze(De,Se,ke,st,Nt){if(typeof st=="string"&&st!==""||typeof st=="number"||typeof st=="bigint")return De=De.get(ke)||null,Q(Se,De,""+st,Nt);if(typeof st=="object"&&st!==null){switch(st.$$typeof){case Me:return De=De.get(st.key===null?ke:st.key)||null,ge(Se,De,st,Nt);case fe:return De=De.get(st.key===null?ke:st.key)||null,ze(Se,De,st,Nt);case bi:var Jt=st._init;return st=Jt(st._payload),Ze(De,Se,ke,st,Nt)}if(Fa(st)||ia(st))return De=De.get(ke)||null,tt(Se,De,st,Nt,null);if(typeof st.then=="function")return Ze(De,Se,ke,Co(st),Nt);if(st.$$typeof===ni)return Ze(De,Se,ke,jl(Se,st),Nt);gr(Se,st)}return null}function Wt(De,Se,ke,st){for(var Nt=null,Jt=null,Ht=Se,$t=Se=0,Dn=null;Ht!==null&&$t<ke.length;$t++){Ht.index>$t?(Dn=Ht,Ht=null):Dn=Ht.sibling;var Li=qe(De,Ht,ke[$t],st);if(Li===null){Ht===null&&(Ht=Dn);break}a&&Ht&&Li.alternate===null&&u(De,Ht),Se=D(Li,Se,$t),Jt===null?Nt=Li:Jt.sibling=Li,Jt=Li,Ht=Dn}if($t===ke.length)return h(De,Ht),Ei&&os(De,$t),Nt;if(Ht===null){for(;$t<ke.length;$t++)Ht=nt(De,ke[$t],st),Ht!==null&&(Se=D(Ht,Se,$t),Jt===null?Nt=Ht:Jt.sibling=Ht,Jt=Ht);return Ei&&os(De,$t),Nt}for(Ht=_(Ht);$t<ke.length;$t++)Dn=Ze(Ht,De,$t,ke[$t],st),Dn!==null&&(a&&Dn.alternate!==null&&Ht.delete(Dn.key===null?$t:Dn.key),Se=D(Dn,Se,$t),Jt===null?Nt=Dn:Jt.sibling=Dn,Jt=Dn);return a&&Ht.forEach(function(xl){return u(De,xl)}),Ei&&os(De,$t),Nt}function Yt(De,Se,ke,st){if(ke==null)throw Error(v(151));for(var Nt=null,Jt=null,Ht=Se,$t=Se=0,Dn=null,Li=ke.next();Ht!==null&&!Li.done;$t++,Li=ke.next()){Ht.index>$t?(Dn=Ht,Ht=null):Dn=Ht.sibling;var xl=qe(De,Ht,Li.value,st);if(xl===null){Ht===null&&(Ht=Dn);break}a&&Ht&&xl.alternate===null&&u(De,Ht),Se=D(xl,Se,$t),Jt===null?Nt=xl:Jt.sibling=xl,Jt=xl,Ht=Dn}if(Li.done)return h(De,Ht),Ei&&os(De,$t),Nt;if(Ht===null){for(;!Li.done;$t++,Li=ke.next())Li=nt(De,Li.value,st),Li!==null&&(Se=D(Li,Se,$t),Jt===null?Nt=Li:Jt.sibling=Li,Jt=Li);return Ei&&os(De,$t),Nt}for(Ht=_(Ht);!Li.done;$t++,Li=ke.next())Li=Ze(Ht,De,$t,Li.value,st),Li!==null&&(a&&Li.alternate!==null&&Ht.delete(Li.key===null?$t:Li.key),Se=D(Li,Se,$t),Jt===null?Nt=Li:Jt.sibling=Li,Jt=Li);return a&&Ht.forEach(function(Hn){return u(De,Hn)}),Ei&&os(De,$t),Nt}function ta(De,Se,ke,st){if(typeof ke=="object"&&ke!==null&&ke.type===Qe&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case Me:e:{for(var Nt=ke.key;Se!==null;){if(Se.key===Nt){if(Nt=ke.type,Nt===Qe){if(Se.tag===7){h(De,Se.sibling),st=w(Se,ke.props.children),st.return=De,De=st;break e}}else if(Se.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===bi&&_r(Nt)===Se.type){h(De,Se.sibling),st=w(Se,ke.props),An(st,ke),st.return=De,De=st;break e}h(De,Se);break}else u(De,Se);Se=Se.sibling}ke.type===Qe?(st=ou(ke.props.children,De.mode,st,ke.key),st.return=De,De=st):(st=Fl(ke.type,ke.key,ke.props,null,De.mode,st),An(st,ke),st.return=De,De=st)}return q(De);case fe:e:{for(Nt=ke.key;Se!==null;){if(Se.key===Nt)if(Se.tag===4&&Se.stateNode.containerInfo===ke.containerInfo&&Se.stateNode.implementation===ke.implementation){h(De,Se.sibling),st=w(Se,ke.children||[]),st.return=De,De=st;break e}else{h(De,Se);break}else u(De,Se);Se=Se.sibling}st=uu(ke,De.mode,st),st.return=De,De=st}return q(De);case bi:return Nt=ke._init,ke=Nt(ke._payload),ta(De,Se,ke,st)}if(Fa(ke))return Wt(De,Se,ke,st);if(ia(ke)){if(Nt=ia(ke),typeof Nt!="function")throw Error(v(150));return ke=Nt.call(ke),Yt(De,Se,ke,st)}if(typeof ke.then=="function")return ta(De,Se,Co(ke),st);if(ke.$$typeof===ni)return ta(De,Se,jl(De,ke),st);gr(De,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint"?(ke=""+ke,Se!==null&&Se.tag===6?(h(De,Se.sibling),st=w(Se,ke),st.return=De,De=st):(h(De,Se),st=Qu(ke,De.mode,st),st.return=De,De=st),q(De)):h(De,Se)}return function(De,Se,ke,st){try{_u=0;var Nt=ta(De,Se,ke,st);return sl=null,Nt}catch(Ht){if(Ht===yt||Ht===du)throw Ht;var Jt=kn(29,Ht,null,De.mode);return Jt.lanes=st,Jt.return=De,Jt}finally{}}}var Xs=bs(!0),Qs=bs(!1),Kn=ut(null),Ks=null;function Mo(a){var u=a.alternate;At(nn,nn.current&1),At(Kn,a),Ks===null&&(u===null||ms.current!==null||u.memoizedState!==null)&&(Ks=a)}function Zf(a){if(a.tag===22){if(At(nn,nn.current),At(Kn,a),Ks===null){var u=a.alternate;u!==null&&u.memoizedState!==null&&(Ks=a)}}else Pr()}function Pr(){At(nn,nn.current),At(Kn,Kn.current)}function yr(a){xt(Kn),Ks===a&&(Ks=null),xt(nn)}var nn=ut(0);function kd(a){for(var u=a;u!==null;){if(u.tag===13){var h=u.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||D0(h)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function qh(a,u,h,_){u=a.memoizedState,h=h(_,u),h=h==null?u:we({},u,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var Bd={enqueueSetState:function(a,u,h){a=a._reactInternals;var _=vr(),w=fs(_);w.payload=u,h!=null&&(w.callback=h),u=Gr(a,w,_),u!==null&&(Qr(u,a,_),Hs(u,a,_))},enqueueReplaceState:function(a,u,h){a=a._reactInternals;var _=vr(),w=fs(_);w.tag=1,w.payload=u,h!=null&&(w.callback=h),u=Gr(a,w,_),u!==null&&(Qr(u,a,_),Hs(u,a,_))},enqueueForceUpdate:function(a,u){a=a._reactInternals;var h=vr(),_=fs(h);_.tag=2,u!=null&&(_.callback=u),u=Gr(a,_,h),u!==null&&(Qr(u,a,h),Hs(u,a,h))}};function ap(a,u,h,_,w,D,q){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(_,D,q):u.prototype&&u.prototype.isPureReactComponent?!hi(h,_)||!hi(w,D):!0}function Yf(a,u,h,_){a=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(h,_),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(h,_),u.state!==a&&Bd.enqueueReplaceState(u,u.state,null)}function Jl(a,u){var h=u;if("ref"in u){h={};for(var _ in u)_!=="ref"&&(h[_]=u[_])}if(a=a.defaultProps){h===u&&(h=we({},h));for(var w in a)h[w]===void 0&&(h[w]=a[w])}return h}var Zc=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function np(a){Zc(a)}function zd(a){console.error(a)}function $f(a){Zc(a)}function Vh(a,u){try{var h=a.onUncaughtError;h(u.value,{componentStack:u.stack})}catch(_){setTimeout(function(){throw _})}}function ol(a,u,h){try{var _=a.onCaughtError;_(h.value,{componentStack:h.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function Xf(a,u,h){return h=fs(h),h.tag=3,h.payload={element:null},h.callback=function(){Vh(a,u)},h}function Yc(a){return a=fs(a),a.tag=3,a}function Gh(a,u,h,_){var w=h.type.getDerivedStateFromError;if(typeof w=="function"){var D=_.value;a.payload=function(){return w(D)},a.callback=function(){ol(u,h,_)}}var q=h.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(a.callback=function(){ol(u,h,_),typeof w!="function"&&(pl===null?pl=new Set([this]):pl.add(this));var Q=_.stack;this.componentDidCatch(_.value,{componentStack:Q!==null?Q:""})})}function Fd(a,u,h,_,w){if(h.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){if(u=h.alternate,u!==null&&cs(u,h,w,!0),h=Kn.current,h!==null){switch(h.tag){case 13:return Ks===null?gl():h.alternate===null&&Ia===0&&(Ia=3),h.flags&=-257,h.flags|=65536,h.lanes=w,_===Uc?h.flags|=16384:(u=h.updateQueue,u===null?h.updateQueue=new Set([_]):u.add(_),cf(a,_,w)),!1;case 22:return h.flags|=65536,_===Uc?h.flags|=16384:(u=h.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([_])},h.updateQueue=u):(h=u.retryQueue,h===null?u.retryQueue=new Set([_]):h.add(_)),cf(a,_,w)),!1}throw Error(v(435,h.tag))}return cf(a,_,w),gl(),!1}if(Ei)return u=Kn.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=w,_!==cu&&(a=Error(v(422),{cause:_}),Qn(Nn(a,h)))):(_!==cu&&(u=Error(v(423),{cause:_}),Qn(Nn(u,h))),a=a.current.alternate,a.flags|=65536,w&=-w,a.lanes|=w,_=Nn(_,h),w=Xf(a.stateNode,_,w),Uh(a,w),Ia!==4&&(Ia=2)),!1;var D=Error(v(520),{cause:_});if(D=Nn(D,h),Kh===null?Kh=[D]:Kh.push(D),Ia!==4&&(Ia=2),u===null)return!0;_=Nn(_,h),h=u;do{switch(h.tag){case 3:return h.flags|=65536,a=w&-w,h.lanes|=a,a=Xf(h.stateNode,_,a),Uh(h,a),!1;case 1:if(u=h.type,D=h.stateNode,(h.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(pl===null||!pl.has(D))))return h.flags|=65536,w&=-w,h.lanes|=w,w=Yc(w),Gh(w,a,h,_),Uh(h,w),!1}h=h.return}while(h!==null);return!1}var Qf=Error(v(461)),hn=!1;function Bn(a,u,h,_){u.child=a===null?Qs(u,null,h,_):Xs(u,a.child,h,_)}function rp(a,u,h,_,w){h=h.render;var D=u.ref;if("ref"in _){var q={};for(var Q in _)Q!=="ref"&&(q[Q]=_[Q])}else q=_;return Dr(u),_=na(a,u,h,q,D,w),Q=mu(),a!==null&&!hn?(Vs(a,u,w),Io(a,u,w)):(Ei&&Q&&Wu(u),u.flags|=1,Bn(a,u,_,w),u.child)}function Kf(a,u,h,_,w){if(a===null){var D=h.type;return typeof D=="function"&&!su(D)&&D.defaultProps===void 0&&h.compare===null?(u.tag=15,u.type=D,Wf(a,u,D,_,w)):(a=Fl(h.type,null,_,u,u.mode,w),a.ref=u.ref,a.return=u,u.child=a)}if(D=a.child,!yu(a,w)){var q=D.memoizedProps;if(h=h.compare,h=h!==null?h:hi,h(q,_)&&a.ref===u.ref)return Io(a,u,w)}return u.flags|=1,a=Os(D,_),a.ref=u.ref,a.return=u,u.child=a}function Wf(a,u,h,_,w){if(a!==null){var D=a.memoizedProps;if(hi(D,_)&&a.ref===u.ref)if(hn=!1,u.pendingProps=_=D,yu(a,w))(a.flags&131072)!==0&&(hn=!0);else return u.lanes=a.lanes,Io(a,u,w)}return Ud(a,u,h,_,w)}function Jf(a,u,h){var _=u.pendingProps,w=_.children,D=a!==null?a.memoizedState:null;if(_.mode==="hidden"){if((u.flags&128)!==0){if(_=D!==null?D.baseLanes|h:h,a!==null){for(w=u.child=a.child,D=0;w!==null;)D=D|w.lanes|w.childLanes,w=w.sibling;u.childLanes=D&~_}else u.childLanes=0,u.child=null;return sp(a,u,_,h)}if((h&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},a!==null&&Us(u,D!==null?D.cachePool:null),D!==null?Hh(u,D):Vc(),Zf(u);else return u.lanes=u.childLanes=536870912,sp(a,u,D!==null?D.baseLanes|h:h,h)}else D!==null?(Us(u,D.cachePool),Hh(u,D),Pr(),u.memoizedState=null):(a!==null&&Us(u,null),Vc(),Pr());return Bn(a,u,w,h),u.child}function sp(a,u,h,_){var w=Vl();return w=w===null?null:{parent:Ua._currentValue,pool:w},u.memoizedState={baseLanes:h,cachePool:w},a!==null&&Us(u,null),Vc(),Zf(u),a!==null&&cs(a,u,_,!0),null}function $c(a,u){var h=u.ref;if(h===null)a!==null&&a.ref!==null&&(u.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(v(284));(a===null||a.ref!==h)&&(u.flags|=4194816)}}function Ud(a,u,h,_,w){return Dr(u),h=na(a,u,h,_,void 0,w),_=mu(),a!==null&&!hn?(Vs(a,u,w),Io(a,u,w)):(Ei&&_&&Wu(u),u.flags|=1,Bn(a,u,h,w),u.child)}function Hd(a,u,h,_,w,D){return Dr(u),u.updateQueue=null,h=pu(u,_,h,w),ra(a),_=mu(),a!==null&&!hn?(Vs(a,u,D),Io(a,u,D)):(Ei&&_&&Wu(u),u.flags|=1,Bn(a,u,h,D),u.child)}function Xc(a,u,h,_,w){if(Dr(u),u.stateNode===null){var D=Ns,q=h.contextType;typeof q=="object"&&q!==null&&(D=tn(q)),D=new h(_,D),u.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=Bd,u.stateNode=D,D._reactInternals=u,D=u.stateNode,D.props=_,D.state=u.memoizedState,D.refs={},jc(u),q=h.contextType,D.context=typeof q=="object"&&q!==null?tn(q):Ns,D.state=u.memoizedState,q=h.getDerivedStateFromProps,typeof q=="function"&&(qh(u,h,q,_),D.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(q=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),q!==D.state&&Bd.enqueueReplaceState(D,D.state,null),$l(u,_,D,w),Yl(),D.state=u.memoizedState),typeof D.componentDidMount=="function"&&(u.flags|=4194308),_=!0}else if(a===null){D=u.stateNode;var Q=u.memoizedProps,ge=Jl(h,Q);D.props=ge;var ze=D.context,tt=h.contextType;q=Ns,typeof tt=="object"&&tt!==null&&(q=tn(tt));var nt=h.getDerivedStateFromProps;tt=typeof nt=="function"||typeof D.getSnapshotBeforeUpdate=="function",Q=u.pendingProps!==Q,tt||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(Q||ze!==q)&&Yf(u,D,_,q),ds=!1;var qe=u.memoizedState;D.state=qe,$l(u,_,D,w),Yl(),ze=u.memoizedState,Q||qe!==ze||ds?(typeof nt=="function"&&(qh(u,h,nt,_),ze=u.memoizedState),(ge=ds||ap(u,h,ge,_,qe,ze,q))?(tt||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(u.flags|=4194308)):(typeof D.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=_,u.memoizedState=ze),D.props=_,D.state=ze,D.context=q,_=ge):(typeof D.componentDidMount=="function"&&(u.flags|=4194308),_=!1)}else{D=u.stateNode,qc(a,u),q=u.memoizedProps,tt=Jl(h,q),D.props=tt,nt=u.pendingProps,qe=D.context,ze=h.contextType,ge=Ns,typeof ze=="object"&&ze!==null&&(ge=tn(ze)),Q=h.getDerivedStateFromProps,(ze=typeof Q=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(q!==nt||qe!==ge)&&Yf(u,D,_,ge),ds=!1,qe=u.memoizedState,D.state=qe,$l(u,_,D,w),Yl();var Ze=u.memoizedState;q!==nt||qe!==Ze||ds||a!==null&&a.dependencies!==null&&Aa(a.dependencies)?(typeof Q=="function"&&(qh(u,h,Q,_),Ze=u.memoizedState),(tt=ds||ap(u,h,tt,_,qe,Ze,ge)||a!==null&&a.dependencies!==null&&Aa(a.dependencies))?(ze||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(_,Ze,ge),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(_,Ze,ge)),typeof D.componentDidUpdate=="function"&&(u.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof D.componentDidUpdate!="function"||q===a.memoizedProps&&qe===a.memoizedState||(u.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||q===a.memoizedProps&&qe===a.memoizedState||(u.flags|=1024),u.memoizedProps=_,u.memoizedState=Ze),D.props=_,D.state=Ze,D.context=ge,_=tt):(typeof D.componentDidUpdate!="function"||q===a.memoizedProps&&qe===a.memoizedState||(u.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||q===a.memoizedProps&&qe===a.memoizedState||(u.flags|=1024),_=!1)}return D=_,$c(a,u),_=(u.flags&128)!==0,D||_?(D=u.stateNode,h=_&&typeof h.getDerivedStateFromError!="function"?null:D.render(),u.flags|=1,a!==null&&_?(u.child=Xs(u,a.child,null,w),u.child=Xs(u,null,h,w)):Bn(a,u,h,w),u.memoizedState=D.state,a=u.child):a=Io(a,u,w),a}function Lr(a,u,h,_){return zs(),u.flags|=256,Bn(a,u,h,_),u.child}var jd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zh(a){return{baseLanes:a,cachePool:Vr()}}function e0(a,u,h){return a=a!==null?a.childLanes&~h:0,u&&(a|=vs),a}function t0(a,u,h){var _=u.pendingProps,w=!1,D=(u.flags&128)!==0,q;if((q=D)||(q=a!==null&&a.memoizedState===null?!1:(nn.current&2)!==0),q&&(w=!0,u.flags&=-129),q=(u.flags&32)!==0,u.flags&=-33,a===null){if(Ei){if(w?Mo(u):Pr(),Ei){var Q=ga,ge;if(ge=Q){e:{for(ge=Q,Q=Ur;ge.nodeType!==8;){if(!Q){Q=null;break e}if(ge=Wn(ge.nextSibling),ge===null){Q=null;break e}}Q=ge}Q!==null?(u.memoizedState={dehydrated:Q,treeContext:zr!==null?{id:Fr,overflow:dr}:null,retryLane:536870912,hydrationErrors:null},ge=kn(18,null,null,0),ge.stateNode=Q,ge.return=u,u.child=ge,vn=u,ga=null,ge=!0):ge=!1}ge||Hi(u)}if(Q=u.memoizedState,Q!==null&&(Q=Q.dehydrated,Q!==null))return D0(Q)?u.lanes=32:u.lanes=536870912,null;yr(u)}return Q=_.children,_=_.fallback,w?(Pr(),w=u.mode,Q=qd({mode:"hidden",children:Q},w),_=ou(_,w,h,null),Q.return=u,_.return=u,Q.sibling=_,u.child=Q,w=u.child,w.memoizedState=Zh(h),w.childLanes=e0(a,q,h),u.memoizedState=jd,_):(Mo(u),i0(u,Q))}if(ge=a.memoizedState,ge!==null&&(Q=ge.dehydrated,Q!==null)){if(D)u.flags&256?(Mo(u),u.flags&=-257,u=a0(a,u,h)):u.memoizedState!==null?(Pr(),u.child=a.child,u.flags|=128,u=null):(Pr(),w=_.fallback,Q=u.mode,_=qd({mode:"visible",children:_.children},Q),w=ou(w,Q,h,null),w.flags|=2,_.return=u,w.return=u,_.sibling=w,u.child=_,Xs(u,a.child,null,h),_=u.child,_.memoizedState=Zh(h),_.childLanes=e0(a,q,h),u.memoizedState=jd,u=w);else if(Mo(u),D0(Q)){if(q=Q.nextSibling&&Q.nextSibling.dataset,q)var ze=q.dgst;q=ze,_=Error(v(419)),_.stack="",_.digest=q,Qn({value:_,source:null,stack:null}),u=a0(a,u,h)}else if(hn||cs(a,u,h,!1),q=(h&a.childLanes)!==0,hn||q){if(q=qi,q!==null&&(_=h&-h,_=(_&42)!==0?1:Ie(_),_=(_&(q.suspendedLanes|h))!==0?0:_,_!==0&&_!==ge.retryLane))throw ge.retryLane=_,ru(a,_),Qr(q,a,_),Qf;Q.data==="$?"||gl(),u=a0(a,u,h)}else Q.data==="$?"?(u.flags|=192,u.child=a.child,u=null):(a=ge.treeContext,ga=Wn(Q.nextSibling),vn=u,Ei=!0,us=null,Ur=!1,a!==null&&(bn[xn++]=Fr,bn[xn++]=dr,bn[xn++]=zr,Fr=a.id,dr=a.overflow,zr=u),u=i0(u,_.children),u.flags|=4096);return u}return w?(Pr(),w=_.fallback,Q=u.mode,ge=a.child,ze=ge.sibling,_=Os(ge,{mode:"hidden",children:_.children}),_.subtreeFlags=ge.subtreeFlags&65011712,ze!==null?w=Os(ze,w):(w=ou(w,Q,h,null),w.flags|=2),w.return=u,_.return=u,_.sibling=w,u.child=_,_=w,w=u.child,Q=a.child.memoizedState,Q===null?Q=Zh(h):(ge=Q.cachePool,ge!==null?(ze=Ua._currentValue,ge=ge.parent!==ze?{parent:ze,pool:ze}:ge):ge=Vr(),Q={baseLanes:Q.baseLanes|h,cachePool:ge}),w.memoizedState=Q,w.childLanes=e0(a,q,h),u.memoizedState=jd,_):(Mo(u),h=a.child,a=h.sibling,h=Os(h,{mode:"visible",children:_.children}),h.return=u,h.sibling=null,a!==null&&(q=u.deletions,q===null?(u.deletions=[a],u.flags|=16):q.push(a)),u.child=h,u.memoizedState=null,h)}function i0(a,u){return u=qd({mode:"visible",children:u},a.mode),u.return=a,a.child=u}function qd(a,u){return a=kn(22,a,null,u),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function a0(a,u,h){return Xs(u,a.child,null,h),a=i0(u,u.pendingProps.children),a.flags|=2,u.memoizedState=null,a}function op(a,u,h){a.lanes|=u;var _=a.alternate;_!==null&&(_.lanes|=u),Bc(a.return,u,h)}function Yh(a,u,h,_,w){var D=a.memoizedState;D===null?a.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:_,tail:h,tailMode:w}:(D.isBackwards=u,D.rendering=null,D.renderingStartTime=0,D.last=_,D.tail=h,D.tailMode=w)}function Vd(a,u,h){var _=u.pendingProps,w=_.revealOrder,D=_.tail;if(Bn(a,u,_.children,h),_=nn.current,(_&2)!==0)_=_&1|2,u.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=u.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&op(a,h,u);else if(a.tag===19)op(a,h,u);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===u)break e;for(;a.sibling===null;){if(a.return===null||a.return===u)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}_&=1}switch(At(nn,_),w){case"forwards":for(h=u.child,w=null;h!==null;)a=h.alternate,a!==null&&kd(a)===null&&(w=h),h=h.sibling;h=w,h===null?(w=u.child,u.child=null):(w=h.sibling,h.sibling=null),Yh(u,!1,w,h,D);break;case"backwards":for(h=null,w=u.child,u.child=null;w!==null;){if(a=w.alternate,a!==null&&kd(a)===null){u.child=w;break}a=w.sibling,w.sibling=h,h=w,w=a}Yh(u,!0,h,null,D);break;case"together":Yh(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Io(a,u,h){if(a!==null&&(u.dependencies=a.dependencies),vu|=u.lanes,(h&u.childLanes)===0)if(a!==null){if(cs(a,u,h,!1),(h&u.childLanes)===0)return null}else return null;if(a!==null&&u.child!==a.child)throw Error(v(153));if(u.child!==null){for(a=u.child,h=Os(a,a.pendingProps),u.child=h,h.return=u;a.sibling!==null;)a=a.sibling,h=h.sibling=Os(a,a.pendingProps),h.return=u;h.sibling=null}return u.child}function yu(a,u){return(a.lanes&u)!==0?!0:(a=a.dependencies,!!(a!==null&&Aa(a)))}function $h(a,u,h){switch(u.tag){case 3:Ni(u,u.stateNode.containerInfo),Fs(u,Ua,a.memoizedState.cache),zs();break;case 27:case 5:Bo(u);break;case 4:Ni(u,u.stateNode.containerInfo);break;case 10:Fs(u,u.type,u.memoizedProps.value);break;case 13:var _=u.memoizedState;if(_!==null)return _.dehydrated!==null?(Mo(u),u.flags|=128,null):(h&u.child.childLanes)!==0?t0(a,u,h):(Mo(u),a=Io(a,u,h),a!==null?a.sibling:null);Mo(u);break;case 19:var w=(a.flags&128)!==0;if(_=(h&u.childLanes)!==0,_||(cs(a,u,h,!1),_=(h&u.childLanes)!==0),w){if(_)return Vd(a,u,h);u.flags|=128}if(w=u.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),At(nn,nn.current),_)break;return null;case 22:case 23:return u.lanes=0,Jf(a,u,h);case 24:Fs(u,Ua,a.memoizedState.cache)}return Io(a,u,h)}function up(a,u,h){if(a!==null)if(a.memoizedProps!==u.pendingProps)hn=!0;else{if(!yu(a,h)&&(u.flags&128)===0)return hn=!1,$h(a,u,h);hn=(a.flags&131072)!==0}else hn=!1,Ei&&(u.flags&1048576)!==0&&Bh(u,Ku,u.index);switch(u.lanes=0,u.tag){case 16:e:{a=u.pendingProps;var _=u.elementType,w=_._init;if(_=w(_._payload),u.type=_,typeof _=="function")su(_)?(a=Jl(_,a),u.tag=1,u=Xc(null,u,_,a,h)):(u.tag=0,u=Ud(null,u,_,a,h));else{if(_!=null){if(w=_.$$typeof,w===Mt){u.tag=11,u=rp(null,u,_,a,h);break e}else if(w===Ii){u.tag=14,u=Kf(null,u,_,a,h);break e}}throw u=xa(_)||_,Error(v(306,u,""))}}return u;case 0:return Ud(a,u,u.type,u.pendingProps,h);case 1:return _=u.type,w=Jl(_,u.pendingProps),Xc(a,u,_,w,h);case 3:e:{if(Ni(u,u.stateNode.containerInfo),a===null)throw Error(v(387));_=u.pendingProps;var D=u.memoizedState;w=D.element,qc(a,u),$l(u,_,null,h);var q=u.memoizedState;if(_=q.cache,Fs(u,Ua,_),_!==D.cache&&To(u,[Ua],h,!0),Yl(),_=q.element,D.isDehydrated)if(D={element:_,isDehydrated:!1,cache:q.cache},u.updateQueue.baseState=D,u.memoizedState=D,u.flags&256){u=Lr(a,u,_,h);break e}else if(_!==w){w=Nn(Error(v(424)),u),Qn(w),u=Lr(a,u,_,h);break e}else{switch(a=u.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(ga=Wn(a.firstChild),vn=u,Ei=!0,us=null,Ur=!0,h=Qs(u,null,_,h),u.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(zs(),_===w){u=Io(a,u,h);break e}Bn(a,u,_,h)}u=u.child}return u;case 26:return $c(a,u),a===null?(h=mh(u.type,null,u.pendingProps,null))?u.memoizedState=h:Ei||(h=u.type,a=u.pendingProps,_=to(Vt.current).createElement(h),_[kt]=u,_[Rt]=a,In(_,h,a),Bt(_),u.stateNode=_):u.memoizedState=mh(u.type,a.memoizedProps,u.pendingProps,a.memoizedState),null;case 27:return Bo(u),a===null&&Ei&&(_=u.stateNode=Ef(u.type,u.pendingProps,Vt.current),vn=u,Ur=!0,w=ga,Su(u.type)?(rn=w,ga=Wn(_.firstChild)):ga=w),Bn(a,u,u.pendingProps.children,h),$c(a,u),a===null&&(u.flags|=4194304),u.child;case 5:return a===null&&Ei&&((w=_=ga)&&(_=Tf(_,u.type,u.pendingProps,Ur),_!==null?(u.stateNode=_,vn=u,ga=Wn(_.firstChild),Ur=!1,w=!0):w=!1),w||Hi(u)),Bo(u),w=u.type,D=u.pendingProps,q=a!==null?a.memoizedProps:null,_=D.children,bf(w,D)?_=null:q!==null&&bf(w,q)&&(u.flags|=32),u.memoizedState!==null&&(w=na(a,u,Xl,null,null,h),ue._currentValue=w),$c(a,u),Bn(a,u,_,h),u.child;case 6:return a===null&&Ei&&((a=h=ga)&&(h=vm(h,u.pendingProps,Ur),h!==null?(u.stateNode=h,vn=u,ga=null,a=!0):a=!1),a||Hi(u)),null;case 13:return t0(a,u,h);case 4:return Ni(u,u.stateNode.containerInfo),_=u.pendingProps,a===null?u.child=Xs(u,null,_,h):Bn(a,u,_,h),u.child;case 11:return rp(a,u,u.type,u.pendingProps,h);case 7:return Bn(a,u,u.pendingProps,h),u.child;case 8:return Bn(a,u,u.pendingProps.children,h),u.child;case 12:return Bn(a,u,u.pendingProps.children,h),u.child;case 10:return _=u.pendingProps,Fs(u,u.type,_.value),Bn(a,u,_.children,h),u.child;case 9:return w=u.type._context,_=u.pendingProps.children,Dr(u),w=tn(w),_=_(w),u.flags|=1,Bn(a,u,_,h),u.child;case 14:return Kf(a,u,u.type,u.pendingProps,h);case 15:return Wf(a,u,u.type,u.pendingProps,h);case 19:return Vd(a,u,h);case 31:return _=u.pendingProps,h=u.mode,_={mode:_.mode,children:_.children},a===null?(h=qd(_,h),h.ref=u.ref,u.child=h,h.return=u,u=h):(h=Os(a.child,_),h.ref=u.ref,u.child=h,h.return=u,u=h),u;case 22:return Jf(a,u,h);case 24:return Dr(u),_=tn(Ua),a===null?(w=Vl(),w===null&&(w=qi,D=Eo(),w.pooledCache=D,D.refCount++,D!==null&&(w.pooledCacheLanes|=h),w=D),u.memoizedState={parent:_,cache:w},jc(u),Fs(u,Ua,w)):((a.lanes&h)!==0&&(qc(a,u),$l(u,null,null,h),Yl()),w=a.memoizedState,D=u.memoizedState,w.parent!==_?(w={parent:_,cache:_},u.memoizedState=w,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=w),Fs(u,Ua,_)):(_=D.cache,Fs(u,Ua,_),_!==w.cache&&To(u,[Ua],h,!0))),Bn(a,u,u.pendingProps.children,h),u.child;case 29:throw u.pendingProps}throw Error(v(156,u.tag))}function bu(a){a.flags|=4}function lp(a,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!O(u)){if(u=Kn.current,u!==null&&((Mi&4194048)===Mi?Ks!==null:(Mi&62914560)!==Mi&&(Mi&536870912)===0||u!==Ks))throw ri=Uc,Gl;a.flags|=8192}}function Gd(a,u){u!==null&&(a.flags|=4),a.flags&16384&&(u=a.tag!==22?ve():536870912,a.lanes|=u,Tu|=u)}function Xh(a,u){if(!Ei)switch(a.tailMode){case"hidden":u=a.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?u||a.tail===null?a.tail=null:a.tail.sibling=null:_.sibling=null}}function Oa(a){var u=a.alternate!==null&&a.alternate.child===a.child,h=0,_=0;if(u)for(var w=a.child;w!==null;)h|=w.lanes|w.childLanes,_|=w.subtreeFlags&65011712,_|=w.flags&65011712,w.return=a,w=w.sibling;else for(w=a.child;w!==null;)h|=w.lanes|w.childLanes,_|=w.subtreeFlags,_|=w.flags,w.return=a,w=w.sibling;return a.subtreeFlags|=_,a.childLanes=h,u}function dm(a,u,h){var _=u.pendingProps;switch(Ul(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oa(u),null;case 1:return Oa(u),null;case 3:return h=u.stateNode,_=null,a!==null&&(_=a.memoizedState.cache),u.memoizedState.cache!==_&&(u.flags|=2048),ls(Ua),qn(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(a===null||a.child===null)&&(hu(u)?bu(u):a===null||a.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,kc())),Oa(u),null;case 26:return h=u.memoizedState,a===null?(bu(u),h!==null?(Oa(u),lp(u,h)):(Oa(u),u.flags&=-16777217)):h?h!==a.memoizedState?(bu(u),Oa(u),lp(u,h)):(Oa(u),u.flags&=-16777217):(a.memoizedProps!==_&&bu(u),Oa(u),u.flags&=-16777217),null;case 27:gn(u),h=Vt.current;var w=u.type;if(a!==null&&u.stateNode!=null)a.memoizedProps!==_&&bu(u);else{if(!_){if(u.stateNode===null)throw Error(v(166));return Oa(u),null}a=Ot.current,hu(u)?Bs(u):(a=Ef(w,_,h),u.stateNode=a,bu(u))}return Oa(u),null;case 5:if(gn(u),h=u.type,a!==null&&u.stateNode!=null)a.memoizedProps!==_&&bu(u);else{if(!_){if(u.stateNode===null)throw Error(v(166));return Oa(u),null}if(a=Ot.current,hu(u))Bs(u);else{switch(w=to(Vt.current),a){case 1:a=w.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:a=w.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":a=w.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":a=w.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":a=w.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof _.is=="string"?w.createElement("select",{is:_.is}):w.createElement("select"),_.multiple?a.multiple=!0:_.size&&(a.size=_.size);break;default:a=typeof _.is=="string"?w.createElement(h,{is:_.is}):w.createElement(h)}}a[kt]=u,a[Rt]=_;e:for(w=u.child;w!==null;){if(w.tag===5||w.tag===6)a.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===u)break e;for(;w.sibling===null;){if(w.return===null||w.return===u)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}u.stateNode=a;e:switch(In(a,h,_),h){case"button":case"input":case"select":case"textarea":a=!!_.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&bu(u)}}return Oa(u),u.flags&=-16777217,null;case 6:if(a&&u.stateNode!=null)a.memoizedProps!==_&&bu(u);else{if(typeof _!="string"&&u.stateNode===null)throw Error(v(166));if(a=Vt.current,hu(u)){if(a=u.stateNode,h=u.memoizedProps,_=null,w=vn,w!==null)switch(w.tag){case 27:case 5:_=w.memoizedProps}a[kt]=u,a=!!(a.nodeValue===h||_!==null&&_.suppressHydrationWarning===!0||S0(a.nodeValue,h)),a||Hi(u)}else a=to(a).createTextNode(_),a[kt]=u,u.stateNode=a}return Oa(u),null;case 13:if(_=u.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(w=hu(u),_!==null&&_.dehydrated!==null){if(a===null){if(!w)throw Error(v(318));if(w=u.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(v(317));w[kt]=u}else zs(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Oa(u),w=!1}else w=kc(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=w),w=!0;if(!w)return u.flags&256?(yr(u),u):(yr(u),null)}if(yr(u),(u.flags&128)!==0)return u.lanes=h,u;if(h=_!==null,a=a!==null&&a.memoizedState!==null,h){_=u.child,w=null,_.alternate!==null&&_.alternate.memoizedState!==null&&_.alternate.memoizedState.cachePool!==null&&(w=_.alternate.memoizedState.cachePool.pool);var D=null;_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(D=_.memoizedState.cachePool.pool),D!==w&&(_.flags|=2048)}return h!==a&&h&&(u.child.flags|=8192),Gd(u,u.updateQueue),Oa(u),null;case 4:return qn(),a===null&&mf(u.stateNode.containerInfo),Oa(u),null;case 10:return ls(u.type),Oa(u),null;case 19:if(xt(nn),w=u.memoizedState,w===null)return Oa(u),null;if(_=(u.flags&128)!==0,D=w.rendering,D===null)if(_)Xh(w,!1);else{if(Ia!==0||a!==null&&(a.flags&128)!==0)for(a=u.child;a!==null;){if(D=kd(a),D!==null){for(u.flags|=128,Xh(w,!1),a=D.updateQueue,u.updateQueue=a,Gd(u,a),u.subtreeFlags=0,a=h,h=u.child;h!==null;)Ld(h,a),h=h.sibling;return At(nn,nn.current&1|2),u.child}a=a.sibling}w.tail!==null&&Ra()>ef&&(u.flags|=128,_=!0,Xh(w,!1),u.lanes=4194304)}else{if(!_)if(a=kd(D),a!==null){if(u.flags|=128,_=!0,a=a.updateQueue,u.updateQueue=a,Gd(u,a),Xh(w,!0),w.tail===null&&w.tailMode==="hidden"&&!D.alternate&&!Ei)return Oa(u),null}else 2*Ra()-w.renderingStartTime>ef&&h!==536870912&&(u.flags|=128,_=!0,Xh(w,!1),u.lanes=4194304);w.isBackwards?(D.sibling=u.child,u.child=D):(a=w.last,a!==null?a.sibling=D:u.child=D,w.last=D)}return w.tail!==null?(u=w.tail,w.rendering=u,w.tail=u.sibling,w.renderingStartTime=Ra(),u.sibling=null,a=nn.current,At(nn,_?a&1|2:a&1),u):(Oa(u),null);case 22:case 23:return yr(u),Gc(),_=u.memoizedState!==null,a!==null?a.memoizedState!==null!==_&&(u.flags|=8192):_&&(u.flags|=8192),_?(h&536870912)!==0&&(u.flags&128)===0&&(Oa(u),u.subtreeFlags&6&&(u.flags|=8192)):Oa(u),h=u.updateQueue,h!==null&&Gd(u,h.retryQueue),h=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),_=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(_=u.memoizedState.cachePool.pool),_!==h&&(u.flags|=2048),a!==null&&xt(hs),null;case 24:return h=null,a!==null&&(h=a.memoizedState.cache),u.memoizedState.cache!==h&&(u.flags|=2048),ls(Ua),Oa(u),null;case 25:return null;case 30:return null}throw Error(v(156,u.tag))}function n0(a,u){switch(Ul(u),u.tag){case 1:return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 3:return ls(Ua),qn(),a=u.flags,(a&65536)!==0&&(a&128)===0?(u.flags=a&-65537|128,u):null;case 26:case 27:case 5:return gn(u),null;case 13:if(yr(u),a=u.memoizedState,a!==null&&a.dehydrated!==null){if(u.alternate===null)throw Error(v(340));zs()}return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 19:return xt(nn),null;case 4:return qn(),null;case 10:return ls(u.type),null;case 22:case 23:return yr(u),Gc(),a!==null&&xt(hs),a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 24:return ls(Ua),null;case 25:return null;default:return null}}function cp(a,u){switch(Ul(u),u.tag){case 3:ls(Ua),qn();break;case 26:case 27:case 5:gn(u);break;case 4:qn();break;case 13:yr(u);break;case 19:xt(nn);break;case 10:ls(u.type);break;case 22:case 23:yr(u),Gc(),a!==null&&xt(hs);break;case 24:ls(Ua)}}function Qc(a,u){try{var h=u.updateQueue,_=h!==null?h.lastEffect:null;if(_!==null){var w=_.next;h=w;do{if((h.tag&a)===a){_=void 0;var D=h.create,q=h.inst;_=D(),q.destroy=_}h=h.next}while(h!==w)}}catch(Q){la(u,u.return,Q)}}function xs(a,u,h){try{var _=u.updateQueue,w=_!==null?_.lastEffect:null;if(w!==null){var D=w.next;_=D;do{if((_.tag&a)===a){var q=_.inst,Q=q.destroy;if(Q!==void 0){q.destroy=void 0,w=u;var ge=h,ze=Q;try{ze()}catch(tt){la(w,ge,tt)}}}_=_.next}while(_!==D)}}catch(tt){la(u,u.return,tt)}}function hp(a){var u=a.updateQueue;if(u!==null){var h=a.stateNode;try{Yi(u,h)}catch(_){la(a,a.return,_)}}}function Ca(a,u,h){h.props=Jl(a.type,a.memoizedProps),h.state=a.memoizedState;try{h.componentWillUnmount()}catch(_){la(a,u,_)}}function Do(a,u){try{var h=a.ref;if(h!==null){switch(a.tag){case 26:case 27:case 5:var _=a.stateNode;break;case 30:_=a.stateNode;break;default:_=a.stateNode}typeof h=="function"?a.refCleanup=h(_):h.current=_}}catch(w){la(a,u,w)}}function Ws(a,u){var h=a.ref,_=a.refCleanup;if(h!==null)if(typeof _=="function")try{_()}catch(w){la(a,u,w)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(w){la(a,u,w)}else h.current=null}function Qh(a){var u=a.type,h=a.memoizedProps,_=a.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":h.autoFocus&&_.focus();break e;case"img":h.src?_.src=h.src:h.srcSet&&(_.srcset=h.srcSet)}}catch(w){la(a,a.return,w)}}function Kc(a,u,h){try{var _=a.stateNode;Ip(_,a.type,h,u),_[Rt]=u}catch(w){la(a,a.return,w)}}function Wc(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Su(a.type)||a.tag===4}function Zd(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Wc(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Su(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Yd(a,u,h){var _=a.tag;if(_===5||_===6)a=a.stateNode,u?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(a,u):(u=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,u.appendChild(a),h=h._reactRootContainer,h!=null||u.onclick!==null||(u.onclick=od));else if(_!==4&&(_===27&&Su(a.type)&&(h=a.stateNode,u=null),a=a.child,a!==null))for(Yd(a,u,h),a=a.sibling;a!==null;)Yd(a,u,h),a=a.sibling}function ul(a,u,h){var _=a.tag;if(_===5||_===6)a=a.stateNode,u?h.insertBefore(a,u):h.appendChild(a);else if(_!==4&&(_===27&&Su(a.type)&&(h=a.stateNode),a=a.child,a!==null))for(ul(a,u,h),a=a.sibling;a!==null;)ul(a,u,h),a=a.sibling}function $d(a){var u=a.stateNode,h=a.memoizedProps;try{for(var _=a.type,w=u.attributes;w.length;)u.removeAttributeNode(w[0]);In(u,_,h),u[kt]=a,u[Rt]=h}catch(D){la(a,a.return,D)}}var Nr=!1,Ma=!1,ll=!1,Jc=typeof WeakSet=="function"?WeakSet:Set,Sn=null;function dp(a,u){if(a=a.containerInfo,C0=ot,a=Dc(a),Rc(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else e:{h=(h=a.ownerDocument)&&h.defaultView||window;var _=h.getSelection&&h.getSelection();if(_&&_.rangeCount!==0){h=_.anchorNode;var w=_.anchorOffset,D=_.focusNode;_=_.focusOffset;try{h.nodeType,D.nodeType}catch{h=null;break e}var q=0,Q=-1,ge=-1,ze=0,tt=0,nt=a,qe=null;t:for(;;){for(var Ze;nt!==h||w!==0&&nt.nodeType!==3||(Q=q+w),nt!==D||_!==0&&nt.nodeType!==3||(ge=q+_),nt.nodeType===3&&(q+=nt.nodeValue.length),(Ze=nt.firstChild)!==null;)qe=nt,nt=Ze;for(;;){if(nt===a)break t;if(qe===h&&++ze===w&&(Q=q),qe===D&&++tt===_&&(ge=q),(Ze=nt.nextSibling)!==null)break;nt=qe,qe=nt.parentNode}nt=Ze}h=Q===-1||ge===-1?null:{start:Q,end:ge}}else h=null}h=h||{start:0,end:0}}else h=null;for(yf={focusedElem:a,selectionRange:h},ot=!1,Sn=u;Sn!==null;)if(u=Sn,a=u.child,(u.subtreeFlags&1024)!==0&&a!==null)a.return=u,Sn=a;else for(;Sn!==null;){switch(u=Sn,D=u.alternate,a=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&D!==null){a=void 0,h=u,w=D.memoizedProps,D=D.memoizedState,_=h.stateNode;try{var Wt=Jl(h.type,w,h.elementType===h.type);a=_.getSnapshotBeforeUpdate(Wt,D),_.__reactInternalSnapshotBeforeUpdate=a}catch(Yt){la(h,h.return,Yt)}}break;case 3:if((a&1024)!==0){if(a=u.stateNode.containerInfo,h=a.nodeType,h===9)fh(a);else if(h===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":fh(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(v(163))}if(a=u.sibling,a!==null){a.return=u.return,Sn=a;break}Sn=u.return}}function cl(a,u,h){var _=h.flags;switch(h.tag){case 0:case 11:case 15:Ro(a,h),_&4&&Qc(5,h);break;case 1:if(Ro(a,h),_&4)if(a=h.stateNode,u===null)try{a.componentDidMount()}catch(q){la(h,h.return,q)}else{var w=Jl(h.type,u.memoizedProps);u=u.memoizedState;try{a.componentDidUpdate(w,u,a.__reactInternalSnapshotBeforeUpdate)}catch(q){la(h,h.return,q)}}_&64&&hp(h),_&512&&Do(h,h.return);break;case 3:if(Ro(a,h),_&64&&(a=h.updateQueue,a!==null)){if(u=null,h.child!==null)switch(h.child.tag){case 27:case 5:u=h.child.stateNode;break;case 1:u=h.child.stateNode}try{Yi(a,u)}catch(q){la(h,h.return,q)}}break;case 27:u===null&&_&4&&$d(h);case 26:case 5:Ro(a,h),u===null&&_&4&&Qh(h),_&512&&Do(h,h.return);break;case 12:Ro(a,h);break;case 13:Ro(a,h),_&4&&s0(a,h),_&64&&(a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(h=No.bind(null,h),Tm(a,h))));break;case 22:if(_=h.memoizedState!==null||Nr,!_){u=u!==null&&u.memoizedState!==null||Ma,w=Nr;var D=Ma;Nr=_,(Ma=u)&&!D?Po(a,h,(h.subtreeFlags&8772)!==0):Ro(a,h),Nr=w,Ma=D}break;case 30:break;default:Ro(a,h)}}function fp(a){var u=a.alternate;u!==null&&(a.alternate=null,fp(u)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(u=a.stateNode,u!==null&&Ft(u)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var ya=null,Cn=!1;function Js(a,u,h){for(h=h.child;h!==null;)r0(a,u,h),h=h.sibling}function r0(a,u,h){if(Ka&&typeof Ka.onCommitFiberUnmount=="function")try{Ka.onCommitFiberUnmount(es,h)}catch{}switch(h.tag){case 26:Ma||Ws(h,u),Js(a,u,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Ma||Ws(h,u);var _=ya,w=Cn;Su(h.type)&&(ya=h.stateNode,Cn=!1),Js(a,u,h),ph(h.stateNode),ya=_,Cn=w;break;case 5:Ma||Ws(h,u);case 6:if(_=ya,w=Cn,ya=null,Js(a,u,h),ya=_,Cn=w,ya!==null)if(Cn)try{(ya.nodeType===9?ya.body:ya.nodeName==="HTML"?ya.ownerDocument.body:ya).removeChild(h.stateNode)}catch(D){la(h,u,D)}else try{ya.removeChild(h.stateNode)}catch(D){la(h,u,D)}break;case 18:ya!==null&&(Cn?(a=ya,ud(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,h.stateNode),fa(a)):ud(ya,h.stateNode));break;case 4:_=ya,w=Cn,ya=h.stateNode.containerInfo,Cn=!0,Js(a,u,h),ya=_,Cn=w;break;case 0:case 11:case 14:case 15:Ma||xs(2,h,u),Ma||xs(4,h,u),Js(a,u,h);break;case 1:Ma||(Ws(h,u),_=h.stateNode,typeof _.componentWillUnmount=="function"&&Ca(h,u,_)),Js(a,u,h);break;case 21:Js(a,u,h);break;case 22:Ma=(_=Ma)||h.memoizedState!==null,Js(a,u,h),Ma=_;break;default:Js(a,u,h)}}function s0(a,u){if(u.memoizedState===null&&(a=u.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{fa(a)}catch(h){la(u,u.return,h)}}function fm(a){switch(a.tag){case 13:case 19:var u=a.stateNode;return u===null&&(u=a.stateNode=new Jc),u;case 22:return a=a.stateNode,u=a._retryCache,u===null&&(u=a._retryCache=new Jc),u;default:throw Error(v(435,a.tag))}}function o0(a,u){var h=fm(a);u.forEach(function(_){var w=_l.bind(null,a,_);h.has(_)||(h.add(_),_.then(w,w))})}function Yr(a,u){var h=u.deletions;if(h!==null)for(var _=0;_<h.length;_++){var w=h[_],D=a,q=u,Q=q;e:for(;Q!==null;){switch(Q.tag){case 27:if(Su(Q.type)){ya=Q.stateNode,Cn=!1;break e}break;case 5:ya=Q.stateNode,Cn=!1;break e;case 3:case 4:ya=Q.stateNode.containerInfo,Cn=!0;break e}Q=Q.return}if(ya===null)throw Error(v(160));r0(D,q,w),ya=null,Cn=!1,D=w.alternate,D!==null&&(D.return=null),w.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)pp(u,a),u=u.sibling}var eo=null;function pp(a,u){var h=a.alternate,_=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Yr(u,a),br(a),_&4&&(xs(3,a,a.return),Qc(3,a),xs(5,a,a.return));break;case 1:Yr(u,a),br(a),_&512&&(Ma||h===null||Ws(h,h.return)),_&64&&Nr&&(a=a.updateQueue,a!==null&&(_=a.callbacks,_!==null&&(h=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=h===null?_:h.concat(_))));break;case 26:var w=eo;if(Yr(u,a),br(a),_&512&&(Ma||h===null||Ws(h,h.return)),_&4){var D=h!==null?h.memoizedState:null;if(_=a.memoizedState,h===null)if(_===null)if(a.stateNode===null){e:{_=a.type,h=a.memoizedProps,w=w.ownerDocument||w;t:switch(_){case"title":D=w.getElementsByTagName("title")[0],(!D||D[We]||D[kt]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=w.createElement(_),w.head.insertBefore(D,w.querySelector("head > title"))),In(D,_,h),D[kt]=a,Bt(D),_=D;break e;case"link":var q=E("link","href",w).get(_+(h.href||""));if(q){for(var Q=0;Q<q.length;Q++)if(D=q[Q],D.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&D.getAttribute("rel")===(h.rel==null?null:h.rel)&&D.getAttribute("title")===(h.title==null?null:h.title)&&D.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){q.splice(Q,1);break t}}D=w.createElement(_),In(D,_,h),w.head.appendChild(D);break;case"meta":if(q=E("meta","content",w).get(_+(h.content||""))){for(Q=0;Q<q.length;Q++)if(D=q[Q],D.getAttribute("content")===(h.content==null?null:""+h.content)&&D.getAttribute("name")===(h.name==null?null:h.name)&&D.getAttribute("property")===(h.property==null?null:h.property)&&D.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&D.getAttribute("charset")===(h.charSet==null?null:h.charSet)){q.splice(Q,1);break t}}D=w.createElement(_),In(D,_,h),w.head.appendChild(D);break;default:throw Error(v(468,_))}D[kt]=a,Bt(D),_=D}a.stateNode=_}else S(w,a.type,a.stateNode);else a.stateNode=r(w,_,a.memoizedProps);else D!==_?(D===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):D.count--,_===null?S(w,a.type,a.stateNode):r(w,_,a.memoizedProps)):_===null&&a.stateNode!==null&&Kc(a,a.memoizedProps,h.memoizedProps)}break;case 27:Yr(u,a),br(a),_&512&&(Ma||h===null||Ws(h,h.return)),h!==null&&_&4&&Kc(a,a.memoizedProps,h.memoizedProps);break;case 5:if(Yr(u,a),br(a),_&512&&(Ma||h===null||Ws(h,h.return)),a.flags&32){w=a.stateNode;try{fo(w,"")}catch(Ze){la(a,a.return,Ze)}}_&4&&a.stateNode!=null&&(w=a.memoizedProps,Kc(a,w,h!==null?h.memoizedProps:w)),_&1024&&(ll=!0);break;case 6:if(Yr(u,a),br(a),_&4){if(a.stateNode===null)throw Error(v(162));_=a.memoizedProps,h=a.stateNode;try{h.nodeValue=_}catch(Ze){la(a,a.return,Ze)}}break;case 3:if(x=null,w=eo,eo=Af(u.containerInfo),Yr(u,a),eo=w,br(a),_&4&&h!==null&&h.memoizedState.isDehydrated)try{fa(u.containerInfo)}catch(Ze){la(a,a.return,Ze)}ll&&(ll=!1,u0(a));break;case 4:_=eo,eo=Af(a.stateNode.containerInfo),Yr(u,a),br(a),eo=_;break;case 12:Yr(u,a),br(a);break;case 13:Yr(u,a),br(a),a.child.flags&8192&&a.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(f0=Ra()),_&4&&(_=a.updateQueue,_!==null&&(a.updateQueue=null,o0(a,_)));break;case 22:w=a.memoizedState!==null;var ge=h!==null&&h.memoizedState!==null,ze=Nr,tt=Ma;if(Nr=ze||w,Ma=tt||ge,Yr(u,a),Ma=tt,Nr=ze,br(a),_&8192)e:for(u=a.stateNode,u._visibility=w?u._visibility&-2:u._visibility|1,w&&(h===null||ge||Nr||Ma||hl(a)),h=null,u=a;;){if(u.tag===5||u.tag===26){if(h===null){ge=h=u;try{if(D=ge.stateNode,w)q=D.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{Q=ge.stateNode;var nt=ge.memoizedProps.style,qe=nt!=null&&nt.hasOwnProperty("display")?nt.display:null;Q.style.display=qe==null||typeof qe=="boolean"?"":(""+qe).trim()}}catch(Ze){la(ge,ge.return,Ze)}}}else if(u.tag===6){if(h===null){ge=u;try{ge.stateNode.nodeValue=w?"":ge.memoizedProps}catch(Ze){la(ge,ge.return,Ze)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===a)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break e;for(;u.sibling===null;){if(u.return===null||u.return===a)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}_&4&&(_=a.updateQueue,_!==null&&(h=_.retryQueue,h!==null&&(_.retryQueue=null,o0(a,h))));break;case 19:Yr(u,a),br(a),_&4&&(_=a.updateQueue,_!==null&&(a.updateQueue=null,o0(a,_)));break;case 30:break;case 21:break;default:Yr(u,a),br(a)}}function br(a){var u=a.flags;if(u&2){try{for(var h,_=a.return;_!==null;){if(Wc(_)){h=_;break}_=_.return}if(h==null)throw Error(v(160));switch(h.tag){case 27:var w=h.stateNode,D=Zd(a);ul(a,D,w);break;case 5:var q=h.stateNode;h.flags&32&&(fo(q,""),h.flags&=-33);var Q=Zd(a);ul(a,Q,q);break;case 3:case 4:var ge=h.stateNode.containerInfo,ze=Zd(a);Yd(a,ze,ge);break;default:throw Error(v(161))}}catch(tt){la(a,a.return,tt)}a.flags&=-3}u&4096&&(a.flags&=-4097)}function u0(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var u=a;u0(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),a=a.sibling}}function Ro(a,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)cl(a,u.alternate,u),u=u.sibling}function hl(a){for(a=a.child;a!==null;){var u=a;switch(u.tag){case 0:case 11:case 14:case 15:xs(4,u,u.return),hl(u);break;case 1:Ws(u,u.return);var h=u.stateNode;typeof h.componentWillUnmount=="function"&&Ca(u,u.return,h),hl(u);break;case 27:ph(u.stateNode);case 26:case 5:Ws(u,u.return),hl(u);break;case 22:u.memoizedState===null&&hl(u);break;case 30:hl(u);break;default:hl(u)}a=a.sibling}}function Po(a,u,h){for(h=h&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var _=u.alternate,w=a,D=u,q=D.flags;switch(D.tag){case 0:case 11:case 15:Po(w,D,h),Qc(4,D);break;case 1:if(Po(w,D,h),_=D,w=_.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(ze){la(_,_.return,ze)}if(_=D,w=_.updateQueue,w!==null){var Q=_.stateNode;try{var ge=w.shared.hiddenCallbacks;if(ge!==null)for(w.shared.hiddenCallbacks=null,w=0;w<ge.length;w++)ps(ge[w],Q)}catch(ze){la(_,_.return,ze)}}h&&q&64&&hp(D),Do(D,D.return);break;case 27:$d(D);case 26:case 5:Po(w,D,h),h&&_===null&&q&4&&Qh(D),Do(D,D.return);break;case 12:Po(w,D,h);break;case 13:Po(w,D,h),h&&q&4&&s0(w,D);break;case 22:D.memoizedState===null&&Po(w,D,h),Do(D,D.return);break;case 30:break;default:Po(w,D,h)}u=u.sibling}}function Xd(a,u){var h=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),a=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(a=u.memoizedState.cachePool.pool),a!==h&&(a!=null&&a.refCount++,h!=null&&el(h))}function Qd(a,u){a=null,u.alternate!==null&&(a=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==a&&(u.refCount++,a!=null&&el(a))}function $r(a,u,h,_){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)l0(a,u,h,_),u=u.sibling}function l0(a,u,h,_){var w=u.flags;switch(u.tag){case 0:case 11:case 15:$r(a,u,h,_),w&2048&&Qc(9,u);break;case 1:$r(a,u,h,_);break;case 3:$r(a,u,h,_),w&2048&&(a=null,u.alternate!==null&&(a=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==a&&(u.refCount++,a!=null&&el(a)));break;case 12:if(w&2048){$r(a,u,h,_),a=u.stateNode;try{var D=u.memoizedProps,q=D.id,Q=D.onPostCommit;typeof Q=="function"&&Q(q,u.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(ge){la(u,u.return,ge)}}else $r(a,u,h,_);break;case 13:$r(a,u,h,_);break;case 23:break;case 22:D=u.stateNode,q=u.alternate,u.memoizedState!==null?D._visibility&2?$r(a,u,h,_):eh(a,u):D._visibility&2?$r(a,u,h,_):(D._visibility|=2,ec(a,u,h,_,(u.subtreeFlags&10256)!==0)),w&2048&&Xd(q,u);break;case 24:$r(a,u,h,_),w&2048&&Qd(u.alternate,u);break;default:$r(a,u,h,_)}}function ec(a,u,h,_,w){for(w=w&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var D=a,q=u,Q=h,ge=_,ze=q.flags;switch(q.tag){case 0:case 11:case 15:ec(D,q,Q,ge,w),Qc(8,q);break;case 23:break;case 22:var tt=q.stateNode;q.memoizedState!==null?tt._visibility&2?ec(D,q,Q,ge,w):eh(D,q):(tt._visibility|=2,ec(D,q,Q,ge,w)),w&&ze&2048&&Xd(q.alternate,q);break;case 24:ec(D,q,Q,ge,w),w&&ze&2048&&Qd(q.alternate,q);break;default:ec(D,q,Q,ge,w)}u=u.sibling}}function eh(a,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var h=a,_=u,w=_.flags;switch(_.tag){case 22:eh(h,_),w&2048&&Xd(_.alternate,_);break;case 24:eh(h,_),w&2048&&Qd(_.alternate,_);break;default:eh(h,_)}u=u.sibling}}var xu=8192;function th(a){if(a.subtreeFlags&xu)for(a=a.child;a!==null;)Kd(a),a=a.sibling}function Kd(a){switch(a.tag){case 26:th(a),a.flags&xu&&a.memoizedState!==null&&j(eo,a.memoizedState,a.memoizedProps);break;case 5:th(a);break;case 3:case 4:var u=eo;eo=Af(a.stateNode.containerInfo),th(a),eo=u;break;case 22:a.memoizedState===null&&(u=a.alternate,u!==null&&u.memoizedState!==null?(u=xu,xu=16777216,th(a),xu=u):th(a));break;default:th(a)}}function ih(a){var u=a.alternate;if(u!==null&&(a=u.child,a!==null)){u.child=null;do u=a.sibling,a.sibling=null,a=u;while(a!==null)}}function tc(a){var u=a.deletions;if((a.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var _=u[h];Sn=_,c0(_,a)}ih(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)mp(a),a=a.sibling}function mp(a){switch(a.tag){case 0:case 11:case 15:tc(a),a.flags&2048&&xs(9,a,a.return);break;case 3:tc(a);break;case 12:tc(a);break;case 22:var u=a.stateNode;a.memoizedState!==null&&u._visibility&2&&(a.return===null||a.return.tag!==13)?(u._visibility&=-3,Wd(a)):tc(a);break;default:tc(a)}}function Wd(a){var u=a.deletions;if((a.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var _=u[h];Sn=_,c0(_,a)}ih(a)}for(a=a.child;a!==null;){switch(u=a,u.tag){case 0:case 11:case 15:xs(8,u,u.return),Wd(u);break;case 22:h=u.stateNode,h._visibility&2&&(h._visibility&=-3,Wd(u));break;default:Wd(u)}a=a.sibling}}function c0(a,u){for(;Sn!==null;){var h=Sn;switch(h.tag){case 0:case 11:case 15:xs(8,h,u);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var _=h.memoizedState.cachePool.pool;_!=null&&_.refCount++}break;case 24:el(h.memoizedState.cache)}if(_=h.child,_!==null)_.return=h,Sn=_;else e:for(h=a;Sn!==null;){_=Sn;var w=_.sibling,D=_.return;if(fp(_),_===h){Sn=null;break e}if(w!==null){w.return=D,Sn=w;break e}Sn=D}}}var gp={getCacheForType:function(a){var u=tn(Ua),h=u.data.get(a);return h===void 0&&(h=a(),u.data.set(a,h)),h}},pm=typeof WeakMap=="function"?WeakMap:Map,$i=0,qi=null,_i=null,Mi=0,Xi=0,Xr=null,dl=!1,ah=!1,h0=!1,Lo=0,Ia=0,vu=0,fl=0,Jd=0,vs=0,Tu=0,Kh=null,xr=null,d0=!1,f0=0,ef=1/0,Wh=null,pl=null,zn=0,Ts=null,ic=null,ml=0,tf=0,ka=null,af=null,Jh=0,nf=null;function vr(){if(($i&2)!==0&&Mi!==0)return Mi&-Mi;if(Je.T!==null){var a=qr;return a!==0?a:ff()}return pt()}function rf(){vs===0&&(vs=(Mi&536870912)===0||Ei?he():536870912);var a=Kn.current;return a!==null&&(a.flags|=32),vs}function Qr(a,u,h){(a===qi&&(Xi===2||Xi===9)||a.cancelPendingCommit!==null)&&(ac(a,0),Eu(a,Mi,vs,!1)),Le(a,h),(($i&2)===0||a!==qi)&&(a===qi&&(($i&2)===0&&(fl|=h),Ia===4&&Eu(a,Mi,vs,!1)),Es(a))}function _p(a,u,h){if(($i&6)!==0)throw Error(v(327));var _=!h&&(u&124)===0&&(u&a.expiredLanes)===0||X(a,u),w=_?gm(a,u):rh(a,u,!0),D=_;do{if(w===0){ah&&!_&&Eu(a,u,0,!1);break}else{if(h=a.current.alternate,D&&!mm(h)){w=rh(a,u,!1),D=!1;continue}if(w===2){if(D=u,a.errorRecoveryDisabledLanes&D)var q=0;else q=a.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){u=q;e:{var Q=a;w=Kh;var ge=Q.current.memoizedState.isDehydrated;if(ge&&(ac(Q,q).flags|=256),q=rh(Q,q,!1),q!==2){if(h0&&!ge){Q.errorRecoveryDisabledLanes|=D,fl|=D,w=4;break e}D=xr,xr=w,D!==null&&(xr===null?xr=D:xr.push.apply(xr,D))}w=q}if(D=!1,w!==2)continue}}if(w===1){ac(a,0),Eu(a,u,0,!0);break}e:{switch(_=a,D=w,D){case 0:case 1:throw Error(v(345));case 4:if((u&4194048)!==u)break;case 6:Eu(_,u,vs,!dl);break e;case 2:xr=null;break;case 3:case 5:break;default:throw Error(v(329))}if((u&62914560)===u&&(w=f0+300-Ra(),10<w)){if(Eu(_,u,vs,!dl),$(_,0,!0)!==0)break e;_.timeoutHandle=Dp(yp.bind(null,_,h,xr,Wh,d0,u,vs,fl,Tu,dl,D,2,-0,0),w);break e}yp(_,h,xr,Wh,d0,u,vs,fl,Tu,dl,D,0,-0,0)}}break}while(!0);Es(a)}function yp(a,u,h,_,w,D,q,Q,ge,ze,tt,nt,qe,Ze){if(a.timeoutHandle=-1,nt=u.subtreeFlags,(nt&8192||(nt&16785408)===16785408)&&(B={stylesheets:null,count:0,unsuspend:U},Kd(u),nt=V(),nt!==null)){a.cancelPendingCommit=nt(of.bind(null,a,u,D,h,_,w,q,Q,ge,tt,1,qe,Ze)),Eu(a,D,q,!ze);return}of(a,u,D,h,_,w,q,Q,ge)}function mm(a){for(var u=a;;){var h=u.tag;if((h===0||h===11||h===15)&&u.flags&16384&&(h=u.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var _=0;_<h.length;_++){var w=h[_],D=w.getSnapshot;w=w.value;try{if(!$n(D(),w))return!1}catch{return!1}}if(h=u.child,u.subtreeFlags&16384&&h!==null)h.return=u,u=h;else{if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Eu(a,u,h,_){u&=~Jd,u&=~fl,a.suspendedLanes|=u,a.pingedLanes&=~u,_&&(a.warmLanes|=u),_=a.expirationTimes;for(var w=u;0<w;){var D=31-Pa(w),q=1<<D;_[D]=-1,w&=~q}h!==0&&Re(a,h,u)}function Mn(){return($i&6)===0?(sc(0),!1):!0}function ed(){if(_i!==null){if(Xi===0)var a=_i.return;else a=_i,jr=Hr=null,Ql(a),sl=null,_u=0,a=_i;for(;a!==null;)cp(a.alternate,a),a=a.return;_i=null}}function ac(a,u){var h=a.timeoutHandle;h!==-1&&(a.timeoutHandle=-1,Rp(h)),h=a.cancelPendingCommit,h!==null&&(a.cancelPendingCommit=null,h()),ed(),qi=a,_i=h=Os(a.current,null),Mi=u,Xi=0,Xr=null,dl=!1,ah=X(a,u),h0=!1,Tu=vs=Jd=fl=vu=Ia=0,xr=Kh=null,d0=!1,(u&8)!==0&&(u|=u&32);var _=a.entangledLanes;if(_!==0)for(a=a.entanglements,_&=u;0<_;){var w=31-Pa(_),D=1<<w;u|=a[w],_&=~D}return Lo=u,nu(),h}function wu(a,u){qt=null,Je.H=Bi,u===yt||u===du?(u=Zl(),Xi=3):u===Gl?(u=Zl(),Xi=4):Xi=u===Qf?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Xr=u,_i===null&&(Ia=1,Vh(a,Nn(u,a.current)))}function td(){var a=Je.H;return Je.H=Bi,a===null?Bi:a}function nh(){var a=Je.A;return Je.A=gp,a}function gl(){Ia=4,dl||(Mi&4194048)!==Mi&&Kn.current!==null||(ah=!0),(vu&134217727)===0&&(fl&134217727)===0||qi===null||Eu(qi,Mi,vs,!1)}function rh(a,u,h){var _=$i;$i|=2;var w=td(),D=nh();(qi!==a||Mi!==u)&&(Wh=null,ac(a,u)),u=!1;var q=Ia;e:do try{if(Xi!==0&&_i!==null){var Q=_i,ge=Xr;switch(Xi){case 8:ed(),q=6;break e;case 3:case 2:case 9:case 6:Kn.current===null&&(u=!0);var ze=Xi;if(Xi=0,Xr=null,sh(a,Q,ge,ze),h&&ah){q=0;break e}break;default:ze=Xi,Xi=0,Xr=null,sh(a,Q,ge,ze)}}sf(),q=Ia;break}catch(tt){wu(a,tt)}while(!0);return u&&a.shellSuspendCounter++,jr=Hr=null,$i=_,Je.H=w,Je.A=D,_i===null&&(qi=null,Mi=0,nu()),q}function sf(){for(;_i!==null;)p0(_i)}function gm(a,u){var h=$i;$i|=2;var _=td(),w=nh();qi!==a||Mi!==u?(Wh=null,ef=Ra()+500,ac(a,u)):ah=X(a,u);e:do try{if(Xi!==0&&_i!==null){u=_i;var D=Xr;t:switch(Xi){case 1:Xi=0,Xr=null,sh(a,u,D,1);break;case 2:case 9:if(fu(D)){Xi=0,Xr=null,m0(u);break}u=function(){Xi!==2&&Xi!==9||qi!==a||(Xi=7),Es(a)},D.then(u,u);break e;case 3:Xi=7;break e;case 4:Xi=5;break e;case 7:fu(D)?(Xi=0,Xr=null,m0(u)):(Xi=0,Xr=null,sh(a,u,D,7));break;case 5:var q=null;switch(_i.tag){case 26:q=_i.memoizedState;case 5:case 27:var Q=_i;if(!q||O(q)){Xi=0,Xr=null;var ge=Q.sibling;if(ge!==null)_i=ge;else{var ze=Q.return;ze!==null?(_i=ze,id(ze)):_i=null}break t}}Xi=0,Xr=null,sh(a,u,D,5);break;case 6:Xi=0,Xr=null,sh(a,u,D,6);break;case 8:ed(),Ia=6;break e;default:throw Error(v(462))}}_m();break}catch(tt){wu(a,tt)}while(!0);return jr=Hr=null,Je.H=_,Je.A=w,$i=h,_i!==null?0:(qi=null,Mi=0,nu(),Ia)}function _m(){for(;_i!==null&&!Jr();)p0(_i)}function p0(a){var u=up(a.alternate,a,Lo);a.memoizedProps=a.pendingProps,u===null?id(a):_i=u}function m0(a){var u=a,h=u.alternate;switch(u.tag){case 15:case 0:u=Hd(h,u,u.pendingProps,u.type,void 0,Mi);break;case 11:u=Hd(h,u,u.pendingProps,u.type.render,u.ref,Mi);break;case 5:Ql(u);default:cp(h,u),u=_i=Ld(u,Lo),u=up(h,u,Lo)}a.memoizedProps=a.pendingProps,u===null?id(a):_i=u}function sh(a,u,h,_){jr=Hr=null,Ql(u),sl=null,_u=0;var w=u.return;try{if(Fd(a,w,u,h,Mi)){Ia=1,Vh(a,Nn(h,a.current)),_i=null;return}}catch(D){if(w!==null)throw _i=w,D;Ia=1,Vh(a,Nn(h,a.current)),_i=null;return}u.flags&32768?(Ei||_===1?a=!0:ah||(Mi&536870912)!==0?a=!1:(dl=a=!0,(_===2||_===9||_===3||_===6)&&(_=Kn.current,_!==null&&_.tag===13&&(_.flags|=16384))),g0(u,a)):id(u)}function id(a){var u=a;do{if((u.flags&32768)!==0){g0(u,dl);return}a=u.return;var h=dm(u.alternate,u,Lo);if(h!==null){_i=h;return}if(u=u.sibling,u!==null){_i=u;return}_i=u=a}while(u!==null);Ia===0&&(Ia=5)}function g0(a,u){do{var h=n0(a.alternate,a);if(h!==null){h.flags&=32767,_i=h;return}if(h=a.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!u&&(a=a.sibling,a!==null)){_i=a;return}_i=a=h}while(a!==null);Ia=6,_i=null}function of(a,u,h,_,w,D,q,Q,ge){a.cancelPendingCommit=null;do lf();while(zn!==0);if(($i&6)!==0)throw Error(v(327));if(u!==null){if(u===a.current)throw Error(v(177));if(D=u.lanes|u.childLanes,D|=Xu,Ae(a,h,D,q,Q,ge),a===qi&&(_i=qi=null,Mi=0),ic=u,Ts=a,ml=h,tf=D,ka=w,af=_,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,wp(rr,function(){return vp(),null})):(a.callbackNode=null,a.callbackPriority=0),_=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||_){_=Je.T,Je.T=null,w=wt.p,wt.p=2,q=$i,$i|=4;try{dp(a,u,h)}finally{$i=q,wt.p=w,Je.T=_}}zn=1,uf(),bp(),_0()}}function uf(){if(zn===1){zn=0;var a=Ts,u=ic,h=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||h){h=Je.T,Je.T=null;var _=wt.p;wt.p=2;var w=$i;$i|=4;try{pp(u,a);var D=yf,q=Dc(a.containerInfo),Q=D.focusedElem,ge=D.selectionRange;if(q!==Q&&Q&&Q.ownerDocument&&Ic(Q.ownerDocument.documentElement,Q)){if(ge!==null&&Rc(Q)){var ze=ge.start,tt=ge.end;if(tt===void 0&&(tt=ze),"selectionStart"in Q)Q.selectionStart=ze,Q.selectionEnd=Math.min(tt,Q.value.length);else{var nt=Q.ownerDocument||document,qe=nt&&nt.defaultView||window;if(qe.getSelection){var Ze=qe.getSelection(),Wt=Q.textContent.length,Yt=Math.min(ge.start,Wt),ta=ge.end===void 0?Yt:Math.min(ge.end,Wt);!Ze.extend&&Yt>ta&&(q=ta,ta=Yt,Yt=q);var De=Mc(Q,Yt),Se=Mc(Q,ta);if(De&&Se&&(Ze.rangeCount!==1||Ze.anchorNode!==De.node||Ze.anchorOffset!==De.offset||Ze.focusNode!==Se.node||Ze.focusOffset!==Se.offset)){var ke=nt.createRange();ke.setStart(De.node,De.offset),Ze.removeAllRanges(),Yt>ta?(Ze.addRange(ke),Ze.extend(Se.node,Se.offset)):(ke.setEnd(Se.node,Se.offset),Ze.addRange(ke))}}}}for(nt=[],Ze=Q;Ze=Ze.parentNode;)Ze.nodeType===1&&nt.push({element:Ze,left:Ze.scrollLeft,top:Ze.scrollTop});for(typeof Q.focus=="function"&&Q.focus(),Q=0;Q<nt.length;Q++){var st=nt[Q];st.element.scrollLeft=st.left,st.element.scrollTop=st.top}}ot=!!C0,yf=C0=null}finally{$i=w,wt.p=_,Je.T=h}}a.current=u,zn=2}}function bp(){if(zn===2){zn=0;var a=Ts,u=ic,h=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||h){h=Je.T,Je.T=null;var _=wt.p;wt.p=2;var w=$i;$i|=4;try{cl(a,u.alternate,u)}finally{$i=w,wt.p=_,Je.T=h}}zn=3}}function _0(){if(zn===4||zn===3){zn=0,ro();var a=Ts,u=ic,h=ml,_=af;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?zn=5:(zn=0,ic=Ts=null,xp(a,a.pendingLanes));var w=a.pendingLanes;if(w===0&&(pl=null),et(h),u=u.stateNode,Ka&&typeof Ka.onCommitFiberRoot=="function")try{Ka.onCommitFiberRoot(es,u,void 0,(u.current.flags&128)===128)}catch{}if(_!==null){u=Je.T,w=wt.p,wt.p=2,Je.T=null;try{for(var D=a.onRecoverableError,q=0;q<_.length;q++){var Q=_[q];D(Q.value,{componentStack:Q.stack})}}finally{Je.T=u,wt.p=w}}(ml&3)!==0&&lf(),Es(a),w=a.pendingLanes,(h&4194090)!==0&&(w&42)!==0?a===nf?Jh++:(Jh=0,nf=a):Jh=0,sc(0)}}function xp(a,u){(a.pooledCacheLanes&=u)===0&&(u=a.pooledCache,u!=null&&(a.pooledCache=null,el(u)))}function lf(a){return uf(),bp(),_0(),vp()}function vp(){if(zn!==5)return!1;var a=Ts,u=tf;tf=0;var h=et(ml),_=Je.T,w=wt.p;try{wt.p=32>h?32:h,Je.T=null,h=ka,ka=null;var D=Ts,q=ml;if(zn=0,ic=Ts=null,ml=0,($i&6)!==0)throw Error(v(331));var Q=$i;if($i|=4,mp(D.current),l0(D,D.current,q,h),$i=Q,sc(0,!1),Ka&&typeof Ka.onPostCommitFiberRoot=="function")try{Ka.onPostCommitFiberRoot(es,D)}catch{}return!0}finally{wt.p=w,Je.T=_,xp(a,u)}}function Tp(a,u,h){u=Nn(h,u),u=Xf(a.stateNode,u,2),a=Gr(a,u,2),a!==null&&(Le(a,2),Es(a))}function la(a,u,h){if(a.tag===3)Tp(a,a,h);else for(;u!==null;){if(u.tag===3){Tp(u,a,h);break}else if(u.tag===1){var _=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(pl===null||!pl.has(_))){a=Nn(h,a),h=Yc(2),_=Gr(u,h,2),_!==null&&(Gh(h,_,u,a),Le(_,2),Es(_));break}}u=u.return}}function cf(a,u,h){var _=a.pingCache;if(_===null){_=a.pingCache=new pm;var w=new Set;_.set(u,w)}else w=_.get(u),w===void 0&&(w=new Set,_.set(u,w));w.has(h)||(h0=!0,w.add(h),a=Ep.bind(null,a,u,h),u.then(a,a))}function Ep(a,u,h){var _=a.pingCache;_!==null&&_.delete(u),a.pingedLanes|=a.suspendedLanes&h,a.warmLanes&=~h,qi===a&&(Mi&h)===h&&(Ia===4||Ia===3&&(Mi&62914560)===Mi&&300>Ra()-f0?($i&2)===0&&ac(a,0):Jd|=h,Tu===Mi&&(Tu=0)),Es(a)}function oh(a,u){u===0&&(u=ve()),a=ru(a,u),a!==null&&(Le(a,u),Es(a))}function No(a){var u=a.memoizedState,h=0;u!==null&&(h=u.retryLane),oh(a,h)}function _l(a,u){var h=0;switch(a.tag){case 13:var _=a.stateNode,w=a.memoizedState;w!==null&&(h=w.retryLane);break;case 19:_=a.stateNode;break;case 22:_=a.stateNode._retryCache;break;default:throw Error(v(314))}_!==null&&_.delete(u),oh(a,h)}function wp(a,u){return on(a,u)}var uh=null,lh=null,y0=!1,nc=!1,ad=!1,rc=0;function Es(a){a!==lh&&a.next===null&&(lh===null?uh=lh=a:lh=lh.next=a),nc=!0,y0||(y0=!0,df())}function sc(a,u){if(!ad&&nc){ad=!0;do for(var h=!1,_=uh;_!==null;){if(a!==0){var w=_.pendingLanes;if(w===0)var D=0;else{var q=_.suspendedLanes,Q=_.pingedLanes;D=(1<<31-Pa(42|a)+1)-1,D&=w&~(q&~Q),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(h=!0,v0(_,D))}else D=Mi,D=$(_,_===qi?D:0,_.cancelPendingCommit!==null||_.timeoutHandle!==-1),(D&3)===0||X(_,D)||(h=!0,v0(_,D));_=_.next}while(h);ad=!1}}function ch(){b0()}function b0(){nc=y0=!1;var a=0;rc!==0&&(xm()&&(a=rc),rc=0);for(var u=Ra(),h=null,_=uh;_!==null;){var w=_.next,D=x0(_,u);D===0?(_.next=null,h===null?uh=w:h.next=w,w===null&&(lh=h)):(h=_,(a!==0||(D&3)!==0)&&(nc=!0)),_=w}sc(a)}function x0(a,u){for(var h=a.suspendedLanes,_=a.pingedLanes,w=a.expirationTimes,D=a.pendingLanes&-62914561;0<D;){var q=31-Pa(D),Q=1<<q,ge=w[q];ge===-1?((Q&h)===0||(Q&_)!==0)&&(w[q]=ie(Q,u)):ge<=u&&(a.expiredLanes|=Q),D&=~Q}if(u=qi,h=Mi,h=$(a,a===u?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),_=a.callbackNode,h===0||a===u&&(Xi===2||Xi===9)||a.cancelPendingCommit!==null)return _!==null&&_!==null&&Oi(_),a.callbackNode=null,a.callbackPriority=0;if((h&3)===0||X(a,h)){if(u=h&-h,u===a.callbackPriority)return u;switch(_!==null&&Oi(_),et(h)){case 2:case 8:h=Vn;break;case 32:h=rr;break;case 268435456:h=so;break;default:h=rr}return _=hf.bind(null,a),h=on(h,_),a.callbackPriority=u,a.callbackNode=h,u}return _!==null&&_!==null&&Oi(_),a.callbackPriority=2,a.callbackNode=null,2}function hf(a,u){if(zn!==0&&zn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var h=a.callbackNode;if(lf()&&a.callbackNode!==h)return null;var _=Mi;return _=$(a,a===qi?_:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),_===0?null:(_p(a,_,u),x0(a,Ra()),a.callbackNode!=null&&a.callbackNode===h?hf.bind(null,a):null)}function v0(a,u){if(lf())return null;_p(a,u,!0)}function df(){Pp(function(){($i&6)!==0?on(Du,ch):b0()})}function ff(){return rc===0&&(rc=he()),rc}function Ap(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:po(""+a)}function Sp(a,u){var h=u.ownerDocument.createElement("input");return h.name=u.name,h.value=u.value,a.id&&h.setAttribute("form",a.id),u.parentNode.insertBefore(h,u),a=new FormData(a),h.parentNode.removeChild(h),a}function Cp(a,u,h,_,w){if(u==="submit"&&h&&h.stateNode===w){var D=Ap((w[Rt]||null).action),q=_.submitter;q&&(u=(u=q[Rt]||null)?Ap(u.formAction):q.getAttribute("formAction"),u!==null&&(D=u,q=null));var Q=new zu("action","action",null,_,w);a.push({event:Q,listeners:[{instance:null,listener:function(){if(_.defaultPrevented){if(rc!==0){var ge=q?Sp(w,q):new FormData(w);_s(h,{pending:!0,data:ge,method:w.method,action:D},null,ge)}}else typeof D=="function"&&(Q.preventDefault(),ge=q?Sp(w,q):new FormData(w),_s(h,{pending:!0,data:ge,method:w.method,action:D},D,ge))},currentTarget:w}]})}}for(var T0=0;T0<Nc.length;T0++){var E0=Nc[T0],ym=E0.toLowerCase(),bm=E0[0].toUpperCase()+E0.slice(1);hr(ym,"on"+bm)}hr(kl,"onAnimationEnd"),hr(Bl,"onAnimationIteration"),hr(Pc,"onAnimationStart"),hr("dblclick","onDoubleClick"),hr("focusin","onFocus"),hr("focusout","onBlur"),hr(au,"onTransitionRun"),hr(Lc,"onTransitionStart"),hr($u,"onTransitionCancel"),hr(cr,"onTransitionEnd"),ts("onMouseEnter",["mouseout","mouseover"]),ts("onMouseLeave",["mouseout","mouseover"]),ts("onPointerEnter",["pointerout","pointerover"]),ts("onPointerLeave",["pointerout","pointerover"]),or("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),or("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),or("onBeforeInput",["compositionend","keypress","textInput","paste"]),or("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),or("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),or("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nd));function Au(a,u){u=(u&4)!==0;for(var h=0;h<a.length;h++){var _=a[h],w=_.event;_=_.listeners;e:{var D=void 0;if(u)for(var q=_.length-1;0<=q;q--){var Q=_[q],ge=Q.instance,ze=Q.currentTarget;if(Q=Q.listener,ge!==D&&w.isPropagationStopped())break e;D=Q,w.currentTarget=ze;try{D(w)}catch(tt){Zc(tt)}w.currentTarget=null,D=ge}else for(q=0;q<_.length;q++){if(Q=_[q],ge=Q.instance,ze=Q.currentTarget,Q=Q.listener,ge!==D&&w.isPropagationStopped())break e;D=Q,w.currentTarget=ze;try{D(w)}catch(tt){Zc(tt)}w.currentTarget=null,D=ge}}}}function yi(a,u){var h=u[vi];h===void 0&&(h=u[vi]=new Set);var _=a+"__bubble";h.has(_)||(A0(u,a,2,!1),h.add(_))}function pf(a,u,h){var _=0;u&&(_|=4),A0(h,a,_,u)}var rd="_reactListening"+Math.random().toString(36).slice(2);function mf(a){if(!a[rd]){a[rd]=!0,Fo.forEach(function(h){h!=="selectionchange"&&(w0.has(h)||pf(h,!1,a),pf(h,!0,a))});var u=a.nodeType===9?a:a.ownerDocument;u===null||u[rd]||(u[rd]=!0,pf("selectionchange",!1,u))}}function A0(a,u,h,_){switch(Ct(u)){case 2:var w=rt;break;case 8:w=ct;break;default:w=Xe}h=w.bind(null,u,h,a),w=void 0,!Ln||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(w=!0),_?w!==void 0?a.addEventListener(u,h,{capture:!0,passive:w}):a.addEventListener(u,h,!0):w!==void 0?a.addEventListener(u,h,{passive:w}):a.addEventListener(u,h,!1)}function sd(a,u,h,_,w){var D=_;if((u&1)===0&&(u&2)===0&&_!==null)e:for(;;){if(_===null)return;var q=_.tag;if(q===3||q===4){var Q=_.stateNode.containerInfo;if(Q===w)break;if(q===4)for(q=_.return;q!==null;){var ge=q.tag;if((ge===3||ge===4)&&q.stateNode.containerInfo===w)return;q=q.return}for(;Q!==null;){if(q=Gt(Q),q===null)return;if(ge=q.tag,ge===5||ge===6||ge===26||ge===27){_=D=q;continue e}Q=Q.parentNode}}_=_.return}Zi(function(){var ze=D,tt=mo(h),nt=[];e:{var qe=kh.get(a);if(qe!==void 0){var Ze=zu,Wt=a;switch(a){case"keypress":if(Zt(h)===0)break e;case"keydown":case"keyup":Ze=eu;break;case"focusin":Wt="focus",Ze=Ko;break;case"focusout":Wt="blur",Ze=Ko;break;case"beforeblur":case"afterblur":Ze=Ko;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=Fu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=Ja;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=Uf;break;case kl:case Bl:case Pc:Ze=en;break;case cr:Ze=jf;break;case"scroll":case"scrollend":Ze=Dl;break;case"wheel":Ze=Uu;break;case"copy":case"cut":case"paste":Ze=vc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=wd;break;case"toggle":case"beforetoggle":Ze=Ac}var Yt=(u&4)!==0,ta=!Yt&&(a==="scroll"||a==="scrollend"),De=Yt?qe!==null?qe+"Capture":null:qe;Yt=[];for(var Se=ze,ke;Se!==null;){var st=Se;if(ke=st.stateNode,st=st.tag,st!==5&&st!==26&&st!==27||ke===null||De===null||(st=is(Se,De),st!=null&&Yt.push(hh(Se,st,ke))),ta)break;Se=Se.return}0<Yt.length&&(qe=new Ze(qe,Wt,null,h,tt),nt.push({event:qe,listeners:Yt}))}}if((u&7)===0){e:{if(qe=a==="mouseover"||a==="pointerover",Ze=a==="mouseout"||a==="pointerout",qe&&h!==Vo&&(Wt=h.relatedTarget||h.fromElement)&&(Gt(Wt)||Wt[Ve]))break e;if((Ze||qe)&&(qe=tt.window===tt?tt:(qe=tt.ownerDocument)?qe.defaultView||qe.parentWindow:window,Ze?(Wt=h.relatedTarget||h.toElement,Ze=ze,Wt=Wt?Gt(Wt):null,Wt!==null&&(ta=N(Wt),Yt=Wt.tag,Wt!==ta||Yt!==5&&Yt!==27&&Yt!==6)&&(Wt=null)):(Ze=null,Wt=ze),Ze!==Wt)){if(Yt=Fu,st="onMouseLeave",De="onMouseEnter",Se="mouse",(a==="pointerout"||a==="pointerover")&&(Yt=wd,st="onPointerLeave",De="onPointerEnter",Se="pointer"),ta=Ze==null?qe:Gi(Ze),ke=Wt==null?qe:Gi(Wt),qe=new Yt(st,Se+"leave",Ze,h,tt),qe.target=ta,qe.relatedTarget=ke,st=null,Gt(tt)===ze&&(Yt=new Yt(De,Se+"enter",Wt,h,tt),Yt.target=ke,Yt.relatedTarget=ta,st=Yt),ta=st,Ze&&Wt)t:{for(Yt=Ze,De=Wt,Se=0,ke=Yt;ke;ke=oc(ke))Se++;for(ke=0,st=De;st;st=oc(st))ke++;for(;0<Se-ke;)Yt=oc(Yt),Se--;for(;0<ke-Se;)De=oc(De),ke--;for(;Se--;){if(Yt===De||De!==null&&Yt===De.alternate)break t;Yt=oc(Yt),De=oc(De)}Yt=null}else Yt=null;Ze!==null&&gf(nt,qe,Ze,Yt,!1),Wt!==null&&ta!==null&&gf(nt,ta,Wt,Yt,!0)}}e:{if(qe=ze?Gi(ze):window,Ze=qe.nodeName&&qe.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&qe.type==="file")var Nt=Ps;else if(Ch(qe))if(Mh)Nt=Rd;else{Nt=Dh;var Jt=Vf}else Ze=qe.nodeName,!Ze||Ze.toLowerCase()!=="input"||qe.type!=="checkbox"&&qe.type!=="radio"?ze&&ln(ze.elementType)&&(Nt=Ps):Nt=Dd;if(Nt&&(Nt=Nt(a,ze))){Vu(nt,Nt,h,tt);break e}Jt&&Jt(a,qe,ze),a==="focusout"&&ze&&qe.type==="number"&&ze.memoizedProps.value!=null&&Il(qe,"number",qe.value)}switch(Jt=ze?Gi(ze):window,a){case"focusin":(Ch(Jt)||Jt.contentEditable==="true")&&(Ir=Jt,Nl=ze,Ol=null);break;case"focusout":Ol=Nl=Ir=null;break;case"mousedown":Lh=!0;break;case"contextmenu":case"mouseup":case"dragend":Lh=!1,Pd(nt,h,tt);break;case"selectionchange":if(Ph)break;case"keydown":case"keyup":Pd(nt,h,tt)}var Ht;if(Cr)e:{switch(a){case"compositionstart":var $t="onCompositionStart";break e;case"compositionend":$t="onCompositionEnd";break e;case"compositionupdate":$t="onCompositionUpdate";break e}$t=void 0}else Mr?Pl(a,h)&&($t="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&($t="onCompositionStart");$t&&(ju&&h.locale!=="ko"&&(Mr||$t!=="onCompositionStart"?$t==="onCompositionEnd"&&Mr&&(Ht=ci()):(Ar=tt,Di="value"in Ar?Ar.value:Ar.textContent,Mr=!0)),Jt=yl(ze,$t),0<Jt.length&&($t=new Ed($t,a,null,h,tt),nt.push({event:$t,listeners:Jt}),Ht?$t.data=Ht:(Ht=Sh(h),Ht!==null&&($t.data=Ht)))),(Ht=Ah?Sd(a,h):Cd(a,h))&&($t=yl(ze,"onBeforeInput"),0<$t.length&&(Jt=new Ed("onBeforeInput","beforeinput",null,h,tt),nt.push({event:Jt,listeners:$t}),Jt.data=Ht)),Cp(nt,a,ze,h,tt)}Au(nt,u)})}function hh(a,u,h){return{instance:a,listener:u,currentTarget:h}}function yl(a,u){for(var h=u+"Capture",_=[];a!==null;){var w=a,D=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||D===null||(w=is(a,h),w!=null&&_.unshift(hh(a,w,D)),w=is(a,u),w!=null&&_.push(hh(a,w,D))),a.tag===3)return _;a=a.return}return[]}function oc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function gf(a,u,h,_,w){for(var D=u._reactName,q=[];h!==null&&h!==_;){var Q=h,ge=Q.alternate,ze=Q.stateNode;if(Q=Q.tag,ge!==null&&ge===_)break;Q!==5&&Q!==26&&Q!==27||ze===null||(ge=ze,w?(ze=is(h,D),ze!=null&&q.unshift(hh(h,ze,ge))):w||(ze=is(h,D),ze!=null&&q.push(hh(h,ze,ge)))),h=h.return}q.length!==0&&a.push({event:u,listeners:q})}var Mp=/\r\n?/g,Kr=/\u0000|\uFFFD/g;function uc(a){return(typeof a=="string"?a:""+a).replace(Mp,`
`).replace(Kr,"")}function S0(a,u){return u=uc(u),uc(a)===u}function od(){}function Qi(a,u,h,_,w,D){switch(h){case"children":typeof _=="string"?u==="body"||u==="textarea"&&_===""||fo(a,_):(typeof _=="number"||typeof _=="bigint")&&u!=="body"&&fo(a,""+_);break;case"className":lo(a,"class",_);break;case"tabIndex":lo(a,"tabindex",_);break;case"dir":case"role":case"viewBox":case"width":case"height":lo(a,h,_);break;case"style":jo(a,_,D);break;case"data":if(u!=="object"){lo(a,"data",_);break}case"src":case"href":if(_===""&&(u!=="a"||h!=="href")){a.removeAttribute(h);break}if(_==null||typeof _=="function"||typeof _=="symbol"||typeof _=="boolean"){a.removeAttribute(h);break}_=po(""+_),a.setAttribute(h,_);break;case"action":case"formAction":if(typeof _=="function"){a.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(h==="formAction"?(u!=="input"&&Qi(a,u,"name",w.name,w,null),Qi(a,u,"formEncType",w.formEncType,w,null),Qi(a,u,"formMethod",w.formMethod,w,null),Qi(a,u,"formTarget",w.formTarget,w,null)):(Qi(a,u,"encType",w.encType,w,null),Qi(a,u,"method",w.method,w,null),Qi(a,u,"target",w.target,w,null)));if(_==null||typeof _=="symbol"||typeof _=="boolean"){a.removeAttribute(h);break}_=po(""+_),a.setAttribute(h,_);break;case"onClick":_!=null&&(a.onclick=od);break;case"onScroll":_!=null&&yi("scroll",a);break;case"onScrollEnd":_!=null&&yi("scrollend",a);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(v(61));if(h=_.__html,h!=null){if(w.children!=null)throw Error(v(60));a.innerHTML=h}}break;case"multiple":a.multiple=_&&typeof _!="function"&&typeof _!="symbol";break;case"muted":a.muted=_&&typeof _!="function"&&typeof _!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(_==null||typeof _=="function"||typeof _=="boolean"||typeof _=="symbol"){a.removeAttribute("xlink:href");break}h=po(""+_),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":_!=null&&typeof _!="function"&&typeof _!="symbol"?a.setAttribute(h,""+_):a.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":_&&typeof _!="function"&&typeof _!="symbol"?a.setAttribute(h,""):a.removeAttribute(h);break;case"capture":case"download":_===!0?a.setAttribute(h,""):_!==!1&&_!=null&&typeof _!="function"&&typeof _!="symbol"?a.setAttribute(h,_):a.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":_!=null&&typeof _!="function"&&typeof _!="symbol"&&!isNaN(_)&&1<=_?a.setAttribute(h,_):a.removeAttribute(h);break;case"rowSpan":case"start":_==null||typeof _=="function"||typeof _=="symbol"||isNaN(_)?a.removeAttribute(h):a.setAttribute(h,_);break;case"popover":yi("beforetoggle",a),yi("toggle",a),Ui(a,"popover",_);break;case"xlinkActuate":Gn(a,"http://www.w3.org/1999/xlink","xlink:actuate",_);break;case"xlinkArcrole":Gn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",_);break;case"xlinkRole":Gn(a,"http://www.w3.org/1999/xlink","xlink:role",_);break;case"xlinkShow":Gn(a,"http://www.w3.org/1999/xlink","xlink:show",_);break;case"xlinkTitle":Gn(a,"http://www.w3.org/1999/xlink","xlink:title",_);break;case"xlinkType":Gn(a,"http://www.w3.org/1999/xlink","xlink:type",_);break;case"xmlBase":Gn(a,"http://www.w3.org/XML/1998/namespace","xml:base",_);break;case"xmlLang":Gn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",_);break;case"xmlSpace":Gn(a,"http://www.w3.org/XML/1998/namespace","xml:space",_);break;case"is":Ui(a,"is",_);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=qo.get(h)||h,Ui(a,h,_))}}function _f(a,u,h,_,w,D){switch(h){case"style":jo(a,_,D);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(v(61));if(h=_.__html,h!=null){if(w.children!=null)throw Error(v(60));a.innerHTML=h}}break;case"children":typeof _=="string"?fo(a,_):(typeof _=="number"||typeof _=="bigint")&&fo(a,""+_);break;case"onScroll":_!=null&&yi("scroll",a);break;case"onScrollEnd":_!=null&&yi("scrollend",a);break;case"onClick":_!=null&&(a.onclick=od);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lu.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(w=h.endsWith("Capture"),u=h.slice(2,w?h.length-7:void 0),D=a[Rt]||null,D=D!=null?D[h]:null,typeof D=="function"&&a.removeEventListener(u,D,w),typeof _=="function")){typeof D!="function"&&D!==null&&(h in a?a[h]=null:a.hasAttribute(h)&&a.removeAttribute(h)),a.addEventListener(u,_,w);break e}h in a?a[h]=_:_===!0?a.setAttribute(h,""):Ui(a,h,_)}}}function In(a,u,h){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yi("error",a),yi("load",a);var _=!1,w=!1,D;for(D in h)if(h.hasOwnProperty(D)){var q=h[D];if(q!=null)switch(D){case"src":_=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(v(137,u));default:Qi(a,u,D,q,h,null)}}w&&Qi(a,u,"srcSet",h.srcSet,h,null),_&&Qi(a,u,"src",h.src,h,null);return;case"input":yi("invalid",a);var Q=D=q=w=null,ge=null,ze=null;for(_ in h)if(h.hasOwnProperty(_)){var tt=h[_];if(tt!=null)switch(_){case"name":w=tt;break;case"type":q=tt;break;case"checked":ge=tt;break;case"defaultChecked":ze=tt;break;case"value":D=tt;break;case"defaultValue":Q=tt;break;case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(v(137,u));break;default:Qi(a,u,_,tt,h,null)}}ho(a,D,Q,ge,ze,q,w,!1),yc(a);return;case"select":yi("invalid",a),_=q=D=null;for(w in h)if(h.hasOwnProperty(w)&&(Q=h[w],Q!=null))switch(w){case"value":D=Q;break;case"defaultValue":q=Q;break;case"multiple":_=Q;default:Qi(a,u,w,Q,h,null)}u=D,h=q,a.multiple=!!_,u!=null?Ou(a,!!_,u,!1):h!=null&&Ou(a,!!_,h,!0);return;case"textarea":yi("invalid",a),D=w=_=null;for(q in h)if(h.hasOwnProperty(q)&&(Q=h[q],Q!=null))switch(q){case"value":_=Q;break;case"defaultValue":w=Q;break;case"children":D=Q;break;case"dangerouslySetInnerHTML":if(Q!=null)throw Error(v(91));break;default:Qi(a,u,q,Q,h,null)}Bu(a,_,w,D),yc(a);return;case"option":for(ge in h)if(h.hasOwnProperty(ge)&&(_=h[ge],_!=null))switch(ge){case"selected":a.selected=_&&typeof _!="function"&&typeof _!="symbol";break;default:Qi(a,u,ge,_,h,null)}return;case"dialog":yi("beforetoggle",a),yi("toggle",a),yi("cancel",a),yi("close",a);break;case"iframe":case"object":yi("load",a);break;case"video":case"audio":for(_=0;_<nd.length;_++)yi(nd[_],a);break;case"image":yi("error",a),yi("load",a);break;case"details":yi("toggle",a);break;case"embed":case"source":case"link":yi("error",a),yi("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ze in h)if(h.hasOwnProperty(ze)&&(_=h[ze],_!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":throw Error(v(137,u));default:Qi(a,u,ze,_,h,null)}return;default:if(ln(u)){for(tt in h)h.hasOwnProperty(tt)&&(_=h[tt],_!==void 0&&_f(a,u,tt,_,h,void 0));return}}for(Q in h)h.hasOwnProperty(Q)&&(_=h[Q],_!=null&&Qi(a,u,Q,_,h,null))}function Ip(a,u,h,_){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,D=null,q=null,Q=null,ge=null,ze=null,tt=null;for(Ze in h){var nt=h[Ze];if(h.hasOwnProperty(Ze)&&nt!=null)switch(Ze){case"checked":break;case"value":break;case"defaultValue":ge=nt;default:_.hasOwnProperty(Ze)||Qi(a,u,Ze,null,_,nt)}}for(var qe in _){var Ze=_[qe];if(nt=h[qe],_.hasOwnProperty(qe)&&(Ze!=null||nt!=null))switch(qe){case"type":D=Ze;break;case"name":w=Ze;break;case"checked":ze=Ze;break;case"defaultChecked":tt=Ze;break;case"value":q=Ze;break;case"defaultValue":Q=Ze;break;case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(v(137,u));break;default:Ze!==nt&&Qi(a,u,qe,Ze,_,nt)}}bc(a,q,Q,ge,ze,tt,D,w);return;case"select":Ze=q=Q=qe=null;for(D in h)if(ge=h[D],h.hasOwnProperty(D)&&ge!=null)switch(D){case"value":break;case"multiple":Ze=ge;default:_.hasOwnProperty(D)||Qi(a,u,D,null,_,ge)}for(w in _)if(D=_[w],ge=h[w],_.hasOwnProperty(w)&&(D!=null||ge!=null))switch(w){case"value":qe=D;break;case"defaultValue":Q=D;break;case"multiple":q=D;default:D!==ge&&Qi(a,u,w,D,_,ge)}u=Q,h=q,_=Ze,qe!=null?Ou(a,!!h,qe,!1):!!_!=!!h&&(u!=null?Ou(a,!!h,u,!0):Ou(a,!!h,h?[]:"",!1));return;case"textarea":Ze=qe=null;for(Q in h)if(w=h[Q],h.hasOwnProperty(Q)&&w!=null&&!_.hasOwnProperty(Q))switch(Q){case"value":break;case"children":break;default:Qi(a,u,Q,null,_,w)}for(q in _)if(w=_[q],D=h[q],_.hasOwnProperty(q)&&(w!=null||D!=null))switch(q){case"value":qe=w;break;case"defaultValue":Ze=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(v(91));break;default:w!==D&&Qi(a,u,q,w,_,D)}ku(a,qe,Ze);return;case"option":for(var Wt in h)if(qe=h[Wt],h.hasOwnProperty(Wt)&&qe!=null&&!_.hasOwnProperty(Wt))switch(Wt){case"selected":a.selected=!1;break;default:Qi(a,u,Wt,null,_,qe)}for(ge in _)if(qe=_[ge],Ze=h[ge],_.hasOwnProperty(ge)&&qe!==Ze&&(qe!=null||Ze!=null))switch(ge){case"selected":a.selected=qe&&typeof qe!="function"&&typeof qe!="symbol";break;default:Qi(a,u,ge,qe,_,Ze)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Yt in h)qe=h[Yt],h.hasOwnProperty(Yt)&&qe!=null&&!_.hasOwnProperty(Yt)&&Qi(a,u,Yt,null,_,qe);for(ze in _)if(qe=_[ze],Ze=h[ze],_.hasOwnProperty(ze)&&qe!==Ze&&(qe!=null||Ze!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":if(qe!=null)throw Error(v(137,u));break;default:Qi(a,u,ze,qe,_,Ze)}return;default:if(ln(u)){for(var ta in h)qe=h[ta],h.hasOwnProperty(ta)&&qe!==void 0&&!_.hasOwnProperty(ta)&&_f(a,u,ta,void 0,_,qe);for(tt in _)qe=_[tt],Ze=h[tt],!_.hasOwnProperty(tt)||qe===Ze||qe===void 0&&Ze===void 0||_f(a,u,tt,qe,_,Ze);return}}for(var De in h)qe=h[De],h.hasOwnProperty(De)&&qe!=null&&!_.hasOwnProperty(De)&&Qi(a,u,De,null,_,qe);for(nt in _)qe=_[nt],Ze=h[nt],!_.hasOwnProperty(nt)||qe===Ze||qe==null&&Ze==null||Qi(a,u,nt,qe,_,Ze)}var C0=null,yf=null;function to(a){return a.nodeType===9?a:a.ownerDocument}function M0(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function I0(a,u){if(a===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&u==="foreignObject"?0:a}function bf(a,u){return a==="textarea"||a==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var xf=null;function xm(){var a=window.event;return a&&a.type==="popstate"?a===xf?!1:(xf=a,!0):(xf=null,!1)}var Dp=typeof setTimeout=="function"?setTimeout:void 0,Rp=typeof clearTimeout=="function"?clearTimeout:void 0,dh=typeof Promise=="function"?Promise:void 0,Pp=typeof queueMicrotask=="function"?queueMicrotask:typeof dh<"u"?function(a){return dh.resolve(null).then(a).catch(vf)}:Dp;function vf(a){setTimeout(function(){throw a})}function Su(a){return a==="head"}function ud(a,u){var h=u,_=0,w=0;do{var D=h.nextSibling;if(a.removeChild(h),D&&D.nodeType===8)if(h=D.data,h==="/$"){if(0<_&&8>_){h=_;var q=a.ownerDocument;if(h&1&&ph(q.documentElement),h&2&&ph(q.body),h&4)for(h=q.head,ph(h),q=h.firstChild;q;){var Q=q.nextSibling,ge=q.nodeName;q[We]||ge==="SCRIPT"||ge==="STYLE"||ge==="LINK"&&q.rel.toLowerCase()==="stylesheet"||h.removeChild(q),q=Q}}if(w===0){a.removeChild(D),fa(u);return}w--}else h==="$"||h==="$?"||h==="$!"?w++:_=h.charCodeAt(0)-48;else _=0;h=D}while(h);fa(u)}function fh(a){var u=a.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var h=u;switch(u=u.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":fh(h),Ft(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}a.removeChild(h)}}function Tf(a,u,h,_){for(;a.nodeType===1;){var w=h;if(a.nodeName.toLowerCase()!==u.toLowerCase()){if(!_&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(_){if(!a[We])switch(u){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(D=a.getAttribute("rel"),D==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(D!==w.rel||a.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||a.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||a.getAttribute("title")!==(w.title==null?null:w.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(D=a.getAttribute("src"),(D!==(w.src==null?null:w.src)||a.getAttribute("type")!==(w.type==null?null:w.type)||a.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&D&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(u==="input"&&a.type==="hidden"){var D=w.name==null?null:""+w.name;if(w.type==="hidden"&&a.getAttribute("name")===D)return a}else return a;if(a=Wn(a.nextSibling),a===null)break}return null}function vm(a,u,h){if(u==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!h||(a=Wn(a.nextSibling),a===null))return null;return a}function D0(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function Tm(a,u){var h=a.ownerDocument;if(a.data!=="$?"||h.readyState==="complete")u();else{var _=function(){u(),h.removeEventListener("DOMContentLoaded",_)};h.addEventListener("DOMContentLoaded",_),a._reactRetry=_}}function Wn(a){for(;a!=null;a=a.nextSibling){var u=a.nodeType;if(u===1||u===3)break;if(u===8){if(u=a.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return a}var rn=null;function Cu(a){a=a.previousSibling;for(var u=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"){if(u===0)return a;u--}else h==="/$"&&u++}a=a.previousSibling}return null}function Ef(a,u,h){switch(u=to(h),a){case"html":if(a=u.documentElement,!a)throw Error(v(452));return a;case"head":if(a=u.head,!a)throw Error(v(453));return a;case"body":if(a=u.body,!a)throw Error(v(454));return a;default:throw Error(v(451))}}function ph(a){for(var u=a.attributes;u.length;)a.removeAttributeNode(u[0]);Ft(a)}var Wr=new Map,wf=new Set;function Af(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Oo=wt.d;wt.d={f:Lp,r:Em,D:R0,C:Np,L:ld,m:P0,X:L0,S:Op,M:Cf};function Lp(){var a=Oo.f(),u=Mn();return a||u}function Em(a){var u=Fi(a);u!==null&&u.tag===5&&u.type==="form"?Gs(u):Oo.r(a)}var lc=typeof document>"u"?null:document;function Sf(a,u,h){var _=lc;if(_&&typeof u=="string"&&u){var w=Yn(u);w='link[rel="'+a+'"][href="'+w+'"]',typeof h=="string"&&(w+='[crossorigin="'+h+'"]'),wf.has(w)||(wf.add(w),a={rel:a,crossOrigin:h,href:u},_.querySelector(w)===null&&(u=_.createElement("link"),In(u,"link",a),Bt(u),_.head.appendChild(u)))}}function R0(a){Oo.D(a),Sf("dns-prefetch",a,null)}function Np(a,u){Oo.C(a,u),Sf("preconnect",a,u)}function ld(a,u,h){Oo.L(a,u,h);var _=lc;if(_&&a&&u){var w='link[rel="preload"][as="'+Yn(u)+'"]';u==="image"&&h&&h.imageSrcSet?(w+='[imagesrcset="'+Yn(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(w+='[imagesizes="'+Yn(h.imageSizes)+'"]')):w+='[href="'+Yn(a)+'"]';var D=w;switch(u){case"style":D=bl(a);break;case"script":D=s(a)}Wr.has(D)||(a=we({rel:"preload",href:u==="image"&&h&&h.imageSrcSet?void 0:a,as:u},h),Wr.set(D,a),_.querySelector(w)!==null||u==="style"&&_.querySelector(cc(D))||u==="script"&&_.querySelector(t(D))||(u=_.createElement("link"),In(u,"link",a),Bt(u),_.head.appendChild(u)))}}function P0(a,u){Oo.m(a,u);var h=lc;if(h&&a){var _=u&&typeof u.as=="string"?u.as:"script",w='link[rel="modulepreload"][as="'+Yn(_)+'"][href="'+Yn(a)+'"]',D=w;switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=s(a)}if(!Wr.has(D)&&(a=we({rel:"modulepreload",href:a},u),Wr.set(D,a),h.querySelector(w)===null)){switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(t(D)))return}_=h.createElement("link"),In(_,"link",a),Bt(_),h.head.appendChild(_)}}}function Op(a,u,h){Oo.S(a,u,h);var _=lc;if(_&&a){var w=qa(_).hoistableStyles,D=bl(a);u=u||"default";var q=w.get(D);if(!q){var Q={loading:0,preload:null};if(q=_.querySelector(cc(D)))Q.loading=5;else{a=we({rel:"stylesheet",href:a,"data-precedence":u},h),(h=Wr.get(D))&&p(a,h);var ge=q=_.createElement("link");Bt(ge),In(ge,"link",a),ge._p=new Promise(function(ze,tt){ge.onload=ze,ge.onerror=tt}),ge.addEventListener("load",function(){Q.loading|=1}),ge.addEventListener("error",function(){Q.loading|=2}),Q.loading|=4,l(q,u,_)}q={type:"stylesheet",instance:q,count:1,state:Q},w.set(D,q)}}}function L0(a,u){Oo.X(a,u);var h=lc;if(h&&a){var _=qa(h).hoistableScripts,w=s(a),D=_.get(w);D||(D=h.querySelector(t(w)),D||(a=we({src:a,async:!0},u),(u=Wr.get(w))&&b(a,u),D=h.createElement("script"),Bt(D),In(D,"link",a),h.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},_.set(w,D))}}function Cf(a,u){Oo.M(a,u);var h=lc;if(h&&a){var _=qa(h).hoistableScripts,w=s(a),D=_.get(w);D||(D=h.querySelector(t(w)),D||(a=we({src:a,async:!0,type:"module"},u),(u=Wr.get(w))&&b(a,u),D=h.createElement("script"),Bt(D),In(D,"link",a),h.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},_.set(w,D))}}function mh(a,u,h,_){var w=(w=Vt.current)?Af(w):null;if(!w)throw Error(v(446));switch(a){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(u=bl(h.href),h=qa(w).hoistableStyles,_=h.get(u),_||(_={type:"style",instance:null,count:0,state:null},h.set(u,_)),_):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){a=bl(h.href);var D=qa(w).hoistableStyles,q=D.get(a);if(q||(w=w.ownerDocument||w,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(a,q),(D=w.querySelector(cc(a)))&&!D._p&&(q.instance=D,q.state.loading=5),Wr.has(a)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Wr.set(a,h),D||wm(w,a,h,q.state))),u&&_===null)throw Error(v(528,""));return q}if(u&&_!==null)throw Error(v(529,""));return null;case"script":return u=h.async,h=h.src,typeof h=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=s(h),h=qa(w).hoistableScripts,_=h.get(u),_||(_={type:"script",instance:null,count:0,state:null},h.set(u,_)),_):{type:"void",instance:null,count:0,state:null};default:throw Error(v(444,a))}}function bl(a){return'href="'+Yn(a)+'"'}function cc(a){return'link[rel="stylesheet"]['+a+"]"}function Mf(a){return we({},a,{"data-precedence":a.precedence,precedence:null})}function wm(a,u,h,_){a.querySelector('link[rel="preload"][as="style"]['+u+"]")?_.loading=1:(u=a.createElement("link"),_.preload=u,u.addEventListener("load",function(){return _.loading|=1}),u.addEventListener("error",function(){return _.loading|=2}),In(u,"link",h),Bt(u),a.head.appendChild(u))}function s(a){return'[src="'+Yn(a)+'"]'}function t(a){return"script[async]"+a}function r(a,u,h){if(u.count++,u.instance===null)switch(u.type){case"style":var _=a.querySelector('style[data-href~="'+Yn(h.href)+'"]');if(_)return u.instance=_,Bt(_),_;var w=we({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return _=(a.ownerDocument||a).createElement("style"),Bt(_),In(_,"style",w),l(_,h.precedence,a),u.instance=_;case"stylesheet":w=bl(h.href);var D=a.querySelector(cc(w));if(D)return u.state.loading|=4,u.instance=D,Bt(D),D;_=Mf(h),(w=Wr.get(w))&&p(_,w),D=(a.ownerDocument||a).createElement("link"),Bt(D);var q=D;return q._p=new Promise(function(Q,ge){q.onload=Q,q.onerror=ge}),In(D,"link",_),u.state.loading|=4,l(D,h.precedence,a),u.instance=D;case"script":return D=s(h.src),(w=a.querySelector(t(D)))?(u.instance=w,Bt(w),w):(_=h,(w=Wr.get(D))&&(_=we({},h),b(_,w)),a=a.ownerDocument||a,w=a.createElement("script"),Bt(w),In(w,"link",_),a.head.appendChild(w),u.instance=w);case"void":return null;default:throw Error(v(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(_=u.instance,u.state.loading|=4,l(_,h.precedence,a));return u.instance}function l(a,u,h){for(var _=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=_.length?_[_.length-1]:null,D=w,q=0;q<_.length;q++){var Q=_[q];if(Q.dataset.precedence===u)D=Q;else if(D!==w)break}D?D.parentNode.insertBefore(a,D.nextSibling):(u=h.nodeType===9?h.head:h,u.insertBefore(a,u.firstChild))}function p(a,u){a.crossOrigin==null&&(a.crossOrigin=u.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=u.referrerPolicy),a.title==null&&(a.title=u.title)}function b(a,u){a.crossOrigin==null&&(a.crossOrigin=u.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=u.referrerPolicy),a.integrity==null&&(a.integrity=u.integrity)}var x=null;function E(a,u,h){if(x===null){var _=new Map,w=x=new Map;w.set(h,_)}else w=x,_=w.get(h),_||(_=new Map,w.set(h,_));if(_.has(a))return _;for(_.set(a,null),h=h.getElementsByTagName(a),w=0;w<h.length;w++){var D=h[w];if(!(D[We]||D[kt]||a==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var q=D.getAttribute(u)||"";q=a+q;var Q=_.get(q);Q?Q.push(D):_.set(q,[D])}}return _}function S(a,u,h){a=a.ownerDocument||a,a.head.insertBefore(h,u==="title"?a.querySelector("head > title"):null)}function R(a,u,h){if(h===1||u.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return a=u.disabled,typeof u.precedence=="string"&&a==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function O(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var B=null;function U(){}function j(a,u,h){if(B===null)throw Error(v(475));var _=B;if(u.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var w=bl(h.href),D=a.querySelector(cc(w));if(D){a=D._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(_.count++,_=Y.bind(_),a.then(_,_)),u.state.loading|=4,u.instance=D,Bt(D);return}D=a.ownerDocument||a,h=Mf(h),(w=Wr.get(w))&&p(h,w),D=D.createElement("link"),Bt(D);var q=D;q._p=new Promise(function(Q,ge){q.onload=Q,q.onerror=ge}),In(D,"link",h),u.instance=D}_.stylesheets===null&&(_.stylesheets=new Map),_.stylesheets.set(u,a),(a=u.state.preload)&&(u.state.loading&3)===0&&(_.count++,u=Y.bind(_),a.addEventListener("load",u),a.addEventListener("error",u))}}function V(){if(B===null)throw Error(v(475));var a=B;return a.stylesheets&&a.count===0&&oe(a,a.stylesheets),0<a.count?function(u){var h=setTimeout(function(){if(a.stylesheets&&oe(a,a.stylesheets),a.unsuspend){var _=a.unsuspend;a.unsuspend=null,_()}},6e4);return a.unsuspend=u,function(){a.unsuspend=null,clearTimeout(h)}}:null}function Y(){if(this.count--,this.count===0){if(this.stylesheets)oe(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var ee=null;function oe(a,u){a.stylesheets=null,a.unsuspend!==null&&(a.count++,ee=new Map,u.forEach(xe,a),ee=null,Y.call(a))}function xe(a,u){if(!(u.state.loading&4)){var h=ee.get(a);if(h)var _=h.get(null);else{h=new Map,ee.set(a,h);for(var w=a.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<w.length;D++){var q=w[D];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(h.set(q.dataset.precedence,q),_=q)}_&&h.set(null,_)}w=u.instance,q=w.getAttribute("data-precedence"),D=h.get(q)||_,D===_&&h.set(null,w),h.set(q,w),this.count++,_=Y.bind(this),w.addEventListener("load",_),w.addEventListener("error",_),D?D.parentNode.insertBefore(w,D.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(w,a.firstChild)),u.state.loading|=4}}var ue={$$typeof:ni,Provider:null,Consumer:null,_currentValue:bt,_currentValue2:bt,_threadCount:0};function H(a,u,h,_,w,D,q,Q){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=te(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=te(0),this.hiddenUpdates=te(null),this.identifierPrefix=_,this.onUncaughtError=w,this.onCaughtError=D,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Q,this.incompleteTransitions=new Map}function J(a,u,h,_,w,D,q,Q,ge,ze,tt,nt){return a=new H(a,u,h,q,Q,ge,ze,nt),u=1,D===!0&&(u|=24),D=kn(3,null,null,u),a.current=D,D.stateNode=a,u=Eo(),u.refCount++,a.pooledCache=u,u.refCount++,D.memoizedState={element:_,isDehydrated:h,cache:u},jc(D),a}function de(a){return a?(a=Ns,a):Ns}function Oe(a,u,h,_,w,D){w=de(w),_.context===null?_.context=w:_.pendingContext=w,_=fs(u),_.payload={element:h},D=D===void 0?null:D,D!==null&&(_.callback=D),h=Gr(a,_,u),h!==null&&(Qr(h,a,u),Hs(h,a,u))}function at(a,u){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<u?h:u}}function Ue(a,u){at(a,u),(a=a.alternate)&&at(a,u)}function Ye(a){if(a.tag===13){var u=ru(a,67108864);u!==null&&Qr(u,a,67108864),Ue(a,67108864)}}var ot=!0;function rt(a,u,h,_){var w=Je.T;Je.T=null;var D=wt.p;try{wt.p=2,Xe(a,u,h,_)}finally{wt.p=D,Je.T=w}}function ct(a,u,h,_){var w=Je.T;Je.T=null;var D=wt.p;try{wt.p=8,Xe(a,u,h,_)}finally{wt.p=D,Je.T=w}}function Xe(a,u,h,_){if(ot){var w=Tt(_);if(w===null)sd(a,u,_,Lt,h),Ya(a,_);else if(fn(w,a,u,h,_))_.stopPropagation();else if(Ya(a,_),u&4&&-1<da.indexOf(a)){for(;w!==null;){var D=Fi(w);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var q=Ce(D.pendingLanes);if(q!==0){var Q=D;for(Q.pendingLanes|=2,Q.entangledLanes|=2;q;){var ge=1<<31-Pa(q);Q.entanglements[1]|=ge,q&=~ge}Es(D),($i&6)===0&&(ef=Ra()+500,sc(0))}}break;case 13:Q=ru(D,2),Q!==null&&Qr(Q,D,2),Mn(),Ue(D,2)}if(D=Tt(_),D===null&&sd(a,u,_,Lt,h),D===w)break;w=D}w!==null&&_.stopPropagation()}else sd(a,u,_,null,h)}}function Tt(a){return a=mo(a),Pt(a)}var Lt=null;function Pt(a){if(Lt=null,a=Gt(a),a!==null){var u=N(a);if(u===null)a=null;else{var h=u.tag;if(h===13){if(a=M(u),a!==null)return a;a=null}else if(h===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;a=null}else u!==a&&(a=null)}}return Lt=a,null}function Ct(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Sl()){case Du:return 2;case Vn:return 8;case rr:case zo:return 32;case so:return 268435456;default:return 32}default:return 32}}var ui=!1,Pi=null,ea=null,ba=null,Fn=new Map,dn=new Map,ha=[],da="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ya(a,u){switch(a){case"focusin":case"focusout":Pi=null;break;case"dragenter":case"dragleave":ea=null;break;case"mouseover":case"mouseout":ba=null;break;case"pointerover":case"pointerout":Fn.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":dn.delete(u.pointerId)}}function Ba(a,u,h,_,w,D){return a===null||a.nativeEvent!==D?(a={blockedOn:u,domEventName:h,eventSystemFlags:_,nativeEvent:D,targetContainers:[w]},u!==null&&(u=Fi(u),u!==null&&Ye(u)),a):(a.eventSystemFlags|=_,u=a.targetContainers,w!==null&&u.indexOf(w)===-1&&u.push(w),a)}function fn(a,u,h,_,w){switch(u){case"focusin":return Pi=Ba(Pi,a,u,h,_,w),!0;case"dragenter":return ea=Ba(ea,a,u,h,_,w),!0;case"mouseover":return ba=Ba(ba,a,u,h,_,w),!0;case"pointerover":var D=w.pointerId;return Fn.set(D,Ba(Fn.get(D)||null,a,u,h,_,w)),!0;case"gotpointercapture":return D=w.pointerId,dn.set(D,Ba(dn.get(D)||null,a,u,h,_,w)),!0}return!1}function Un(a){var u=Gt(a.target);if(u!==null){var h=N(u);if(h!==null){if(u=h.tag,u===13){if(u=M(h),u!==null){a.blockedOn=u,_t(a.priority,function(){if(h.tag===13){var _=vr();_=Ie(_);var w=ru(h,_);w!==null&&Qr(w,h,_),Ue(h,_)}});return}}else if(u===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Jn(a){if(a.blockedOn!==null)return!1;for(var u=a.targetContainers;0<u.length;){var h=Tt(a.nativeEvent);if(h===null){h=a.nativeEvent;var _=new h.constructor(h.type,h);Vo=_,h.target.dispatchEvent(_),Vo=null}else return u=Fi(h),u!==null&&Ye(u),a.blockedOn=h,!1;u.shift()}return!0}function $a(a,u,h){Jn(a)&&h.delete(u)}function Tr(){ui=!1,Pi!==null&&Jn(Pi)&&(Pi=null),ea!==null&&Jn(ea)&&(ea=null),ba!==null&&Jn(ba)&&(ba=null),Fn.forEach($a),dn.forEach($a)}function Da(a,u){a.blockedOn===u&&(a.blockedOn=null,ui||(ui=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Tr)))}var za=null;function Xa(a){za!==a&&(za=a,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){za===a&&(za=null);for(var u=0;u<a.length;u+=3){var h=a[u],_=a[u+1],w=a[u+2];if(typeof _!="function"){if(Pt(_||h)===null)continue;break}var D=Fi(h);D!==null&&(a.splice(u,3),u-=3,_s(D,{pending:!0,data:w,method:h.method,action:_},_,w))}}))}function fa(a){function u(ge){return Da(ge,a)}Pi!==null&&Da(Pi,a),ea!==null&&Da(ea,a),ba!==null&&Da(ba,a),Fn.forEach(u),dn.forEach(u);for(var h=0;h<ha.length;h++){var _=ha[h];_.blockedOn===a&&(_.blockedOn=null)}for(;0<ha.length&&(h=ha[0],h.blockedOn===null);)Un(h),h.blockedOn===null&&ha.shift();if(h=(a.ownerDocument||a).$$reactFormReplay,h!=null)for(_=0;_<h.length;_+=3){var w=h[_],D=h[_+1],q=w[Rt]||null;if(typeof D=="function")q||Xa(h);else if(q){var Q=null;if(D&&D.hasAttribute("formAction")){if(w=D,q=D[Rt]||null)Q=q.formAction;else if(Pt(w)!==null)continue}else Q=q.action;typeof Q=="function"?h[_+1]=Q:(h.splice(_,3),_-=3),Xa(h)}}}function Vi(a){this._internalRoot=a}Or.prototype.render=Vi.prototype.render=function(a){var u=this._internalRoot;if(u===null)throw Error(v(409));var h=u.current,_=vr();Oe(h,_,a,u,null,null)},Or.prototype.unmount=Vi.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var u=a.containerInfo;Oe(a.current,2,null,a,null,null),Mn(),u[Ve]=null}};function Or(a){this._internalRoot=a}Or.prototype.unstable_scheduleHydration=function(a){if(a){var u=pt();a={blockedOn:null,target:a,priority:u};for(var h=0;h<ha.length&&u!==0&&u<ha[h].priority;h++);ha.splice(h,0,a),h===0&&Un(a)}};var hc=o.version;if(hc!=="19.1.0")throw Error(v(527,hc,"19.1.0"));wt.findDOMNode=function(a){var u=a._reactInternals;if(u===void 0)throw typeof a.render=="function"?Error(v(188)):(a=Object.keys(a).join(","),Error(v(268,a)));return a=K(u),a=a!==null?W(a):null,a=a===null?null:a.stateNode,a};var io={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Je,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var If=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!If.isDisabled&&If.supportsFiber)try{es=If.inject(io),Ka=If}catch{}}return O0.createRoot=function(a,u){if(!C(a))throw Error(v(299));var h=!1,_="",w=np,D=zd,q=$f,Q=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(_=u.identifierPrefix),u.onUncaughtError!==void 0&&(w=u.onUncaughtError),u.onCaughtError!==void 0&&(D=u.onCaughtError),u.onRecoverableError!==void 0&&(q=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(Q=u.unstable_transitionCallbacks)),u=J(a,1,!1,null,null,h,_,w,D,q,Q,null),a[Ve]=u.current,mf(a),new Vi(u)},O0.hydrateRoot=function(a,u,h){if(!C(a))throw Error(v(299));var _=!1,w="",D=np,q=zd,Q=$f,ge=null,ze=null;return h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(w=h.identifierPrefix),h.onUncaughtError!==void 0&&(D=h.onUncaughtError),h.onCaughtError!==void 0&&(q=h.onCaughtError),h.onRecoverableError!==void 0&&(Q=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(ge=h.unstable_transitionCallbacks),h.formState!==void 0&&(ze=h.formState)),u=J(a,1,!0,u,h??null,_,w,D,q,Q,ge,ze),u.context=de(null),h=u.current,_=vr(),_=Ie(_),w=fs(_),w.callback=null,Gr(h,w,_),h=_,u.current.lanes=h,Le(u,h),Es(u),a[Ve]=u.current,mf(a),new Or(u)},O0.version="19.1.0",O0}var kg;function iy(){if(kg)return Cm.exports;kg=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(o){console.error(o)}}return i(),Cm.exports=ty(),Cm.exports}var ay=iy(),Up={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.5.0/LICENSE.txt
 */var ny=Up.exports,Bg;function ry(){return Bg||(Bg=1,function(i,o){(function(m,v){i.exports=v()})(ny,function(){var m={},v={};function C(M,d,K){if(v[M]=K,M==="index"){var W="var sharedModule = {}; ("+v.shared+")(sharedModule); ("+v.worker+")(sharedModule);",we={};return v.shared(we),v.index(m,we),typeof window<"u"&&m.setWorkerUrl(window.URL.createObjectURL(new Blob([W],{type:"text/javascript"}))),m}}C("shared",["exports"],function(M){function d(s,t,r,l){return new(r||(r=Promise))(function(p,b){function x(R){try{S(l.next(R))}catch(O){b(O)}}function E(R){try{S(l.throw(R))}catch(O){b(O)}}function S(R){var O;R.done?p(R.value):(O=R.value,O instanceof r?O:new r(function(B){B(O)})).then(x,E)}S((l=l.apply(s,t||[])).next())})}function K(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var W,we;function Pe(){if(we)return W;function s(t,r){this.x=t,this.y=r}return we=1,W=s,s.prototype={clone:function(){return new s(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,l=t.y-this.y;return r*r+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),l=Math.sin(t),p=l*this.x+r*this.y;return this.x=r*this.x-l*this.y,this.y=p,this},_rotateAround:function(t,r){var l=Math.cos(t),p=Math.sin(t),b=r.y+p*(this.x-r.x)+l*(this.y-r.y);return this.x=r.x+l*(this.x-r.x)-p*(this.y-r.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},s.convert=function(t){return t instanceof s?t:Array.isArray(t)?new s(t[0],t[1]):t},W}typeof SuppressedError=="function"&&SuppressedError;var Me,fe,Qe=K(Pe()),ai=function(){if(fe)return Me;function s(t,r,l,p){this.cx=3*t,this.bx=3*(l-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(p-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=l,this.p2y=p}return fe=1,Me=s,s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var l=t,p=0;p<8;p++){var b=this.sampleCurveX(l)-t;if(Math.abs(b)<r)return l;var x=this.sampleCurveDerivativeX(l);if(Math.abs(x)<1e-6)break;l-=b/x}var E=0,S=1;for(l=t,p=0;p<20&&(b=this.sampleCurveX(l),!(Math.abs(b-t)<r));p++)t>b?E=l:S=l,l=.5*(S-E)+E;return l},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},Me}(),li=K(ai);let ei,Ci;function ni(){return ei==null&&(ei=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ei}function Mt(){if(Ci==null&&(Ci=!1,ni())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<5*5;l++){const p=4*l;t.fillStyle=`rgb(${p},${p+1},${p+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}const r=t.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&r[l]!==l){Ci=!0;break}}}return Ci||!1}var Et=1e-6,Ut=typeof Float32Array<"u"?Float32Array:Array;function Ii(){var s=new Ut(9);return Ut!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function bi(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function nr(){var s=new Ut(3);return Ut!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Ms(s){return Math.hypot(s[0],s[1],s[2])}function mn(s,t,r){var l=new Ut(3);return l[0]=s,l[1]=t,l[2]=r,l}Math.hypot||(Math.hypot=function(){for(var s=0,t=arguments.length;t--;)s+=arguments[t]*arguments[t];return Math.sqrt(s)});var ia,sn=Ms;function xa(s,t,r){var l=t[0],p=t[1],b=t[2],x=t[3];return s[0]=r[0]*l+r[4]*p+r[8]*b+r[12]*x,s[1]=r[1]*l+r[5]*p+r[9]*b+r[13]*x,s[2]=r[2]*l+r[6]*p+r[10]*b+r[14]*x,s[3]=r[3]*l+r[7]*p+r[11]*b+r[15]*x,s}function Fa(){var s=new Ut(4);return Ut!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Je(){var s=new Ut(2);return Ut!=Float32Array&&(s[0]=0,s[1]=0),s}function wt(s,t){var r=new Ut(2);return r[0]=s,r[1]=t,r}nr(),ia=new Ut(4),Ut!=Float32Array&&(ia[0]=0,ia[1]=0,ia[2]=0,ia[3]=0),nr(),mn(1,0,0),mn(0,1,0),Fa(),Fa(),Ii(),Je();const bt=8192;function xi(s,t,r){return t*(bt/(s.tileSize*Math.pow(2,r-s.tileID.overscaledZ)))}function Te(s,t){return(s%t+t)%t}function ut(s,t,r){return s*(1-r)+t*r}function xt(s){if(s<=0)return 0;if(s>=1)return 1;const t=s*s,r=t*s;return 4*(s<.5?r:3*(s-t)+r-.75)}function At(s,t,r,l){const p=new li(s,t,r,l);return b=>p.solve(b)}const Ot=At(.25,.1,.25,1);function Xt(s,t,r){return Math.min(r,Math.max(t,s))}function Vt(s,t,r){const l=r-t,p=((s-t)%l+l)%l+t;return p===t?r:p}function aa(s,...t){for(const r of t)for(const l in r)s[l]=r[l];return s}let Ni=1;function qn(s,t,r){const l={};for(const p in s)l[p]=t.call(this,s[p],p,s);return l}function Bo(s,t,r){const l={};for(const p in s)t.call(this,s[p],p,s)&&(l[p]=s[p]);return l}function gn(s){return Array.isArray(s)?s.map(gn):typeof s=="object"&&s?qn(s,gn):s}const Rn={};function on(s){Rn[s]||(typeof console<"u"&&console.warn(s),Rn[s]=!0)}function Oi(s,t,r){return(r.y-s.y)*(t.x-s.x)>(t.y-s.y)*(r.x-s.x)}function Jr(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let ro=null;function Ra(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const Sl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Du(s,t,r,l,p){return d(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const b=new VideoFrame(s,{timestamp:0});try{const x=b==null?void 0:b.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const E=x.startsWith("BGR"),S=new Uint8ClampedArray(l*p*4);if(yield b.copyTo(S,function(R,O,B,U,j){const V=4*Math.max(1,0),Y=(Math.max(0,B)-B)*U*4+V,ee=4*U,oe=Math.max(0,O),xe=Math.max(0,B);return{rect:{x:oe,y:xe,width:Math.min(R.width,O+U)-oe,height:Math.min(R.height,B+j)-xe},layout:[{offset:Y,stride:ee}]}}(s,t,r,l,p)),E)for(let R=0;R<S.length;R+=4){const O=S[R];S[R]=S[R+2],S[R+2]=O}return S}finally{b.close()}})}let Vn,rr;function zo(s,t,r,l){return s.addEventListener(t,r,l),{unsubscribe:()=>{s.removeEventListener(t,r,l)}}}function so(s){return s*Math.PI/180}function Is(s){return s/Math.PI*180}const Ru={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},es={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Ka="AbortError";function _n(){return new Error(Ka)}const Pa={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function oo(s){return Pa.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const Pu="global-dispatcher";class wr extends Error{constructor(t,r,l,p){super(`AJAXError: ${r} (${t}): ${l}`),this.status=t,this.statusText=r,this.url=l,this.body=p}}const un=()=>Jr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,sr=function(s,t){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const l=oo(s.url);if(l)return l(s,t);if(Jr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:Pu},t)}if(!(/^file:/.test(r=s.url)||/^file:/.test(un())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,p){return d(this,void 0,void 0,function*(){const b=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:un(),signal:p.signal});let x,E;l.type!=="json"||b.headers.has("Accept")||b.headers.set("Accept","application/json");try{x=yield fetch(b)}catch(R){throw new wr(0,R.message,l.url,new Blob)}if(!x.ok){const R=yield x.blob();throw new wr(x.status,x.statusText,l.url,R)}E=l.type==="arrayBuffer"||l.type==="image"?x.arrayBuffer():l.type==="json"?x.json():x.text();const S=yield E;if(p.signal.aborted)throw _n();return{data:S,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(s,t);if(Jr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:Pu},t)}var r;return function(l,p){return new Promise((b,x)=>{var E;const S=new XMLHttpRequest;S.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(S.responseType="arraybuffer");for(const R in l.headers)S.setRequestHeader(R,l.headers[R]);l.type==="json"&&(S.responseType="text",!((E=l.headers)===null||E===void 0)&&E.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=l.credentials==="include",S.onerror=()=>{x(new Error(S.statusText))},S.onload=()=>{if(!p.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let R=S.response;if(l.type==="json")try{R=JSON.parse(S.response)}catch(O){return void x(O)}b({data:R,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const R=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});x(new wr(S.status,S.statusText,l.url,R))}},p.signal.addEventListener("abort",()=>{S.abort(),x(_n())}),S.send(l.body)})}(s,t)};function Ce(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const t=new URL(s),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function $(s,t,r){r[s]&&r[s].indexOf(t)!==-1||(r[s]=r[s]||[],r[s].push(t))}function X(s,t,r){if(r&&r[s]){const l=r[s].indexOf(t);l!==-1&&r[s].splice(l,1)}}class ie{constructor(t,r={}){aa(this,r),this.type=t}}class he extends ie{constructor(t,r={}){super("error",aa({error:t},r))}}class ve{on(t,r){return this._listeners=this._listeners||{},$(t,r,this._listeners),{unsubscribe:()=>{this.off(t,r)}}}off(t,r){return X(t,r,this._listeners),X(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},$(t,r,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,r){typeof t=="string"&&(t=new ie(t,r||{}));const l=t.type;if(this.listens(l)){t.target=this;const p=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const E of p)E.call(this,t);const b=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const E of b)X(l,E,this._oneTimeListeners),E.call(this,t);const x=this._eventedParent;x&&(aa(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(t))}else t instanceof he&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var te={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Le=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ae(s,t){const r={};for(const l in s)l!=="ref"&&(r[l]=s[l]);return Le.forEach(l=>{l in t&&(r[l]=t[l])}),r}function Re(s,t){if(Array.isArray(s)){if(!Array.isArray(t)||s.length!==t.length)return!1;for(let r=0;r<s.length;r++)if(!Re(s[r],t[r]))return!1;return!0}if(typeof s=="object"&&s!==null&&t!==null){if(typeof t!="object"||Object.keys(s).length!==Object.keys(t).length)return!1;for(const r in s)if(!Re(s[r],t[r]))return!1;return!0}return s===t}function Fe(s,t){s.push(t)}function Ie(s,t,r){Fe(r,{command:"addSource",args:[s,t[s]]})}function et(s,t,r){Fe(t,{command:"removeSource",args:[s]}),r[s]=!0}function pt(s,t,r,l){et(s,r,l),Ie(s,t,r)}function _t(s,t,r){let l;for(l in s[r])if(Object.prototype.hasOwnProperty.call(s[r],l)&&l!=="data"&&!Re(s[r][l],t[r][l]))return!1;for(l in t[r])if(Object.prototype.hasOwnProperty.call(t[r],l)&&l!=="data"&&!Re(s[r][l],t[r][l]))return!1;return!0}function It(s,t,r,l,p,b){s=s||{},t=t||{};for(const x in s)Object.prototype.hasOwnProperty.call(s,x)&&(Re(s[x],t[x])||r.push({command:b,args:[l,x,t[x],p]}));for(const x in t)Object.prototype.hasOwnProperty.call(t,x)&&!Object.prototype.hasOwnProperty.call(s,x)&&(Re(s[x],t[x])||r.push({command:b,args:[l,x,t[x],p]}))}function kt(s){return s.id}function Rt(s,t){return s[t.id]=t,s}class Ve{constructor(t,r,l,p){this.message=(t?`${t}: `:"")+l,p&&(this.identifier=p),r!=null&&r.__line__&&(this.line=r.__line__)}}function vi(s,...t){for(const r of t)for(const l in r)s[l]=r[l];return s}class fi extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class Ti{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[l,p]of r)this.bindings[l]=p}concat(t){return new Ti(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const jt={kind:"null"},We={kind:"number"},Ft={kind:"string"},Gt={kind:"boolean"},Fi={kind:"color"},Gi={kind:"projectionDefinition"},qa={kind:"object"},Bt={kind:"value"},Fo={kind:"collator"},Lu={kind:"formatted"},or={kind:"padding"},ts={kind:"colorArray"},Ds={kind:"numberArray"},uo={kind:"resolvedImage"},va={kind:"variableAnchorOffsetCollection"};function ur(s,t){return{kind:"array",itemType:s,N:t}}function Ui(s){if(s.kind==="array"){const t=Ui(s.itemType);return typeof s.N=="number"?`array<${t}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${t}>`}return s.kind}const lo=[jt,We,Ft,Gt,Fi,Gi,Lu,qa,ur(Bt),or,Ds,ts,uo,va];function Gn(s,t){if(t.kind==="error")return null;if(s.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Gn(s.itemType,t.itemType))&&(typeof s.N!="number"||s.N===t.N))return null}else{if(s.kind===t.kind)return null;if(s.kind==="value"){for(const r of lo)if(!Gn(r,t))return null}}return`Expected ${Ui(s)} but found ${Ui(t)} instead.`}function Cl(s,t){return t.some(r=>r.kind===s.kind)}function co(s,t){return t.some(r=>r==="null"?s===null:r==="array"?Array.isArray(s):r==="object"?s&&!Array.isArray(s)&&typeof s=="object":r===typeof s)}function Zn(s,t){return s.kind==="array"&&t.kind==="array"?s.itemType.kind===t.itemType.kind&&typeof s.N=="number":s.kind===t.kind}const _c=.96422,Ml=.82521,xd=4/29,Uo=6/29,lr=3*Uo*Uo,vd=Uo*Uo*Uo,Ff=Math.PI/180,yc=180/Math.PI;function Eh(s){return(s%=360)<0&&(s+=360),s}function Nu([s,t,r,l]){let p,b;const x=Yn((.2225045*(s=Ho(s))+.7168786*(t=Ho(t))+.0606169*(r=Ho(r)))/1);s===t&&t===r?p=b=x:(p=Yn((.4360747*s+.3850649*t+.1430804*r)/_c),b=Yn((.0139322*s+.0971045*t+.7141733*r)/Ml));const E=116*x-16;return[E<0?0:E,500*(p-x),200*(x-b),l]}function Ho(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Yn(s){return s>vd?Math.pow(s,1/3):s/lr+xd}function bc([s,t,r,l]){let p=(s+16)/116,b=isNaN(t)?p:p+t/500,x=isNaN(r)?p:p-r/200;return p=1*Il(p),b=_c*Il(b),x=Ml*Il(x),[ho(3.1338561*b-1.6168667*p-.4906146*x),ho(-.9787684*b+1.9161415*p+.033454*x),ho(.0719453*b-.2289914*p+1.4052427*x),l]}function ho(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function Il(s){return s>Uo?s*s*s:lr*(s-xd)}const Ou=Object.hasOwn||function(s,t){return Object.prototype.hasOwnProperty.call(s,t)};function ku(s,t){return Ou(s,t)?s[t]:void 0}function Bu(s){return parseInt(s.padEnd(2,s),16)/255}function fo(s,t){return Pn(t?s/100:s,0,1)}function Pn(s,t,r){return Math.min(Math.max(t,s),r)}function mi(s){return!s.some(Number.isNaN)}const jo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ln(s,t,r){return s+r*(t-s)}function qo(s,t,r){return s.map((l,p)=>ln(l,t[p],r))}class pi{constructor(t,r,l,p=1,b=!0){this.r=t,this.g=r,this.b=l,this.a=p,b||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[t,r,l,p]))}static parse(t){if(t instanceof pi)return t;if(typeof t!="string")return;const r=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=ku(jo,l);if(p){const[x,E,S]=p;return[x/255,E/255,S/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const x=l.length<6?1:2;let E=1;return[Bu(l.slice(E,E+=x)),Bu(l.slice(E,E+=x)),Bu(l.slice(E,E+=x)),Bu(l.slice(E,E+x)||"ff")]}if(l.startsWith("rgb")){const x=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[E,S,R,O,B,U,j,V,Y,ee,oe,xe]=x,ue=[O||" ",j||" ",ee].join("");if(ue==="  "||ue==="  /"||ue===",,"||ue===",,,"){const H=[R,U,Y].join(""),J=H==="%%%"?100:H===""?255:0;if(J){const de=[Pn(+S/J,0,1),Pn(+B/J,0,1),Pn(+V/J,0,1),oe?fo(+oe,xe):1];if(mi(de))return de}}return}}const b=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[x,E,S,R,O,B,U,j,V]=b,Y=[S||" ",O||" ",U].join("");if(Y==="  "||Y==="  /"||Y===",,"||Y===",,,"){const ee=[+E,Pn(+R,0,100),Pn(+B,0,100),j?fo(+j,V):1];if(mi(ee))return function([oe,xe,ue,H]){function J(de){const Oe=(de+oe/30)%12,at=xe*Math.min(ue,1-ue);return ue-at*Math.max(-1,Math.min(Oe-3,9-Oe,1))}return oe=Eh(oe),xe/=100,ue/=100,[J(0),J(8),J(4),H]}(ee)}}}(t);return r?new pi(...r,!1):void 0}get rgb(){const{r:t,g:r,b:l,a:p}=this,b=p||1/0;return this.overwriteGetter("rgb",[t/b,r/b,l/b,p])}get hcl(){return this.overwriteGetter("hcl",function(t){const[r,l,p,b]=Nu(t),x=Math.sqrt(l*l+p*p);return[Math.round(1e4*x)?Eh(Math.atan2(p,l)*yc):NaN,x,r,b]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Nu(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){const[t,r,l,p]=this.rgb;return`rgba(${[t,r,l].map(b=>Math.round(255*b)).join(",")},${p})`}static interpolate(t,r,l,p="rgb"){switch(p){case"rgb":{const[b,x,E,S]=qo(t.rgb,r.rgb,l);return new pi(b,x,E,S,!1)}case"hcl":{const[b,x,E,S]=t.hcl,[R,O,B,U]=r.hcl;let j,V;if(isNaN(b)||isNaN(R))isNaN(b)?isNaN(R)?j=NaN:(j=R,E!==1&&E!==0||(V=O)):(j=b,B!==1&&B!==0||(V=x));else{let ue=R-b;R>b&&ue>180?ue-=360:R<b&&b-R>180&&(ue+=360),j=b+l*ue}const[Y,ee,oe,xe]=function([ue,H,J,de]){return ue=isNaN(ue)?0:ue*Ff,bc([J,Math.cos(ue)*H,Math.sin(ue)*H,de])}([j,V??ln(x,O,l),ln(E,B,l),ln(S,U,l)]);return new pi(Y,ee,oe,xe,!1)}case"lab":{const[b,x,E,S]=bc(qo(t.lab,r.lab,l));return new pi(b,x,E,S,!1)}}}}pi.black=new pi(0,0,0,1),pi.white=new pi(1,1,1,1),pi.transparent=new pi(0,0,0,0),pi.red=new pi(1,0,0,1);class po{constructor(t,r,l){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Vo=["bottom","center","top"];class mo{constructor(t,r,l,p,b,x){this.text=t,this.image=r,this.scale=l,this.fontStack=p,this.textColor=b,this.verticalAlign=x}}class Va{constructor(t){this.sections=t}static fromString(t){return new Va([new mo(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Va?t:Va.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Ta{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ta)return t;if(typeof t=="number")return new Ta([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Ta(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,l){return new Ta(qo(t.values,r.values,l))}}class Ea{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ea)return t;if(typeof t=="number")return new Ea([t]);if(Array.isArray(t)){for(const r of t)if(typeof r!="number")return;return new Ea(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,l){return new Ea(qo(t.values,r.values,l))}}class Ga{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ga)return t;if(typeof t=="string"){const l=pi.parse(t);return l?new Ga([l]):void 0}if(!Array.isArray(t))return;const r=[];for(const l of t){if(typeof l!="string")return;const p=pi.parse(l);if(!p)return;r.push(p)}return new Ga(r)}toString(){return JSON.stringify(this.values)}static interpolate(t,r,l,p="rgb"){const b=[];if(t.values.length!=r.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${r.values.length}), cannot interpolate.`);for(let x=0;x<t.values.length;x++)b.push(pi.interpolate(t.values[x],r.values[x],l,p));return new Ga(b)}}class Zi extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const is=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ma{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ma)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let r=0;r<t.length;r+=2){const l=t[r],p=t[r+1];if(typeof l!="string"||!is.has(l)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new ma(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,l){const p=t.values,b=r.values;if(p.length!==b.length)throw new Zi(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${r.toString()}`);const x=[];for(let E=0;E<p.length;E+=2){if(p[E]!==b[E])throw new Zi(`Cannot interpolate values containing mismatched anchors. from[${E}]: ${p[E]}, to[${E}]: ${b[E]}`);x.push(p[E]);const[S,R]=p[E+1],[O,B]=b[E+1];x.push([ln(S,O,l),ln(R,B,l)])}return new ma(x)}}class Ln{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Ln({name:t,available:!1}):null}}class Wa{constructor(t,r,l){this.from=t,this.to=r,this.transition=l}static interpolate(t,r,l){return new Wa(t,r,l)}static parse(t){return t instanceof Wa?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Wa(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Wa(t.from,t.to,t.transition):typeof t=="string"?new Wa(t,t,1):void 0}}function Ar(s,t,r,l){return typeof s=="number"&&s>=0&&s<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[s,t,r,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[s,t,r,l]:[s,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Di(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Wa||s instanceof pi||s instanceof po||s instanceof Va||s instanceof Ta||s instanceof Ea||s instanceof Ga||s instanceof ma||s instanceof Ln)return!0;if(Array.isArray(s)){for(const t of s)if(!Di(t))return!1;return!0}if(typeof s=="object"){for(const t in s)if(!Di(s[t]))return!1;return!0}return!1}function Wi(s){if(s===null)return jt;if(typeof s=="string")return Ft;if(typeof s=="boolean")return Gt;if(typeof s=="number")return We;if(s instanceof pi)return Fi;if(s instanceof Wa)return Gi;if(s instanceof po)return Fo;if(s instanceof Va)return Lu;if(s instanceof Ta)return or;if(s instanceof Ea)return Ds;if(s instanceof Ga)return ts;if(s instanceof ma)return va;if(s instanceof Ln)return uo;if(Array.isArray(s)){const t=s.length;let r;for(const l of s){const p=Wi(l);if(r){if(r===p)continue;r=Bt;break}r=p}return ur(r||Bt,t)}return qa}function ci(s){const t=typeof s;return s===null?"":t==="string"||t==="number"||t==="boolean"?String(s):s instanceof pi||s instanceof Wa||s instanceof Va||s instanceof Ta||s instanceof Ea||s instanceof Ga||s instanceof ma||s instanceof Ln?s.toString():JSON.stringify(s)}class Zt{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Di(t[1]))return r.error("invalid value");const l=t[1];let p=Wi(l);const b=r.expectedType;return p.kind!=="array"||p.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(p=b),new Zt(p,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Rs={string:Ft,number:We,boolean:Gt,object:qa};class ti{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let l,p=1;const b=t[0];if(b==="array"){let E,S;if(t.length>2){const R=t[1];if(typeof R!="string"||!(R in Rs)||R==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);E=Rs[R],p++}else E=Bt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);S=t[2],p++}l=ur(E,S)}else{if(!Rs[b])throw new Error(`Types doesn't contain name = ${b}`);l=Rs[b]}const x=[];for(;p<t.length;p++){const E=r.parse(t[p],p,Bt);if(!E)return null;x.push(E)}return new ti(l,x)}evaluate(t){for(let r=0;r<this.args.length;r++){const l=this.args[r].evaluate(t);if(!Gn(this.type,Wi(l)))return l;if(r===this.args.length-1)throw new Zi(`Expected value to be of type ${Ui(this.type)}, but found ${Ui(Wi(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const cn={"to-boolean":Gt,"to-color":Fi,"to-number":We,"to-string":Ft};class wa{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const l=t[0];if(!cn[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return r.error("Expected one argument.");const p=cn[l],b=[];for(let x=1;x<t.length;x++){const E=r.parse(t[x],x,Bt);if(!E)return null;b.push(E)}return new wa(p,b)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,l;for(const p of this.args){if(r=p.evaluate(t),l=null,r instanceof pi)return r;if(typeof r=="string"){const b=t.parseColor(r);if(b)return b}else if(Array.isArray(r)&&(l=r.length<3||r.length>4?`Invalid rgba value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Ar(r[0],r[1],r[2],r[3]),!l))return new pi(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Zi(l||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const l of this.args){r=l.evaluate(t);const p=Ta.parse(r);if(p)return p}throw new Zi(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"numberArray":{let r;for(const l of this.args){r=l.evaluate(t);const p=Ea.parse(r);if(p)return p}throw new Zi(`Could not parse numberArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"colorArray":{let r;for(const l of this.args){r=l.evaluate(t);const p=Ga.parse(r);if(p)return p}throw new Zi(`Could not parse colorArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const l of this.args){r=l.evaluate(t);const p=ma.parse(r);if(p)return p}throw new Zi(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const l of this.args){if(r=l.evaluate(t),r===null)return 0;const p=Number(r);if(!isNaN(p))return p}throw new Zi(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Va.fromString(ci(this.args[0].evaluate(t)));case"resolvedImage":return Ln.fromString(ci(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return ci(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const zu=["Unknown","Point","LineString","Polygon"];class Go{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?zu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache.get(t);return r||(r=pi.parse(t),this._parseColorCache.set(t,r)),r}}class Dl{constructor(t,r,l=[],p,b=new Ti,x=[]){this.registry=t,this.path=l,this.key=l.map(E=>`[${E}]`).join(""),this.scope=b,this.errors=x,this.expectedType=p,this._isConstant=r}parse(t,r,l,p,b={}){return r?this.concat(r,l,p)._parse(t,b):this._parse(t,b)}_parse(t,r){function l(p,b,x){return x==="assert"?new ti(b,[p]):x==="coerce"?new wa(b,[p]):p}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=t[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[p];if(b){let x=b.parse(t,this);if(!x)return null;if(this.expectedType){const E=this.expectedType,S=x.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||S.kind!=="value"){if(E.kind==="projectionDefinition"&&["string","array"].includes(S.kind)||["color","formatted","resolvedImage"].includes(E.kind)&&["value","string"].includes(S.kind)||["padding","numberArray"].includes(E.kind)&&["value","number","array"].includes(S.kind)||E.kind==="colorArray"&&["value","string","array"].includes(S.kind)||E.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(S.kind))x=l(x,E,r.typeAnnotation||"coerce");else if(this.checkSubtype(E,S))return null}else x=l(x,E,r.typeAnnotation||"assert")}if(!(x instanceof Zt)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const E=new Go;try{x=new Zt(x.type,x.evaluate(E))}catch(S){return this.error(S.message),null}}return x}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,l){const p=typeof t=="number"?this.path.concat(t):this.path,b=l?this.scope.concat(l):this.scope;return new Dl(this.registry,this._isConstant,p,r||null,b,this.errors)}error(t,...r){const l=`${this.key}${r.map(p=>`[${p}]`).join("")}`;this.errors.push(new fi(l,t))}checkSubtype(t,r){const l=Gn(t,r);return l&&this.error(l),l}}class go{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let b=1;b<t.length-1;b+=2){const x=t[b];if(typeof x!="string")return r.error(`Expected string, but found ${typeof x} instead.`,b);if(/[^a-zA-Z0-9_]/.test(x))return r.error("Variable names must contain only alphanumeric characters or '_'.",b);const E=r.parse(t[b+1],b+1);if(!E)return null;l.push([x,E])}const p=r.parse(t[t.length-1],t.length-1,r.expectedType,l);return p?new go(l,p):null}outputDefined(){return this.result.outputDefined()}}class Zo{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const l=t[1];return r.scope.has(l)?new Zo(l,r.scope.get(l)):r.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Yo{constructor(t,r,l){this.type=t,this.index=r,this.input=l}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,We),p=r.parse(t[2],2,ur(r.expectedType||Bt));return l&&p?new Yo(p.type.itemType,l,p):null}evaluate(t){const r=this.index.evaluate(t),l=this.input.evaluate(t);if(r<0)throw new Zi(`Array index out of bounds: ${r} < 0.`);if(r>=l.length)throw new Zi(`Array index out of bounds: ${r} > ${l.length-1}.`);if(r!==Math.floor(r))throw new Zi(`Array index must be an integer, but found ${r} instead.`);return l[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class $o{constructor(t,r){this.type=Gt,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,Bt),p=r.parse(t[2],2,Bt);return l&&p?Cl(l.type,[Gt,Ft,We,jt,Bt])?new $o(l,p):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ui(l.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!co(r,["boolean","string","number","null"]))throw new Zi(`Expected first argument to be of type boolean, string, number or null, but found ${Ui(Wi(r))} instead.`);if(!co(l,["string","array"]))throw new Zi(`Expected second argument to be of type array or string, but found ${Ui(Wi(l))} instead.`);return l.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Fu{constructor(t,r,l){this.type=We,this.needle=t,this.haystack=r,this.fromIndex=l}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,Bt),p=r.parse(t[2],2,Bt);if(!l||!p)return null;if(!Cl(l.type,[Gt,Ft,We,jt,Bt]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ui(l.type)} instead`);if(t.length===4){const b=r.parse(t[3],3,We);return b?new Fu(l,p,b):null}return new Fu(l,p)}evaluate(t){const r=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!co(r,["boolean","string","number","null"]))throw new Zi(`Expected first argument to be of type boolean, string, number or null, but found ${Ui(Wi(r))} instead.`);let p;if(this.fromIndex&&(p=this.fromIndex.evaluate(t)),co(l,["string"])){const b=l.indexOf(r,p);return b===-1?-1:[...l.slice(0,b)].length}if(co(l,["array"]))return l.indexOf(r,p);throw new Zi(`Expected second argument to be of type array or string, but found ${Ui(Wi(l))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Xo{constructor(t,r,l,p,b,x){this.inputType=t,this.type=r,this.input=l,this.cases=p,this.outputs=b,this.otherwise=x}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let l,p;r.expectedType&&r.expectedType.kind!=="value"&&(p=r.expectedType);const b={},x=[];for(let R=2;R<t.length-1;R+=2){let O=t[R];const B=t[R+1];Array.isArray(O)||(O=[O]);const U=r.concat(R);if(O.length===0)return U.error("Expected at least one branch label.");for(const V of O){if(typeof V!="number"&&typeof V!="string")return U.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof V=="number"&&Math.floor(V)!==V)return U.error("Numeric branch labels must be integer values.");if(l){if(U.checkSubtype(l,Wi(V)))return null}else l=Wi(V);if(b[String(V)]!==void 0)return U.error("Branch labels must be unique.");b[String(V)]=x.length}const j=r.parse(B,R,p);if(!j)return null;p=p||j.type,x.push(j)}const E=r.parse(t[1],1,Bt);if(!E)return null;const S=r.parse(t[t.length-1],t.length-1,p);return S?E.type.kind!=="value"&&r.concat(1).checkSubtype(l,E.type)?null:new Xo(l,p,E,b,x,S):null}evaluate(t){const r=this.input.evaluate(t);return(Wi(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Ja{constructor(t,r,l){this.type=t,this.branches=r,this.otherwise=l}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let l;r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);const p=[];for(let x=1;x<t.length-1;x+=2){const E=r.parse(t[x],x,Gt);if(!E)return null;const S=r.parse(t[x+1],x+1,l);if(!S)return null;p.push([E,S]),l=l||S.type}const b=r.parse(t[t.length-1],t.length-1,l);if(!b)return null;if(!l)throw new Error("Can't infer output type");return new Ja(l,p,b)}evaluate(t){for(const[r,l]of this.branches)if(r.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,l]of this.branches)t(r),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class Qo{constructor(t,r,l,p){this.type=t,this.input=r,this.beginIndex=l,this.endIndex=p}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,Bt),p=r.parse(t[2],2,We);if(!l||!p)return null;if(!Cl(l.type,[ur(Bt),Ft,Bt]))return r.error(`Expected first argument to be of type array or string, but found ${Ui(l.type)} instead`);if(t.length===4){const b=r.parse(t[3],3,We);return b?new Qo(l.type,l,p,b):null}return new Qo(l.type,l,p)}evaluate(t){const r=this.input.evaluate(t),l=this.beginIndex.evaluate(t);let p;if(this.endIndex&&(p=this.endIndex.evaluate(t)),co(r,["string"]))return[...r].slice(l,p).join("");if(co(r,["array"]))return r.slice(l,p);throw new Zi(`Expected first argument to be of type array or string, but found ${Ui(Wi(r))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Ko(s,t){const r=s.length-1;let l,p,b=0,x=r,E=0;for(;b<=x;)if(E=Math.floor((b+x)/2),l=s[E],p=s[E+1],l<=t){if(E===r||t<p)return E;b=E+1}else{if(!(l>t))throw new Zi("Input is not a number.");x=E-1}return 0}class _o{constructor(t,r,l){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[p,b]of l)this.labels.push(p),this.outputs.push(b)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const l=r.parse(t[1],1,We);if(!l)return null;const p=[];let b=null;r.expectedType&&r.expectedType.kind!=="value"&&(b=r.expectedType);for(let x=1;x<t.length;x+=2){const E=x===1?-1/0:t[x],S=t[x+1],R=x,O=x+1;if(typeof E!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(p.length&&p[p.length-1][0]>=E)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const B=r.parse(S,O,b);if(!B)return null;b=b||B.type,p.push([E,B])}return new _o(b,l,p)}evaluate(t){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(t);const p=this.input.evaluate(t);if(p<=r[0])return l[0].evaluate(t);const b=r.length;return p>=r[b-1]?l[b-1].evaluate(t):l[Ko(r,p)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function en(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var xc,vc,Td=function(){if(vc)return xc;function s(t,r,l,p){this.cx=3*t,this.bx=3*(l-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(p-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=l,this.p2y=p}return vc=1,xc=s,s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var l=t,p=0;p<8;p++){var b=this.sampleCurveX(l)-t;if(Math.abs(b)<r)return l;var x=this.sampleCurveDerivativeX(l);if(Math.abs(x)<1e-6)break;l-=b/x}var E=0,S=1;for(l=t,p=0;p<20&&(b=this.sampleCurveX(l),!(Math.abs(b-t)<r));p++)t>b?E=l:S=l,l=.5*(S-E)+E;return l},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},xc}(),Ed=en(Td);class yn{constructor(t,r,l,p,b){this.type=t,this.operator=r,this.interpolation=l,this.input=p,this.labels=[],this.outputs=[];for(const[x,E]of b)this.labels.push(x),this.outputs.push(E)}static interpolationFactor(t,r,l,p){let b=0;if(t.name==="exponential")b=Rl(r,t.base,l,p);else if(t.name==="linear")b=Rl(r,1,l,p);else if(t.name==="cubic-bezier"){const x=t.controlPoints;b=new Ed(x[0],x[1],x[2],x[3]).solve(Rl(r,1,l,p))}return b}static parse(t,r){let[l,p,b,...x]=t;if(!Array.isArray(p)||p.length===0)return r.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const R=p[1];if(typeof R!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:R}}else{if(p[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const R=p.slice(1);if(R.length!==4||R.some(O=>typeof O!="number"||O<0||O>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:R}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(b=r.parse(b,2,We),!b)return null;const E=[];let S=null;l!=="interpolate-hcl"&&l!=="interpolate-lab"||r.expectedType==ts?r.expectedType&&r.expectedType.kind!=="value"&&(S=r.expectedType):S=Fi;for(let R=0;R<x.length;R+=2){const O=x[R],B=x[R+1],U=R+3,j=R+4;if(typeof O!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(E.length&&E[E.length-1][0]>=O)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const V=r.parse(B,j,S);if(!V)return null;S=S||V.type,E.push([O,V])}return Zn(S,We)||Zn(S,Gi)||Zn(S,Fi)||Zn(S,or)||Zn(S,Ds)||Zn(S,ts)||Zn(S,va)||Zn(S,ur(We))?new yn(S,l,p,b,E):r.error(`Type ${Ui(S)} is not interpolatable.`)}evaluate(t){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(t);const p=this.input.evaluate(t);if(p<=r[0])return l[0].evaluate(t);const b=r.length;if(p>=r[b-1])return l[b-1].evaluate(t);const x=Ko(r,p),E=yn.interpolationFactor(this.interpolation,p,r[x],r[x+1]),S=l[x].evaluate(t),R=l[x+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ln(S,R,E);case"color":return pi.interpolate(S,R,E);case"padding":return Ta.interpolate(S,R,E);case"colorArray":return Ga.interpolate(S,R,E);case"numberArray":return Ea.interpolate(S,R,E);case"variableAnchorOffsetCollection":return ma.interpolate(S,R,E);case"array":return qo(S,R,E);case"projectionDefinition":return Wa.interpolate(S,R,E)}case"interpolate-hcl":switch(this.type.kind){case"color":return pi.interpolate(S,R,E,"hcl");case"colorArray":return Ga.interpolate(S,R,E,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return pi.interpolate(S,R,E,"lab");case"colorArray":return Ga.interpolate(S,R,E,"lab")}}}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Rl(s,t,r,l){const p=l-r,b=s-r;return p===0?0:t===1?b/p:(Math.pow(t,b)-1)/(Math.pow(t,p)-1)}const as={color:pi.interpolate,number:ln,padding:Ta.interpolate,numberArray:Ea.interpolate,colorArray:Ga.interpolate,variableAnchorOffsetCollection:ma.interpolate,array:qo};class Wo{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let l=null;const p=r.expectedType;p&&p.kind!=="value"&&(l=p);const b=[];for(const E of t.slice(1)){const S=r.parse(E,1+b.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,b.push(S)}if(!l)throw new Error("No output type");const x=p&&b.some(E=>Gn(p,E.type));return new Wo(x?Bt:l,b)}evaluate(t){let r,l=null,p=0;for(const b of this.args)if(p++,l=b.evaluate(t),l&&l instanceof Ln&&!l.available&&(r||(r=l.name),l=null,p===this.args.length&&(l=r)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Jo(s,t){return s==="=="||s==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Sr(s,t,r,l){return l.compare(t,r)===0}function eu(s,t,r){const l=s!=="=="&&s!=="!=";return class C_{constructor(b,x,E){this.type=Gt,this.lhs=b,this.rhs=x,this.collator=E,this.hasUntypedArgument=b.type.kind==="value"||x.type.kind==="value"}static parse(b,x){if(b.length!==3&&b.length!==4)return x.error("Expected two or three arguments.");const E=b[0];let S=x.parse(b[1],1,Bt);if(!S)return null;if(!Jo(E,S.type))return x.concat(1).error(`"${E}" comparisons are not supported for type '${Ui(S.type)}'.`);let R=x.parse(b[2],2,Bt);if(!R)return null;if(!Jo(E,R.type))return x.concat(2).error(`"${E}" comparisons are not supported for type '${Ui(R.type)}'.`);if(S.type.kind!==R.type.kind&&S.type.kind!=="value"&&R.type.kind!=="value")return x.error(`Cannot compare types '${Ui(S.type)}' and '${Ui(R.type)}'.`);l&&(S.type.kind==="value"&&R.type.kind!=="value"?S=new ti(R.type,[S]):S.type.kind!=="value"&&R.type.kind==="value"&&(R=new ti(S.type,[R])));let O=null;if(b.length===4){if(S.type.kind!=="string"&&R.type.kind!=="string"&&S.type.kind!=="value"&&R.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(O=x.parse(b[3],3,Fo),!O)return null}return new C_(S,R,O)}evaluate(b){const x=this.lhs.evaluate(b),E=this.rhs.evaluate(b);if(l&&this.hasUntypedArgument){const S=Wi(x),R=Wi(E);if(S.kind!==R.kind||S.kind!=="string"&&S.kind!=="number")throw new Zi(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${S.kind}, ${R.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=Wi(x),R=Wi(E);if(S.kind!=="string"||R.kind!=="string")return t(b,x,E)}return this.collator?r(b,x,E,this.collator.evaluate(b)):t(b,x,E)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const Tc=eu("==",function(s,t,r){return t===r},Sr),wd=eu("!=",function(s,t,r){return t!==r},function(s,t,r,l){return!Sr(0,t,r,l)}),wh=eu("<",function(s,t,r){return t<r},function(s,t,r,l){return l.compare(t,r)<0}),Uf=eu(">",function(s,t,r){return t>r},function(s,t,r,l){return l.compare(t,r)>0}),Hf=eu("<=",function(s,t,r){return t<=r},function(s,t,r,l){return l.compare(t,r)<=0}),jf=eu(">=",function(s,t,r){return t>=r},function(s,t,r,l){return l.compare(t,r)>=0});class Ec{constructor(t,r,l){this.type=Fo,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return r.error("Collator options argument must be an object.");const p=r.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Gt);if(!p)return null;const b=r.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Gt);if(!b)return null;let x=null;return l.locale&&(x=r.parse(l.locale,1,Ft),!x)?null:new Ec(p,b,x)}evaluate(t){return new po(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Uu{constructor(t,r,l,p,b){this.type=Ft,this.number=t,this.locale=r,this.currency=l,this.minFractionDigits=p,this.maxFractionDigits=b}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const l=r.parse(t[1],1,We);if(!l)return null;const p=t[2];if(typeof p!="object"||Array.isArray(p))return r.error("NumberFormat options argument must be an object.");let b=null;if(p.locale&&(b=r.parse(p.locale,1,Ft),!b))return null;let x=null;if(p.currency&&(x=r.parse(p.currency,1,Ft),!x))return null;let E=null;if(p["min-fraction-digits"]&&(E=r.parse(p["min-fraction-digits"],1,We),!E))return null;let S=null;return p["max-fraction-digits"]&&(S=r.parse(p["max-fraction-digits"],1,We),!S)?null:new Uu(l,b,x,E,S)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class wc{constructor(t){this.type=Lu,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return r.error("First argument must be an image or text section.");const p=[];let b=!1;for(let x=1;x<=t.length-1;++x){const E=t[x];if(b&&typeof E=="object"&&!Array.isArray(E)){b=!1;let S=null;if(E["font-scale"]&&(S=r.parse(E["font-scale"],1,We),!S))return null;let R=null;if(E["text-font"]&&(R=r.parse(E["text-font"],1,ur(Ft)),!R))return null;let O=null;if(E["text-color"]&&(O=r.parse(E["text-color"],1,Fi),!O))return null;let B=null;if(E["vertical-align"]){if(typeof E["vertical-align"]=="string"&&!Vo.includes(E["vertical-align"]))return r.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${E["vertical-align"]}' instead.`);if(B=r.parse(E["vertical-align"],1,Ft),!B)return null}const U=p[p.length-1];U.scale=S,U.font=R,U.textColor=O,U.verticalAlign=B}else{const S=r.parse(t[x],1,Bt);if(!S)return null;const R=S.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,p.push({content:S,scale:null,font:null,textColor:null,verticalAlign:null})}}return new wc(p)}evaluate(t){return new Va(this.sections.map(r=>{const l=r.content.evaluate(t);return Wi(l)===uo?new mo("",l,null,null,null,r.verticalAlign?r.verticalAlign.evaluate(t):null):new mo(ci(l),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null,r.verticalAlign?r.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor),r.verticalAlign&&t(r.verticalAlign)}outputDefined(){return!1}}class Ac{constructor(t){this.type=uo,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");const l=r.parse(t[1],1,Ft);return l?new Ac(l):r.error("No image name provided.")}evaluate(t){const r=this.input.evaluate(t),l=Ln.fromString(r);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(r)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class Sc{constructor(t){this.type=We,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=r.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${Ui(l.type)} instead.`):new Sc(l):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new Zi(`Expected value to be of type string or array, but found ${Ui(Wi(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Cr=8192;function Hu(s,t){const r=(180+s[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,p=Math.pow(2,t.z);return[Math.round(r*p*Cr),Math.round(l*p*Cr)]}function Ah(s,t){const r=Math.pow(2,t.z);return[(p=(s[0]/Cr+t.x)/r,360*p-180),(l=(s[1]/Cr+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,p}function ju(s,t){s[0]=Math.min(s[0],t[0]),s[1]=Math.min(s[1],t[1]),s[2]=Math.max(s[2],t[0]),s[3]=Math.max(s[3],t[1])}function qu(s,t){return!(s[0]<=t[0]||s[2]>=t[2]||s[1]<=t[1]||s[3]>=t[3])}function Ad(s,t,r){const l=s[0]-t[0],p=s[1]-t[1],b=s[0]-r[0],x=s[1]-r[1];return l*x-b*p==0&&l*b<=0&&p*x<=0}function Pl(s,t,r,l){return(p=[l[0]-r[0],l[1]-r[1]])[0]*(b=[t[0]-s[0],t[1]-s[1]])[1]-p[1]*b[0]!=0&&!(!Ch(s,t,r,l)||!Ch(r,l,s,t));var p,b}function Sh(s,t,r){for(const l of r)for(let p=0;p<l.length-1;++p)if(Pl(s,t,l[p],l[p+1]))return!0;return!1}function Mr(s,t,r=!1){let l=!1;for(const E of t)for(let S=0;S<E.length-1;S++){if(Ad(s,E[S],E[S+1]))return r;(b=E[S])[1]>(p=s)[1]!=(x=E[S+1])[1]>p[1]&&p[0]<(x[0]-b[0])*(p[1]-b[1])/(x[1]-b[1])+b[0]&&(l=!l)}var p,b,x;return l}function Sd(s,t){for(const r of t)if(Mr(s,r))return!0;return!1}function Cd(s,t){for(const r of s)if(!Mr(r,t))return!1;for(let r=0;r<s.length-1;++r)if(Sh(s[r],s[r+1],t))return!1;return!0}function qf(s,t){for(const r of t)if(Cd(s,r))return!0;return!1}function Ch(s,t,r,l){const p=l[0]-r[0],b=l[1]-r[1],x=(s[0]-r[0])*b-p*(s[1]-r[1]),E=(t[0]-r[0])*b-p*(t[1]-r[1]);return x>0&&E<0||x<0&&E>0}function Vu(s,t,r){const l=[];for(let p=0;p<s.length;p++){const b=[];for(let x=0;x<s[p].length;x++){const E=Hu(s[p][x],r);ju(t,E),b.push(E)}l.push(b)}return l}function Gu(s,t,r){const l=[];for(let p=0;p<s.length;p++){const b=Vu(s[p],t,r);l.push(b)}return l}function Zu(s,t,r,l){if(s[0]<r[0]||s[0]>r[2]){const p=.5*l;let b=s[0]-r[0]>p?-l:r[0]-s[0]>p?l:0;b===0&&(b=s[0]-r[2]>p?-l:r[2]-s[0]>p?l:0),s[0]+=b}ju(t,s)}function Md(s,t,r,l){const p=Math.pow(2,l.z)*Cr,b=[l.x*Cr,l.y*Cr],x=[];for(const E of s)for(const S of E){const R=[S.x+b[0],S.y+b[1]];Zu(R,t,r,p),x.push(R)}return x}function Yu(s,t,r,l){const p=Math.pow(2,l.z)*Cr,b=[l.x*Cr,l.y*Cr],x=[];for(const S of s){const R=[];for(const O of S){const B=[O.x+b[0],O.y+b[1]];ju(t,B),R.push(B)}x.push(R)}if(t[2]-t[0]<=p/2){(E=t)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const S of x)for(const R of S)Zu(R,t,r,p)}var E;return x}class Ps{constructor(t,r){this.type=Gt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Di(t[1])){const l=t[1];if(l.type==="FeatureCollection"){const p=[];for(const b of l.features){const{type:x,coordinates:E}=b.geometry;x==="Polygon"&&p.push(E),x==="MultiPolygon"&&p.push(...E)}if(p.length)return new Ps(l,{type:"MultiPolygon",coordinates:p})}else if(l.type==="Feature"){const p=l.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Ps(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Ps(l,l)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,l){const p=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],x=r.canonicalID();if(l.type==="Polygon"){const E=Vu(l.coordinates,b,x),S=Md(r.geometry(),p,b,x);if(!qu(p,b))return!1;for(const R of S)if(!Mr(R,E))return!1}if(l.type==="MultiPolygon"){const E=Gu(l.coordinates,b,x),S=Md(r.geometry(),p,b,x);if(!qu(p,b))return!1;for(const R of S)if(!Sd(R,E))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,l){const p=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],x=r.canonicalID();if(l.type==="Polygon"){const E=Vu(l.coordinates,b,x),S=Yu(r.geometry(),p,b,x);if(!qu(p,b))return!1;for(const R of S)if(!Cd(R,E))return!1}if(l.type==="MultiPolygon"){const E=Gu(l.coordinates,b,x),S=Yu(r.geometry(),p,b,x);if(!qu(p,b))return!1;for(const R of S)if(!qf(R,E))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Mh=class{constructor(s=[],t=(r,l)=>r<l?-1:r>l?1:0){if(this.data=s,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:t,compare:r}=this,l=t[s];for(;s>0;){const p=s-1>>1,b=t[p];if(r(l,b)>=0)break;t[s]=b,s=p}t[s]=l}_down(s){const{data:t,compare:r}=this,l=this.length>>1,p=t[s];for(;s<l;){let b=1+(s<<1);const x=b+1;if(x<this.length&&r(t[x],t[b])<0&&(b=x),r(t[b],p)>=0)break;t[s]=t[b],s=b}t[s]=p}};function Cc(s,t,r=0,l=s.length-1,p=Ih){for(;l>r;){if(l-r>600){const S=l-r+1,R=t-r+1,O=Math.log(S),B=.5*Math.exp(2*O/3),U=.5*Math.sqrt(O*B*(S-B)/S)*(R-S/2<0?-1:1);Cc(s,t,Math.max(r,Math.floor(t-R*B/S+U)),Math.min(l,Math.floor(t+(S-R)*B/S+U)),p)}const b=s[t];let x=r,E=l;for(yo(s,r,t),p(s[l],b)>0&&yo(s,r,l);x<E;){for(yo(s,x,E),x++,E--;p(s[x],b)<0;)x++;for(;p(s[E],b)>0;)E--}p(s[r],b)===0?yo(s,r,E):(E++,yo(s,E,l)),E<=t&&(r=E+1),t<=E&&(l=E-1)}}function yo(s,t,r){const l=s[t];s[t]=s[r],s[r]=l}function Ih(s,t){return s<t?-1:s>t?1:0}function Ll(s,t){if(s.length<=1)return[s];const r=[];let l,p;for(const b of s){const x=Vf(b);x!==0&&(b.area=Math.abs(x),p===void 0&&(p=x<0),p===x<0?(l&&r.push(l),l=[b]):l.push(b))}if(l&&r.push(l),t>1)for(let b=0;b<r.length;b++)r[b].length<=t||(Cc(r[b],t,1,r[b].length-1,Id),r[b]=r[b].slice(0,t));return r}function Id(s,t){return t.area-s.area}function Vf(s){let t=0;for(let r,l,p=0,b=s.length,x=b-1;p<b;x=p++)r=s[p],l=s[x],t+=(l.x-r.x)*(r.y+l.y);return t}const Dh=1/298.257223563,Dd=Dh*(2-Dh),Rd=Math.PI/180;class Rh{constructor(t){const r=6378.137*Rd*1e3,l=Math.cos(t*Rd),p=1/(1-Dd*(1-l*l)),b=Math.sqrt(p);this.kx=r*b*l,this.ky=r*b*p*(1-Dd)}distance(t,r){const l=this.wrap(t[0]-r[0])*this.kx,p=(t[1]-r[1])*this.ky;return Math.sqrt(l*l+p*p)}pointOnLine(t,r){let l,p,b,x,E=1/0;for(let S=0;S<t.length-1;S++){let R=t[S][0],O=t[S][1],B=this.wrap(t[S+1][0]-R)*this.kx,U=(t[S+1][1]-O)*this.ky,j=0;B===0&&U===0||(j=(this.wrap(r[0]-R)*this.kx*B+(r[1]-O)*this.ky*U)/(B*B+U*U),j>1?(R=t[S+1][0],O=t[S+1][1]):j>0&&(R+=B/this.kx*j,O+=U/this.ky*j)),B=this.wrap(r[0]-R)*this.kx,U=(r[1]-O)*this.ky;const V=B*B+U*U;V<E&&(E=V,l=R,p=O,b=S,x=j)}return{point:[l,p],index:b,t:Math.max(0,Math.min(1,x))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function $n(s,t){return t[0]-s[0]}function hi(s){return s[1]-s[0]+1}function ns(s,t){return s[1]>=s[0]&&s[1]<t}function Mc(s,t){if(s[0]>s[1])return[null,null];const r=hi(s);if(t){if(r===2)return[s,null];const p=Math.floor(r/2);return[[s[0],s[0]+p],[s[0]+p,s[1]]]}if(r===1)return[s,null];const l=Math.floor(r/2)-1;return[[s[0],s[0]+l],[s[0]+l+1,s[1]]]}function Ic(s,t){if(!ns(t,s.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let l=t[0];l<=t[1];++l)ju(r,s[l]);return r}function Dc(s){const t=[1/0,1/0,-1/0,-1/0];for(const r of s)for(const l of r)ju(t,l);return t}function Rc(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function Ph(s,t,r){if(!Rc(s)||!Rc(t))return NaN;let l=0,p=0;return s[2]<t[0]&&(l=t[0]-s[2]),s[0]>t[2]&&(l=s[0]-t[2]),s[1]>t[3]&&(p=s[1]-t[3]),s[3]<t[1]&&(p=t[1]-s[3]),r.distance([0,0],[l,p])}function Ir(s,t,r){const l=r.pointOnLine(t,s);return r.distance(s,l.point)}function Nl(s,t,r,l,p){const b=Math.min(Ir(s,[r,l],p),Ir(t,[r,l],p)),x=Math.min(Ir(r,[s,t],p),Ir(l,[s,t],p));return Math.min(b,x)}function Ol(s,t,r,l,p){if(!ns(t,s.length)||!ns(l,r.length))return 1/0;let b=1/0;for(let x=t[0];x<t[1];++x){const E=s[x],S=s[x+1];for(let R=l[0];R<l[1];++R){const O=r[R],B=r[R+1];if(Pl(E,S,O,B))return 0;b=Math.min(b,Nl(E,S,O,B,p))}}return b}function Lh(s,t,r,l,p){if(!ns(t,s.length)||!ns(l,r.length))return NaN;let b=1/0;for(let x=t[0];x<=t[1];++x)for(let E=l[0];E<=l[1];++E)if(b=Math.min(b,p.distance(s[x],r[E])),b===0)return b;return b}function Pd(s,t,r){if(Mr(s,t,!0))return 0;let l=1/0;for(const p of t){const b=p[0],x=p[p.length-1];if(b!==x&&(l=Math.min(l,Ir(s,[x,b],r)),l===0))return l;const E=r.pointOnLine(p,s);if(l=Math.min(l,r.distance(s,E.point)),l===0)return l}return l}function tu(s,t,r,l){if(!ns(t,s.length))return NaN;for(let b=t[0];b<=t[1];++b)if(Mr(s[b],r,!0))return 0;let p=1/0;for(let b=t[0];b<t[1];++b){const x=s[b],E=s[b+1];for(const S of r)for(let R=0,O=S.length,B=O-1;R<O;B=R++){const U=S[B],j=S[R];if(Pl(x,E,U,j))return 0;p=Math.min(p,Nl(x,E,U,j,l))}}return p}function iu(s,t){for(const r of s)for(const l of r)if(Mr(l,t,!0))return!0;return!1}function Nh(s,t,r,l=1/0){const p=Dc(s),b=Dc(t);if(l!==1/0&&Ph(p,b,r)>=l)return l;if(qu(p,b)){if(iu(s,t))return 0}else if(iu(t,s))return 0;let x=1/0;for(const E of s)for(let S=0,R=E.length,O=R-1;S<R;O=S++){const B=E[O],U=E[S];for(const j of t)for(let V=0,Y=j.length,ee=Y-1;V<Y;ee=V++){const oe=j[ee],xe=j[V];if(Pl(B,U,oe,xe))return 0;x=Math.min(x,Nl(B,U,oe,xe,r))}}return x}function Oh(s,t,r,l,p,b){if(!b)return;const x=Ph(Ic(l,b),p,r);x<t&&s.push([x,b,[0,0]])}function rs(s,t,r,l,p,b,x){if(!b||!x)return;const E=Ph(Ic(l,b),Ic(p,x),r);E<t&&s.push([E,b,x])}function kl(s,t,r,l,p=1/0){let b=Math.min(l.distance(s[0],r[0][0]),p);if(b===0)return b;const x=new Mh([[0,[0,s.length-1],[0,0]]],$n),E=Dc(r);for(;x.length>0;){const S=x.pop();if(S[0]>=b)continue;const R=S[1],O=t?50:100;if(hi(R)<=O){if(!ns(R,s.length))return NaN;if(t){const B=tu(s,R,r,l);if(isNaN(B)||B===0)return B;b=Math.min(b,B)}else for(let B=R[0];B<=R[1];++B){const U=Pd(s[B],r,l);if(b=Math.min(b,U),b===0)return 0}}else{const B=Mc(R,t);Oh(x,b,l,s,E,B[0]),Oh(x,b,l,s,E,B[1])}}return b}function Bl(s,t,r,l,p,b=1/0){let x=Math.min(b,p.distance(s[0],r[0]));if(x===0)return x;const E=new Mh([[0,[0,s.length-1],[0,r.length-1]]],$n);for(;E.length>0;){const S=E.pop();if(S[0]>=x)continue;const R=S[1],O=S[2],B=t?50:100,U=l?50:100;if(hi(R)<=B&&hi(O)<=U){if(!ns(R,s.length)&&ns(O,r.length))return NaN;let j;if(t&&l)j=Ol(s,R,r,O,p),x=Math.min(x,j);else if(t&&!l){const V=s.slice(R[0],R[1]+1);for(let Y=O[0];Y<=O[1];++Y)if(j=Ir(r[Y],V,p),x=Math.min(x,j),x===0)return x}else if(!t&&l){const V=r.slice(O[0],O[1]+1);for(let Y=R[0];Y<=R[1];++Y)if(j=Ir(s[Y],V,p),x=Math.min(x,j),x===0)return x}else j=Lh(s,R,r,O,p),x=Math.min(x,j)}else{const j=Mc(R,t),V=Mc(O,l);rs(E,x,p,s,r,j[0],V[0]),rs(E,x,p,s,r,j[0],V[1]),rs(E,x,p,s,r,j[1],V[0]),rs(E,x,p,s,r,j[1],V[1])}}return x}function Pc(s){return s.type==="MultiPolygon"?s.coordinates.map(t=>({type:"Polygon",coordinates:t})):s.type==="MultiLineString"?s.coordinates.map(t=>({type:"LineString",coordinates:t})):s.type==="MultiPoint"?s.coordinates.map(t=>({type:"Point",coordinates:t})):[s]}class au{constructor(t,r){this.type=We,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Di(t[1])){const l=t[1];if(l.type==="FeatureCollection")return new au(l,l.features.map(p=>Pc(p.geometry)).flat());if(l.type==="Feature")return new au(l,Pc(l.geometry));if("type"in l&&"coordinates"in l)return new au(l,Pc(l))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,l){const p=r.geometry(),b=p.flat().map(S=>Ah([S.x,S.y],r.canonical));if(p.length===0)return NaN;const x=new Rh(b[0][1]);let E=1/0;for(const S of l){switch(S.type){case"Point":E=Math.min(E,Bl(b,!1,[S.coordinates],!1,x,E));break;case"LineString":E=Math.min(E,Bl(b,!1,S.coordinates,!0,x,E));break;case"Polygon":E=Math.min(E,kl(b,!1,S.coordinates,x,E))}if(E===0)return E}return E}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,l){const p=r.geometry(),b=p.flat().map(S=>Ah([S.x,S.y],r.canonical));if(p.length===0)return NaN;const x=new Rh(b[0][1]);let E=1/0;for(const S of l){switch(S.type){case"Point":E=Math.min(E,Bl(b,!0,[S.coordinates],!1,x,E));break;case"LineString":E=Math.min(E,Bl(b,!0,S.coordinates,!0,x,E));break;case"Polygon":E=Math.min(E,kl(b,!0,S.coordinates,x,E))}if(E===0)return E}return E}(t,this.geometries);if(t.geometryType()==="Polygon")return function(r,l){const p=r.geometry();if(p.length===0||p[0].length===0)return NaN;const b=Ll(p,0).map(S=>S.map(R=>R.map(O=>Ah([O.x,O.y],r.canonical)))),x=new Rh(b[0][0][0][1]);let E=1/0;for(const S of l)for(const R of b){switch(S.type){case"Point":E=Math.min(E,kl([S.coordinates],!1,R,x,E));break;case"LineString":E=Math.min(E,kl(S.coordinates,!0,R,x,E));break;case"Polygon":E=Math.min(E,Nh(R,S.coordinates,x,E))}if(E===0)return E}return E}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Lc{constructor(t){this.type=Bt,this.key=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=t[1];return l==null?r.error("Global state property must be defined."):typeof l!="string"?r.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new Lc(l)}evaluate(t){var r;const l=(r=t.globals)===null||r===void 0?void 0:r.globalState;return l&&Object.keys(l).length!==0?ku(l,this.key):null}eachChild(){}outputDefined(){return!1}}const $u={"==":Tc,"!=":wd,">":Uf,"<":wh,">=":jf,"<=":Hf,array:ti,at:Yo,boolean:ti,case:Ja,coalesce:Wo,collator:Ec,format:wc,image:Ac,in:$o,"index-of":Fu,interpolate:yn,"interpolate-hcl":yn,"interpolate-lab":yn,length:Sc,let:go,literal:Zt,match:Xo,number:ti,"number-format":Uu,object:ti,slice:Qo,step:_o,string:ti,"to-boolean":wa,"to-color":wa,"to-number":wa,"to-string":wa,var:Zo,within:Ps,distance:au,"global-state":Lc};class cr{constructor(t,r,l,p){this.name=t,this.type=r,this._evaluate=l,this.args=p}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){const l=t[0],p=cr.definitions[l];if(!p)return r.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,E=x.filter(([R])=>!Array.isArray(R)||R.length===t.length-1);let S=null;for(const[R,O]of E){S=new Dl(r.registry,Nn,r.path,null,r.scope);const B=[];let U=!1;for(let j=1;j<t.length;j++){const V=t[j],Y=Array.isArray(R)?R[j-1]:R.type,ee=S.parse(V,1+B.length,Y);if(!ee){U=!0;break}B.push(ee)}if(!U)if(Array.isArray(R)&&R.length!==B.length)S.error(`Expected ${R.length} arguments, but found ${B.length} instead.`);else{for(let j=0;j<B.length;j++){const V=Array.isArray(R)?R[j]:R.type,Y=B[j];S.concat(j+1).checkSubtype(V,Y.type)}if(S.errors.length===0)return new cr(l,b,O,B)}}if(E.length===1)r.errors.push(...S.errors);else{const R=(E.length?E:x).map(([B])=>{return U=B,Array.isArray(U)?`(${U.map(Ui).join(", ")})`:`(${Ui(U.type)}...)`;var U}).join(" | "),O=[];for(let B=1;B<t.length;B++){const U=r.parse(t[B],1+O.length);if(!U)return null;O.push(Ui(U.type))}r.error(`Expected arguments of type ${R}, but found (${O.join(", ")}) instead.`)}return null}static register(t,r){cr.definitions=r;for(const l in r)t[l]=cr}}function kh(s,[t,r,l,p]){t=t.evaluate(s),r=r.evaluate(s),l=l.evaluate(s);const b=p?p.evaluate(s):1,x=Ar(t,r,l,b);if(x)throw new Zi(x);return new pi(t/255,r/255,l/255,b,!1)}function Nc(s,t){return s in t}function hr(s,t){const r=t[s];return r===void 0?null:r}function bo(s){return{type:s}}function Nn(s){if(s instanceof Zo)return Nn(s.boundExpression);if(s instanceof cr&&s.name==="error"||s instanceof Ec||s instanceof Ps||s instanceof au||s instanceof Lc)return!1;const t=s instanceof wa||s instanceof ti;let r=!0;return s.eachChild(l=>{r=t?r&&Nn(l):r&&l instanceof Zt}),!!r&&On(s)&&Xu(s,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function On(s){if(s instanceof cr&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Ps||s instanceof au)return!1;let t=!0;return s.eachChild(r=>{t&&!On(r)&&(t=!1)}),t}function ss(s){if(s instanceof cr&&s.name==="feature-state")return!1;let t=!0;return s.eachChild(r=>{t&&!ss(r)&&(t=!1)}),t}function Xu(s,t){if(s instanceof cr&&t.indexOf(s.name)>=0)return!1;let r=!0;return s.eachChild(l=>{r&&!Xu(l,t)&&(r=!1)}),r}function nu(s){return{result:"success",value:s}}function Ls(s){return{result:"error",value:s}}function xo(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function ru(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function zl(s){return!!s.expression&&s.expression.interpolated}function si(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function Ns(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&Wi(s)===qa}function Oc(s){return s}function kn(s,t){const r=s.stops&&typeof s.stops[0][0]=="object",l=r||!(r||s.property!==void 0),p=s.type||(zl(t)?"exponential":"interval"),b=function(O){switch(O.type){case"color":return pi.parse;case"padding":return Ta.parse;case"numberArray":return Ea.parse;case"colorArray":return Ga.parse;default:return null}}(t);if(b&&((s=vi({},s)).stops&&(s.stops=s.stops.map(O=>[O[0],b(O[1])])),s.default=b(s.default?s.default:t.default)),s.colorSpace&&(x=s.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var x;const E=function(O){switch(O){case"exponential":return Fl;case"interval":return Ld;case"categorical":return Os;case"identity":return ou;default:throw new Error(`Unknown function type "${O}"`)}}(p);let S,R;if(p==="categorical"){S=Object.create(null);for(const O of s.stops)S[O[0]]=O[1];R=typeof s.stops[0][0]}if(r){const O={},B=[];for(let V=0;V<s.stops.length;V++){const Y=s.stops[V],ee=Y[0].zoom;O[ee]===void 0&&(O[ee]={zoom:ee,type:s.type,property:s.property,default:s.default,stops:[]},B.push(ee)),O[ee].stops.push([Y[0].value,Y[1]])}const U=[];for(const V of B)U.push([O[V].zoom,kn(O[V],t)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:yn.interpolationFactor.bind(void 0,j),zoomStops:U.map(V=>V[0]),evaluate:({zoom:V},Y)=>Fl({stops:U,base:s.base},t,V).evaluate(V,Y)}}if(l){const O=p==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:yn.interpolationFactor.bind(void 0,O),zoomStops:s.stops.map(B=>B[0]),evaluate:({zoom:B})=>E(s,t,B,S,R)}}return{kind:"source",evaluate(O,B){const U=B&&B.properties?B.properties[s.property]:void 0;return U===void 0?su(s.default,t.default):E(s,t,U,S,R)}}}function su(s,t,r){return s!==void 0?s:t!==void 0?t:r!==void 0?r:void 0}function Os(s,t,r,l,p){return su(typeof r===p?l[r]:void 0,s.default,t.default)}function Ld(s,t,r){if(si(r)!=="number")return su(s.default,t.default);const l=s.stops.length;if(l===1||r<=s.stops[0][0])return s.stops[0][1];if(r>=s.stops[l-1][0])return s.stops[l-1][1];const p=Ko(s.stops.map(b=>b[0]),r);return s.stops[p][1]}function Fl(s,t,r){const l=s.base!==void 0?s.base:1;if(si(r)!=="number")return su(s.default,t.default);const p=s.stops.length;if(p===1||r<=s.stops[0][0])return s.stops[0][1];if(r>=s.stops[p-1][0])return s.stops[p-1][1];const b=Ko(s.stops.map(O=>O[0]),r),x=function(O,B,U,j){const V=j-U,Y=O-U;return V===0?0:B===1?Y/V:(Math.pow(B,Y)-1)/(Math.pow(B,V)-1)}(r,l,s.stops[b][0],s.stops[b+1][0]),E=s.stops[b][1],S=s.stops[b+1][1],R=as[t.type]||Oc;return typeof E.evaluate=="function"?{evaluate(...O){const B=E.evaluate.apply(void 0,O),U=S.evaluate.apply(void 0,O);if(B!==void 0&&U!==void 0)return R(B,U,x,s.colorSpace)}}:R(E,S,x,s.colorSpace)}function ou(s,t,r){switch(t.type){case"color":r=pi.parse(r);break;case"formatted":r=Va.fromString(r.toString());break;case"resolvedImage":r=Ln.fromString(r.toString());break;case"padding":r=Ta.parse(r);break;case"colorArray":r=Ga.parse(r);break;case"numberArray":r=Ea.parse(r);break;default:si(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0)}return su(r,s.default,t.default)}cr.register($u,{error:[{kind:"error"},[Ft],(s,[t])=>{throw new Zi(t.evaluate(s))}],typeof:[Ft,[Bt],(s,[t])=>Ui(Wi(t.evaluate(s)))],"to-rgba":[ur(We,4),[Fi],(s,[t])=>{const[r,l,p,b]=t.evaluate(s).rgb;return[255*r,255*l,255*p,b]}],rgb:[Fi,[We,We,We],kh],rgba:[Fi,[We,We,We,We],kh],has:{type:Gt,overloads:[[[Ft],(s,[t])=>Nc(t.evaluate(s),s.properties())],[[Ft,qa],(s,[t,r])=>Nc(t.evaluate(s),r.evaluate(s))]]},get:{type:Bt,overloads:[[[Ft],(s,[t])=>hr(t.evaluate(s),s.properties())],[[Ft,qa],(s,[t,r])=>hr(t.evaluate(s),r.evaluate(s))]]},"feature-state":[Bt,[Ft],(s,[t])=>hr(t.evaluate(s),s.featureState||{})],properties:[qa,[],s=>s.properties()],"geometry-type":[Ft,[],s=>s.geometryType()],id:[Bt,[],s=>s.id()],zoom:[We,[],s=>s.globals.zoom],"heatmap-density":[We,[],s=>s.globals.heatmapDensity||0],"line-progress":[We,[],s=>s.globals.lineProgress||0],accumulated:[Bt,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[We,bo(We),(s,t)=>{let r=0;for(const l of t)r+=l.evaluate(s);return r}],"*":[We,bo(We),(s,t)=>{let r=1;for(const l of t)r*=l.evaluate(s);return r}],"-":{type:We,overloads:[[[We,We],(s,[t,r])=>t.evaluate(s)-r.evaluate(s)],[[We],(s,[t])=>-t.evaluate(s)]]},"/":[We,[We,We],(s,[t,r])=>t.evaluate(s)/r.evaluate(s)],"%":[We,[We,We],(s,[t,r])=>t.evaluate(s)%r.evaluate(s)],ln2:[We,[],()=>Math.LN2],pi:[We,[],()=>Math.PI],e:[We,[],()=>Math.E],"^":[We,[We,We],(s,[t,r])=>Math.pow(t.evaluate(s),r.evaluate(s))],sqrt:[We,[We],(s,[t])=>Math.sqrt(t.evaluate(s))],log10:[We,[We],(s,[t])=>Math.log(t.evaluate(s))/Math.LN10],ln:[We,[We],(s,[t])=>Math.log(t.evaluate(s))],log2:[We,[We],(s,[t])=>Math.log(t.evaluate(s))/Math.LN2],sin:[We,[We],(s,[t])=>Math.sin(t.evaluate(s))],cos:[We,[We],(s,[t])=>Math.cos(t.evaluate(s))],tan:[We,[We],(s,[t])=>Math.tan(t.evaluate(s))],asin:[We,[We],(s,[t])=>Math.asin(t.evaluate(s))],acos:[We,[We],(s,[t])=>Math.acos(t.evaluate(s))],atan:[We,[We],(s,[t])=>Math.atan(t.evaluate(s))],min:[We,bo(We),(s,t)=>Math.min(...t.map(r=>r.evaluate(s)))],max:[We,bo(We),(s,t)=>Math.max(...t.map(r=>r.evaluate(s)))],abs:[We,[We],(s,[t])=>Math.abs(t.evaluate(s))],round:[We,[We],(s,[t])=>{const r=t.evaluate(s);return r<0?-Math.round(-r):Math.round(r)}],floor:[We,[We],(s,[t])=>Math.floor(t.evaluate(s))],ceil:[We,[We],(s,[t])=>Math.ceil(t.evaluate(s))],"filter-==":[Gt,[Ft,Bt],(s,[t,r])=>s.properties()[t.value]===r.value],"filter-id-==":[Gt,[Bt],(s,[t])=>s.id()===t.value],"filter-type-==":[Gt,[Ft],(s,[t])=>s.geometryType()===t.value],"filter-<":[Gt,[Ft,Bt],(s,[t,r])=>{const l=s.properties()[t.value],p=r.value;return typeof l==typeof p&&l<p}],"filter-id-<":[Gt,[Bt],(s,[t])=>{const r=s.id(),l=t.value;return typeof r==typeof l&&r<l}],"filter->":[Gt,[Ft,Bt],(s,[t,r])=>{const l=s.properties()[t.value],p=r.value;return typeof l==typeof p&&l>p}],"filter-id->":[Gt,[Bt],(s,[t])=>{const r=s.id(),l=t.value;return typeof r==typeof l&&r>l}],"filter-<=":[Gt,[Ft,Bt],(s,[t,r])=>{const l=s.properties()[t.value],p=r.value;return typeof l==typeof p&&l<=p}],"filter-id-<=":[Gt,[Bt],(s,[t])=>{const r=s.id(),l=t.value;return typeof r==typeof l&&r<=l}],"filter->=":[Gt,[Ft,Bt],(s,[t,r])=>{const l=s.properties()[t.value],p=r.value;return typeof l==typeof p&&l>=p}],"filter-id->=":[Gt,[Bt],(s,[t])=>{const r=s.id(),l=t.value;return typeof r==typeof l&&r>=l}],"filter-has":[Gt,[Bt],(s,[t])=>t.value in s.properties()],"filter-has-id":[Gt,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[Gt,[ur(Ft)],(s,[t])=>t.value.indexOf(s.geometryType())>=0],"filter-id-in":[Gt,[ur(Bt)],(s,[t])=>t.value.indexOf(s.id())>=0],"filter-in-small":[Gt,[Ft,ur(Bt)],(s,[t,r])=>r.value.indexOf(s.properties()[t.value])>=0],"filter-in-large":[Gt,[Ft,ur(Bt)],(s,[t,r])=>function(l,p,b,x){for(;b<=x;){const E=b+x>>1;if(p[E]===l)return!0;p[E]>l?x=E-1:b=E+1}return!1}(s.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Gt,overloads:[[[Gt,Gt],(s,[t,r])=>t.evaluate(s)&&r.evaluate(s)],[bo(Gt),(s,t)=>{for(const r of t)if(!r.evaluate(s))return!1;return!0}]]},any:{type:Gt,overloads:[[[Gt,Gt],(s,[t,r])=>t.evaluate(s)||r.evaluate(s)],[bo(Gt),(s,t)=>{for(const r of t)if(r.evaluate(s))return!0;return!1}]]},"!":[Gt,[Gt],(s,[t])=>!t.evaluate(s)],"is-supported-script":[Gt,[Ft],(s,[t])=>{const r=s.globals&&s.globals.isSupportedScript;return!r||r(t.evaluate(s))}],upcase:[Ft,[Ft],(s,[t])=>t.evaluate(s).toUpperCase()],downcase:[Ft,[Ft],(s,[t])=>t.evaluate(s).toLowerCase()],concat:[Ft,bo(Bt),(s,t)=>t.map(r=>ci(r.evaluate(s))).join("")],"resolved-locale":[Ft,[Fo],(s,[t])=>t.evaluate(s).resolvedLocale()]});class Qu{constructor(t,r){this.expression=t,this._warningHistory={},this._evaluator=new Go,this._defaultValue=r?function(l){if(l.type==="color"&&Ns(l.default))return new pi(0,0,0,0);switch(l.type){case"color":return pi.parse(l.default)||null;case"padding":return Ta.parse(l.default)||null;case"numberArray":return Ea.parse(l.default)||null;case"colorArray":return Ga.parse(l.default)||null;case"variableAnchorOffsetCollection":return ma.parse(l.default)||null;case"projectionDefinition":return Wa.parse(l.default)||null;default:return l.default===void 0?null:l.default}}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,l,p,b,x){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=l,this._evaluator.canonical=p,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(t,r,l,p,b,x){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=l||null,this._evaluator.canonical=p,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=x||null;try{const E=this.expression.evaluate(this._evaluator);if(E==null||typeof E=="number"&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new Zi(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function uu(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in $u}function ks(s,t){const r=new Dl($u,Nn,[],t?function(p){const b={color:Fi,string:Ft,number:We,enum:Ft,boolean:Gt,formatted:Lu,padding:or,numberArray:Ds,colorArray:ts,projectionDefinition:Gi,resolvedImage:uo,variableAnchorOffsetCollection:va};return p.type==="array"?ur(b[p.value]||Bt,p.length):b[p.type]}(t):void 0),l=r.parse(s,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?nu(new Qu(l,t)):Ls(r.errors)}class vo{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!ss(r.expression)}evaluateWithoutErrorHandling(t,r,l,p,b,x){return this._styleExpression.evaluateWithoutErrorHandling(t,r,l,p,b,x)}evaluate(t,r,l,p,b,x){return this._styleExpression.evaluate(t,r,l,p,b,x)}}class lu{constructor(t,r,l,p){this.kind=t,this.zoomStops=l,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!ss(r.expression),this.interpolationType=p}evaluateWithoutErrorHandling(t,r,l,p,b,x){return this._styleExpression.evaluateWithoutErrorHandling(t,r,l,p,b,x)}evaluate(t,r,l,p,b,x){return this._styleExpression.evaluate(t,r,l,p,b,x)}interpolationFactor(t,r,l){return this.interpolationType?yn.interpolationFactor(this.interpolationType,t,r,l):0}}function Ku(s,t){const r=ks(s,t);if(r.result==="error")return r;const l=r.value.expression,p=On(l);if(!p&&!xo(t))return Ls([new fi("","data expressions not supported")]);const b=Xu(l,["zoom"]);if(!b&&!ru(t))return Ls([new fi("","zoom expressions not supported")]);const x=xn(l);return x||b?x instanceof fi?Ls([x]):x instanceof yn&&!zl(t)?Ls([new fi("",'"interpolate" expressions cannot be used with this property')]):nu(x?new lu(p?"camera":"composite",r.value,x.labels,x instanceof yn?x.interpolation:void 0):new vo(p?"constant":"source",r.value)):Ls([new fi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class bn{constructor(t,r){this._parameters=t,this._specification=r,vi(this,kn(this._parameters,this._specification))}static deserialize(t){return new bn(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function xn(s){let t=null;if(s instanceof go)t=xn(s.result);else if(s instanceof Wo){for(const r of s.args)if(t=xn(r),t)break}else(s instanceof _o||s instanceof yn)&&s.input instanceof cr&&s.input.name==="zoom"&&(t=s);return t instanceof fi||s.eachChild(r=>{const l=xn(r);l instanceof fi?t=l:!t&&l?t=new fi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new fi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function zr(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const t of s.slice(1))if(!zr(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Fr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function dr(s){if(s==null)return{filter:()=>!0,needGeometry:!1};zr(s)||(s=Wu(s));const t=ks(s,Fr);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,l,p)=>t.value.evaluate(r,l,{},p),needGeometry:Bh(s)}}function os(s,t){return s<t?-1:s>t?1:0}function Bh(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let t=1;t<s.length;t++)if(Bh(s[t]))return!0;return!1}function Wu(s){if(!s)return!0;const t=s[0];return s.length<=1?t!=="any":t==="=="?Ul(s[1],s[2],"=="):t==="!="?Ei(Ul(s[1],s[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Ul(s[1],s[2],t):t==="any"?(r=s.slice(1),["any"].concat(r.map(Wu))):t==="all"?["all"].concat(s.slice(1).map(Wu)):t==="none"?["all"].concat(s.slice(1).map(Wu).map(Ei)):t==="in"?vn(s[1],s.slice(2)):t==="!in"?Ei(vn(s[1],s.slice(2))):t==="has"?ga(s[1]):t!=="!has"||Ei(ga(s[1]));var r}function Ul(s,t,r){switch(s){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,s,t]}}function vn(s,t){if(t.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",s,["literal",t.sort(os)]]:["filter-in-small",s,["literal",t]]}}function ga(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Ei(s){return["!",s]}function us(s){const t=typeof s;if(t==="number"||t==="boolean"||t==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let p="[";for(const b of s)p+=`${us(b)},`;return`${p}]`}const r=Object.keys(s).sort();let l="{";for(let p=0;p<r.length;p++)l+=`${JSON.stringify(r[p])}:${us(s[r[p]])},`;return`${l}}`}function Ur(s){let t="";for(const r of Le)t+=`/${us(s[r])}`;return t}function cu(s){const t=s.value;return t?[new Ve(s.key,t,"constants have been deprecated as of v8")]:[]}function Hi(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Bs(s){if(Array.isArray(s))return s.map(Bs);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const t={};for(const r in s)t[r]=Bs(s[r]);return t}return Hi(s)}function Xn(s){const t=s.key,r=s.value,l=s.valueSpec||{},p=s.objectElementValidators||{},b=s.style,x=s.styleSpec,E=s.validateSpec;let S=[];const R=si(r);if(R!=="object")return[new Ve(t,r,`object expected, ${R} found`)];for(const O in r){const B=O.split(".")[0],U=ku(l,B)||l["*"];let j;if(ku(p,B))j=p[B];else if(ku(l,B))j=E;else if(p["*"])j=p["*"];else{if(!l["*"]){S.push(new Ve(t,r[O],`unknown property "${O}"`));continue}j=E}S=S.concat(j({key:(t&&`${t}.`)+O,value:r[O],valueSpec:U,style:b,styleSpec:x,object:r,objectKey:O,validateSpec:E},r))}for(const O in l)p[O]||l[O].required&&l[O].default===void 0&&r[O]===void 0&&S.push(new Ve(t,r,`missing required property "${O}"`));return S}function hu(s){const t=s.value,r=s.valueSpec,l=s.style,p=s.styleSpec,b=s.key,x=s.arrayElementValidator||s.validateSpec;if(si(t)!=="array")return[new Ve(b,t,`array expected, ${si(t)} found`)];if(r.length&&t.length!==r.length)return[new Ve(b,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new Ve(b,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let E={type:r.value,values:r.values};p.$version<7&&(E.function=r.function),si(r.value)==="object"&&(E=r.value);let S=[];for(let R=0;R<t.length;R++)S=S.concat(x({array:t,arrayIndex:R,value:t[R],valueSpec:E,validateSpec:s.validateSpec,style:l,styleSpec:p,key:`${b}[${R}]`}));return S}function zs(s){const t=s.key,r=s.value,l=s.valueSpec;let p=si(r);return p==="number"&&r!=r&&(p="NaN"),p!=="number"?[new Ve(t,r,`number expected, ${p} found`)]:"minimum"in l&&r<l.minimum?[new Ve(t,r,`${r} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&r>l.maximum?[new Ve(t,r,`${r} is greater than the maximum value ${l.maximum}`)]:[]}function kc(s){const t=s.valueSpec,r=Hi(s.value.type);let l,p,b,x={};const E=r!=="categorical"&&s.value.property===void 0,S=!E,R=si(s.value.stops)==="array"&&si(s.value.stops[0])==="array"&&si(s.value.stops[0][0])==="object",O=Xn({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(j){if(r==="identity")return[new Ve(j.key,j.value,'identity function may not have a "stops" property')];let V=[];const Y=j.value;return V=V.concat(hu({key:j.key,value:Y,valueSpec:j.valueSpec,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:B})),si(Y)==="array"&&Y.length===0&&V.push(new Ve(j.key,Y,"array must have at least one stop")),V},default:function(j){return j.validateSpec({key:j.key,value:j.value,valueSpec:t,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec})}}});return r==="identity"&&E&&O.push(new Ve(s.key,s.value,'missing required property "property"')),r==="identity"||s.value.stops||O.push(new Ve(s.key,s.value,'missing required property "stops"')),r==="exponential"&&s.valueSpec.expression&&!zl(s.valueSpec)&&O.push(new Ve(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(S&&!xo(s.valueSpec)?O.push(new Ve(s.key,s.value,"property functions not supported")):E&&!ru(s.valueSpec)&&O.push(new Ve(s.key,s.value,"zoom functions not supported"))),r!=="categorical"&&!R||s.value.property!==void 0||O.push(new Ve(s.key,s.value,'"property" property is required')),O;function B(j){let V=[];const Y=j.value,ee=j.key;if(si(Y)!=="array")return[new Ve(ee,Y,`array expected, ${si(Y)} found`)];if(Y.length!==2)return[new Ve(ee,Y,`array length 2 expected, length ${Y.length} found`)];if(R){if(si(Y[0])!=="object")return[new Ve(ee,Y,`object expected, ${si(Y[0])} found`)];if(Y[0].zoom===void 0)return[new Ve(ee,Y,"object stop key must have zoom")];if(Y[0].value===void 0)return[new Ve(ee,Y,"object stop key must have value")];if(b&&b>Hi(Y[0].zoom))return[new Ve(ee,Y[0].zoom,"stop zoom values must appear in ascending order")];Hi(Y[0].zoom)!==b&&(b=Hi(Y[0].zoom),p=void 0,x={}),V=V.concat(Xn({key:`${ee}[0]`,value:Y[0],valueSpec:{zoom:{}},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:zs,value:U}}))}else V=V.concat(U({key:`${ee}[0]`,value:Y[0],validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec},Y));return uu(Bs(Y[1]))?V.concat([new Ve(`${ee}[1]`,Y[1],"expressions are not allowed in function stops.")]):V.concat(j.validateSpec({key:`${ee}[1]`,value:Y[1],valueSpec:t,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec}))}function U(j,V){const Y=si(j.value),ee=Hi(j.value),oe=j.value!==null?j.value:V;if(l){if(Y!==l)return[new Ve(j.key,oe,`${Y} stop domain type must match previous stop domain type ${l}`)]}else l=Y;if(Y!=="number"&&Y!=="string"&&Y!=="boolean")return[new Ve(j.key,oe,"stop domain value must be a number, string, or boolean")];if(Y!=="number"&&r!=="categorical"){let xe=`number expected, ${Y} found`;return xo(t)&&r===void 0&&(xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ve(j.key,oe,xe)]}return r!=="categorical"||Y!=="number"||isFinite(ee)&&Math.floor(ee)===ee?r!=="categorical"&&Y==="number"&&p!==void 0&&ee<p?[new Ve(j.key,oe,"stop domain values must appear in ascending order")]:(p=ee,r==="categorical"&&ee in x?[new Ve(j.key,oe,"stop domain values must be unique")]:(x[ee]=!0,[])):[new Ve(j.key,oe,`integer expected, found ${ee}`)]}}function Qn(s){const t=(s.expressionContext==="property"?Ku:ks)(Bs(s.value),s.valueSpec);if(t.result==="error")return t.value.map(l=>new Ve(`${s.key}${l.key}`,s.value,l.message));const r=t.value.expression||t.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!r.outputDefined())return[new Ve(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!ss(r))return[new Ve(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!ss(r))return[new Ve(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!Xu(r,["zoom","feature-state"]))return[new Ve(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!On(r))return[new Ve(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hl(s){const t=s.key,r=s.value,l=si(r);return l!=="string"?[new Ve(t,r,`color expected, ${l} found`)]:pi.parse(String(r))?[]:[new Ve(t,r,`color expected, "${r}" found`)]}function Hr(s){const t=s.key,r=s.value,l=s.valueSpec,p=[];return Array.isArray(l.values)?l.values.indexOf(Hi(r))===-1&&p.push(new Ve(t,r,`expected one of [${l.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(l.values).indexOf(Hi(r))===-1&&p.push(new Ve(t,r,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(r)} found`)),p}function jr(s){return zr(Bs(s.value))?Qn(vi({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Fs(s)}function Fs(s){const t=s.value,r=s.key;if(si(t)!=="array")return[new Ve(r,t,`array expected, ${si(t)} found`)];const l=s.styleSpec;let p,b=[];if(t.length<1)return[new Ve(r,t,"filter array must have at least 1 element")];switch(b=b.concat(Hr({key:`${r}[0]`,value:t[0],valueSpec:l.filter_operator,style:s.style,styleSpec:s.styleSpec})),Hi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Hi(t[1])==="$type"&&b.push(new Ve(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&b.push(new Ve(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(p=si(t[1]),p!=="string"&&b.push(new Ve(`${r}[1]`,t[1],`string expected, ${p} found`)));for(let x=2;x<t.length;x++)p=si(t[x]),Hi(t[1])==="$type"?b=b.concat(Hr({key:`${r}[${x}]`,value:t[x],valueSpec:l.geometry_type,style:s.style,styleSpec:s.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&b.push(new Ve(`${r}[${x}]`,t[x],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let x=1;x<t.length;x++)b=b.concat(Fs({key:`${r}[${x}]`,value:t[x],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":p=si(t[1]),t.length!==2?b.push(new Ve(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):p!=="string"&&b.push(new Ve(`${r}[1]`,t[1],`string expected, ${p} found`))}return b}function ls(s,t){const r=s.key,l=s.validateSpec,p=s.style,b=s.styleSpec,x=s.value,E=s.objectKey,S=b[`${t}_${s.layerType}`];if(!S)return[];const R=E.match(/^(.*)-transition$/);if(t==="paint"&&R&&S[R[1]]&&S[R[1]].transition)return l({key:r,value:x,valueSpec:b.transition,style:p,styleSpec:b});const O=s.valueSpec||S[E];if(!O)return[new Ve(r,x,`unknown property "${E}"`)];let B;if(si(x)==="string"&&xo(O)&&!O.tokens&&(B=/^{([^}]+)}$/.exec(x)))return[new Ve(r,x,`"${E}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(B[1])} }\`.`)];const U=[];return s.layerType==="symbol"&&(E==="text-field"&&p&&!p.glyphs&&U.push(new Ve(r,x,'use of "text-field" requires a style "glyphs" property')),E==="text-font"&&Ns(Bs(x))&&Hi(x.type)==="identity"&&U.push(new Ve(r,x,'"text-font" does not support identity functions'))),U.concat(l({key:s.key,value:x,valueSpec:O,style:p,styleSpec:b,expressionContext:"property",propertyType:t,propertyKey:E}))}function Bc(s){return ls(s,"paint")}function To(s){return ls(s,"layout")}function cs(s){let t=[];const r=s.value,l=s.key,p=s.style,b=s.styleSpec;if(si(r)!=="object")return[new Ve(l,r,`object expected, ${si(r)} found`)];r.type||r.ref||t.push(new Ve(l,r,'either "type" or "ref" is required'));let x=Hi(r.type);const E=Hi(r.ref);if(r.id){const S=Hi(r.id);for(let R=0;R<s.arrayIndex;R++){const O=p.layers[R];Hi(O.id)===S&&t.push(new Ve(l,r.id,`duplicate layer id "${r.id}", previously used at line ${O.id.__line__}`))}}if("ref"in r){let S;["type","source","source-layer","filter","layout"].forEach(R=>{R in r&&t.push(new Ve(l,r[R],`"${R}" is prohibited for ref layers`))}),p.layers.forEach(R=>{Hi(R.id)===E&&(S=R)}),S?S.ref?t.push(new Ve(l,r.ref,"ref cannot reference another ref layer")):x=Hi(S.type):t.push(new Ve(l,r.ref,`ref layer "${E}" not found`))}else if(x!=="background")if(r.source){const S=p.sources&&p.sources[r.source],R=S&&Hi(S.type);S?R==="vector"&&x==="raster"?t.push(new Ve(l,r.source,`layer "${r.id}" requires a raster source`)):R!=="raster-dem"&&x==="hillshade"?t.push(new Ve(l,r.source,`layer "${r.id}" requires a raster-dem source`)):R==="raster"&&x!=="raster"?t.push(new Ve(l,r.source,`layer "${r.id}" requires a vector source`)):R!=="vector"||r["source-layer"]?R==="raster-dem"&&x!=="hillshade"?t.push(new Ve(l,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!r.paint||!r.paint["line-gradient"]||R==="geojson"&&S.lineMetrics||t.push(new Ve(l,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Ve(l,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new Ve(l,r.source,`source "${r.source}" not found`))}else t.push(new Ve(l,r,'missing required property "source"'));return t=t.concat(Xn({key:l,value:r,valueSpec:b.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${l}.type`,value:r.type,valueSpec:b.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:r,objectKey:"type"}),filter:jr,layout:S=>Xn({layer:r,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":R=>To(vi({layerType:x},R))}}),paint:S=>Xn({layer:r,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":R=>Bc(vi({layerType:x},R))}})}})),t}function Aa(s){const t=s.value,r=s.key,l=si(t);return l!=="string"?[new Ve(r,t,`string expected, ${l} found`)]:[]}const Dr={promoteId:function({key:s,value:t}){if(si(t)==="string")return Aa({key:s,value:t});{const r=[];for(const l in t)r.push(...Aa({key:`${s}.${l}`,value:t[l]}));return r}}};function tn(s){const t=s.value,r=s.key,l=s.styleSpec,p=s.style,b=s.validateSpec;if(!t.type)return[new Ve(r,t,'"type" is required')];const x=Hi(t.type);let E;switch(x){case"vector":case"raster":return E=Xn({key:r,value:t,valueSpec:l[`source_${x.replace("-","_")}`],style:s.style,styleSpec:l,objectElementValidators:Dr,validateSpec:b}),E;case"raster-dem":return E=function(S){var R;const O=(R=S.sourceName)!==null&&R!==void 0?R:"",B=S.value,U=S.styleSpec,j=U.source_raster_dem,V=S.style;let Y=[];const ee=si(B);if(B===void 0)return Y;if(ee!=="object")return Y.push(new Ve("source_raster_dem",B,`object expected, ${ee} found`)),Y;const oe=Hi(B.encoding)==="custom",xe=["redFactor","greenFactor","blueFactor","baseShift"],ue=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const H in B)!oe&&xe.includes(H)?Y.push(new Ve(H,B[H],`In "${O}": "${H}" is only valid when "encoding" is set to "custom". ${ue} encoding found`)):j[H]?Y=Y.concat(S.validateSpec({key:H,value:B[H],valueSpec:j[H],validateSpec:S.validateSpec,style:V,styleSpec:U})):Y.push(new Ve(H,B[H],`unknown property "${H}"`));return Y}({sourceName:r,value:t,style:s.style,styleSpec:l,validateSpec:b}),E;case"geojson":if(E=Xn({key:r,value:t,valueSpec:l.source_geojson,style:p,styleSpec:l,validateSpec:b,objectElementValidators:Dr}),t.cluster)for(const S in t.clusterProperties){const[R,O]=t.clusterProperties[S],B=typeof R=="string"?[R,["accumulated"],["get",S]]:R;E.push(...Qn({key:`${r}.${S}.map`,value:O,expressionContext:"cluster-map"})),E.push(...Qn({key:`${r}.${S}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return E;case"video":return Xn({key:r,value:t,valueSpec:l.source_video,style:p,validateSpec:b,styleSpec:l});case"image":return Xn({key:r,value:t,valueSpec:l.source_image,style:p,validateSpec:b,styleSpec:l});case"canvas":return[new Ve(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Hr({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function jl(s){const t=s.value,r=s.styleSpec,l=r.light,p=s.style;let b=[];const x=si(t);if(t===void 0)return b;if(x!=="object")return b=b.concat([new Ve("light",t,`object expected, ${x} found`)]),b;for(const E in t){const S=E.match(/^(.*)-transition$/);b=b.concat(S&&l[S[1]]&&l[S[1]].transition?s.validateSpec({key:E,value:t[E],valueSpec:r.transition,validateSpec:s.validateSpec,style:p,styleSpec:r}):l[E]?s.validateSpec({key:E,value:t[E],valueSpec:l[E],validateSpec:s.validateSpec,style:p,styleSpec:r}):[new Ve(E,t[E],`unknown property "${E}"`)])}return b}function zh(s){const t=s.value,r=s.styleSpec,l=r.sky,p=s.style,b=si(t);if(t===void 0)return[];if(b!=="object")return[new Ve("sky",t,`object expected, ${b} found`)];let x=[];for(const E in t)x=x.concat(l[E]?s.validateSpec({key:E,value:t[E],valueSpec:l[E],style:p,styleSpec:r}):[new Ve(E,t[E],`unknown property "${E}"`)]);return x}function Ju(s){const t=s.value,r=s.styleSpec,l=r.terrain,p=s.style;let b=[];const x=si(t);if(t===void 0)return b;if(x!=="object")return b=b.concat([new Ve("terrain",t,`object expected, ${x} found`)]),b;for(const E in t)b=b.concat(l[E]?s.validateSpec({key:E,value:t[E],valueSpec:l[E],validateSpec:s.validateSpec,style:p,styleSpec:r}):[new Ve(E,t[E],`unknown property "${E}"`)]);return b}function Fh(s){let t=[];const r=s.value,l=s.key;if(Array.isArray(r)){const p=[],b=[];for(const x in r)r[x].id&&p.includes(r[x].id)&&t.push(new Ve(l,r,`all the sprites' ids must be unique, but ${r[x].id} is duplicated`)),p.push(r[x].id),r[x].url&&b.includes(r[x].url)&&t.push(new Ve(l,r,`all the sprites' URLs must be unique, but ${r[x].url} is duplicated`)),b.push(r[x].url),t=t.concat(Xn({key:`${l}[${x}]`,value:r[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return t}return Aa({key:l,value:r})}function zc(s){return t=s.value,t&&t.constructor===Object?[]:[new Ve(s.key,s.value,`object expected, ${si(s.value)} found`)];var t}const Ua={"*":()=>[],array:hu,boolean:function(s){const t=s.value,r=s.key,l=si(t);return l!=="boolean"?[new Ve(r,t,`boolean expected, ${l} found`)]:[]},number:zs,color:Hl,constants:cu,enum:Hr,filter:jr,function:kc,layer:cs,object:Xn,source:tn,light:jl,sky:zh,terrain:Ju,projection:function(s){const t=s.value,r=s.styleSpec,l=r.projection,p=s.style,b=si(t);if(t===void 0)return[];if(b!=="object")return[new Ve("projection",t,`object expected, ${b} found`)];let x=[];for(const E in t)x=x.concat(l[E]?s.validateSpec({key:E,value:t[E],valueSpec:l[E],style:p,styleSpec:r}):[new Ve(E,t[E],`unknown property "${E}"`)]);return x},projectionDefinition:function(s){const t=s.key;let r=s.value;r=r instanceof String?r.valueOf():r;const l=si(r);return l!=="array"||function(p){return Array.isArray(p)&&p.length===3&&typeof p[0]=="string"&&typeof p[1]=="string"&&typeof p[2]=="number"}(r)||function(p){return!!["interpolate","step","literal"].includes(p[0])}(r)?["array","string"].includes(l)?[]:[new Ve(t,r,`projection expected, invalid type "${l}" found`)]:[new Ve(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Aa,formatted:function(s){return Aa(s).length===0?[]:Qn(s)},resolvedImage:function(s){return Aa(s).length===0?[]:Qn(s)},padding:function(s){const t=s.key,r=s.value;if(si(r)==="array"){if(r.length<1||r.length>4)return[new Ve(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const l={type:"number"};let p=[];for(let b=0;b<r.length;b++)p=p.concat(s.validateSpec({key:`${t}[${b}]`,value:r[b],validateSpec:s.validateSpec,valueSpec:l}));return p}return zs({key:t,value:r,valueSpec:{}})},numberArray:function(s){const t=s.key,r=s.value;if(si(r)==="array"){const l={type:"number"};if(r.length<1)return[new Ve(t,r,"array length at least 1 expected, length 0 found")];let p=[];for(let b=0;b<r.length;b++)p=p.concat(s.validateSpec({key:`${t}[${b}]`,value:r[b],validateSpec:s.validateSpec,valueSpec:l}));return p}return zs({key:t,value:r,valueSpec:{}})},colorArray:function(s){const t=s.key,r=s.value;if(si(r)==="array"){if(r.length<1)return[new Ve(t,r,"array length at least 1 expected, length 0 found")];let l=[];for(let p=0;p<r.length;p++)l=l.concat(Hl({key:`${t}[${p}]`,value:r[p]}));return l}return Hl({key:t,value:r})},variableAnchorOffsetCollection:function(s){const t=s.key,r=s.value,l=si(r),p=s.styleSpec;if(l!=="array"||r.length<1||r.length%2!=0)return[new Ve(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let b=[];for(let x=0;x<r.length;x+=2)b=b.concat(Hr({key:`${t}[${x}]`,value:r[x],valueSpec:p.layout_symbol["text-anchor"]})),b=b.concat(hu({key:`${t}[${x+1}]`,value:r[x+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:p}));return b},sprite:Fh,state:zc};function Eo(s){const t=s.value,r=s.valueSpec,l=s.styleSpec;return s.validateSpec=Eo,r.expression&&Ns(Hi(t))?kc(s):r.expression&&uu(Bs(t))?Qn(s):r.type&&Ua[r.type]?Ua[r.type](s):Xn(vi({},s,{valueSpec:r.type?l[r.type]:r}))}function el(s){const t=s.value,r=s.key,l=Aa(s);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Ve(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Ve(r,t,'"glyphs" url must include a "{range}" token'))),l}function Ha(s,t=te){let r=[];return r=r.concat(Eo({key:"",value:s,valueSpec:t.$root,styleSpec:t,style:s,validateSpec:Eo,objectElementValidators:{glyphs:el,"*":()=>[]}})),s.constants&&(r=r.concat(cu({key:"constants",value:s.constants}))),qr(r)}function fr(s){return function(t){return s({...t,validateSpec:Eo})}}function qr(s){return[].concat(s).sort((t,r)=>t.line-r.line)}function Tn(s){return function(...t){return qr(s.apply(this,t))}}Ha.source=Tn(fr(tn)),Ha.sprite=Tn(fr(Fh)),Ha.glyphs=Tn(fr(el)),Ha.light=Tn(fr(jl)),Ha.sky=Tn(fr(zh)),Ha.terrain=Tn(fr(Ju)),Ha.state=Tn(fr(zc)),Ha.layer=Tn(fr(cs)),Ha.filter=Tn(fr(jr)),Ha.paintProperty=Tn(fr(Bc)),Ha.layoutProperty=Tn(fr(To));const tl=Ha,ql=tl.light,Gf=tl.sky,Fc=tl.paintProperty,hs=tl.layoutProperty;function Vl(s,t){let r=!1;if(t&&t.length)for(const l of t)s.fire(new he(new Error(l.message))),r=!0;return r}class Us{constructor(t,r,l){const p=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const x=new Int32Array(this.arrayBuffer);t=x[0],this.d=(r=x[1])+2*(l=x[2]);for(let S=0;S<this.d*this.d;S++){const R=x[3+S],O=x[3+S+1];p.push(R===O?null:x.subarray(R,O))}const E=x[3+p.length+1];this.keys=x.subarray(x[3+p.length],E),this.bboxes=x.subarray(E),this.insert=this._insertReadonly}else{this.d=r+2*l;for(let x=0;x<this.d*this.d;x++)p.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=l,this.scale=r/t,this.uid=0;const b=l/r*t;this.min=-b,this.max=t+b}insert(t,r,l,p,b){this._forEachCell(r,l,p,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,l,p,b,x){this.cells[b].push(x)}query(t,r,l,p,b){const x=this.min,E=this.max;if(t<=x&&r<=x&&E<=l&&E<=p&&!b)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(t,r,l,p,this._queryCell,S,{},b),S}}_queryCell(t,r,l,p,b,x,E,S){const R=this.cells[b];if(R!==null){const O=this.keys,B=this.bboxes;for(let U=0;U<R.length;U++){const j=R[U];if(E[j]===void 0){const V=4*j;(S?S(B[V+0],B[V+1],B[V+2],B[V+3]):t<=B[V+2]&&r<=B[V+3]&&l>=B[V+0]&&p>=B[V+1])?(E[j]=!0,x.push(O[j])):E[j]=!1}}}}_forEachCell(t,r,l,p,b,x,E,S){const R=this._convertToCellCoord(t),O=this._convertToCellCoord(r),B=this._convertToCellCoord(l),U=this._convertToCellCoord(p);for(let j=R;j<=B;j++)for(let V=O;V<=U;V++){const Y=this.d*V+j;if((!S||S(this._convertFromCellCoord(j),this._convertFromCellCoord(V),this._convertFromCellCoord(j+1),this._convertFromCellCoord(V+1)))&&b.call(this,t,r,l,p,Y,x,E,S))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,r=3+this.cells.length+1+1;let l=0;for(let x=0;x<this.cells.length;x++)l+=this.cells[x].length;const p=new Int32Array(r+l+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let b=r;for(let x=0;x<t.length;x++){const E=t[x];p[3+x]=b,p.set(E,b),b+=E.length}return p[3+t.length]=b,p.set(this.keys,b),b+=this.keys.length,p[3+t.length+1]=b,p.set(this.bboxes,b),b+=this.bboxes.length,p.buffer}static serialize(t,r){const l=t.toArrayBuffer();return r&&r.push(l),{buffer:l}}static deserialize(t){return new Us(t.buffer)}}const Vr={};function yt(s,t,r={}){if(Vr[s])throw new Error(`${s} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:s,writeable:!1}),Vr[s]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}yt("Object",Object),yt("TransferableGridIndex",Us),yt("Color",pi),yt("Error",Error),yt("AJAXError",wr),yt("ResolvedImage",Ln),yt("StylePropertyFunction",bn),yt("StyleExpression",Qu,{omit:["_evaluator"]}),yt("ZoomDependentExpression",lu),yt("ZoomConstantExpression",vo),yt("CompoundExpression",cr,{omit:["_evaluate"]});for(const s in $u)$u[s]._classRegistryKey||yt(`Expression_${s}`,$u[s]);function Gl(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function du(s){return s.$name||s.constructor._classRegistryKey}function Uc(s){return!function(t){if(t===null||typeof t!="object")return!1;const r=du(t);return!(!r||r==="Object")}(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||Gl(s)||Ra(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function fu(s,t){if(Uc(s))return(Gl(s)||Ra(s))&&t&&t.push(s),ArrayBuffer.isView(s)&&t&&t.push(s.buffer),s instanceof ImageData&&t&&t.push(s.data.buffer),s;if(Array.isArray(s)){const b=[];for(const x of s)b.push(fu(x,t));return b}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const r=du(s);if(!r)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!Vr[r])throw new Error(`${r} is not registered.`);const{klass:l}=Vr[r],p=l.serialize?l.serialize(s,t):{};if(l.serialize){if(t&&p===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in s){if(!s.hasOwnProperty(b)||Vr[r].omit.indexOf(b)>=0)continue;const x=s[b];p[b]=Vr[r].shallow.indexOf(b)>=0?x:fu(x,t)}s instanceof Error&&(p.message=s.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(p.$name=r),p}function wo(s){if(Uc(s))return s;if(Array.isArray(s))return s.map(wo);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const t=du(s)||"Object";if(!Vr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=Vr[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(s);const l=Object.create(r.prototype);for(const p of Object.keys(s)){if(p==="$name")continue;const b=s[p];l[p]=Vr[t].shallow.indexOf(p)>=0?b:wo(b)}return l}class Hc{constructor(){this.first=!0}update(t,r){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}const ri={"Latin-1 Supplement":s=>s>=128&&s<=255,"Hangul Jamo":s=>s>=4352&&s<=4607,Khmer:s=>s>=6016&&s<=6143,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Kanbun:s=>s>=12688&&s<=12703,"CJK Strokes":s=>s>=12736&&s<=12783,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Hangul Syllables":s=>s>=44032&&s<=55215,"Private Use Area":s=>s>=57344&&s<=63743,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Zl(s){for(const t of s)if(Gr(t.charCodeAt(0)))return!0;return!1}function Nd(s){for(const t of s)if(!qc(t.charCodeAt(0)))return!1;return!0}function ds(s){const t=s.map(r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}}).filter(r=>r);return new RegExp(t.join("|"),"u")}const jc=ds(["Arab","Dupl","Mong","Ougr","Syrc"]);function qc(s){return!jc.test(String.fromCodePoint(s))}const fs=ds(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Gr(s){return!(s!==746&&s!==747&&(s<4352||!(ri["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||ri["CJK Compatibility"](s)||ri["CJK Strokes"](s)||!(!ri["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||ri["Enclosed CJK Letters and Months"](s)||ri["Ideographic Description Characters"](s)||ri.Kanbun(s)||ri.Katakana(s)&&s!==12540||!(!ri["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!ri["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||ri["Vertical Forms"](s)||ri["Yijing Hexagram Symbols"](s)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(s))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(s))||fs.test(String.fromCodePoint(s)))))}function Hs(s){return!(Gr(s)||function(t){return!!(ri["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||ri["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||ri["Letterlike Symbols"](t)||ri["Number Forms"](t)||ri["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||ri["Control Pictures"](t)&&t!==9251||ri["Optical Character Recognition"](t)||ri["Enclosed Alphanumerics"](t)||ri["Geometric Shapes"](t)||ri["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||ri["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ri["CJK Symbols and Punctuation"](t)||ri.Katakana(t)||ri["Private Use Area"](t)||ri["CJK Compatibility Forms"](t)||ri["Small Form Variants"](t)||ri["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(s))}const Uh=ds(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function il(s){return Uh.test(String.fromCodePoint(s))}function Yl(s,t){return!(!t&&il(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||ri.Khmer(s))}function $l(s){for(const t of s)if(il(t.charCodeAt(0)))return!0;return!1}const ps=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){if(ps.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(s,t){return d(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(s.pluginStatus!=="loading")return this.setState(s),s;const r=s.pluginURL,l=new Promise(b=>{this.loadScriptResolve=b});t(r);const p=new Promise(b=>setTimeout(()=>b(),this.TIMEOUT));if(yield Promise.race([l,p]),this.isParsed()){const b={pluginStatus:"loaded",pluginURL:r};return this.setState(b),b}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${r}`)})}};class Yi{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Hc,this.transition={})}isSupportedScript(t){return function(r,l){for(const p of r)if(!Yl(p.charCodeAt(0),l))return!1;return!0}(t,ps.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,r=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*r}}}class ms{constructor(t,r){this.property=t,this.value=r,this.expression=function(l,p){if(Ns(l))return new bn(l,p);if(uu(l)){const b=Ku(l,p);if(b.result==="error")throw new Error(b.value.map(x=>`${x.key}: ${x.message}`).join(", "));return b.value}{let b=l;return p.type==="color"&&typeof l=="string"?b=pi.parse(l):p.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?p.type!=="numberArray"||typeof l!="number"&&!Array.isArray(l)?p.type!=="colorArray"||typeof l!="string"&&!Array.isArray(l)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(l)?b=ma.parse(l):p.type==="projectionDefinition"&&typeof l=="string"&&(b=Wa.parse(l)):b=Ga.parse(l):b=Ea.parse(l):b=Ta.parse(l),{kind:"constant",evaluate:()=>b}}}(r===void 0?t.specification.default:r,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,l){return this.property.possiblyEvaluate(this,t,r,l)}}class al{constructor(t){this.property=t,this.value=new ms(t,void 0)}transitioned(t,r){return new Vc(this.property,this.value,r,aa({},t.transition,this.transition),t.now)}untransitioned(){return new Vc(this.property,this.value,null,{},0)}}class Hh{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return gn(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new al(this._values[t].property)),this._values[t].value=new ms(this._values[t].property,r===null?void 0:gn(r))}getTransition(t){return gn(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new al(this._values[t].property)),this._values[t].transition=gn(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(t[r]=l);const p=this.getTransition(r);p!==void 0&&(t[`${r}-transition`]=p)}return t}transitioned(t,r){const l=new Gc(this._properties);for(const p of Object.keys(this._values))l._values[p]=this._values[p].transitioned(t,r._values[p]);return l}untransitioned(){const t=new Gc(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class Vc{constructor(t,r,l,p,b){this.property=t,this.value=r,this.begin=b+p.delay||0,this.end=this.begin+p.duration||0,t.specification.transition&&(p.delay||p.duration)&&(this.prior=l)}possiblyEvaluate(t,r,l){const p=t.now||0,b=this.value.possiblyEvaluate(t,r,l),x=this.prior;if(x){if(p>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(p<this.begin)return x.possiblyEvaluate(t,r,l);{const E=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(t,r,l),b,xt(E))}}return b}}class Gc{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,l){const p=new Ri(this._properties);for(const b of Object.keys(this._values))p._values[b]=this._values[b].possiblyEvaluate(t,r,l);return p}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Ao{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return gn(this._values[t].value)}setValue(t,r){this._values[t]=new ms(this._values[t].property,r===null?void 0:gn(r))}serialize(){const t={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(t[r]=l)}return t}possiblyEvaluate(t,r,l){const p=new Ri(this._properties);for(const b of Object.keys(this._values))p._values[b]=this._values[b].possiblyEvaluate(t,r,l);return p}}class qt{constructor(t,r,l){this.property=t,this.value=r,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,l,p){return this.property.evaluate(this.value,this.parameters,t,r,l,p)}}class Ri{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class gt{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,l){const p=as[this.specification.type];return p?p(t,r,l):t}}class zt{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,l,p){return new qt(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},l,p)}:t.expression,r)}interpolate(t,r,l){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new qt(this,{kind:"constant",value:void 0},t.parameters);const p=as[this.specification.type];if(p){const b=p(t.value.value,r.value.value,l);return new qt(this,{kind:"constant",value:b},t.parameters)}return t}evaluate(t,r,l,p,b,x){return t.kind==="constant"?t.value:t.evaluate(r,l,p,b,x)}}class gs extends zt{possiblyEvaluate(t,r,l,p){if(t.value===void 0)return new qt(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){const b=t.expression.evaluate(r,null,{},l,p),x=t.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,E=this._calculate(x,x,x,r);return new qt(this,{kind:"constant",value:E},r)}if(t.expression.kind==="camera"){const b=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new qt(this,{kind:"constant",value:b},r)}return new qt(this,t.expression,r)}evaluate(t,r,l,p,b,x){if(t.kind==="source"){const E=t.evaluate(r,l,p,b,x);return this._calculate(E,E,E,r)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},l,p),t.evaluate({zoom:Math.floor(r.zoom)},l,p),t.evaluate({zoom:Math.floor(r.zoom)+1},l,p),r):t.value}_calculate(t,r,l,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:l,to:r}}interpolate(t){return t}}class js{constructor(t){this.specification=t}possiblyEvaluate(t,r,l,p){if(t.value!==void 0){if(t.expression.kind==="constant"){const b=t.expression.evaluate(r,null,{},l,p);return this._calculate(b,b,b,r)}return this._calculate(t.expression.evaluate(new Yi(Math.floor(r.zoom-1),r)),t.expression.evaluate(new Yi(Math.floor(r.zoom),r)),t.expression.evaluate(new Yi(Math.floor(r.zoom+1),r)),r)}}_calculate(t,r,l,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:l,to:r}}interpolate(t){return t}}class nl{constructor(t){this.specification=t}possiblyEvaluate(t,r,l,p){return!!t.expression.evaluate(r,null,{},l,p)}interpolate(){return!1}}class ca{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in t){const l=t[r];l.specification.overridable&&this.overridableProperties.push(r);const p=this.defaultPropertyValues[r]=new ms(l,void 0),b=this.defaultTransitionablePropertyValues[r]=new al(l);this.defaultTransitioningPropertyValues[r]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=p.possiblyEvaluate({})}}}yt("DataDrivenProperty",zt),yt("DataConstantProperty",gt),yt("CrossFadedDataDrivenProperty",gs),yt("CrossFadedProperty",js),yt("ColorRampProperty",nl);const So="-transition";class Rr extends ve{constructor(t,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new Ao(r.layout)),r.paint)){this._transitionablePaint=new Hh(r.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ri(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,l={}){r!=null&&this._validate(hs,`layers.${this.id}.layout.${t}`,t,r,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,r):this.visibility=r)}getPaintProperty(t){return t.endsWith(So)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,l={}){if(r!=null&&this._validate(Fc,`layers.${this.id}.paint.${t}`,t,r,l))return!1;if(t.endsWith(So))return this._transitionablePaint.setTransition(t.slice(0,-11),r||void 0),!1;{const p=this._transitionablePaint._values[t],b=p.property.specification["property-type"]==="cross-faded-data-driven",x=p.value.isDataDriven(),E=p.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);const S=this._transitionablePaint._values[t].value;return S.isDataDriven()||x||b||this._handleOverridablePaintPropertyUpdate(t,E,S)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Bo(t,(r,l)=>!(r===void 0||l==="layout"&&!Object.keys(r).length||l==="paint"&&!Object.keys(r).length))}_validate(t,r,l,p,b={}){return(!b||b.validate!==!1)&&Vl(this,t.call(tl,{key:r,layerType:this.type,objectKey:l,value:p,styleSpec:te,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof qt&&xo(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const Sa={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class qs{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class na{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ra(s,t=1){let r=0,l=0;return{members:s.map(p=>{const b=Sa[p.type].BYTES_PER_ELEMENT,x=r=pu(r,Math.max(t,b)),E=p.components||1;return l=Math.max(l,b),r+=b*E,{name:p.name,type:p.type,components:E,offset:x}}),size:pu(r,Math.max(l,t)),alignment:t}}function pu(s,t){return Math.ceil(s/t)*t}class Xl extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const p=2*t;return this.int16[p+0]=r,this.int16[p+1]=l,t}}Xl.prototype.bytesPerElement=4,yt("StructArrayLayout2i4",Xl);class mu extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l)}emplace(t,r,l,p){const b=3*t;return this.int16[b+0]=r,this.int16[b+1]=l,this.int16[b+2]=p,t}}mu.prototype.bytesPerElement=6,yt("StructArrayLayout3i6",mu);class Vs extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,p){const b=this.length;return this.resize(b+1),this.emplace(b,t,r,l,p)}emplace(t,r,l,p,b){const x=4*t;return this.int16[x+0]=r,this.int16[x+1]=l,this.int16[x+2]=p,this.int16[x+3]=b,t}}Vs.prototype.bytesPerElement=8,yt("StructArrayLayout4i8",Vs);class Ql extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,p,b,x){const E=this.length;return this.resize(E+1),this.emplace(E,t,r,l,p,b,x)}emplace(t,r,l,p,b,x,E){const S=6*t;return this.int16[S+0]=r,this.int16[S+1]=l,this.int16[S+2]=p,this.int16[S+3]=b,this.int16[S+4]=x,this.int16[S+5]=E,t}}Ql.prototype.bytesPerElement=12,yt("StructArrayLayout2i4i12",Ql);class En extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,p,b,x){const E=this.length;return this.resize(E+1),this.emplace(E,t,r,l,p,b,x)}emplace(t,r,l,p,b,x,E){const S=4*t,R=8*t;return this.int16[S+0]=r,this.int16[S+1]=l,this.uint8[R+4]=p,this.uint8[R+5]=b,this.uint8[R+6]=x,this.uint8[R+7]=E,t}}En.prototype.bytesPerElement=8,yt("StructArrayLayout2i4ub8",En);class sa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const p=2*t;return this.float32[p+0]=r,this.float32[p+1]=l,t}}sa.prototype.bytesPerElement=8,yt("StructArrayLayout2f8",sa);class Kl extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,p,b,x,E,S,R,O){const B=this.length;return this.resize(B+1),this.emplace(B,t,r,l,p,b,x,E,S,R,O)}emplace(t,r,l,p,b,x,E,S,R,O,B){const U=10*t;return this.uint16[U+0]=r,this.uint16[U+1]=l,this.uint16[U+2]=p,this.uint16[U+3]=b,this.uint16[U+4]=x,this.uint16[U+5]=E,this.uint16[U+6]=S,this.uint16[U+7]=R,this.uint16[U+8]=O,this.uint16[U+9]=B,t}}Kl.prototype.bytesPerElement=20,yt("StructArrayLayout10ui20",Kl);class g extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,p,b,x,E,S,R,O,B,U){const j=this.length;return this.resize(j+1),this.emplace(j,t,r,l,p,b,x,E,S,R,O,B,U)}emplace(t,r,l,p,b,x,E,S,R,O,B,U,j){const V=12*t;return this.int16[V+0]=r,this.int16[V+1]=l,this.int16[V+2]=p,this.int16[V+3]=b,this.uint16[V+4]=x,this.uint16[V+5]=E,this.uint16[V+6]=S,this.uint16[V+7]=R,this.int16[V+8]=O,this.int16[V+9]=B,this.int16[V+10]=U,this.int16[V+11]=j,t}}g.prototype.bytesPerElement=24,yt("StructArrayLayout4i4ui4i24",g);class e extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l)}emplace(t,r,l,p){const b=3*t;return this.float32[b+0]=r,this.float32[b+1]=l,this.float32[b+2]=p,t}}e.prototype.bytesPerElement=12,yt("StructArrayLayout3f12",e);class n extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}n.prototype.bytesPerElement=4,yt("StructArrayLayout1ul4",n);class c extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,p,b,x,E,S,R){const O=this.length;return this.resize(O+1),this.emplace(O,t,r,l,p,b,x,E,S,R)}emplace(t,r,l,p,b,x,E,S,R,O){const B=10*t,U=5*t;return this.int16[B+0]=r,this.int16[B+1]=l,this.int16[B+2]=p,this.int16[B+3]=b,this.int16[B+4]=x,this.int16[B+5]=E,this.uint32[U+3]=S,this.uint16[B+8]=R,this.uint16[B+9]=O,t}}c.prototype.bytesPerElement=20,yt("StructArrayLayout6i1ul2ui20",c);class f extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,p,b,x){const E=this.length;return this.resize(E+1),this.emplace(E,t,r,l,p,b,x)}emplace(t,r,l,p,b,x,E){const S=6*t;return this.int16[S+0]=r,this.int16[S+1]=l,this.int16[S+2]=p,this.int16[S+3]=b,this.int16[S+4]=x,this.int16[S+5]=E,t}}f.prototype.bytesPerElement=12,yt("StructArrayLayout2i2i2i12",f);class y extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,p,b){const x=this.length;return this.resize(x+1),this.emplace(x,t,r,l,p,b)}emplace(t,r,l,p,b,x){const E=4*t,S=8*t;return this.float32[E+0]=r,this.float32[E+1]=l,this.float32[E+2]=p,this.int16[S+6]=b,this.int16[S+7]=x,t}}y.prototype.bytesPerElement=16,yt("StructArrayLayout2f1f2i16",y);class T extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,p,b,x){const E=this.length;return this.resize(E+1),this.emplace(E,t,r,l,p,b,x)}emplace(t,r,l,p,b,x,E){const S=16*t,R=4*t,O=8*t;return this.uint8[S+0]=r,this.uint8[S+1]=l,this.float32[R+1]=p,this.float32[R+2]=b,this.int16[O+6]=x,this.int16[O+7]=E,t}}T.prototype.bytesPerElement=16,yt("StructArrayLayout2ub2f2i16",T);class A extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l)}emplace(t,r,l,p){const b=3*t;return this.uint16[b+0]=r,this.uint16[b+1]=l,this.uint16[b+2]=p,t}}A.prototype.bytesPerElement=6,yt("StructArrayLayout3ui6",A);class I extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,p,b,x,E,S,R,O,B,U,j,V,Y,ee,oe){const xe=this.length;return this.resize(xe+1),this.emplace(xe,t,r,l,p,b,x,E,S,R,O,B,U,j,V,Y,ee,oe)}emplace(t,r,l,p,b,x,E,S,R,O,B,U,j,V,Y,ee,oe,xe){const ue=24*t,H=12*t,J=48*t;return this.int16[ue+0]=r,this.int16[ue+1]=l,this.uint16[ue+2]=p,this.uint16[ue+3]=b,this.uint32[H+2]=x,this.uint32[H+3]=E,this.uint32[H+4]=S,this.uint16[ue+10]=R,this.uint16[ue+11]=O,this.uint16[ue+12]=B,this.float32[H+7]=U,this.float32[H+8]=j,this.uint8[J+36]=V,this.uint8[J+37]=Y,this.uint8[J+38]=ee,this.uint32[H+10]=oe,this.int16[ue+22]=xe,t}}I.prototype.bytesPerElement=48,yt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",I);class L extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,p,b,x,E,S,R,O,B,U,j,V,Y,ee,oe,xe,ue,H,J,de,Oe,at,Ue,Ye,ot,rt){const ct=this.length;return this.resize(ct+1),this.emplace(ct,t,r,l,p,b,x,E,S,R,O,B,U,j,V,Y,ee,oe,xe,ue,H,J,de,Oe,at,Ue,Ye,ot,rt)}emplace(t,r,l,p,b,x,E,S,R,O,B,U,j,V,Y,ee,oe,xe,ue,H,J,de,Oe,at,Ue,Ye,ot,rt,ct){const Xe=32*t,Tt=16*t;return this.int16[Xe+0]=r,this.int16[Xe+1]=l,this.int16[Xe+2]=p,this.int16[Xe+3]=b,this.int16[Xe+4]=x,this.int16[Xe+5]=E,this.int16[Xe+6]=S,this.int16[Xe+7]=R,this.uint16[Xe+8]=O,this.uint16[Xe+9]=B,this.uint16[Xe+10]=U,this.uint16[Xe+11]=j,this.uint16[Xe+12]=V,this.uint16[Xe+13]=Y,this.uint16[Xe+14]=ee,this.uint16[Xe+15]=oe,this.uint16[Xe+16]=xe,this.uint16[Xe+17]=ue,this.uint16[Xe+18]=H,this.uint16[Xe+19]=J,this.uint16[Xe+20]=de,this.uint16[Xe+21]=Oe,this.uint16[Xe+22]=at,this.uint32[Tt+12]=Ue,this.float32[Tt+13]=Ye,this.float32[Tt+14]=ot,this.uint16[Xe+30]=rt,this.uint16[Xe+31]=ct,t}}L.prototype.bytesPerElement=64,yt("StructArrayLayout8i15ui1ul2f2ui64",L);class k extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}k.prototype.bytesPerElement=4,yt("StructArrayLayout1f4",k);class F extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l)}emplace(t,r,l,p){const b=3*t;return this.uint16[6*t+0]=r,this.float32[b+1]=l,this.float32[b+2]=p,t}}F.prototype.bytesPerElement=12,yt("StructArrayLayout1ui2f12",F);class z extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l)}emplace(t,r,l,p){const b=4*t;return this.uint32[2*t+0]=r,this.uint16[b+2]=l,this.uint16[b+3]=p,t}}z.prototype.bytesPerElement=8,yt("StructArrayLayout1ul2ui8",z);class G extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const p=2*t;return this.uint16[p+0]=r,this.uint16[p+1]=l,t}}G.prototype.bytesPerElement=4,yt("StructArrayLayout2ui4",G);class Z extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}Z.prototype.bytesPerElement=2,yt("StructArrayLayout1ui2",Z);class ne extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,p){const b=this.length;return this.resize(b+1),this.emplace(b,t,r,l,p)}emplace(t,r,l,p,b){const x=4*t;return this.float32[x+0]=r,this.float32[x+1]=l,this.float32[x+2]=p,this.float32[x+3]=b,t}}ne.prototype.bytesPerElement=16,yt("StructArrayLayout4f16",ne);class ae extends qs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Qe(this.anchorPointX,this.anchorPointY)}}ae.prototype.size=20;class re extends c{get(t){return new ae(this,t)}}yt("CollisionBoxArray",re);class le extends qs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}le.prototype.size=48;class me extends I{get(t){return new le(this,t)}}yt("PlacedSymbolArray",me);class pe extends qs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}pe.prototype.size=64;class ye extends L{get(t){return new pe(this,t)}}yt("SymbolInstanceArray",ye);class Ee extends k{getoffsetX(t){return this.float32[1*t+0]}}yt("GlyphOffsetArray",Ee);class be extends mu{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}yt("SymbolLineVertexArray",be);class Ne extends qs{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ne.prototype.size=12;class $e extends F{get(t){return new Ne(this,t)}}yt("TextAnchorOffsetArray",$e);class je extends qs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}je.prototype.size=8;class He extends z{get(t){return new je(this,t)}}yt("FeatureIndexArray",He);class Ge extends Xl{}class ft extends Xl{}class ht extends Xl{}class it extends Ql{}class St extends En{}class ii extends sa{}class di extends Kl{}class oa extends g{}class ki extends e{}class ua extends n{}class Ji extends f{}class ji extends T{}class wi extends A{}class La extends G{}const Za=ra([{name:"a_pos",components:2,type:"Int16"}],4),{members:an}=Za;class Si{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,r,l,p){const b=this.segments[this.segments.length-1];return t>Si.MAX_VERTEX_ARRAY_LENGTH&&on(`Max vertices per segment is ${Si.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Si.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!b||b.vertexLength+t>Si.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==p?this.createNewSegment(r,l,p):b}createNewSegment(t,r,l){const p={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return l!==void 0&&(p.sortKey=l),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(p),p}getOrCreateLatestSegment(t,r,l){return this.prepareSegment(0,t,r,l)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,l,p){return new Si([{vertexOffset:t,primitiveOffset:r,vertexLength:l,primitiveLength:p,vaos:{},sortKey:0}])}}function _s(s,t){return 256*(s=Xt(Math.floor(s),0,255))+Xt(Math.floor(t),0,255)}Si.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,yt("SegmentVector",Si);const Zr=ra([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Gs,Zs,rl,Ys={exports:{}},gu={exports:{}},pr={exports:{}},$s=function(){if(rl)return Ys.exports;rl=1;var s=(Gs||(Gs=1,gu.exports=function(r,l){var p,b,x,E,S,R,O,B;for(b=r.length-(p=3&r.length),x=l,S=3432918353,R=461845907,B=0;B<b;)O=255&r.charCodeAt(B)|(255&r.charCodeAt(++B))<<8|(255&r.charCodeAt(++B))<<16|(255&r.charCodeAt(++B))<<24,++B,x=27492+(65535&(E=5*(65535&(x=(x^=O=(65535&(O=(O=(65535&O)*S+(((O>>>16)*S&65535)<<16)&4294967295)<<15|O>>>17))*R+(((O>>>16)*R&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(O=0,p){case 3:O^=(255&r.charCodeAt(B+2))<<16;case 2:O^=(255&r.charCodeAt(B+1))<<8;case 1:x^=O=(65535&(O=(O=(65535&(O^=255&r.charCodeAt(B)))*S+(((O>>>16)*S&65535)<<16)&4294967295)<<15|O>>>17))*R+(((O>>>16)*R&65535)<<16)&4294967295}return x^=r.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),gu.exports),t=(Zs||(Zs=1,pr.exports=function(r,l){for(var p,b=r.length,x=l^b,E=0;b>=4;)p=1540483477*(65535&(p=255&r.charCodeAt(E)|(255&r.charCodeAt(++E))<<8|(255&r.charCodeAt(++E))<<16|(255&r.charCodeAt(++E))<<24))+((1540483477*(p>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),b-=4,++E;switch(b){case 3:x^=(255&r.charCodeAt(E+2))<<16;case 2:x^=(255&r.charCodeAt(E+1))<<8;case 1:x=1540483477*(65535&(x^=255&r.charCodeAt(E)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),pr.exports);return Ys.exports=s,Ys.exports.murmur3=s,Ys.exports.murmur2=t,Ys.exports}(),mr=K($s);class ys{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,l,p){this.ids.push(_a(t)),this.positions.push(r,l,p)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=_a(t);let l=0,p=this.ids.length-1;for(;l<p;){const x=l+p>>1;this.ids[x]>=r?p=x:l=x+1}const b=[];for(;this.ids[l]===r;)b.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return b}static serialize(t,r){const l=new Float64Array(t.ids),p=new Uint32Array(t.positions);return Na(l,p,0,l.length-1),r&&r.push(l.buffer,p.buffer),{ids:l,positions:p}}static deserialize(t){const r=new ys;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}function _a(s){const t=+s;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:mr(String(s))}function Na(s,t,r,l){for(;r<l;){const p=s[r+l>>1];let b=r-1,x=l+1;for(;;){do b++;while(s[b]<p);do x--;while(s[x]>p);if(b>=x)break;wn(s,b,x),wn(t,3*b,3*x),wn(t,3*b+1,3*x+1),wn(t,3*b+2,3*x+2)}x-r<l-x?(Na(s,t,r,x),r=x+1):(Na(s,t,x+1,l),l=x)}}function wn(s,t,r){const l=s[t];s[t]=s[r],s[r]=l}yt("FeaturePositionMap",ys);class Bi{constructor(t,r){this.gl=t.gl,this.location=r}}class Wl extends Bi{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class jh extends Bi{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Od extends Bi{constructor(t,r){super(t,r),this.current=pi.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const sl=new Float32Array(16);function _u(s){return[_s(255*s.r,255*s.g),_s(255*s.b,255*s.a)]}class Co{constructor(t,r,l){this.value=t,this.uniformNames=r.map(p=>`u_${p}`),this.type=l}setUniform(t,r,l){t.set(l.constantOr(this.value))}getBinding(t,r,l){return this.type==="color"?new Od(t,r):new Wl(t,r)}}class An{constructor(t,r){this.uniformNames=r.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,l,p){const b=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&t.set(b)}getBinding(t,r,l){return l.substr(0,9)==="u_pattern"?new jh(t,r):new Wl(t,r)}}class gr{constructor(t,r,l,p){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=r.map(b=>({name:`a_${b}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(t,r,l,p,b){const x=this.paintVertexArray.length,E=this.expression.evaluate(new Yi(0),r,{},p,[],b);this.paintVertexArray.resize(t),this._setPaintValue(x,t,E)}updatePaintArray(t,r,l,p){const b=this.expression.evaluate({zoom:0},l,p);this._setPaintValue(t,r,b)}_setPaintValue(t,r,l){if(this.type==="color"){const p=_u(l);for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,p[0],p[1])}else{for(let p=t;p<r;p++)this.paintVertexArray.emplace(p,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class _r{constructor(t,r,l,p,b,x){this.expression=t,this.uniformNames=r.map(E=>`u_${E}_t`),this.type=l,this.useIntegerZoom=p,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=r.map(E=>({name:`a_${E}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(t,r,l,p,b){const x=this.expression.evaluate(new Yi(this.zoom),r,{},p,[],b),E=this.expression.evaluate(new Yi(this.zoom+1),r,{},p,[],b),S=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(S,t,x,E)}updatePaintArray(t,r,l,p){const b=this.expression.evaluate({zoom:this.zoom},l,p),x=this.expression.evaluate({zoom:this.zoom+1},l,p);this._setPaintValue(t,r,b,x)}_setPaintValue(t,r,l,p){if(this.type==="color"){const b=_u(l),x=_u(p);for(let E=t;E<r;E++)this.paintVertexArray.emplace(E,b[0],b[1],x[0],x[1])}else{for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,l,p);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(p))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){const l=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,p=Xt(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(p)}getBinding(t,r,l){return new Wl(t,r)}}class bs{constructor(t,r,l,p,b,x){this.expression=t,this.type=r,this.useIntegerZoom=l,this.zoom=p,this.layerId=x,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(t,r,l){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(p,t,r.patterns&&r.patterns[this.layerId],l)}updatePaintArray(t,r,l,p,b){this._setPaintValues(t,r,l.patterns&&l.patterns[this.layerId],b)}_setPaintValues(t,r,l,p){if(!p||!l)return;const{min:b,mid:x,max:E}=l,S=p[b],R=p[x],O=p[E];if(S&&R&&O)for(let B=t;B<r;B++)this.zoomInPaintVertexArray.emplace(B,R.tl[0],R.tl[1],R.br[0],R.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],R.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(B,R.tl[0],R.tl[1],R.br[0],R.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],R.pixelRatio,O.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Zr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Zr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Xs{constructor(t,r,l){this.binders={},this._buffers=[];const p=[];for(const b in t.paint._values){if(!l(b))continue;const x=t.paint.get(b);if(!(x instanceof qt&&xo(x.property.specification)))continue;const E=Kn(b,t.type),S=x.value,R=x.property.specification.type,O=x.property.useIntegerZoom,B=x.property.specification["property-type"],U=B==="cross-faded"||B==="cross-faded-data-driven";if(S.kind==="constant")this.binders[b]=U?new An(S.value,E):new Co(S.value,E,R),p.push(`/u_${b}`);else if(S.kind==="source"||U){const j=Ks(b,R,"source");this.binders[b]=U?new bs(S,R,O,r,j,t.id):new gr(S,E,R,j),p.push(`/a_${b}`)}else{const j=Ks(b,R,"composite");this.binders[b]=new _r(S,E,R,O,r,j),p.push(`/z_${b}`)}}this.cacheKey=p.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof gr||r instanceof _r?r.maxValue:0}populatePaintArrays(t,r,l,p,b){for(const x in this.binders){const E=this.binders[x];(E instanceof gr||E instanceof _r||E instanceof bs)&&E.populatePaintArray(t,r,l,p,b)}}setConstantPatternPositions(t,r){for(const l in this.binders){const p=this.binders[l];p instanceof An&&p.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,l,p,b){let x=!1;for(const E in t){const S=r.getPositions(E);for(const R of S){const O=l.feature(R.index);for(const B in this.binders){const U=this.binders[B];if((U instanceof gr||U instanceof _r||U instanceof bs)&&U.expression.isStateDependent===!0){const j=p.paint.get(B);U.expression=j.value,U.updatePaintArray(R.start,R.end,O,t[E],b),x=!0}}}}return x}defines(){const t=[];for(const r in this.binders){const l=this.binders[r];(l instanceof Co||l instanceof An)&&t.push(...l.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof gr||l instanceof _r)for(let p=0;p<l.paintVertexAttributes.length;p++)t.push(l.paintVertexAttributes[p].name);else if(l instanceof bs)for(let p=0;p<Zr.members.length;p++)t.push(Zr.members[p].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof Co||l instanceof An||l instanceof _r)for(const p of l.uniformNames)t.push(p)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){const l=[];for(const p in this.binders){const b=this.binders[p];if(b instanceof Co||b instanceof An||b instanceof _r){for(const x of b.uniformNames)if(r[x]){const E=b.getBinding(t,r[x],x);l.push({name:x,property:p,binding:E})}}}return l}setUniforms(t,r,l,p){for(const{name:b,property:x,binding:E}of r)this.binders[x].setUniform(E,p,l.get(x),b)}updatePaintBuffers(t){this._buffers=[];for(const r in this.binders){const l=this.binders[r];if(t&&l instanceof bs){const p=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(l instanceof gr||l instanceof _r)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const r in this.binders){const l=this.binders[r];(l instanceof gr||l instanceof _r||l instanceof bs)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof gr||r instanceof _r||r instanceof bs)&&r.destroy()}}}class Qs{constructor(t,r,l=()=>!0){this.programConfigurations={};for(const p of t)this.programConfigurations[p.id]=new Xs(p,r,l);this.needsUpload=!1,this._featureMap=new ys,this._bufferOffset=0}populatePaintArrays(t,r,l,p,b,x){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(t,r,p,b,x);r.id!==void 0&&this._featureMap.add(r.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,l,p){for(const b of l)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(t,this._featureMap,r,b,p)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Kn(s,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${t}-`,"").replace(/-/g,"_")]}function Ks(s,t,r){const l={color:{source:sa,composite:ne},number:{source:k,composite:sa}},p=function(b){return{"line-pattern":{source:di,composite:di},"fill-pattern":{source:di,composite:di},"fill-extrusion-pattern":{source:di,composite:di}}[b]}(s);return p&&p[r]||l[t][r]}yt("ConstantBinder",Co),yt("CrossFadedConstantBinder",An),yt("SourceExpressionBinder",gr),yt("CrossFadedCompositeBinder",bs),yt("CompositeExpressionBinder",_r),yt("ProgramConfiguration",Xs,{omit:["_buffers"]}),yt("ProgramConfigurationSet",Qs);const Mo=Math.pow(2,14)-1,Zf=-Mo-1;function Pr(s){const t=bt/s.extent,r=s.loadGeometry();for(let l=0;l<r.length;l++){const p=r[l];for(let b=0;b<p.length;b++){const x=p[b],E=Math.round(x.x*t),S=Math.round(x.y*t);x.x=Xt(E,Zf,Mo),x.y=Xt(S,Zf,Mo),(E<x.x||E>x.x+1||S<x.y||S>x.y+1)&&on("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function yr(s,t){return{type:s.type,id:s.id,properties:s.properties,geometry:t?Pr(s):[]}}const nn=-32768;function kd(s,t,r,l,p){s.emplaceBack(nn+8*t+l,nn+8*r+p)}class qh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ft,this.indexArray=new wi,this.segments=new Si,this.programConfigurations=new Qs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,l){const p=this.layers[0],b=[];let x=null,E=!1,S=p.type==="heatmap";if(p.type==="circle"){const O=p;x=O.layout.get("circle-sort-key"),E=!x.isConstant(),S=S||O.paint.get("circle-pitch-alignment")==="map"}const R=S?r.subdivisionGranularity.circle:1;for(const{feature:O,id:B,index:U,sourceLayerIndex:j}of t){const V=this.layers[0]._featureFilter.needGeometry,Y=yr(O,V);if(!this.layers[0]._featureFilter.filter(new Yi(this.zoom),Y,l))continue;const ee=E?x.evaluate(Y,{},l):void 0,oe={id:B,properties:O.properties,type:O.type,sourceLayerIndex:j,index:U,geometry:V?Y.geometry:Pr(O),patterns:{},sortKey:ee};b.push(oe)}E&&b.sort((O,B)=>O.sortKey-B.sortKey);for(const O of b){const{geometry:B,index:U,sourceLayerIndex:j}=O,V=t[U].feature;this.addFeature(O,B,U,l,R),r.featureIndex.insert(V,B,U,j,this.index)}}update(t,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,an),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,l,p,b=1){let x;switch(b){case 1:x=[0,7];break;case 3:x=[0,2,5,7];break;case 5:x=[0,1,3,4,6,7];break;case 7:x=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${b}; valid values are 1, 3, 5, 7.`)}const E=x.length;for(const S of r)for(const R of S){const O=R.x,B=R.y;if(O<0||O>=bt||B<0||B>=bt)continue;const U=this.segments.prepareSegment(E*E,this.layoutVertexArray,this.indexArray,t.sortKey),j=U.vertexLength;for(let V=0;V<E;V++)for(let Y=0;Y<E;Y++)kd(this.layoutVertexArray,O,B,x[Y],x[V]);for(let V=0;V<E-1;V++)for(let Y=0;Y<E-1;Y++){const ee=j+V*E+Y,oe=j+(V+1)*E+Y;this.indexArray.emplaceBack(ee,oe+1,ee+1),this.indexArray.emplaceBack(ee,oe,oe+1)}U.vertexLength+=E*E,U.primitiveLength+=(E-1)*(E-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},p)}}function Bd(s,t){for(let r=0;r<s.length;r++)if(ol(t,s[r]))return!0;for(let r=0;r<t.length;r++)if(ol(s,t[r]))return!0;return!!Zc(s,t)}function ap(s,t,r){return!!ol(s,t)||!!zd(t,s,r)}function Yf(s,t){if(s.length===1)return Vh(t,s[0]);for(let r=0;r<t.length;r++){const l=t[r];for(let p=0;p<l.length;p++)if(ol(s,l[p]))return!0}for(let r=0;r<s.length;r++)if(Vh(t,s[r]))return!0;for(let r=0;r<t.length;r++)if(Zc(s,t[r]))return!0;return!1}function Jl(s,t,r){if(s.length>1){if(Zc(s,t))return!0;for(let l=0;l<t.length;l++)if(zd(t[l],s,r))return!0}for(let l=0;l<s.length;l++)if(zd(s[l],t,r))return!0;return!1}function Zc(s,t){if(s.length===0||t.length===0)return!1;for(let r=0;r<s.length-1;r++){const l=s[r],p=s[r+1];for(let b=0;b<t.length-1;b++)if(np(l,p,t[b],t[b+1]))return!0}return!1}function np(s,t,r,l){return Oi(s,r,l)!==Oi(t,r,l)&&Oi(s,t,r)!==Oi(s,t,l)}function zd(s,t,r){const l=r*r;if(t.length===1)return s.distSqr(t[0])<l;for(let p=1;p<t.length;p++)if($f(s,t[p-1],t[p])<l)return!0;return!1}function $f(s,t,r){const l=t.distSqr(r);if(l===0)return s.distSqr(t);const p=((s.x-t.x)*(r.x-t.x)+(s.y-t.y)*(r.y-t.y))/l;return s.distSqr(p<0?t:p>1?r:r.sub(t)._mult(p)._add(t))}function Vh(s,t){for(let r=0;r<s.length;r++)if(ol(s[r],t))return!0;return!1}function ol(s,t){let r=!1;for(let l=0,p=s.length-1;l<s.length;p=l++){const b=s[l],x=s[p];b.y>t.y!=x.y>t.y&&t.x<(x.x-b.x)*(t.y-b.y)/(x.y-b.y)+b.x&&(r=!r)}return r}function Xf(s,t,r){const l=r[0],p=r[2];if(s.x<l.x&&t.x<l.x||s.x>p.x&&t.x>p.x||s.y<l.y&&t.y<l.y||s.y>p.y&&t.y>p.y)return!1;const b=Oi(s,t,r[0]);return b!==Oi(s,t,r[1])||b!==Oi(s,t,r[2])||b!==Oi(s,t,r[3])}function Yc(s,t,r){const l=t.paint.get(s).value;return l.kind==="constant"?l.value:r.programConfigurations.get(t.id).getMaxValue(s)}function Gh(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Fd(s,t,r,l,p){if(!t[0]&&!t[1])return s;const b=Qe.convert(t)._mult(p);r==="viewport"&&b._rotate(-l);const x=[];for(let E=0;E<s.length;E++)x.push(s[E].sub(b));return x}let Qf,hn;yt("CircleBucket",qh,{omit:["layers"]});var Bn={get paint(){return hn=hn||new ca({"circle-radius":new zt(te.paint_circle["circle-radius"]),"circle-color":new zt(te.paint_circle["circle-color"]),"circle-blur":new zt(te.paint_circle["circle-blur"]),"circle-opacity":new zt(te.paint_circle["circle-opacity"]),"circle-translate":new gt(te.paint_circle["circle-translate"]),"circle-translate-anchor":new gt(te.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gt(te.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gt(te.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new zt(te.paint_circle["circle-stroke-width"]),"circle-stroke-color":new zt(te.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new zt(te.paint_circle["circle-stroke-opacity"])})},get layout(){return Qf=Qf||new ca({"circle-sort-key":new zt(te.layout_circle["circle-sort-key"])})}};class rp extends Rr{constructor(t){super(t,Bn)}createBucket(t){return new qh(t)}queryRadius(t){const r=t;return Yc("circle-radius",this,r)+Yc("circle-stroke-width",this,r)+Gh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:l,geometry:p,transform:b,pixelsToTileUnits:x,unwrappedTileID:E,getElevation:S}){const R=Fd(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-b.bearingInRadians,x),O=this.paint.get("circle-radius").evaluate(r,l)+this.paint.get("circle-stroke-width").evaluate(r,l),B=this.paint.get("circle-pitch-alignment")==="map",U=B?R:function(V,Y,ee,oe){return V.map(xe=>Kf(xe,Y,ee,oe))}(R,b,E,S),j=B?O*x:O;for(const V of p)for(const Y of V){const ee=B?Y:Kf(Y,b,E,S);let oe=j;const xe=b.projectTileCoordinates(Y.x,Y.y,E,S).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?oe*=xe/b.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(oe*=b.cameraToCenterDistance/xe),ap(U,ee,oe))return!0}return!1}}function Kf(s,t,r,l){const p=t.projectTileCoordinates(s.x,s.y,r,l).point;return new Qe((.5*p.x+.5)*t.width,(.5*-p.y+.5)*t.height)}class Wf extends qh{}let Jf;yt("HeatmapBucket",Wf,{omit:["layers"]});var sp={get paint(){return Jf=Jf||new ca({"heatmap-radius":new zt(te.paint_heatmap["heatmap-radius"]),"heatmap-weight":new zt(te.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gt(te.paint_heatmap["heatmap-intensity"]),"heatmap-color":new nl(te.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gt(te.paint_heatmap["heatmap-opacity"])})}};function $c(s,{width:t,height:r},l,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==t*r*l)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${t*r*l}`)}else p=new Uint8Array(t*r*l);return s.width=t,s.height=r,s.data=p,s}function Ud(s,{width:t,height:r},l){if(t===s.width&&r===s.height)return;const p=$c({},{width:t,height:r},l);Hd(s,p,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,t),height:Math.min(s.height,r)},l),s.width=t,s.height=r,s.data=p.data}function Hd(s,t,r,l,p,b){if(p.width===0||p.height===0)return t;if(p.width>s.width||p.height>s.height||r.x>s.width-p.width||r.y>s.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>t.width||p.height>t.height||l.x>t.width-p.width||l.y>t.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const x=s.data,E=t.data;if(x===E)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<p.height;S++){const R=((r.y+S)*s.width+r.x)*b,O=((l.y+S)*t.width+l.x)*b;for(let B=0;B<p.width*b;B++)E[O+B]=x[R+B]}return t}class Xc{constructor(t,r){$c(this,t,1,r)}resize(t){Ud(this,t,1)}clone(){return new Xc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,l,p,b){Hd(t,r,l,p,b,1)}}class Lr{constructor(t,r){$c(this,t,4,r)}resize(t){Ud(this,t,4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Lr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,l,p,b){Hd(t,r,l,p,b,4)}}function jd(s){const t={},r=s.resolution||256,l=s.clips?s.clips.length:1,p=s.image||new Lr({width:r,height:l});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const b=(x,E,S)=>{t[s.evaluationKey]=S;const R=s.expression.evaluate(t);p.data[x+E+0]=Math.floor(255*R.r/R.a),p.data[x+E+1]=Math.floor(255*R.g/R.a),p.data[x+E+2]=Math.floor(255*R.b/R.a),p.data[x+E+3]=Math.floor(255*R.a)};if(s.clips)for(let x=0,E=0;x<l;++x,E+=4*r)for(let S=0,R=0;S<r;S++,R+=4){const O=S/(r-1),{start:B,end:U}=s.clips[x];b(E,R,B*(1-O)+U*O)}else for(let x=0,E=0;x<r;x++,E+=4)b(0,E,x/(r-1));return p}yt("AlphaImage",Xc),yt("RGBAImage",Lr);const Zh="big-fb";class e0 extends Rr{createBucket(t){return new Wf(t)}constructor(t){super(t,sp),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=jd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Zh)&&this.heatmapFbos.delete(Zh)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let t0;var i0={get paint(){return t0=t0||new ca({"hillshade-illumination-direction":new gt(te.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new gt(te.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new gt(te.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gt(te.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gt(te.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gt(te.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gt(te.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new gt(te.paint_hillshade["hillshade-method"])})}};class qd extends Rr{constructor(t){super(t,i0),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,r=this.paint.get("hillshade-illumination-altitude").values,l=this.paint.get("hillshade-highlight-color").values,p=this.paint.get("hillshade-shadow-color").values;const b=Math.max(t.length,r.length,l.length,p.length);t=t.concat(Array(b-t.length).fill(t.at(-1))),r=r.concat(Array(b-r.length).fill(r.at(-1))),l=l.concat(Array(b-l.length).fill(l.at(-1))),p=p.concat(Array(b-p.length).fill(p.at(-1)));const x=r.map(so);return{directionRadians:t.map(so),altitudeRadians:x,shadowColor:p,highlightColor:l}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const a0=ra([{name:"a_pos",components:2,type:"Int16"}],4),{members:op}=a0;function Yh(s,t,r){const l=r.patternDependencies;let p=!1;for(const b of t){const x=b.paint.get(`${s}-pattern`);x.isConstant()||(p=!0);const E=x.constantOr(null);E&&(p=!0,l[E.to]=!0,l[E.from]=!0)}return p}function Vd(s,t,r,l,p){const b=p.patternDependencies;for(const x of t){const E=x.paint.get(`${s}-pattern`).value;if(E.kind!=="constant"){let S=E.evaluate({zoom:l-1},r,{},p.availableImages),R=E.evaluate({zoom:l},r,{},p.availableImages),O=E.evaluate({zoom:l+1},r,{},p.availableImages);S=S&&S.name?S.name:S,R=R&&R.name?R.name:R,O=O&&O.name?O.name:O,b[S]=!0,b[R]=!0,b[O]=!0,r.patterns[x.id]={min:S,mid:R,max:O}}}return r}function Io(s,t,r,l,p){let b;if(p===function(x,E,S,R){let O=0;for(let B=E,U=S-R;B<S;B+=R)O+=(x[U]-x[B])*(x[B+1]+x[U+1]),U=B;return O}(s,t,r,l)>0)for(let x=t;x<r;x+=l)b=Yd(x/l|0,s[x],s[x+1],b);else for(let x=r-l;x>=t;x-=l)b=Yd(x/l|0,s[x],s[x+1],b);return b&&Do(b,b.next)&&(ul(b),b=b.next),b}function yu(s,t){if(!s)return s;t||(t=s);let r,l=s;do if(r=!1,l.steiner||!Do(l,l.next)&&Ca(l.prev,l,l.next)!==0)l=l.next;else{if(ul(l),l=t=l.prev,l===l.next)break;r=!0}while(r||l!==t);return t}function $h(s,t,r,l,p,b,x){if(!s)return;!x&&b&&function(S,R,O,B){let U=S;do U.z===0&&(U.z=n0(U.x,U.y,R,O,B)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==S);U.prevZ.nextZ=null,U.prevZ=null,function(j){let V,Y=1;do{let ee,oe=j;j=null;let xe=null;for(V=0;oe;){V++;let ue=oe,H=0;for(let de=0;de<Y&&(H++,ue=ue.nextZ,ue);de++);let J=Y;for(;H>0||J>0&&ue;)H!==0&&(J===0||!ue||oe.z<=ue.z)?(ee=oe,oe=oe.nextZ,H--):(ee=ue,ue=ue.nextZ,J--),xe?xe.nextZ=ee:j=ee,ee.prevZ=xe,xe=ee;oe=ue}xe.nextZ=null,Y*=2}while(V>1)}(U)}(s,l,p,b);let E=s;for(;s.prev!==s.next;){const S=s.prev,R=s.next;if(b?bu(s,l,p,b):up(s))t.push(S.i,s.i,R.i),ul(s),s=R.next,E=R.next;else if((s=R)===E){x?x===1?$h(s=lp(yu(s),t),t,r,l,p,b,2):x===2&&Gd(s,t,r,l,p,b):$h(yu(s),t,r,l,p,b,1);break}}}function up(s){const t=s.prev,r=s,l=s.next;if(Ca(t,r,l)>=0)return!1;const p=t.x,b=r.x,x=l.x,E=t.y,S=r.y,R=l.y,O=Math.min(p,b,x),B=Math.min(E,S,R),U=Math.max(p,b,x),j=Math.max(E,S,R);let V=l.next;for(;V!==t;){if(V.x>=O&&V.x<=U&&V.y>=B&&V.y<=j&&xs(p,E,b,S,x,R,V.x,V.y)&&Ca(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function bu(s,t,r,l){const p=s.prev,b=s,x=s.next;if(Ca(p,b,x)>=0)return!1;const E=p.x,S=b.x,R=x.x,O=p.y,B=b.y,U=x.y,j=Math.min(E,S,R),V=Math.min(O,B,U),Y=Math.max(E,S,R),ee=Math.max(O,B,U),oe=n0(j,V,t,r,l),xe=n0(Y,ee,t,r,l);let ue=s.prevZ,H=s.nextZ;for(;ue&&ue.z>=oe&&H&&H.z<=xe;){if(ue.x>=j&&ue.x<=Y&&ue.y>=V&&ue.y<=ee&&ue!==p&&ue!==x&&xs(E,O,S,B,R,U,ue.x,ue.y)&&Ca(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,H.x>=j&&H.x<=Y&&H.y>=V&&H.y<=ee&&H!==p&&H!==x&&xs(E,O,S,B,R,U,H.x,H.y)&&Ca(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;ue&&ue.z>=oe;){if(ue.x>=j&&ue.x<=Y&&ue.y>=V&&ue.y<=ee&&ue!==p&&ue!==x&&xs(E,O,S,B,R,U,ue.x,ue.y)&&Ca(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;H&&H.z<=xe;){if(H.x>=j&&H.x<=Y&&H.y>=V&&H.y<=ee&&H!==p&&H!==x&&xs(E,O,S,B,R,U,H.x,H.y)&&Ca(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function lp(s,t){let r=s;do{const l=r.prev,p=r.next.next;!Do(l,p)&&Ws(l,r,r.next,p)&&Wc(l,p)&&Wc(p,l)&&(t.push(l.i,r.i,p.i),ul(r),ul(r.next),r=s=p),r=r.next}while(r!==s);return yu(r)}function Gd(s,t,r,l,p,b){let x=s;do{let E=x.next.next;for(;E!==x.prev;){if(x.i!==E.i&&hp(x,E)){let S=Zd(x,E);return x=yu(x,x.next),S=yu(S,S.next),$h(x,t,r,l,p,b,0),void $h(S,t,r,l,p,b,0)}E=E.next}x=x.next}while(x!==s)}function Xh(s,t){let r=s.x-t.x;return r===0&&(r=s.y-t.y,r===0)&&(r=(s.next.y-s.y)/(s.next.x-s.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function Oa(s,t){const r=function(p,b){let x=b;const E=p.x,S=p.y;let R,O=-1/0;if(Do(p,x))return x;do{if(Do(p,x.next))return x.next;if(S<=x.y&&S>=x.next.y&&x.next.y!==x.y){const Y=x.x+(S-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(Y<=E&&Y>O&&(O=Y,R=x.x<x.next.x?x:x.next,Y===E))return R}x=x.next}while(x!==b);if(!R)return null;const B=R,U=R.x,j=R.y;let V=1/0;x=R;do{if(E>=x.x&&x.x>=U&&E!==x.x&&Qc(S<j?E:O,S,U,j,S<j?O:E,S,x.x,x.y)){const Y=Math.abs(S-x.y)/(E-x.x);Wc(x,p)&&(Y<V||Y===V&&(x.x>R.x||x.x===R.x&&dm(R,x)))&&(R=x,V=Y)}x=x.next}while(x!==B);return R}(s,t);if(!r)return t;const l=Zd(r,s);return yu(l,l.next),yu(r,r.next)}function dm(s,t){return Ca(s.prev,s,t.prev)<0&&Ca(t.next,s,s.next)<0}function n0(s,t,r,l,p){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-r)*p|0)|s<<8))|s<<4))|s<<2))|s<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*p|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function cp(s){let t=s,r=s;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==s);return r}function Qc(s,t,r,l,p,b,x,E){return(p-x)*(t-E)>=(s-x)*(b-E)&&(s-x)*(l-E)>=(r-x)*(t-E)&&(r-x)*(b-E)>=(p-x)*(l-E)}function xs(s,t,r,l,p,b,x,E){return!(s===x&&t===E)&&Qc(s,t,r,l,p,b,x,E)}function hp(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!function(r,l){let p=r;do{if(p.i!==r.i&&p.next.i!==r.i&&p.i!==l.i&&p.next.i!==l.i&&Ws(p,p.next,r,l))return!0;p=p.next}while(p!==r);return!1}(s,t)&&(Wc(s,t)&&Wc(t,s)&&function(r,l){let p=r,b=!1;const x=(r.x+l.x)/2,E=(r.y+l.y)/2;do p.y>E!=p.next.y>E&&p.next.y!==p.y&&x<(p.next.x-p.x)*(E-p.y)/(p.next.y-p.y)+p.x&&(b=!b),p=p.next;while(p!==r);return b}(s,t)&&(Ca(s.prev,s,t.prev)||Ca(s,t.prev,t))||Do(s,t)&&Ca(s.prev,s,s.next)>0&&Ca(t.prev,t,t.next)>0)}function Ca(s,t,r){return(t.y-s.y)*(r.x-t.x)-(t.x-s.x)*(r.y-t.y)}function Do(s,t){return s.x===t.x&&s.y===t.y}function Ws(s,t,r,l){const p=Kc(Ca(s,t,r)),b=Kc(Ca(s,t,l)),x=Kc(Ca(r,l,s)),E=Kc(Ca(r,l,t));return p!==b&&x!==E||!(p!==0||!Qh(s,r,t))||!(b!==0||!Qh(s,l,t))||!(x!==0||!Qh(r,s,l))||!(E!==0||!Qh(r,t,l))}function Qh(s,t,r){return t.x<=Math.max(s.x,r.x)&&t.x>=Math.min(s.x,r.x)&&t.y<=Math.max(s.y,r.y)&&t.y>=Math.min(s.y,r.y)}function Kc(s){return s>0?1:s<0?-1:0}function Wc(s,t){return Ca(s.prev,s,s.next)<0?Ca(s,t,s.next)>=0&&Ca(s,s.prev,t)>=0:Ca(s,t,s.prev)<0||Ca(s,s.next,t)<0}function Zd(s,t){const r=$d(s.i,s.x,s.y),l=$d(t.i,t.x,t.y),p=s.next,b=t.prev;return s.next=t,t.prev=s,r.next=p,p.prev=r,l.next=r,r.prev=l,b.next=l,l.prev=b,l}function Yd(s,t,r,l){const p=$d(s,t,r);return l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p),p}function ul(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function $d(s,t,r){return{i:s,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Nr{constructor(t,r){if(r>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=r}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Ma{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Ma.noSubdivision=new Ma({fill:new Nr(0,0),line:new Nr(0,0),tile:new Nr(0,0),stencil:new Nr(0,0),circle:1}),yt("SubdivisionGranularityExpression",Nr),yt("SubdivisionGranularitySetting",Ma);const ll=-32768,Jc=32767;class Sn{constructor(t,r){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=bt/t,this._canonical=r}_getKey(t,r){return(t+=32768)<<16|(r+=32768)<<0}_vertexToIndex(t,r){if(t<-32768||r<-32768||t>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const l=0|Math.round(t),p=0|Math.round(r),b=this._getKey(l,p);if(this._vertexDictionary.has(b))return this._vertexDictionary.get(b);const x=this._vertexBuffer.length/2;return this._vertexDictionary.set(b,x),this._vertexBuffer.push(l,p),x}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(p,b){const x=[];for(let E=0;E<b.length;E+=3){const S=b[E],R=b[E+1],O=b[E+2],B=p[2*S],U=p[2*S+1];(p[2*R]-B)*(p[2*O+1]-U)-(p[2*R+1]-U)*(p[2*O]-B)>0?(x.push(S),x.push(O),x.push(R)):(x.push(S),x.push(R),x.push(O))}return x}(this._vertexBuffer,t);const r=[],l=t.length;for(let p=0;p<l;p+=3){const b=[t[p+0],t[p+1],t[p+2]],x=[this._vertexBuffer[2*t[p+0]+0],this._vertexBuffer[2*t[p+0]+1],this._vertexBuffer[2*t[p+1]+0],this._vertexBuffer[2*t[p+1]+1],this._vertexBuffer[2*t[p+2]+0],this._vertexBuffer[2*t[p+2]+1]];let E=1/0,S=1/0,R=-1/0,O=-1/0;for(let Y=0;Y<3;Y++){const ee=x[2*Y],oe=x[2*Y+1];E=Math.min(E,ee),R=Math.max(R,ee),S=Math.min(S,oe),O=Math.max(O,oe)}if(E===R||S===O)continue;const B=Math.floor(E/this._granularityCellSize),U=Math.ceil(R/this._granularityCellSize),j=Math.floor(S/this._granularityCellSize),V=Math.ceil(O/this._granularityCellSize);if(B!==U||j!==V)for(let Y=j;Y<V;Y++){const ee=this._scanlineGenerateVertexRingForCellRow(Y,x,b);fp(this._vertexBuffer,ee,r)}else r.push(...b)}return r}_scanlineGenerateVertexRingForCellRow(t,r,l){const p=t*this._granularityCellSize,b=p+this._granularityCellSize,x=[];for(let E=0;E<3;E++){const S=r[2*E],R=r[2*E+1],O=r[2*(E+1)%6],B=r[(2*(E+1)+1)%6],U=r[2*(E+2)%6],j=r[(2*(E+2)+1)%6],V=O-S,Y=B-R,ee=V===0,oe=Y===0,xe=(p-R)/Y,ue=(b-R)/Y,H=Math.min(xe,ue),J=Math.max(xe,ue);if(!oe&&(H>=1||J<=0)||oe&&(R<p||R>b)){B>=p&&B<=b&&x.push(l[(E+1)%3]);continue}!oe&&H>0&&x.push(this._vertexToIndex(S+V*H,R+Y*H));const de=S+V*Math.max(H,0),Oe=S+V*Math.min(J,1);ee||this._generateIntraEdgeVertices(x,S,R,O,B,de,Oe),!oe&&J<1&&x.push(this._vertexToIndex(S+V*J,R+Y*J)),(oe||B>=p&&B<=b)&&x.push(l[(E+1)%3]),!oe&&(B<=p||B>=b)&&this._generateInterEdgeVertices(x,S,R,O,B,U,j,Oe,p,b)}return x}_generateIntraEdgeVertices(t,r,l,p,b,x,E){const S=p-r,R=b-l,O=R===0,B=O?Math.min(r,p):Math.min(x,E),U=O?Math.max(r,p):Math.max(x,E),j=Math.floor(B/this._granularityCellSize)+1,V=Math.ceil(U/this._granularityCellSize)-1;if(O?r<p:x<E)for(let Y=j;Y<=V;Y++){const ee=Y*this._granularityCellSize;t.push(this._vertexToIndex(ee,l+R*(ee-r)/S))}else for(let Y=V;Y>=j;Y--){const ee=Y*this._granularityCellSize;t.push(this._vertexToIndex(ee,l+R*(ee-r)/S))}}_generateInterEdgeVertices(t,r,l,p,b,x,E,S,R,O){const B=b-l,U=x-p,j=E-b,V=(R-b)/j,Y=(O-b)/j,ee=Math.min(V,Y),oe=Math.max(V,Y),xe=p+U*ee;let ue=Math.floor(Math.min(xe,S)/this._granularityCellSize)+1,H=Math.ceil(Math.max(xe,S)/this._granularityCellSize)-1,J=S<xe;const de=j===0;if(de&&(E===R||E===O))return;if(de||ee>=1||oe<=0){const at=l-E,Ue=x+(r-x)*Math.min((R-E)/at,(O-E)/at);ue=Math.floor(Math.min(Ue,S)/this._granularityCellSize)+1,H=Math.ceil(Math.max(Ue,S)/this._granularityCellSize)-1,J=S<Ue}const Oe=B>0?O:R;if(J)for(let at=ue;at<=H;at++)t.push(this._vertexToIndex(at*this._granularityCellSize,Oe));else for(let at=H;at>=ue;at--)t.push(this._vertexToIndex(at*this._granularityCellSize,Oe))}_generateOutline(t){const r=[];for(const l of t){const p=cl(l,this._granularity,!0),b=this._pointArrayToIndices(p),x=[];for(let E=1;E<b.length;E++)x.push(b[E-1]),x.push(b[E]);r.push(x)}return r}_handlePoles(t){let r=!1,l=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(l=!0)),(r||l)&&this._fillPoles(t,r,l)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let r=0;r<t.length;r+=2){const l=t[r+1];l===ll&&(t[r+1]=-32767),l===Jc&&(t[r+1]=32766)}}_generatePoleQuad(t,r,l,p,b,x){p>b!=(x===ll)?(t.push(r),t.push(l),t.push(this._vertexToIndex(p,x)),t.push(l),t.push(this._vertexToIndex(b,x)),t.push(this._vertexToIndex(p,x))):(t.push(l),t.push(r),t.push(this._vertexToIndex(p,x)),t.push(this._vertexToIndex(b,x)),t.push(l),t.push(this._vertexToIndex(p,x)))}_fillPoles(t,r,l){const p=this._vertexBuffer,b=bt,x=t.length;for(let E=2;E<x;E+=3){const S=t[E-2],R=t[E-1],O=t[E],B=p[2*S],U=p[2*S+1],j=p[2*R],V=p[2*R+1],Y=p[2*O],ee=p[2*O+1];r&&(U===0&&V===0&&this._generatePoleQuad(t,S,R,B,j,ll),V===0&&ee===0&&this._generatePoleQuad(t,R,O,j,Y,ll),ee===0&&U===0&&this._generatePoleQuad(t,O,S,Y,B,ll)),l&&(U===b&&V===b&&this._generatePoleQuad(t,S,R,B,j,Jc),V===b&&ee===b&&this._generatePoleQuad(t,R,O,j,Y,Jc),ee===b&&U===b&&this._generatePoleQuad(t,O,S,Y,B,Jc))}}_initializeVertices(t){for(let r=0;r<t.length;r+=2)this._vertexToIndex(t[r],t[r+1])}subdividePolygonInternal(t,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:l,holeIndices:p}=function(E){const S=[],R=[];for(const O of E)if(O.length!==0){O!==E[0]&&S.push(R.length/2);for(let B=0;B<O.length;B++)R.push(O[B].x),R.push(O[B].y)}return{flattened:R,holeIndices:S}}(t);let b;this._initializeVertices(l);try{const E=function(R,O,B=2){const U=O&&O.length,j=U?O[0]*B:R.length;let V=Io(R,0,j,B,!0);const Y=[];if(!V||V.next===V.prev)return Y;let ee,oe,xe;if(U&&(V=function(ue,H,J,de){const Oe=[];for(let at=0,Ue=H.length;at<Ue;at++){const Ye=Io(ue,H[at]*de,at<Ue-1?H[at+1]*de:ue.length,de,!1);Ye===Ye.next&&(Ye.steiner=!0),Oe.push(cp(Ye))}Oe.sort(Xh);for(let at=0;at<Oe.length;at++)J=Oa(Oe[at],J);return J}(R,O,V,B)),R.length>80*B){ee=1/0,oe=1/0;let ue=-1/0,H=-1/0;for(let J=B;J<j;J+=B){const de=R[J],Oe=R[J+1];de<ee&&(ee=de),Oe<oe&&(oe=Oe),de>ue&&(ue=de),Oe>H&&(H=Oe)}xe=Math.max(ue-ee,H-oe),xe=xe!==0?32767/xe:0}return $h(V,Y,B,ee,oe,xe,0),Y}(l,p),S=this._convertIndices(l,E);b=this._subdivideTrianglesScanline(S)}catch(E){console.error(E)}let x=[];return r&&(x=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(b),{verticesFlattened:this._vertexBuffer,indicesTriangles:b,indicesLineList:x}}_convertIndices(t,r){const l=[];for(let p=0;p<r.length;p++)l.push(this._vertexToIndex(t[2*r[p]],t[2*r[p]+1]));return l}_pointArrayToIndices(t){const r=[];for(let l=0;l<t.length;l++){const p=t[l];r.push(this._vertexToIndex(p.x,p.y))}return r}}function dp(s,t,r,l=!0){return new Sn(r,t).subdividePolygonInternal(s,l)}function cl(s,t,r=!1){if(!s||s.length<1)return[];if(s.length<2)return[];const l=s[0],p=s[s.length-1],b=r&&(l.x!==p.x||l.y!==p.y);if(t<2)return b?[...s,s[0]]:[...s];const x=Math.floor(bt/t),E=[];E.push(new Qe(s[0].x,s[0].y));const S=s.length,R=b?S:S-1;for(let O=0;O<R;O++){const B=s[O],U=O<S-1?s[O+1]:s[0],j=B.x,V=B.y,Y=U.x,ee=U.y,oe=j!==Y,xe=V!==ee;if(!oe&&!xe)continue;const ue=Y-j,H=ee-V,J=Math.abs(ue),de=Math.abs(H);let Oe=j,at=V;for(;;){const Ye=ue>0?(Math.floor(Oe/x)+1)*x:(Math.ceil(Oe/x)-1)*x,ot=H>0?(Math.floor(at/x)+1)*x:(Math.ceil(at/x)-1)*x,rt=Math.abs(Oe-Ye),ct=Math.abs(at-ot),Xe=Math.abs(Oe-Y),Tt=Math.abs(at-ee),Lt=oe?rt/J:Number.POSITIVE_INFINITY,Pt=xe?ct/de:Number.POSITIVE_INFINITY;if((Xe<=rt||!oe)&&(Tt<=ct||!xe))break;if(Lt<Pt&&oe||!xe){Oe=Ye,at+=H*Lt;const Ct=new Qe(Oe,Math.round(at));E[E.length-1].x===Ct.x&&E[E.length-1].y===Ct.y||E.push(Ct)}else{Oe+=ue*Pt,at=ot;const Ct=new Qe(Math.round(Oe),at);E[E.length-1].x===Ct.x&&E[E.length-1].y===Ct.y||E.push(Ct)}}const Ue=new Qe(Y,ee);E[E.length-1].x===Ue.x&&E[E.length-1].y===Ue.y||E.push(Ue)}return E}function fp(s,t,r){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let l=0,p=s[2*t[0]];for(let S=1;S<t.length;S++){const R=s[2*t[S]];R<p&&(p=R,l=S)}const b=t.length;let x=l,E=(x+1)%b;for(;;){const S=x-1>=0?x-1:b-1,R=(E+1)%b,O=s[2*t[S]],B=s[2*t[R]],U=s[2*t[x]],j=s[2*t[x]+1],V=s[2*t[E]+1];let Y=!1;if(O<B)Y=!0;else if(O>B)Y=!1;else{const ee=V-j,oe=-(s[2*t[E]]-U),xe=j<V?1:-1;((O-U)*ee+(s[2*t[S]+1]-j)*oe)*xe>((B-U)*ee+(s[2*t[R]+1]-j)*oe)*xe&&(Y=!0)}if(Y){const ee=t[S],oe=t[x],xe=t[E];ee!==oe&&ee!==xe&&oe!==xe&&r.push(xe,oe,ee),x--,x<0&&(x=b-1)}else{const ee=t[R],oe=t[x],xe=t[E];ee!==oe&&ee!==xe&&oe!==xe&&r.push(xe,oe,ee),E++,E>=b&&(E=0)}if(S===R)break}}function ya(s,t,r,l,p,b,x,E,S){const R=p.length/2,O=x&&E&&S;if(R<Si.MAX_VERTEX_ARRAY_LENGTH){const B=t.prepareSegment(R,r,l),U=B.vertexLength;for(let Y=0;Y<b.length;Y+=3)l.emplaceBack(U+b[Y],U+b[Y+1],U+b[Y+2]);let j,V;B.vertexLength+=R,B.primitiveLength+=b.length/3,O&&(V=x.prepareSegment(R,r,E),j=V.vertexLength,V.vertexLength+=R);for(let Y=0;Y<p.length;Y+=2)s(p[Y],p[Y+1]);if(O)for(let Y=0;Y<S.length;Y++){const ee=S[Y];for(let oe=1;oe<ee.length;oe+=2)E.emplaceBack(j+ee[oe-1],j+ee[oe]);V.primitiveLength+=ee.length/2}}else(function(B,U,j,V,Y,ee){const oe=[];for(let de=0;de<V.length/2;de++)oe.push(-1);const xe={count:0};let ue=0,H=B.getOrCreateLatestSegment(U,j),J=H.vertexLength;for(let de=2;de<Y.length;de+=3){const Oe=Y[de-2],at=Y[de-1],Ue=Y[de];let Ye=oe[Oe]<ue,ot=oe[at]<ue,rt=oe[Ue]<ue;H.vertexLength+((Ye?1:0)+(ot?1:0)+(rt?1:0))>Si.MAX_VERTEX_ARRAY_LENGTH&&(H=B.createNewSegment(U,j),ue=xe.count,Ye=!0,ot=!0,rt=!0,J=0);const ct=Cn(oe,V,ee,xe,Oe,Ye,H),Xe=Cn(oe,V,ee,xe,at,ot,H),Tt=Cn(oe,V,ee,xe,Ue,rt,H);j.emplaceBack(J+ct-ue,J+Xe-ue,J+Tt-ue),H.primitiveLength++}})(t,r,l,p,b,s),O&&function(B,U,j,V,Y,ee){const oe=[];for(let de=0;de<V.length/2;de++)oe.push(-1);const xe={count:0};let ue=0,H=B.getOrCreateLatestSegment(U,j),J=H.vertexLength;for(let de=0;de<Y.length;de++){const Oe=Y[de];for(let at=1;at<Y[de].length;at+=2){const Ue=Oe[at-1],Ye=Oe[at];let ot=oe[Ue]<ue,rt=oe[Ye]<ue;H.vertexLength+((ot?1:0)+(rt?1:0))>Si.MAX_VERTEX_ARRAY_LENGTH&&(H=B.createNewSegment(U,j),ue=xe.count,ot=!0,rt=!0,J=0);const ct=Cn(oe,V,ee,xe,Ue,ot,H),Xe=Cn(oe,V,ee,xe,Ye,rt,H);j.emplaceBack(J+ct-ue,J+Xe-ue),H.primitiveLength++}}}(x,r,E,p,S,s),t.forceNewSegmentOnNextPrepare(),x==null||x.forceNewSegmentOnNextPrepare()}function Cn(s,t,r,l,p,b,x){if(b){const E=l.count;return r(t[2*p],t[2*p+1]),s[p]=l.count,l.count++,x.vertexLength++,E}return s[p]}class Js{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ht,this.indexArray=new wi,this.indexArray2=new La,this.programConfigurations=new Qs(t.layers,t.zoom),this.segments=new Si,this.segments2=new Si,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,l){this.hasPattern=Yh("fill",this.layers,r);const p=this.layers[0].layout.get("fill-sort-key"),b=!p.isConstant(),x=[];for(const{feature:E,id:S,index:R,sourceLayerIndex:O}of t){const B=this.layers[0]._featureFilter.needGeometry,U=yr(E,B);if(!this.layers[0]._featureFilter.filter(new Yi(this.zoom),U,l))continue;const j=b?p.evaluate(U,{},l,r.availableImages):void 0,V={id:S,properties:E.properties,type:E.type,sourceLayerIndex:O,index:R,geometry:B?U.geometry:Pr(E),patterns:{},sortKey:j};x.push(V)}b&&x.sort((E,S)=>E.sortKey-S.sortKey);for(const E of x){const{geometry:S,index:R,sourceLayerIndex:O}=E;if(this.hasPattern){const B=Vd("fill",this.layers,E,this.zoom,r);this.patternFeatures.push(B)}else this.addFeature(E,S,R,l,{},r.subdivisionGranularity);r.featureIndex.insert(t[R].feature,S,R,O,this.index)}}update(t,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,l)}addFeatures(t,r,l){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,r,l,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,op),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,l,p,b,x){for(const E of Ll(r,500)){const S=dp(E,p,x.fill.getGranularityForZoomLevel(p.z)),R=this.layoutVertexArray;ya((O,B)=>{R.emplaceBack(O,B)},this.segments,this.layoutVertexArray,this.indexArray,S.verticesFlattened,S.indicesTriangles,this.segments2,this.indexArray2,S.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,b,p)}}let r0,s0;yt("FillBucket",Js,{omit:["layers","patternFeatures"]});var fm={get paint(){return s0=s0||new ca({"fill-antialias":new gt(te.paint_fill["fill-antialias"]),"fill-opacity":new zt(te.paint_fill["fill-opacity"]),"fill-color":new zt(te.paint_fill["fill-color"]),"fill-outline-color":new zt(te.paint_fill["fill-outline-color"]),"fill-translate":new gt(te.paint_fill["fill-translate"]),"fill-translate-anchor":new gt(te.paint_fill["fill-translate-anchor"]),"fill-pattern":new gs(te.paint_fill["fill-pattern"])})},get layout(){return r0=r0||new ca({"fill-sort-key":new zt(te.layout_fill["fill-sort-key"])})}};class o0 extends Rr{constructor(t){super(t,fm)}recalculate(t,r){super.recalculate(t,r);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Js(t)}queryRadius(){return Gh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:r,transform:l,pixelsToTileUnits:p}){return Yf(Fd(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-l.bearingInRadians,p),r)}isTileClipped(){return!0}}const Yr=ra([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),eo=ra([{name:"a_centroid",components:2,type:"Int16"}],4),{members:pp}=Yr;var br,u0,Ro,hl,Po,Xd,Qd,$r={};function l0(){if(u0)return br;u0=1;var s=Pe();function t(p,b,x,E,S){this.properties={},this.extent=x,this.type=0,this._pbf=p,this._geometry=-1,this._keys=E,this._values=S,p.readFields(r,this,b)}function r(p,b,x){p==1?b.id=x.readVarint():p==2?function(E,S){for(var R=E.readVarint()+E.pos;E.pos<R;){var O=S._keys[E.readVarint()],B=S._values[E.readVarint()];S.properties[O]=B}}(x,b):p==3?b.type=x.readVarint():p==4&&(b._geometry=x.pos)}function l(p){for(var b,x,E=0,S=0,R=p.length,O=R-1;S<R;O=S++)E+=((x=p[O]).x-(b=p[S]).x)*(b.y+x.y);return E}return br=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var p=this._pbf;p.pos=this._geometry;for(var b,x=p.readVarint()+p.pos,E=1,S=0,R=0,O=0,B=[];p.pos<x;){if(S<=0){var U=p.readVarint();E=7&U,S=U>>3}if(S--,E===1||E===2)R+=p.readSVarint(),O+=p.readSVarint(),E===1&&(b&&B.push(b),b=[]),b.push(new s(R,O));else{if(E!==7)throw new Error("unknown command "+E);b&&b.push(b[0].clone())}}return b&&B.push(b),B},t.prototype.bbox=function(){var p=this._pbf;p.pos=this._geometry;for(var b=p.readVarint()+p.pos,x=1,E=0,S=0,R=0,O=1/0,B=-1/0,U=1/0,j=-1/0;p.pos<b;){if(E<=0){var V=p.readVarint();x=7&V,E=V>>3}if(E--,x===1||x===2)(S+=p.readSVarint())<O&&(O=S),S>B&&(B=S),(R+=p.readSVarint())<U&&(U=R),R>j&&(j=R);else if(x!==7)throw new Error("unknown command "+x)}return[O,U,B,j]},t.prototype.toGeoJSON=function(p,b,x){var E,S,R=this.extent*Math.pow(2,x),O=this.extent*p,B=this.extent*b,U=this.loadGeometry(),j=t.types[this.type];function V(oe){for(var xe=0;xe<oe.length;xe++){var ue=oe[xe];oe[xe]=[360*(ue.x+O)/R-180,360/Math.PI*Math.atan(Math.exp((180-360*(ue.y+B)/R)*Math.PI/180))-90]}}switch(this.type){case 1:var Y=[];for(E=0;E<U.length;E++)Y[E]=U[E][0];V(U=Y);break;case 2:for(E=0;E<U.length;E++)V(U[E]);break;case 3:for(U=function(oe){var xe=oe.length;if(xe<=1)return[oe];for(var ue,H,J=[],de=0;de<xe;de++){var Oe=l(oe[de]);Oe!==0&&(H===void 0&&(H=Oe<0),H===Oe<0?(ue&&J.push(ue),ue=[oe[de]]):ue.push(oe[de]))}return ue&&J.push(ue),J}(U),E=0;E<U.length;E++)for(S=0;S<U[E].length;S++)V(U[E][S])}U.length===1?U=U[0]:j="Multi"+j;var ee={type:"Feature",geometry:{type:j,coordinates:U},properties:this.properties};return"id"in this&&(ee.id=this.id),ee},br}function ec(){if(hl)return Ro;hl=1;var s=l0();function t(l,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(r,this,p),this.length=this._features.length}function r(l,p,b){l===15?p.version=b.readVarint():l===1?p.name=b.readString():l===5?p.extent=b.readVarint():l===2?p._features.push(b.pos):l===3?p._keys.push(b.readString()):l===4&&p._values.push(function(x){for(var E=null,S=x.readVarint()+x.pos;x.pos<S;){var R=x.readVarint()>>3;E=R===1?x.readString():R===2?x.readFloat():R===3?x.readDouble():R===4?x.readVarint64():R===5?x.readVarint():R===6?x.readSVarint():R===7?x.readBoolean():null}return E}(b))}return Ro=t,t.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var p=this._pbf.readVarint()+this._pbf.pos;return new s(this._pbf,p,this.extent,this._keys,this._values)},Ro}function eh(){return Qd||(Qd=1,$r.VectorTile=function(){if(Xd)return Po;Xd=1;var s=ec();function t(r,l,p){if(r===3){var b=new s(p,p.readVarint()+p.pos);b.length&&(l[b.name]=b)}}return Po=function(r,l){this.layers=r.readFields(t,{},l)},Po}(),$r.VectorTileFeature=l0(),$r.VectorTileLayer=ec()),$r}var xu=K(eh());const th=xu.VectorTileFeature.types,Kd=Math.pow(2,13);function ih(s,t,r,l,p,b,x,E){s.emplaceBack(t,r,2*Math.floor(l*Kd)+x,p*Kd*2,b*Kd*2,Math.round(E))}class tc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new it,this.centroidVertexArray=new Ge,this.indexArray=new wi,this.programConfigurations=new Qs(t.layers,t.zoom),this.segments=new Si,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,l){this.features=[],this.hasPattern=Yh("fill-extrusion",this.layers,r);for(const{feature:p,id:b,index:x,sourceLayerIndex:E}of t){const S=this.layers[0]._featureFilter.needGeometry,R=yr(p,S);if(!this.layers[0]._featureFilter.filter(new Yi(this.zoom),R,l))continue;const O={id:b,sourceLayerIndex:E,index:x,geometry:S?R.geometry:Pr(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(Vd("fill-extrusion",this.layers,O,this.zoom,r)):this.addFeature(O,O.geometry,x,l,{},r.subdivisionGranularity),r.featureIndex.insert(p,O.geometry,x,E,this.index,!0)}}addFeatures(t,r,l){for(const p of this.features){const{geometry:b}=p;this.addFeature(p,b,p.index,r,l,t.subdivisionGranularity)}}update(t,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,pp),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,eo.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,l,p,b,x){for(const E of Ll(r,500)){const S={x:0,y:0,sampleCount:0},R=this.layoutVertexArray.length;this.processPolygon(S,p,t,E,x);const O=this.layoutVertexArray.length-R,B=Math.floor(S.x/S.sampleCount),U=Math.floor(S.y/S.sampleCount);for(let j=0;j<O;j++)this.centroidVertexArray.emplaceBack(B,U)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,b,p)}processPolygon(t,r,l,p,b){if(p.length<1||c0(p[0]))return;for(const B of p)B.length!==0&&mp(t,B);const x={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},E=b.fill.getGranularityForZoomLevel(r.z),S=th[l.type]==="Polygon";for(const B of p){if(B.length===0||c0(B))continue;const U=cl(B,E,S);this._generateSideFaces(U,x)}if(!S)return;const R=dp(p,r,E,!1),O=this.layoutVertexArray;ya((B,U)=>{ih(O,B,U,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,R.verticesFlattened,R.indicesTriangles)}_generateSideFaces(t,r){let l=0;for(let p=1;p<t.length;p++){const b=t[p],x=t[p-1];if(Wd(b,x))continue;r.segment.vertexLength+4>Si.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const E=b.sub(x)._perp()._unit(),S=x.dist(b);l+S>32768&&(l=0),ih(this.layoutVertexArray,b.x,b.y,E.x,E.y,0,0,l),ih(this.layoutVertexArray,b.x,b.y,E.x,E.y,0,1,l),l+=S,ih(this.layoutVertexArray,x.x,x.y,E.x,E.y,0,0,l),ih(this.layoutVertexArray,x.x,x.y,E.x,E.y,0,1,l);const R=r.segment.vertexLength;this.indexArray.emplaceBack(R,R+2,R+1),this.indexArray.emplaceBack(R+1,R+2,R+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}}function mp(s,t){for(let r=0;r<t.length;r++){const l=t[r];r===t.length-1&&t[0].x===l.x&&t[0].y===l.y||(s.x+=l.x,s.y+=l.y,s.sampleCount++)}}function Wd(s,t){return s.x===t.x&&(s.x<0||s.x>bt)||s.y===t.y&&(s.y<0||s.y>bt)}function c0(s){return s.every(t=>t.x<0)||s.every(t=>t.x>bt)||s.every(t=>t.y<0)||s.every(t=>t.y>bt)}let gp;yt("FillExtrusionBucket",tc,{omit:["layers","features"]});var pm={get paint(){return gp=gp||new ca({"fill-extrusion-opacity":new gt(te["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new zt(te["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gt(te["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gt(te["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new gs(te["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new zt(te["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new zt(te["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gt(te["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class $i extends Rr{constructor(t){super(t,pm)}createBucket(t){return new tc(t)}queryRadius(){return Gh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:l,geometry:p,transform:b,pixelsToTileUnits:x,pixelPosMatrix:E}){const S=Fd(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-b.bearingInRadians,x),R=this.paint.get("fill-extrusion-height").evaluate(r,l),O=this.paint.get("fill-extrusion-base").evaluate(r,l),B=function(j,V,Y){const ee=[];for(const oe of j){const xe=[oe.x,oe.y,0,1];xa(xe,xe,V),ee.push(new Qe(xe[0]/xe[3],xe[1]/xe[3]))}return ee}(S,E),U=function(j,V,Y,ee){const oe=[],xe=[],ue=ee[8]*V,H=ee[9]*V,J=ee[10]*V,de=ee[11]*V,Oe=ee[8]*Y,at=ee[9]*Y,Ue=ee[10]*Y,Ye=ee[11]*Y;for(const ot of j){const rt=[],ct=[];for(const Xe of ot){const Tt=Xe.x,Lt=Xe.y,Pt=ee[0]*Tt+ee[4]*Lt+ee[12],Ct=ee[1]*Tt+ee[5]*Lt+ee[13],ui=ee[2]*Tt+ee[6]*Lt+ee[14],Pi=ee[3]*Tt+ee[7]*Lt+ee[15],ea=ui+J,ba=Pi+de,Fn=Pt+Oe,dn=Ct+at,ha=ui+Ue,da=Pi+Ye,Ya=new Qe((Pt+ue)/ba,(Ct+H)/ba);Ya.z=ea/ba,rt.push(Ya);const Ba=new Qe(Fn/da,dn/da);Ba.z=ha/da,ct.push(Ba)}oe.push(rt),xe.push(ct)}return[oe,xe]}(p,O,R,E);return function(j,V,Y){let ee=1/0;Yf(Y,V)&&(ee=_i(Y,V[0]));for(let oe=0;oe<V.length;oe++){const xe=V[oe],ue=j[oe];for(let H=0;H<xe.length-1;H++){const J=xe[H],de=[J,xe[H+1],ue[H+1],ue[H],J];Bd(Y,de)&&(ee=Math.min(ee,_i(Y,de)))}}return ee!==1/0&&ee}(U[0],U[1],B)}}function qi(s,t){return s.x*t.x+s.y*t.y}function _i(s,t){if(s.length===1){let r=0;const l=t[r++];let p;for(;!p||l.equals(p);)if(p=t[r++],!p)return 1/0;for(;r<t.length;r++){const b=t[r],x=s[0],E=p.sub(l),S=b.sub(l),R=x.sub(l),O=qi(E,E),B=qi(E,S),U=qi(S,S),j=qi(R,E),V=qi(R,S),Y=O*U-B*B,ee=(U*j-B*V)/Y,oe=(O*V-B*j)/Y,xe=l.z*(1-ee-oe)+p.z*ee+b.z*oe;if(isFinite(xe))return xe}return 1/0}{let r=1/0;for(const l of t)r=Math.min(r,l.z);return r}}const Mi=ra([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Xi}=Mi,Xr=ra([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:dl}=Xr,ah=xu.VectorTileFeature.types,h0=Math.cos(Math.PI/180*37.5),Lo=Math.pow(2,14)/.5;class Ia{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new St,this.layoutVertexArray2=new ii,this.indexArray=new wi,this.programConfigurations=new Qs(t.layers,t.zoom),this.segments=new Si,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,l){this.hasPattern=Yh("line",this.layers,r);const p=this.layers[0].layout.get("line-sort-key"),b=!p.isConstant(),x=[];for(const{feature:E,id:S,index:R,sourceLayerIndex:O}of t){const B=this.layers[0]._featureFilter.needGeometry,U=yr(E,B);if(!this.layers[0]._featureFilter.filter(new Yi(this.zoom),U,l))continue;const j=b?p.evaluate(U,{},l):void 0,V={id:S,properties:E.properties,type:E.type,sourceLayerIndex:O,index:R,geometry:B?U.geometry:Pr(E),patterns:{},sortKey:j};x.push(V)}b&&x.sort((E,S)=>E.sortKey-S.sortKey);for(const E of x){const{geometry:S,index:R,sourceLayerIndex:O}=E;if(this.hasPattern){const B=Vd("line",this.layers,E,this.zoom,r);this.patternFeatures.push(B)}else this.addFeature(E,S,R,l,{},r.subdivisionGranularity);r.featureIndex.insert(t[R].feature,S,R,O,this.index)}}update(t,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,l)}addFeatures(t,r,l){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,r,l,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,dl)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xi),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,l,p,b,x){const E=this.layers[0].layout,S=E.get("line-join").evaluate(t,{}),R=E.get("line-cap"),O=E.get("line-miter-limit"),B=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const U of r)this.addLine(U,t,S,R,O,B,p,x);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,b,p)}addLine(t,r,l,p,b,x,E,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=cl(t,E?S.line.getGranularityForZoomLevel(E.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ue=0;ue<t.length-1;ue++)this.totalDistance+=t[ue].dist(t[ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const R=ah[r.type]==="Polygon";let O=t.length;for(;O>=2&&t[O-1].equals(t[O-2]);)O--;let B=0;for(;B<O-1&&t[B].equals(t[B+1]);)B++;if(O<(R?3:2))return;l==="bevel"&&(b=1.05);const U=this.overscaling<=16?15*bt/(512*this.overscaling):0,j=this.segments.prepareSegment(10*O,this.layoutVertexArray,this.indexArray);let V,Y,ee,oe,xe;this.e1=this.e2=-1,R&&(V=t[O-2],xe=t[B].sub(V)._unit()._perp());for(let ue=B;ue<O;ue++){if(ee=ue===O-1?R?t[B+1]:void 0:t[ue+1],ee&&t[ue].equals(ee))continue;xe&&(oe=xe),V&&(Y=V),V=t[ue],xe=ee?ee.sub(V)._unit()._perp():oe,oe=oe||xe;let H=oe.add(xe);H.x===0&&H.y===0||H._unit();const J=oe.x*xe.x+oe.y*xe.y,de=H.x*xe.x+H.y*xe.y,Oe=de!==0?1/de:1/0,at=2*Math.sqrt(2-2*de),Ue=de<h0&&Y&&ee,Ye=oe.x*xe.y-oe.y*xe.x>0;if(Ue&&ue>B){const ct=V.dist(Y);if(ct>2*U){const Xe=V.sub(V.sub(Y)._mult(U/ct)._round());this.updateDistance(Y,Xe),this.addCurrentVertex(Xe,oe,0,0,j),Y=Xe}}const ot=Y&&ee;let rt=ot?l:R?"butt":p;if(ot&&rt==="round"&&(Oe<x?rt="miter":Oe<=2&&(rt="fakeround")),rt==="miter"&&Oe>b&&(rt="bevel"),rt==="bevel"&&(Oe>2&&(rt="flipbevel"),Oe<b&&(rt="miter")),Y&&this.updateDistance(Y,V),rt==="miter")H._mult(Oe),this.addCurrentVertex(V,H,0,0,j);else if(rt==="flipbevel"){if(Oe>100)H=xe.mult(-1);else{const ct=Oe*oe.add(xe).mag()/oe.sub(xe).mag();H._perp()._mult(ct*(Ye?-1:1))}this.addCurrentVertex(V,H,0,0,j),this.addCurrentVertex(V,H.mult(-1),0,0,j)}else if(rt==="bevel"||rt==="fakeround"){const ct=-Math.sqrt(Oe*Oe-1),Xe=Ye?ct:0,Tt=Ye?0:ct;if(Y&&this.addCurrentVertex(V,oe,Xe,Tt,j),rt==="fakeround"){const Lt=Math.round(180*at/Math.PI/20);for(let Pt=1;Pt<Lt;Pt++){let Ct=Pt/Lt;if(Ct!==.5){const Pi=Ct-.5;Ct+=Ct*Pi*(Ct-1)*((1.0904+J*(J*(3.55645-1.43519*J)-3.2452))*Pi*Pi+(.848013+J*(.215638*J-1.06021)))}const ui=xe.sub(oe)._mult(Ct)._add(oe)._unit()._mult(Ye?-1:1);this.addHalfVertex(V,ui.x,ui.y,!1,Ye,0,j)}}ee&&this.addCurrentVertex(V,xe,-Xe,-Tt,j)}else if(rt==="butt")this.addCurrentVertex(V,H,0,0,j);else if(rt==="square"){const ct=Y?1:-1;this.addCurrentVertex(V,H,ct,ct,j)}else rt==="round"&&(Y&&(this.addCurrentVertex(V,oe,0,0,j),this.addCurrentVertex(V,oe,1,1,j,!0)),ee&&(this.addCurrentVertex(V,xe,-1,-1,j,!0),this.addCurrentVertex(V,xe,0,0,j)));if(Ue&&ue<O-1){const ct=V.dist(ee);if(ct>2*U){const Xe=V.add(ee.sub(V)._mult(U/ct)._round());this.updateDistance(V,Xe),this.addCurrentVertex(Xe,xe,0,0,j),V=Xe}}}}addCurrentVertex(t,r,l,p,b,x=!1){const E=r.y*p-r.x,S=-r.y-r.x*p;this.addHalfVertex(t,r.x+r.y*l,r.y-r.x*l,x,!1,l,b),this.addHalfVertex(t,E,S,x,!0,-p,b),this.distance>Lo/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,l,p,b,x))}addHalfVertex({x:t,y:r},l,p,b,x,E,S){const R=.5*(this.lineClips?this.scaledDistance*(Lo-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(b?1:0),(r<<1)+(x?1:0),Math.round(63*l)+128,Math.round(63*p)+128,1+(E===0?0:E<0?-1:1)|(63&R)<<2,R>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const O=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,O,this.e2),S.primitiveLength++),x?this.e2=O:this.e1=O}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}let vu,fl;yt("LineBucket",Ia,{omit:["layers","patternFeatures"]});var Jd={get paint(){return fl=fl||new ca({"line-opacity":new zt(te.paint_line["line-opacity"]),"line-color":new zt(te.paint_line["line-color"]),"line-translate":new gt(te.paint_line["line-translate"]),"line-translate-anchor":new gt(te.paint_line["line-translate-anchor"]),"line-width":new zt(te.paint_line["line-width"]),"line-gap-width":new zt(te.paint_line["line-gap-width"]),"line-offset":new zt(te.paint_line["line-offset"]),"line-blur":new zt(te.paint_line["line-blur"]),"line-dasharray":new js(te.paint_line["line-dasharray"]),"line-pattern":new gs(te.paint_line["line-pattern"]),"line-gradient":new nl(te.paint_line["line-gradient"])})},get layout(){return vu=vu||new ca({"line-cap":new gt(te.layout_line["line-cap"]),"line-join":new zt(te.layout_line["line-join"]),"line-miter-limit":new gt(te.layout_line["line-miter-limit"]),"line-round-limit":new gt(te.layout_line["line-round-limit"]),"line-sort-key":new zt(te.layout_line["line-sort-key"])})}};class vs extends zt{possiblyEvaluate(t,r){return r=new Yi(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,l,p){return r=aa({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,l,p)}}let Tu;class Kh extends Rr{constructor(t){super(t,Jd),this.gradientVersion=0,Tu||(Tu=new vs(Jd.paint.properties["line-width"].specification),Tu.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(r)&&r._styleExpression.expression instanceof _o,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=Tu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Ia(t)}queryRadius(t){const r=t,l=xr(Yc("line-width",this,r),Yc("line-gap-width",this,r)),p=Yc("line-offset",this,r);return l/2+Math.abs(p)+Gh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:l,geometry:p,transform:b,pixelsToTileUnits:x}){const E=Fd(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-b.bearingInRadians,x),S=x/2*xr(this.paint.get("line-width").evaluate(r,l),this.paint.get("line-gap-width").evaluate(r,l)),R=this.paint.get("line-offset").evaluate(r,l);return R&&(p=function(O,B){const U=[];for(let j=0;j<O.length;j++){const V=O[j],Y=[];for(let ee=0;ee<V.length;ee++){const oe=V[ee-1],xe=V[ee],ue=V[ee+1],H=ee===0?new Qe(0,0):xe.sub(oe)._unit()._perp(),J=ee===V.length-1?new Qe(0,0):ue.sub(xe)._unit()._perp(),de=H._add(J)._unit(),Oe=de.x*J.x+de.y*J.y;Oe!==0&&de._mult(1/Oe),Y.push(de._mult(B)._add(xe))}U.push(Y)}return U}(p,R*x)),function(O,B,U){for(let j=0;j<B.length;j++){const V=B[j];if(O.length>=3){for(let Y=0;Y<V.length;Y++)if(ol(O,V[Y]))return!0}if(Jl(O,V,U))return!0}return!1}(E,p,S)}isTileClipped(){return!0}}function xr(s,t){return t>0?t+2*s:s}const d0=ra([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),f0=ra([{name:"a_projected_pos",components:3,type:"Float32"}],4);ra([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ef=ra([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ra([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Wh=ra([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),pl=ra([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function zn(s,t,r){return s.sections.forEach(l=>{l.text=function(p,b,x){const E=b.layout.get("text-transform").evaluate(x,{});return E==="uppercase"?p=p.toLocaleUpperCase():E==="lowercase"&&(p=p.toLocaleLowerCase()),ps.applyArabicShaping&&(p=ps.applyArabicShaping(p)),p}(l.text,t,r)}),s}ra([{name:"triangle",components:3,type:"Uint16"}]),ra([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ra([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ra([{type:"Float32",name:"offsetX"}]),ra([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ra([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ts={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ic,ml,tf,ka=24,af={};function Jh(){return ic||(ic=1,af.read=function(s,t,r,l,p){var b,x,E=8*p-l-1,S=(1<<E)-1,R=S>>1,O=-7,B=r?p-1:0,U=r?-1:1,j=s[t+B];for(B+=U,b=j&(1<<-O)-1,j>>=-O,O+=E;O>0;b=256*b+s[t+B],B+=U,O-=8);for(x=b&(1<<-O)-1,b>>=-O,O+=l;O>0;x=256*x+s[t+B],B+=U,O-=8);if(b===0)b=1-R;else{if(b===S)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,l),b-=R}return(j?-1:1)*x*Math.pow(2,b-l)},af.write=function(s,t,r,l,p,b){var x,E,S,R=8*b-p-1,O=(1<<R)-1,B=O>>1,U=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=l?0:b-1,V=l?1:-1,Y=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(E=isNaN(t)?1:0,x=O):(x=Math.floor(Math.log(t)/Math.LN2),t*(S=Math.pow(2,-x))<1&&(x--,S*=2),(t+=x+B>=1?U/S:U*Math.pow(2,1-B))*S>=2&&(x++,S/=2),x+B>=O?(E=0,x=O):x+B>=1?(E=(t*S-1)*Math.pow(2,p),x+=B):(E=t*Math.pow(2,B-1)*Math.pow(2,p),x=0));p>=8;s[r+j]=255&E,j+=V,E/=256,p-=8);for(x=x<<p|E,R+=p;R>0;s[r+j]=255&x,j+=V,x/=256,R-=8);s[r+j-V]|=128*Y}),af}function nf(){if(tf)return ml;tf=1,ml=t;var s=Jh();function t(H){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(H)?H:new Uint8Array(H||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var r=4294967296,l=1/r,p=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function b(H){return H.type===t.Bytes?H.readVarint()+H.pos:H.pos+1}function x(H,J,de){return de?4294967296*J+(H>>>0):4294967296*(J>>>0)+(H>>>0)}function E(H,J,de){var Oe=J<=16383?1:J<=2097151?2:J<=268435455?3:Math.floor(Math.log(J)/(7*Math.LN2));de.realloc(Oe);for(var at=de.pos-1;at>=H;at--)de.buf[at+Oe]=de.buf[at]}function S(H,J){for(var de=0;de<H.length;de++)J.writeVarint(H[de])}function R(H,J){for(var de=0;de<H.length;de++)J.writeSVarint(H[de])}function O(H,J){for(var de=0;de<H.length;de++)J.writeFloat(H[de])}function B(H,J){for(var de=0;de<H.length;de++)J.writeDouble(H[de])}function U(H,J){for(var de=0;de<H.length;de++)J.writeBoolean(H[de])}function j(H,J){for(var de=0;de<H.length;de++)J.writeFixed32(H[de])}function V(H,J){for(var de=0;de<H.length;de++)J.writeSFixed32(H[de])}function Y(H,J){for(var de=0;de<H.length;de++)J.writeFixed64(H[de])}function ee(H,J){for(var de=0;de<H.length;de++)J.writeSFixed64(H[de])}function oe(H,J){return(H[J]|H[J+1]<<8|H[J+2]<<16)+16777216*H[J+3]}function xe(H,J,de){H[de]=J,H[de+1]=J>>>8,H[de+2]=J>>>16,H[de+3]=J>>>24}function ue(H,J){return(H[J]|H[J+1]<<8|H[J+2]<<16)+(H[J+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(H,J,de){for(de=de||this.length;this.pos<de;){var Oe=this.readVarint(),at=Oe>>3,Ue=this.pos;this.type=7&Oe,H(at,J,this),this.pos===Ue&&this.skip(Oe)}return J},readMessage:function(H,J){return this.readFields(H,J,this.readVarint()+this.pos)},readFixed32:function(){var H=oe(this.buf,this.pos);return this.pos+=4,H},readSFixed32:function(){var H=ue(this.buf,this.pos);return this.pos+=4,H},readFixed64:function(){var H=oe(this.buf,this.pos)+oe(this.buf,this.pos+4)*r;return this.pos+=8,H},readSFixed64:function(){var H=oe(this.buf,this.pos)+ue(this.buf,this.pos+4)*r;return this.pos+=8,H},readFloat:function(){var H=s.read(this.buf,this.pos,!0,23,4);return this.pos+=4,H},readDouble:function(){var H=s.read(this.buf,this.pos,!0,52,8);return this.pos+=8,H},readVarint:function(H){var J,de,Oe=this.buf;return J=127&(de=Oe[this.pos++]),de<128?J:(J|=(127&(de=Oe[this.pos++]))<<7,de<128?J:(J|=(127&(de=Oe[this.pos++]))<<14,de<128?J:(J|=(127&(de=Oe[this.pos++]))<<21,de<128?J:function(at,Ue,Ye){var ot,rt,ct=Ye.buf;if(ot=(112&(rt=ct[Ye.pos++]))>>4,rt<128||(ot|=(127&(rt=ct[Ye.pos++]))<<3,rt<128)||(ot|=(127&(rt=ct[Ye.pos++]))<<10,rt<128)||(ot|=(127&(rt=ct[Ye.pos++]))<<17,rt<128)||(ot|=(127&(rt=ct[Ye.pos++]))<<24,rt<128)||(ot|=(1&(rt=ct[Ye.pos++]))<<31,rt<128))return x(at,ot,Ue);throw new Error("Expected varint not more than 10 bytes")}(J|=(15&(de=Oe[this.pos]))<<28,H,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var H=this.readVarint();return H%2==1?(H+1)/-2:H/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var H=this.readVarint()+this.pos,J=this.pos;return this.pos=H,H-J>=12&&p?function(de,Oe,at){return p.decode(de.subarray(Oe,at))}(this.buf,J,H):function(de,Oe,at){for(var Ue="",Ye=Oe;Ye<at;){var ot,rt,ct,Xe=de[Ye],Tt=null,Lt=Xe>239?4:Xe>223?3:Xe>191?2:1;if(Ye+Lt>at)break;Lt===1?Xe<128&&(Tt=Xe):Lt===2?(192&(ot=de[Ye+1]))==128&&(Tt=(31&Xe)<<6|63&ot)<=127&&(Tt=null):Lt===3?(rt=de[Ye+2],(192&(ot=de[Ye+1]))==128&&(192&rt)==128&&((Tt=(15&Xe)<<12|(63&ot)<<6|63&rt)<=2047||Tt>=55296&&Tt<=57343)&&(Tt=null)):Lt===4&&(rt=de[Ye+2],ct=de[Ye+3],(192&(ot=de[Ye+1]))==128&&(192&rt)==128&&(192&ct)==128&&((Tt=(15&Xe)<<18|(63&ot)<<12|(63&rt)<<6|63&ct)<=65535||Tt>=1114112)&&(Tt=null)),Tt===null?(Tt=65533,Lt=1):Tt>65535&&(Tt-=65536,Ue+=String.fromCharCode(Tt>>>10&1023|55296),Tt=56320|1023&Tt),Ue+=String.fromCharCode(Tt),Ye+=Lt}return Ue}(this.buf,J,H)},readBytes:function(){var H=this.readVarint()+this.pos,J=this.buf.subarray(this.pos,H);return this.pos=H,J},readPackedVarint:function(H,J){if(this.type!==t.Bytes)return H.push(this.readVarint(J));var de=b(this);for(H=H||[];this.pos<de;)H.push(this.readVarint(J));return H},readPackedSVarint:function(H){if(this.type!==t.Bytes)return H.push(this.readSVarint());var J=b(this);for(H=H||[];this.pos<J;)H.push(this.readSVarint());return H},readPackedBoolean:function(H){if(this.type!==t.Bytes)return H.push(this.readBoolean());var J=b(this);for(H=H||[];this.pos<J;)H.push(this.readBoolean());return H},readPackedFloat:function(H){if(this.type!==t.Bytes)return H.push(this.readFloat());var J=b(this);for(H=H||[];this.pos<J;)H.push(this.readFloat());return H},readPackedDouble:function(H){if(this.type!==t.Bytes)return H.push(this.readDouble());var J=b(this);for(H=H||[];this.pos<J;)H.push(this.readDouble());return H},readPackedFixed32:function(H){if(this.type!==t.Bytes)return H.push(this.readFixed32());var J=b(this);for(H=H||[];this.pos<J;)H.push(this.readFixed32());return H},readPackedSFixed32:function(H){if(this.type!==t.Bytes)return H.push(this.readSFixed32());var J=b(this);for(H=H||[];this.pos<J;)H.push(this.readSFixed32());return H},readPackedFixed64:function(H){if(this.type!==t.Bytes)return H.push(this.readFixed64());var J=b(this);for(H=H||[];this.pos<J;)H.push(this.readFixed64());return H},readPackedSFixed64:function(H){if(this.type!==t.Bytes)return H.push(this.readSFixed64());var J=b(this);for(H=H||[];this.pos<J;)H.push(this.readSFixed64());return H},skip:function(H){var J=7&H;if(J===t.Varint)for(;this.buf[this.pos++]>127;);else if(J===t.Bytes)this.pos=this.readVarint()+this.pos;else if(J===t.Fixed32)this.pos+=4;else{if(J!==t.Fixed64)throw new Error("Unimplemented type: "+J);this.pos+=8}},writeTag:function(H,J){this.writeVarint(H<<3|J)},realloc:function(H){for(var J=this.length||16;J<this.pos+H;)J*=2;if(J!==this.length){var de=new Uint8Array(J);de.set(this.buf),this.buf=de,this.length=J}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(H){this.realloc(4),xe(this.buf,H,this.pos),this.pos+=4},writeSFixed32:function(H){this.realloc(4),xe(this.buf,H,this.pos),this.pos+=4},writeFixed64:function(H){this.realloc(8),xe(this.buf,-1&H,this.pos),xe(this.buf,Math.floor(H*l),this.pos+4),this.pos+=8},writeSFixed64:function(H){this.realloc(8),xe(this.buf,-1&H,this.pos),xe(this.buf,Math.floor(H*l),this.pos+4),this.pos+=8},writeVarint:function(H){(H=+H||0)>268435455||H<0?function(J,de){var Oe,at;if(J>=0?(Oe=J%4294967296|0,at=J/4294967296|0):(at=~(-J/4294967296),4294967295^(Oe=~(-J%4294967296))?Oe=Oe+1|0:(Oe=0,at=at+1|0)),J>=18446744073709552e3||J<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");de.realloc(10),function(Ue,Ye,ot){ot.buf[ot.pos++]=127&Ue|128,Ue>>>=7,ot.buf[ot.pos++]=127&Ue|128,Ue>>>=7,ot.buf[ot.pos++]=127&Ue|128,Ue>>>=7,ot.buf[ot.pos++]=127&Ue|128,ot.buf[ot.pos]=127&(Ue>>>=7)}(Oe,0,de),function(Ue,Ye){var ot=(7&Ue)<<4;Ye.buf[Ye.pos++]|=ot|((Ue>>>=3)?128:0),Ue&&(Ye.buf[Ye.pos++]=127&Ue|((Ue>>>=7)?128:0),Ue&&(Ye.buf[Ye.pos++]=127&Ue|((Ue>>>=7)?128:0),Ue&&(Ye.buf[Ye.pos++]=127&Ue|((Ue>>>=7)?128:0),Ue&&(Ye.buf[Ye.pos++]=127&Ue|((Ue>>>=7)?128:0),Ue&&(Ye.buf[Ye.pos++]=127&Ue)))))}(at,de)}(H,this):(this.realloc(4),this.buf[this.pos++]=127&H|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=H>>>7&127))))},writeSVarint:function(H){this.writeVarint(H<0?2*-H-1:2*H)},writeBoolean:function(H){this.writeVarint(!!H)},writeString:function(H){H=String(H),this.realloc(4*H.length),this.pos++;var J=this.pos;this.pos=function(Oe,at,Ue){for(var Ye,ot,rt=0;rt<at.length;rt++){if((Ye=at.charCodeAt(rt))>55295&&Ye<57344){if(!ot){Ye>56319||rt+1===at.length?(Oe[Ue++]=239,Oe[Ue++]=191,Oe[Ue++]=189):ot=Ye;continue}if(Ye<56320){Oe[Ue++]=239,Oe[Ue++]=191,Oe[Ue++]=189,ot=Ye;continue}Ye=ot-55296<<10|Ye-56320|65536,ot=null}else ot&&(Oe[Ue++]=239,Oe[Ue++]=191,Oe[Ue++]=189,ot=null);Ye<128?Oe[Ue++]=Ye:(Ye<2048?Oe[Ue++]=Ye>>6|192:(Ye<65536?Oe[Ue++]=Ye>>12|224:(Oe[Ue++]=Ye>>18|240,Oe[Ue++]=Ye>>12&63|128),Oe[Ue++]=Ye>>6&63|128),Oe[Ue++]=63&Ye|128)}return Ue}(this.buf,H,this.pos);var de=this.pos-J;de>=128&&E(J,de,this),this.pos=J-1,this.writeVarint(de),this.pos+=de},writeFloat:function(H){this.realloc(4),s.write(this.buf,H,this.pos,!0,23,4),this.pos+=4},writeDouble:function(H){this.realloc(8),s.write(this.buf,H,this.pos,!0,52,8),this.pos+=8},writeBytes:function(H){var J=H.length;this.writeVarint(J),this.realloc(J);for(var de=0;de<J;de++)this.buf[this.pos++]=H[de]},writeRawMessage:function(H,J){this.pos++;var de=this.pos;H(J,this);var Oe=this.pos-de;Oe>=128&&E(de,Oe,this),this.pos=de-1,this.writeVarint(Oe),this.pos+=Oe},writeMessage:function(H,J,de){this.writeTag(H,t.Bytes),this.writeRawMessage(J,de)},writePackedVarint:function(H,J){J.length&&this.writeMessage(H,S,J)},writePackedSVarint:function(H,J){J.length&&this.writeMessage(H,R,J)},writePackedBoolean:function(H,J){J.length&&this.writeMessage(H,U,J)},writePackedFloat:function(H,J){J.length&&this.writeMessage(H,O,J)},writePackedDouble:function(H,J){J.length&&this.writeMessage(H,B,J)},writePackedFixed32:function(H,J){J.length&&this.writeMessage(H,j,J)},writePackedSFixed32:function(H,J){J.length&&this.writeMessage(H,V,J)},writePackedFixed64:function(H,J){J.length&&this.writeMessage(H,Y,J)},writePackedSFixed64:function(H,J){J.length&&this.writeMessage(H,ee,J)},writeBytesField:function(H,J){this.writeTag(H,t.Bytes),this.writeBytes(J)},writeFixed32Field:function(H,J){this.writeTag(H,t.Fixed32),this.writeFixed32(J)},writeSFixed32Field:function(H,J){this.writeTag(H,t.Fixed32),this.writeSFixed32(J)},writeFixed64Field:function(H,J){this.writeTag(H,t.Fixed64),this.writeFixed64(J)},writeSFixed64Field:function(H,J){this.writeTag(H,t.Fixed64),this.writeSFixed64(J)},writeVarintField:function(H,J){this.writeTag(H,t.Varint),this.writeVarint(J)},writeSVarintField:function(H,J){this.writeTag(H,t.Varint),this.writeSVarint(J)},writeStringField:function(H,J){this.writeTag(H,t.Bytes),this.writeString(J)},writeFloatField:function(H,J){this.writeTag(H,t.Fixed32),this.writeFloat(J)},writeDoubleField:function(H,J){this.writeTag(H,t.Fixed64),this.writeDouble(J)},writeBooleanField:function(H,J){this.writeVarintField(H,!!J)}},ml}var vr=K(nf());const rf=3;function Qr(s,t,r){s===1&&r.readMessage(_p,t)}function _p(s,t,r){if(s===3){const{id:l,bitmap:p,width:b,height:x,left:E,top:S,advance:R}=r.readMessage(yp,{});t.push({id:l,bitmap:new Xc({width:b+2*rf,height:x+2*rf},p),metrics:{width:b,height:x,left:E,top:S,advance:R}})}}function yp(s,t,r){s===1?t.id=r.readVarint():s===2?t.bitmap=r.readBytes():s===3?t.width=r.readVarint():s===4?t.height=r.readVarint():s===5?t.left=r.readSVarint():s===6?t.top=r.readSVarint():s===7&&(t.advance=r.readVarint())}const mm=rf;function Eu(s){let t=0,r=0;for(const x of s)t+=x.w*x.h,r=Math.max(r,x.w);s.sort((x,E)=>E.h-x.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let p=0,b=0;for(const x of s)for(let E=l.length-1;E>=0;E--){const S=l[E];if(!(x.w>S.w||x.h>S.h)){if(x.x=S.x,x.y=S.y,b=Math.max(b,x.y+x.h),p=Math.max(p,x.x+x.w),x.w===S.w&&x.h===S.h){const R=l.pop();E<l.length&&(l[E]=R)}else x.h===S.h?(S.x+=x.w,S.w-=x.w):x.w===S.w?(S.y+=x.h,S.h-=x.h):(l.push({x:S.x+x.w,y:S.y,w:S.w-x.w,h:x.h}),S.y+=x.h,S.h-=x.h);break}}return{w:p,h:b,fill:t/(p*b)||0}}const Mn=1;class ed{constructor(t,{pixelRatio:r,version:l,stretchX:p,stretchY:b,content:x,textFitWidth:E,textFitHeight:S}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=p,this.stretchY=b,this.content=x,this.version=l,this.textFitWidth=E,this.textFitHeight=S}get tl(){return[this.paddedRect.x+Mn,this.paddedRect.y+Mn]}get br(){return[this.paddedRect.x+this.paddedRect.w-Mn,this.paddedRect.y+this.paddedRect.h-Mn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Mn)/this.pixelRatio,(this.paddedRect.h-2*Mn)/this.pixelRatio]}}class ac{constructor(t,r){const l={},p={};this.haveRenderCallbacks=[];const b=[];this.addImages(t,l,b),this.addImages(r,p,b);const{w:x,h:E}=Eu(b),S=new Lr({width:x||1,height:E||1});for(const R in t){const O=t[R],B=l[R].paddedRect;Lr.copy(O.data,S,{x:0,y:0},{x:B.x+Mn,y:B.y+Mn},O.data)}for(const R in r){const O=r[R],B=p[R].paddedRect,U=B.x+Mn,j=B.y+Mn,V=O.data.width,Y=O.data.height;Lr.copy(O.data,S,{x:0,y:0},{x:U,y:j},O.data),Lr.copy(O.data,S,{x:0,y:Y-1},{x:U,y:j-1},{width:V,height:1}),Lr.copy(O.data,S,{x:0,y:0},{x:U,y:j+Y},{width:V,height:1}),Lr.copy(O.data,S,{x:V-1,y:0},{x:U-1,y:j},{width:1,height:Y}),Lr.copy(O.data,S,{x:0,y:0},{x:U+V,y:j},{width:1,height:Y})}this.image=S,this.iconPositions=l,this.patternPositions=p}addImages(t,r,l){for(const p in t){const b=t[p],x={x:0,y:0,w:b.data.width+2*Mn,h:b.data.height+2*Mn};l.push(x),r[p]=new ed(x,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),r),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),r)}patchUpdatedImage(t,r,l){if(!t||!r||t.version===r.version)return;t.version=r.version;const[p,b]=t.tl;l.update(r.data,void 0,{x:p,y:b})}}var wu;yt("ImagePosition",ed),yt("ImageAtlas",ac),M.al=void 0,(wu=M.al||(M.al={}))[wu.none=0]="none",wu[wu.horizontal=1]="horizontal",wu[wu.vertical=2]="vertical",wu[wu.horizontalOnly=3]="horizontalOnly";const td=-17;class nh{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,r,l){const p=new nh;return p.scale=t||1,p.fontStack=r,p.verticalAlign=l||"bottom",p}static forImage(t,r){const l=new nh;return l.imageName=t,l.verticalAlign=r||"bottom",l}}class gl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const l=new gl;for(let p=0;p<t.sections.length;p++){const b=t.sections[p];b.image?l.addImageSection(b):l.addTextSection(b,r)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let r="";for(let l=0;l<t.length;l++){const p=t.charCodeAt(l+1)||null,b=t.charCodeAt(l-1)||null;r+=p&&Hs(p)&&!Ts[t[l+1]]||b&&Hs(b)&&!Ts[t[l-1]]||!Ts[t[l]]?t[l]:Ts[t[l]]}return r}(this.text)}trim(){let t=0;for(let l=0;l<this.text.length&&sf[this.text.charCodeAt(l)];l++)t++;let r=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&sf[this.text.charCodeAt(l)];l--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const l=new gl;return l.text=this.text.substring(t,r),l.sectionIndex=this.sectionIndex.slice(t,r),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}getMaxImageSize(t){let r=0,l=0;for(let p=0;p<this.length();p++){const b=this.getSection(p);if(b.imageName){const x=t[b.imageName];if(!x)continue;const E=x.displaySize;r=Math.max(r,E[0]),l=Math.max(l,E[1])}}return{maxImageWidth:r,maxImageHeight:l}}addTextSection(t,r){this.text+=t.text,this.sections.push(nh.forText(t.scale,t.fontStack||r,t.verticalAlign));const l=this.sections.length-1;for(let p=0;p<t.text.length;++p)this.sectionIndex.push(l)}addImageSection(t){const r=t.image?t.image.name:"";if(r.length===0)return void on("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(nh.forImage(r,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):on("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function rh(s,t,r,l,p,b,x,E,S,R,O,B,U,j,V){const Y=gl.fromFeature(s,p);let ee;B===M.al.vertical&&Y.verticalizePunctuation();const{processBidirectionalText:oe,processStyledBidirectionalText:xe}=ps;if(oe&&Y.sections.length===1){ee=[];const J=oe(Y.toString(),of(Y,R,b,t,l,j));for(const de of J){const Oe=new gl;Oe.text=de,Oe.sections=Y.sections;for(let at=0;at<de.length;at++)Oe.sectionIndex.push(0);ee.push(Oe)}}else if(xe){ee=[];const J=xe(Y.text,Y.sectionIndex,of(Y,R,b,t,l,j));for(const de of J){const Oe=new gl;Oe.text=de[0],Oe.sectionIndex=de[1],Oe.sections=Y.sections,ee.push(Oe)}}else ee=function(J,de){const Oe=[],at=J.text;let Ue=0;for(const Ye of de)Oe.push(J.substring(Ue,Ye)),Ue=Ye;return Ue<at.length&&Oe.push(J.substring(Ue,at.length)),Oe}(Y,of(Y,R,b,t,l,j));const ue=[],H={positionedLines:ue,text:Y.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(J,de,Oe,at,Ue,Ye,ot,rt,ct,Xe,Tt,Lt){let Pt=0,Ct=0,ui=0,Pi=0;const ea=rt==="right"?1:rt==="left"?0:.5,ba=ka/Lt;let Fn=0;for(const da of Ue){da.trim();const Ya=da.getMaxScale(),Ba={positionedGlyphs:[],lineOffset:0};J.positionedLines[Fn]=Ba;const fn=Ba.positionedGlyphs;let Un=0;if(!da.length()){Ct+=Ye,++Fn;continue}const Jn=bp(at,da,ba);for(let Tr=0;Tr<da.length();Tr++){const Da=da.getSection(Tr),za=da.getSectionIndex(Tr),Xa=da.getCharCode(Tr),fa=xp(ct,Tt,Xa);let Vi;if(Da.imageName){if(J.iconsInText=!0,Da.scale=Da.scale*ba,Vi=vp(Da,fa,Ya,Jn,at),!Vi)continue;Un=Math.max(Un,Vi.imageOffset)}else if(Vi=lf(Da,Xa,fa,Jn,de,Oe),!Vi)continue;const{rect:Or,metrics:hc,baselineOffset:io}=Vi;fn.push({glyph:Xa,imageName:Da.imageName,x:Pt,y:Ct+io+td,vertical:fa,scale:Da.scale,fontStack:Da.fontStack,sectionIndex:za,metrics:hc,rect:Or}),fa?(J.verticalizable=!0,Pt+=(Da.imageName?hc.advance:ka)*Da.scale+Xe):Pt+=hc.advance*Da.scale+Xe}fn.length!==0&&(ui=Math.max(Pt-Xe,ui),Tp(fn,0,fn.length-1,ea)),Pt=0,Ba.lineOffset=Math.max(Un,(Ya-1)*ka);const $a=Ye*Ya+Un;Ct+=$a,Pi=Math.max($a,Pi),++Fn}const{horizontalAlign:dn,verticalAlign:ha}=uf(ot);(function(da,Ya,Ba,fn,Un,Jn,$a,Tr,Da){const za=(Ya-Ba)*Un;let Xa=0;Xa=Jn!==$a?-Tr*fn-td:-fn*Da*$a+.5*$a;for(const fa of da)for(const Vi of fa.positionedGlyphs)Vi.x+=za,Vi.y+=Xa})(J.positionedLines,ea,dn,ha,ui,Pi,Ye,Ct,Ue.length),J.top+=-ha*Ct,J.bottom=J.top+Ct,J.left+=-dn*ui,J.right=J.left+ui}(H,t,r,l,ee,x,E,S,B,R,U,V),!function(J){for(const de of J)if(de.positionedGlyphs.length!==0)return!1;return!0}(ue)&&H}const sf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},gm={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},_m={40:!0};function p0(s,t,r,l,p,b){if(t.imageName){const x=l[t.imageName];return x?x.displaySize[0]*t.scale*ka/b+p:0}{const x=r[t.fontStack],E=x&&x[s];return E?E.metrics.advance*t.scale+p:0}}function m0(s,t,r,l){const p=Math.pow(s-t,2);return l?s<t?p/2:2*p:p+Math.abs(r)*r}function sh(s,t,r){let l=0;return s===10&&(l-=1e4),r&&(l+=150),s!==40&&s!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function id(s,t,r,l,p,b){let x=null,E=m0(t,r,p,b);for(const S of l){const R=m0(t-S.x,r,p,b)+S.badness;R<=E&&(x=S,E=R)}return{index:s,x:t,priorBreak:x,badness:E}}function g0(s){return s?g0(s.priorBreak).concat(s.index):[]}function of(s,t,r,l,p,b){if(!s)return[];const x=[],E=function(B,U,j,V,Y,ee){let oe=0;for(let xe=0;xe<B.length();xe++){const ue=B.getSection(xe);oe+=p0(B.getCharCode(xe),ue,V,Y,U,ee)}return oe/Math.max(1,Math.ceil(oe/j))}(s,t,r,l,p,b),S=s.text.indexOf("")>=0;let R=0;for(let B=0;B<s.length();B++){const U=s.getSection(B),j=s.getCharCode(B);if(sf[j]||(R+=p0(j,U,l,p,t,b)),B<s.length()-1){const V=!((O=j)<11904)&&(!!ri["CJK Compatibility Forms"](O)||!!ri["CJK Compatibility"](O)||!!ri["CJK Strokes"](O)||!!ri["CJK Symbols and Punctuation"](O)||!!ri["Enclosed CJK Letters and Months"](O)||!!ri["Halfwidth and Fullwidth Forms"](O)||!!ri["Ideographic Description Characters"](O)||!!ri["Vertical Forms"](O)||fs.test(String.fromCodePoint(O)));(gm[j]||V||U.imageName||B!==s.length()-2&&_m[s.getCharCode(B+1)])&&x.push(id(B+1,R,E,x,sh(j,s.getCharCode(B+1),V&&S),!1))}}var O;return g0(id(s.length(),R,E,x,0,!0))}function uf(s){let t=.5,r=.5;switch(s){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function bp(s,t,r){const l=t.getMaxScale()*ka,{maxImageWidth:p,maxImageHeight:b}=t.getMaxImageSize(s),x=Math.max(l,b*r);return{verticalLineContentWidth:Math.max(l,p*r),horizontalLineContentHeight:x}}function _0(s){switch(s){case"top":return 0;case"center":return .5;default:return 1}}function xp(s,t,r){return!(s===M.al.horizontal||!t&&!Gr(r)||t&&(sf[r]||(l=r,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(l)))));var l}function lf(s,t,r,l,p,b){const x=b[s.fontStack],E=function(R,O,B,U){if(R&&R.rect)return R;const j=O[B.fontStack],V=j&&j[U];return V?{rect:null,metrics:V.metrics}:null}(x&&x[t],p,s,t);if(E===null)return null;let S;if(r)S=l.verticalLineContentWidth-s.scale*ka;else{const R=_0(s.verticalAlign);S=(l.horizontalLineContentHeight-s.scale*ka)*R}return{rect:E.rect,metrics:E.metrics,baselineOffset:S}}function vp(s,t,r,l,p){const b=p[s.imageName];if(!b)return null;const x=b.paddedRect,E=b.displaySize,S={width:E[0],height:E[1],left:Mn,top:-3,advance:t?E[1]:E[0]};let R;if(t)R=l.verticalLineContentWidth-E[1]*s.scale;else{const O=_0(s.verticalAlign);R=(l.horizontalLineContentHeight-E[1]*s.scale)*O}return{rect:x,metrics:S,baselineOffset:R,imageOffset:(t?E[0]:E[1])*s.scale-ka*r}}function Tp(s,t,r,l){if(l===0)return;const p=s[r],b=(s[r].x+p.metrics.advance*p.scale)*l;for(let x=t;x<=r;x++)s[x].x-=b}function la(s,t,r){const{horizontalAlign:l,verticalAlign:p}=uf(r),b=t[0]-s.displaySize[0]*l,x=t[1]-s.displaySize[1]*p;return{image:s,top:x,bottom:x+s.displaySize[1],left:b,right:b+s.displaySize[0]}}function cf(s){var t,r;let l=s.left,p=s.top,b=s.right-l,x=s.bottom-p;const E=(t=s.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",S=(r=s.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",R=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(S==="proportional"){if(E==="stretchOnly"&&b/x<R||E==="proportional"){const O=Math.ceil(x*R);l*=O/b,b=O}}else if(E==="proportional"&&S==="stretchOnly"&&R!==0&&b/x>R){const O=Math.ceil(b/R);p*=O/x,x=O}return{x1:l,y1:p,x2:l+b,y2:p+x}}function Ep(s,t,r,l,p,b){const x=s.image;let E;if(x.content){const ee=x.content,oe=x.pixelRatio||1;E=[ee[0]/oe,ee[1]/oe,x.displaySize[0]-ee[2]/oe,x.displaySize[1]-ee[3]/oe]}const S=t.left*b,R=t.right*b;let O,B,U,j;r==="width"||r==="both"?(j=p[0]+S-l[3],B=p[0]+R+l[1]):(j=p[0]+(S+R-x.displaySize[0])/2,B=j+x.displaySize[0]);const V=t.top*b,Y=t.bottom*b;return r==="height"||r==="both"?(O=p[1]+V-l[0],U=p[1]+Y+l[2]):(O=p[1]+(V+Y-x.displaySize[1])/2,U=O+x.displaySize[1]),{image:x,top:O,right:B,bottom:U,left:j,collisionPadding:E}}const oh=255,No=128,_l=oh*No;function wp(s,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Yi(s+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:p}=r;let b=0;for(;b<l.length&&l[b]<=s;)b++;b=Math.max(0,b-1);let x=b;for(;x<l.length&&l[x]<s+1;)x++;x=Math.min(l.length-1,x);const E=l[b],S=l[x];return r.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:S,interpolationType:p}:{kind:"camera",minZoom:E,maxZoom:S,minSize:r.evaluate(new Yi(E)),maxSize:r.evaluate(new Yi(S)),interpolationType:p}}}function uh(s,t,r){let l="never";const p=s.get(t);return p?l=p:s.get(r)&&(l="always"),l}const lh=xu.VectorTileFeature.types,y0=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nc(s,t,r,l,p,b,x,E,S,R,O,B,U){const j=E?Math.min(_l,Math.round(E[0])):0,V=E?Math.min(_l,Math.round(E[1])):0;s.emplaceBack(t,r,Math.round(32*l),Math.round(32*p),b,x,(j<<1)+(S?1:0),V,16*R,16*O,256*B,256*U)}function ad(s,t,r){s.emplaceBack(t.x,t.y,r),s.emplaceBack(t.x,t.y,r),s.emplaceBack(t.x,t.y,r),s.emplaceBack(t.x,t.y,r)}function rc(s){for(const t of s.sections)if($l(t.text))return!0;return!1}class Es{constructor(t){this.layoutVertexArray=new oa,this.indexArray=new wi,this.programConfigurations=t,this.segments=new Si,this.dynamicLayoutVertexArray=new ki,this.opacityVertexArray=new ua,this.hasVisibleVertices=!1,this.placedSymbolArray=new me}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,l,p){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,d0.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,f0.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,y0,!0),this.opacityVertexBuffer.itemSize=1),(l||p)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}yt("SymbolBuffers",Es);class sc{constructor(t,r,l){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new l,this.segments=new Si,this.collisionVertexArray=new ji}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,ef.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}yt("CollisionBuffers",sc);class ch{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(x=>x.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wp(this.zoom,r["text-size"]),this.iconSizeData=wp(this.zoom,r["icon-size"]);const l=this.layers[0].layout,p=l.get("symbol-sort-key"),b=l.get("symbol-z-order");this.canOverlap=uh(l,"text-overlap","text-allow-overlap")!=="never"||uh(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(x=>M.al[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=t.sourceID}createArrays(){this.text=new Es(new Qs(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Es(new Qs(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Ee,this.lineVertexArray=new be,this.symbolInstances=new ye,this.textAnchorOffsets=new $e}calculateGlyphDependencies(t,r,l,p,b){for(let x=0;x<t.length;x++)if(r[t.charCodeAt(x)]=!0,(l||p)&&b){const E=Ts[t.charAt(x)];E&&(r[E.charCodeAt(0)]=!0)}}populate(t,r,l){const p=this.layers[0],b=p.layout,x=b.get("text-font"),E=b.get("text-field"),S=b.get("icon-image"),R=(E.value.kind!=="constant"||E.value.value instanceof Va&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),O=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,B=b.get("symbol-sort-key");if(this.features=[],!R&&!O)return;const U=r.iconDependencies,j=r.glyphDependencies,V=r.availableImages,Y=new Yi(this.zoom);for(const{feature:ee,id:oe,index:xe,sourceLayerIndex:ue}of t){const H=p._featureFilter.needGeometry,J=yr(ee,H);if(!p._featureFilter.filter(Y,J,l))continue;let de,Oe;if(H||(J.geometry=Pr(ee)),R){const Ue=p.getValueAndResolveTokens("text-field",J,l,V),Ye=Va.factory(Ue),ot=this.hasRTLText=this.hasRTLText||rc(Ye);(!ot||ps.getRTLTextPluginStatus()==="unavailable"||ot&&ps.isParsed())&&(de=zn(Ye,p,J))}if(O){const Ue=p.getValueAndResolveTokens("icon-image",J,l,V);Oe=Ue instanceof Ln?Ue:Ln.fromString(Ue)}if(!de&&!Oe)continue;const at=this.sortFeaturesByKey?B.evaluate(J,{},l):void 0;if(this.features.push({id:oe,text:de,icon:Oe,index:xe,sourceLayerIndex:ue,geometry:J.geometry,properties:ee.properties,type:lh[ee.type],sortKey:at}),Oe&&(U[Oe.name]=!0),de){const Ue=x.evaluate(J,{},l).join(","),Ye=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(M.al.vertical)>=0;for(const ot of de.sections)if(ot.image)U[ot.image.name]=!0;else{const rt=Zl(de.toString()),ct=ot.fontStack||Ue,Xe=j[ct]=j[ct]||{};this.calculateGlyphDependencies(ot.text,Xe,Ye,this.allowVerticalPlacement,rt)}}}b.get("symbol-placement")==="line"&&(this.features=function(ee){const oe={},xe={},ue=[];let H=0;function J(Ue){ue.push(ee[Ue]),H++}function de(Ue,Ye,ot){const rt=xe[Ue];return delete xe[Ue],xe[Ye]=rt,ue[rt].geometry[0].pop(),ue[rt].geometry[0]=ue[rt].geometry[0].concat(ot[0]),rt}function Oe(Ue,Ye,ot){const rt=oe[Ye];return delete oe[Ye],oe[Ue]=rt,ue[rt].geometry[0].shift(),ue[rt].geometry[0]=ot[0].concat(ue[rt].geometry[0]),rt}function at(Ue,Ye,ot){const rt=ot?Ye[0][Ye[0].length-1]:Ye[0][0];return`${Ue}:${rt.x}:${rt.y}`}for(let Ue=0;Ue<ee.length;Ue++){const Ye=ee[Ue],ot=Ye.geometry,rt=Ye.text?Ye.text.toString():null;if(!rt){J(Ue);continue}const ct=at(rt,ot),Xe=at(rt,ot,!0);if(ct in xe&&Xe in oe&&xe[ct]!==oe[Xe]){const Tt=Oe(ct,Xe,ot),Lt=de(ct,Xe,ue[Tt].geometry);delete oe[ct],delete xe[Xe],xe[at(rt,ue[Lt].geometry,!0)]=Lt,ue[Tt].geometry=null}else ct in xe?de(ct,Xe,ot):Xe in oe?Oe(ct,Xe,ot):(J(Ue),oe[ct]=H-1,xe[Xe]=H-1)}return ue.filter(Ue=>Ue.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ee,oe)=>ee.sortKey-oe.sortKey)}update(t,r,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,l),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const l=this.lineVertexArray.length;if(t.segment!==void 0){let p=t.dist(r[t.segment+1]),b=t.dist(r[t.segment]);const x={};for(let E=t.segment+1;E<r.length;E++)x[E]={x:r[E].x,y:r[E].y,tileUnitDistanceFromAnchor:p},E<r.length-1&&(p+=r[E+1].dist(r[E]));for(let E=t.segment||0;E>=0;E--)x[E]={x:r[E].x,y:r[E].y,tileUnitDistanceFromAnchor:b},E>0&&(b+=r[E-1].dist(r[E]));for(let E=0;E<r.length;E++){const S=x[E];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,r,l,p,b,x,E,S,R,O,B,U){const j=t.indexArray,V=t.layoutVertexArray,Y=t.segments.prepareSegment(4*r.length,V,j,this.canOverlap?x.sortKey:void 0),ee=this.glyphOffsetArray.length,oe=Y.vertexLength,xe=this.allowVerticalPlacement&&E===M.al.vertical?Math.PI/2:0,ue=x.text&&x.text.sections;for(let H=0;H<r.length;H++){const{tl:J,tr:de,bl:Oe,br:at,tex:Ue,pixelOffsetTL:Ye,pixelOffsetBR:ot,minFontScaleX:rt,minFontScaleY:ct,glyphOffset:Xe,isSDF:Tt,sectionIndex:Lt}=r[H],Pt=Y.vertexLength,Ct=Xe[1];nc(V,S.x,S.y,J.x,Ct+J.y,Ue.x,Ue.y,l,Tt,Ye.x,Ye.y,rt,ct),nc(V,S.x,S.y,de.x,Ct+de.y,Ue.x+Ue.w,Ue.y,l,Tt,ot.x,Ye.y,rt,ct),nc(V,S.x,S.y,Oe.x,Ct+Oe.y,Ue.x,Ue.y+Ue.h,l,Tt,Ye.x,ot.y,rt,ct),nc(V,S.x,S.y,at.x,Ct+at.y,Ue.x+Ue.w,Ue.y+Ue.h,l,Tt,ot.x,ot.y,rt,ct),ad(t.dynamicLayoutVertexArray,S,xe),j.emplaceBack(Pt,Pt+2,Pt+1),j.emplaceBack(Pt+1,Pt+2,Pt+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Xe[0]),H!==r.length-1&&Lt===r[H+1].sectionIndex||t.programConfigurations.populatePaintArrays(V.length,x,x.index,{},U,ue&&ue[Lt])}t.placedSymbolArray.emplaceBack(S.x,S.y,ee,this.glyphOffsetArray.length-ee,oe,R,O,S.segment,l?l[0]:0,l?l[1]:0,p[0],p[1],E,0,!1,0,B)}_addCollisionDebugVertex(t,r,l,p,b,x){return r.emplaceBack(0,0),t.emplaceBack(l.x,l.y,p,b,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(t,r,l,p,b,x,E){const S=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),R=S.vertexLength,O=b.layoutVertexArray,B=b.collisionVertexArray,U=E.anchorX,j=E.anchorY;this._addCollisionDebugVertex(O,B,x,U,j,new Qe(t,r)),this._addCollisionDebugVertex(O,B,x,U,j,new Qe(l,r)),this._addCollisionDebugVertex(O,B,x,U,j,new Qe(l,p)),this._addCollisionDebugVertex(O,B,x,U,j,new Qe(t,p)),S.vertexLength+=4;const V=b.indexArray;V.emplaceBack(R,R+1),V.emplaceBack(R+1,R+2),V.emplaceBack(R+2,R+3),V.emplaceBack(R+3,R),S.primitiveLength+=4}addDebugCollisionBoxes(t,r,l,p){for(let b=t;b<r;b++){const x=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,p?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new sc(Ji,Wh.members,La),this.iconCollisionBox=new sc(Ji,Wh.members,La);for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,l,p,b,x,E,S,R){const O={};for(let B=r;B<l;B++){const U=t.get(B);O.textBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},O.textFeatureIndex=U.featureIndex;break}for(let B=p;B<b;B++){const U=t.get(B);O.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},O.verticalTextFeatureIndex=U.featureIndex;break}for(let B=x;B<E;B++){const U=t.get(B);O.iconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},O.iconFeatureIndex=U.featureIndex;break}for(let B=S;B<R;B++){const U=t.get(B);O.verticalIconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},O.verticalIconFeatureIndex=U.featureIndex;break}return O}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const l=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){const l=t.placedSymbolArray.get(r),p=l.vertexStartIndex+4*l.numGlyphs;for(let b=l.vertexStartIndex;b<p;b+=4)t.indexArray.emplaceBack(b,b+2,b+1),t.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),l=Math.cos(t),p=[],b=[],x=[];for(let E=0;E<this.symbolInstances.length;++E){x.push(E);const S=this.symbolInstances.get(E);p.push(0|Math.round(r*S.anchorX+l*S.anchorY)),b.push(S.featureIndex)}return x.sort((E,S)=>p[E]-p[S]||b[S]-b[E]),x}addToSortKeyRanges(t,r){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===r?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const l=this.symbolInstances.get(r);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((p,b,x)=>{p>=0&&x.indexOf(p)===b&&this.addIndicesForPlacedSymbol(this.text,p)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let b0,x0;yt("SymbolBucket",ch,{omit:["layers","collisionBoxArray","features","compareText"]}),ch.MAX_GLYPHS=65535,ch.addDynamicAttributes=ad;var hf={get paint(){return x0=x0||new ca({"icon-opacity":new zt(te.paint_symbol["icon-opacity"]),"icon-color":new zt(te.paint_symbol["icon-color"]),"icon-halo-color":new zt(te.paint_symbol["icon-halo-color"]),"icon-halo-width":new zt(te.paint_symbol["icon-halo-width"]),"icon-halo-blur":new zt(te.paint_symbol["icon-halo-blur"]),"icon-translate":new gt(te.paint_symbol["icon-translate"]),"icon-translate-anchor":new gt(te.paint_symbol["icon-translate-anchor"]),"text-opacity":new zt(te.paint_symbol["text-opacity"]),"text-color":new zt(te.paint_symbol["text-color"],{runtimeType:Fi,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new zt(te.paint_symbol["text-halo-color"]),"text-halo-width":new zt(te.paint_symbol["text-halo-width"]),"text-halo-blur":new zt(te.paint_symbol["text-halo-blur"]),"text-translate":new gt(te.paint_symbol["text-translate"]),"text-translate-anchor":new gt(te.paint_symbol["text-translate-anchor"])})},get layout(){return b0=b0||new ca({"symbol-placement":new gt(te.layout_symbol["symbol-placement"]),"symbol-spacing":new gt(te.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gt(te.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new zt(te.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gt(te.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new gt(te.layout_symbol["icon-allow-overlap"]),"icon-overlap":new gt(te.layout_symbol["icon-overlap"]),"icon-ignore-placement":new gt(te.layout_symbol["icon-ignore-placement"]),"icon-optional":new gt(te.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gt(te.layout_symbol["icon-rotation-alignment"]),"icon-size":new zt(te.layout_symbol["icon-size"]),"icon-text-fit":new gt(te.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new gt(te.layout_symbol["icon-text-fit-padding"]),"icon-image":new zt(te.layout_symbol["icon-image"]),"icon-rotate":new zt(te.layout_symbol["icon-rotate"]),"icon-padding":new zt(te.layout_symbol["icon-padding"]),"icon-keep-upright":new gt(te.layout_symbol["icon-keep-upright"]),"icon-offset":new zt(te.layout_symbol["icon-offset"]),"icon-anchor":new zt(te.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gt(te.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gt(te.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gt(te.layout_symbol["text-rotation-alignment"]),"text-field":new zt(te.layout_symbol["text-field"]),"text-font":new zt(te.layout_symbol["text-font"]),"text-size":new zt(te.layout_symbol["text-size"]),"text-max-width":new zt(te.layout_symbol["text-max-width"]),"text-line-height":new gt(te.layout_symbol["text-line-height"]),"text-letter-spacing":new zt(te.layout_symbol["text-letter-spacing"]),"text-justify":new zt(te.layout_symbol["text-justify"]),"text-radial-offset":new zt(te.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gt(te.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new zt(te.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new zt(te.layout_symbol["text-anchor"]),"text-max-angle":new gt(te.layout_symbol["text-max-angle"]),"text-writing-mode":new gt(te.layout_symbol["text-writing-mode"]),"text-rotate":new zt(te.layout_symbol["text-rotate"]),"text-padding":new gt(te.layout_symbol["text-padding"]),"text-keep-upright":new gt(te.layout_symbol["text-keep-upright"]),"text-transform":new zt(te.layout_symbol["text-transform"]),"text-offset":new zt(te.layout_symbol["text-offset"]),"text-allow-overlap":new gt(te.layout_symbol["text-allow-overlap"]),"text-overlap":new gt(te.layout_symbol["text-overlap"]),"text-ignore-placement":new gt(te.layout_symbol["text-ignore-placement"]),"text-optional":new gt(te.layout_symbol["text-optional"])})}};class v0{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:jt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}yt("FormatSectionOverride",v0,{omit:["defaultValue"]});class df extends Rr{constructor(t){super(t,hf)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const p=[];for(const b of l)p.indexOf(b)<0&&p.push(b);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,l,p){const b=this.layout.get(t).evaluate(r,{},l,p),x=this._unevaluatedLayout._values[t];return x.isDataDriven()||uu(x.value)||!b?b:function(E,S){return S.replace(/{([^{}]+)}/g,(R,O)=>E&&O in E?String(E[O]):"")}(r.properties,b)}createBucket(t){return new ch(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of hf.paint.overridableProperties){if(!df.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),l=new v0(r),p=new Qu(l,r.property.specification);let b=null;b=r.value.kind==="constant"||r.value.kind==="source"?new vo("source",p):new lu("composite",p,r.value.zoomStops),this.paint._values[t]=new qt(r.property,b,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,l){return!(!this.layout||r.isDataDriven()||l.isDataDriven())&&df.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const l=t.get("text-field"),p=hf.paint.properties[r];let b=!1;const x=E=>{for(const S of E)if(p.overrides&&p.overrides.hasOverride(S))return void(b=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Va)x(l.value.value.sections);else if(l.value.kind==="source"){const E=R=>{b||(R instanceof Zt&&Wi(R.value)===Lu?x(R.value.sections):R instanceof wc?x(R.sections):R.eachChild(E))},S=l.value;S._styleExpression&&E(S._styleExpression.expression)}return b}}let ff;var Ap={get paint(){return ff=ff||new ca({"background-color":new gt(te.paint_background["background-color"]),"background-pattern":new js(te.paint_background["background-pattern"]),"background-opacity":new gt(te.paint_background["background-opacity"])})}};class Sp extends Rr{constructor(t){super(t,Ap)}}let Cp;var T0={get paint(){return Cp=Cp||new ca({"raster-opacity":new gt(te.paint_raster["raster-opacity"]),"raster-hue-rotate":new gt(te.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gt(te.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gt(te.paint_raster["raster-brightness-max"]),"raster-saturation":new gt(te.paint_raster["raster-saturation"]),"raster-contrast":new gt(te.paint_raster["raster-contrast"]),"raster-resampling":new gt(te.paint_raster["raster-resampling"]),"raster-fade-duration":new gt(te.paint_raster["raster-fade-duration"])})}};class E0 extends Rr{constructor(t){super(t,T0)}}class ym extends Rr{constructor(t){super(t,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class bm{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const nd={once:!0},w0=63710088e-1;class Au{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Au(Vt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,l=this.lat*r,p=t.lat*r,b=Math.sin(l)*Math.sin(p)+Math.cos(l)*Math.cos(p)*Math.cos((t.lng-this.lng)*r);return w0*Math.acos(Math.min(b,1))}static convert(t){if(t instanceof Au)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Au(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Au(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const yi=2*Math.PI*w0;function pf(s){return yi*Math.cos(s*Math.PI/180)}function rd(s){return(180+s)/360}function mf(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function A0(s,t){return s/pf(t)}function sd(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function hh(s,t){return s*pf(sd(t))}class yl{constructor(t,r,l=0){this.x=+t,this.y=+r,this.z=+l}static fromLngLat(t,r=0){const l=Au.convert(t);return new yl(rd(l.lng),mf(l.lat),A0(r,l.lat))}toLngLat(){return new Au(360*this.x-180,sd(this.y))}toAltitude(){return hh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/yi*(t=sd(this.y),1/Math.cos(t*Math.PI/180));var t}}function oc(s,t,r){var l=2*Math.PI*6378137/256/Math.pow(2,r);return[s*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class gf{constructor(t,r,l){if(!function(p,b,x){return!(p<0||p>25||x<0||x>=Math.pow(2,p)||b<0||b>=Math.pow(2,p))}(t,r,l))throw new Error(`x=${r}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=l,this.key=uc(0,t,t,r,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,l){const p=(x=this.y,E=this.z,S=oc(256*(b=this.x),256*(x=Math.pow(2,E)-x-1),E),R=oc(256*(b+1),256*(x+1),E),S[0]+","+S[1]+","+R[0]+","+R[1]);var b,x,E,S,R;const O=function(B,U,j){let V,Y="";for(let ee=B;ee>0;ee--)V=1<<ee-1,Y+=(U&V?1:0)+(j&V?2:0);return Y}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,O).replace(/{bbox-epsg-3857}/g,p)}isChildOf(t){const r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){const r=Math.pow(2,this.z);return new Qe((t.x*r-this.x)*bt,(t.y*r-this.y)*bt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Mp{constructor(t,r){this.wrap=t,this.canonical=r,this.key=uc(t,r.z,r.z,r.x,r.y)}}class Kr{constructor(t,r,l,p,b){if(this.terrainRttPosMatrix32f=null,t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=r,this.canonical=new gf(l,+p,+b),this.key=uc(r,t,l,p,b)}clone(){return new Kr(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-t;return t>this.canonical.z?new Kr(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Kr(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?uc(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):uc(this.wrap*+r,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new Kr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,l=2*this.canonical.x,p=2*this.canonical.y;return[new Kr(r,this.wrap,r,l,p),new Kr(r,this.wrap,r,l+1,p),new Kr(r,this.wrap,r,l,p+1),new Kr(r,this.wrap,r,l+1,p+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Kr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Kr(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Mp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new yl(t.x-this.wrap,t.y))}}function uc(s,t,r,l,p){(s*=2)<0&&(s=-1*s-1);const b=1<<r;return(b*b*s+b*p+l).toString(36)+r.toString(36)+t.toString(36)}yt("CanonicalTileID",gf),yt("OverscaledTileID",Kr,{omit:["terrainRttPosMatrix32f"]});class S0{constructor(t,r,l,p=1,b=1,x=1,E=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void on(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const S=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=b,this.blueFactor=x,this.baseShift=E;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let R=0;R<S;R++)this.data[this._idx(-1,R)]=this.data[this._idx(0,R)],this.data[this._idx(S,R)]=this.data[this._idx(S-1,R)],this.data[this._idx(R,-1)]=this.data[this._idx(R,0)],this.data[this._idx(R,S)]=this.data[this._idx(R,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let R=0;R<S;R++)for(let O=0;O<S;O++){const B=this.get(R,O);B>this.max&&(this.max=B),B<this.min&&(this.min=B)}}get(t,r){const l=new Uint8Array(this.data.buffer),p=4*this._idx(t,r);return this.unpack(l[p],l[p+1],l[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,l){return t*this.redFactor+r*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new Lr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let p=r*this.dim,b=r*this.dim+this.dim,x=l*this.dim,E=l*this.dim+this.dim;switch(r){case-1:p=b-1;break;case 1:b=p+1}switch(l){case-1:x=E-1;break;case 1:E=x+1}const S=-r*this.dim,R=-l*this.dim;for(let O=x;O<E;O++)for(let B=p;B<b;B++)this.data[this._idx(B,O)]=t.data[this._idx(B+S,O+R)]}}yt("DEMData",S0);class od{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const l=t[r];this._stringToNumber[l]=r,this._numberToString[r]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Qi{constructor(t,r,l,p,b){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=l,t._y=p,this.properties=t.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(t[r]=this[r]);return t}}class _f{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Us(bt,16,0),this.grid3D=new Us(bt,16,0),this.featureIndexArray=new He,this.promoteId=r}insert(t,r,l,p,b,x){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,p,b);const S=x?this.grid3D:this.grid;for(let R=0;R<r.length;R++){const O=r[R],B=[1/0,1/0,-1/0,-1/0];for(let U=0;U<O.length;U++){const j=O[U];B[0]=Math.min(B[0],j.x),B[1]=Math.min(B[1],j.y),B[2]=Math.max(B[2],j.x),B[3]=Math.max(B[3],j.y)}B[0]<bt&&B[1]<bt&&B[2]>=0&&B[3]>=0&&S.insert(E,B[0],B[1],B[2],B[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new xu.VectorTile(new vr(this.rawTileData)).layers,this.sourceLayerCoder=new od(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,l,p){this.loadVTLayers();const b=t.params,x=bt/t.tileSize/t.scale,E=dr(b.filter),S=t.queryGeometry,R=t.queryPadding*x,O=Ip(S),B=this.grid.query(O.minX-R,O.minY-R,O.maxX+R,O.maxY+R),U=Ip(t.cameraQueryGeometry),j=this.grid3D.query(U.minX-R,U.minY-R,U.maxX+R,U.maxY+R,(ee,oe,xe,ue)=>function(H,J,de,Oe,at){for(const Ye of H)if(J<=Ye.x&&de<=Ye.y&&Oe>=Ye.x&&at>=Ye.y)return!0;const Ue=[new Qe(J,de),new Qe(J,at),new Qe(Oe,at),new Qe(Oe,de)];if(H.length>2){for(const Ye of Ue)if(ol(H,Ye))return!0}for(let Ye=0;Ye<H.length-1;Ye++)if(Xf(H[Ye],H[Ye+1],Ue))return!0;return!1}(t.cameraQueryGeometry,ee-R,oe-R,xe+R,ue+R));for(const ee of j)B.push(ee);B.sort(C0);const V={};let Y;for(let ee=0;ee<B.length;ee++){const oe=B[ee];if(oe===Y)continue;Y=oe;const xe=this.featureIndexArray.get(oe);let ue=null;this.loadMatchingFeature(V,xe.bucketIndex,xe.sourceLayerIndex,xe.featureIndex,E,b.layers,b.availableImages,r,l,p,(H,J,de)=>(ue||(ue=Pr(H)),J.queryIntersectsFeature({queryGeometry:S,feature:H,featureState:de,geometry:ue,zoom:this.z,transform:t.transform,pixelsToTileUnits:x,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return V}loadMatchingFeature(t,r,l,p,b,x,E,S,R,O,B){const U=this.bucketLayerIDs[r];if(x&&!U.some(ee=>x.has(ee)))return;const j=this.sourceLayerCoder.decode(l),V=this.vtLayers[j].feature(p);if(b.needGeometry){const ee=yr(V,!0);if(!b.filter(new Yi(this.tileID.overscaledZ),ee,this.tileID.canonical))return}else if(!b.filter(new Yi(this.tileID.overscaledZ),V))return;const Y=this.getId(V,j);for(let ee=0;ee<U.length;ee++){const oe=U[ee];if(x&&!x.has(oe))continue;const xe=S[oe];if(!xe)continue;let ue={};Y&&O&&(ue=O.getState(xe.sourceLayer||"_geojsonTileLayer",Y));const H=aa({},R[oe]);H.paint=In(H.paint,xe.paint,V,ue,E),H.layout=In(H.layout,xe.layout,V,ue,E);const J=!B||B(V,xe,ue);if(!J)continue;const de=new Qi(V,this.z,this.x,this.y,Y);de.layer=H;let Oe=t[oe];Oe===void 0&&(Oe=t[oe]=[]),Oe.push({featureIndex:p,feature:de,intersectionZ:J})}}lookupSymbolFeatures(t,r,l,p,b,x,E,S){const R={};this.loadVTLayers();const O=dr(b);for(const B of t)this.loadMatchingFeature(R,l,p,B,O,x,E,S,r);return R}hasLayer(t){for(const r of this.bucketLayerIDs)for(const l of r)if(t===l)return!0;return!1}getId(t,r){var l;let p=t.id;return this.promoteId&&(p=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof p=="boolean"&&(p=Number(p)),p===void 0&&(!((l=t.properties)===null||l===void 0)&&l.cluster)&&this.promoteId&&(p=Number(t.properties.cluster_id))),p}}function In(s,t,r,l,p){return qn(s,(b,x)=>{const E=t instanceof Ri?t.get(x):null;return E&&E.evaluate?E.evaluate(r,l,p):E})}function Ip(s){let t=1/0,r=1/0,l=-1/0,p=-1/0;for(const b of s)t=Math.min(t,b.x),r=Math.min(r,b.y),l=Math.max(l,b.x),p=Math.max(p,b.y);return{minX:t,minY:r,maxX:l,maxY:p}}function C0(s,t){return t-s}function yf(s,t,r,l,p){const b=[];for(let x=0;x<s.length;x++){const E=s[x];let S;for(let R=0;R<E.length-1;R++){let O=E[R],B=E[R+1];O.x<t&&B.x<t||(O.x<t?O=new Qe(t,O.y+(t-O.x)/(B.x-O.x)*(B.y-O.y))._round():B.x<t&&(B=new Qe(t,O.y+(t-O.x)/(B.x-O.x)*(B.y-O.y))._round()),O.y<r&&B.y<r||(O.y<r?O=new Qe(O.x+(r-O.y)/(B.y-O.y)*(B.x-O.x),r)._round():B.y<r&&(B=new Qe(O.x+(r-O.y)/(B.y-O.y)*(B.x-O.x),r)._round()),O.x>=l&&B.x>=l||(O.x>=l?O=new Qe(l,O.y+(l-O.x)/(B.x-O.x)*(B.y-O.y))._round():B.x>=l&&(B=new Qe(l,O.y+(l-O.x)/(B.x-O.x)*(B.y-O.y))._round()),O.y>=p&&B.y>=p||(O.y>=p?O=new Qe(O.x+(p-O.y)/(B.y-O.y)*(B.x-O.x),p)._round():B.y>=p&&(B=new Qe(O.x+(p-O.y)/(B.y-O.y)*(B.x-O.x),p)._round()),S&&O.equals(S[S.length-1])||(S=[O],b.push(S)),S.push(B)))))}}return b}yt("FeatureIndex",_f,{omit:["rawTileData","sourceLayerCoder"]});class to extends Qe{constructor(t,r,l,p){super(t,r),this.angle=l,p!==void 0&&(this.segment=p)}clone(){return new to(this.x,this.y,this.angle,this.segment)}}function M0(s,t,r,l,p){if(t.segment===void 0||r===0)return!0;let b=t,x=t.segment+1,E=0;for(;E>-r/2;){if(x--,x<0)return!1;E-=s[x].dist(b),b=s[x]}E+=s[x].dist(s[x+1]),x++;const S=[];let R=0;for(;E<r/2;){const O=s[x],B=s[x+1];if(!B)return!1;let U=s[x-1].angleTo(O)-O.angleTo(B);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:E,angleDelta:U}),R+=U;E-S[0].distance>l;)R-=S.shift().angleDelta;if(R>p)return!1;x++,E+=O.dist(B)}return!0}function I0(s){let t=0;for(let r=0;r<s.length-1;r++)t+=s[r].dist(s[r+1]);return t}function bf(s,t,r){return s?.6*t*r:0}function xf(s,t){return Math.max(s?s.right-s.left:0,t?t.right-t.left:0)}function xm(s,t,r,l,p,b){const x=bf(r,p,b),E=xf(r,l)*b;let S=0;const R=I0(s)/2;for(let O=0;O<s.length-1;O++){const B=s[O],U=s[O+1],j=B.dist(U);if(S+j>R){const V=(R-S)/j,Y=as.number(B.x,U.x,V),ee=as.number(B.y,U.y,V),oe=new to(Y,ee,U.angleTo(B),O);return oe._round(),!x||M0(s,oe,E,x,t)?oe:void 0}S+=j}}function Dp(s,t,r,l,p,b,x,E,S){const R=bf(l,b,x),O=xf(l,p),B=O*x,U=s[0].x===0||s[0].x===S||s[0].y===0||s[0].y===S;return t-B<t/4&&(t=B+t/4),Rp(s,U?t/2*E%t:(O/2+2*b)*x*E%t,t,R,r,B,U,!1,S)}function Rp(s,t,r,l,p,b,x,E,S){const R=b/2,O=I0(s);let B=0,U=t-r,j=[];for(let V=0;V<s.length-1;V++){const Y=s[V],ee=s[V+1],oe=Y.dist(ee),xe=ee.angleTo(Y);for(;U+r<B+oe;){U+=r;const ue=(U-B)/oe,H=as.number(Y.x,ee.x,ue),J=as.number(Y.y,ee.y,ue);if(H>=0&&H<S&&J>=0&&J<S&&U-R>=0&&U+R<=O){const de=new to(H,J,xe,V);de._round(),l&&!M0(s,de,b,l,p)||j.push(de)}}B+=oe}return E||j.length||x||(j=Rp(s,B/2,r,l,p,b,x,!0,S)),j}yt("Anchor",to);const dh=Mn;function Pp(s,t,r,l){const p=[],b=s.image,x=b.pixelRatio,E=b.paddedRect.w-2*dh,S=b.paddedRect.h-2*dh;let R={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const O=b.stretchX||[[0,E]],B=b.stretchY||[[0,S]],U=(Xe,Tt)=>Xe+Tt[1]-Tt[0],j=O.reduce(U,0),V=B.reduce(U,0),Y=E-j,ee=S-V;let oe=0,xe=j,ue=0,H=V,J=0,de=Y,Oe=0,at=ee;if(b.content&&l){const Xe=b.content,Tt=Xe[2]-Xe[0],Lt=Xe[3]-Xe[1];(b.textFitWidth||b.textFitHeight)&&(R=cf(s)),oe=vf(O,0,Xe[0]),ue=vf(B,0,Xe[1]),xe=vf(O,Xe[0],Xe[2]),H=vf(B,Xe[1],Xe[3]),J=Xe[0]-oe,Oe=Xe[1]-ue,de=Tt-xe,at=Lt-H}const Ue=R.x1,Ye=R.y1,ot=R.x2-Ue,rt=R.y2-Ye,ct=(Xe,Tt,Lt,Pt)=>{const Ct=ud(Xe.stretch-oe,xe,ot,Ue),ui=fh(Xe.fixed-J,de,Xe.stretch,j),Pi=ud(Tt.stretch-ue,H,rt,Ye),ea=fh(Tt.fixed-Oe,at,Tt.stretch,V),ba=ud(Lt.stretch-oe,xe,ot,Ue),Fn=fh(Lt.fixed-J,de,Lt.stretch,j),dn=ud(Pt.stretch-ue,H,rt,Ye),ha=fh(Pt.fixed-Oe,at,Pt.stretch,V),da=new Qe(Ct,Pi),Ya=new Qe(ba,Pi),Ba=new Qe(ba,dn),fn=new Qe(Ct,dn),Un=new Qe(ui/x,ea/x),Jn=new Qe(Fn/x,ha/x),$a=t*Math.PI/180;if($a){const za=Math.sin($a),Xa=Math.cos($a),fa=[Xa,-za,za,Xa];da._matMult(fa),Ya._matMult(fa),fn._matMult(fa),Ba._matMult(fa)}const Tr=Xe.stretch+Xe.fixed,Da=Tt.stretch+Tt.fixed;return{tl:da,tr:Ya,bl:fn,br:Ba,tex:{x:b.paddedRect.x+dh+Tr,y:b.paddedRect.y+dh+Da,w:Lt.stretch+Lt.fixed-Tr,h:Pt.stretch+Pt.fixed-Da},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Un,pixelOffsetBR:Jn,minFontScaleX:de/x/ot,minFontScaleY:at/x/rt,isSDF:r}};if(l&&(b.stretchX||b.stretchY)){const Xe=Su(O,Y,j),Tt=Su(B,ee,V);for(let Lt=0;Lt<Xe.length-1;Lt++){const Pt=Xe[Lt],Ct=Xe[Lt+1];for(let ui=0;ui<Tt.length-1;ui++)p.push(ct(Pt,Tt[ui],Ct,Tt[ui+1]))}}else p.push(ct({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:S+1}));return p}function vf(s,t,r){let l=0;for(const p of s)l+=Math.max(t,Math.min(r,p[1]))-Math.max(t,Math.min(r,p[0]));return l}function Su(s,t,r){const l=[{fixed:-1,stretch:0}];for(const[p,b]of s){const x=l[l.length-1];l.push({fixed:p-x.stretch,stretch:x.stretch}),l.push({fixed:p-x.stretch,stretch:x.stretch+(b-p)})}return l.push({fixed:t+dh,stretch:r}),l}function ud(s,t,r,l){return s/t*r+l}function fh(s,t,r,l){return s-t*r/l}class Tf{constructor(t,r,l,p,b,x,E,S,R,O){var B;if(this.boxStartIndex=t.length,R){let U=x.top,j=x.bottom;const V=x.collisionPadding;V&&(U-=V[1],j+=V[3]);let Y=j-U;Y>0&&(Y=Math.max(10,Y),this.circleDiameter=Y)}else{const U=!((B=x.image)===null||B===void 0)&&B.content&&(x.image.textFitWidth||x.image.textFitHeight)?cf(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};U.y1=U.y1*E-S[0],U.y2=U.y2*E+S[2],U.x1=U.x1*E-S[3],U.x2=U.x2*E+S[1];const j=x.collisionPadding;if(j&&(U.x1-=j[0]*E,U.y1-=j[1]*E,U.x2+=j[2]*E,U.y2+=j[3]*E),O){const V=new Qe(U.x1,U.y1),Y=new Qe(U.x2,U.y1),ee=new Qe(U.x1,U.y2),oe=new Qe(U.x2,U.y2),xe=O*Math.PI/180;V._rotate(xe),Y._rotate(xe),ee._rotate(xe),oe._rotate(xe),U.x1=Math.min(V.x,Y.x,ee.x,oe.x),U.x2=Math.max(V.x,Y.x,ee.x,oe.x),U.y1=Math.min(V.y,Y.y,ee.y,oe.y),U.y2=Math.max(V.y,Y.y,ee.y,oe.y)}t.emplaceBack(r.x,r.y,U.x1,U.y1,U.x2,U.y2,l,p,b)}this.boxEndIndex=t.length}}class vm{constructor(t=[],r=(l,p)=>l<p?-1:l>p?1:0){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:r,compare:l}=this,p=r[t];for(;t>0;){const b=t-1>>1,x=r[b];if(l(p,x)>=0)break;r[t]=x,t=b}r[t]=p}_down(t){const{data:r,compare:l}=this,p=this.length>>1,b=r[t];for(;t<p;){let x=1+(t<<1);const E=x+1;if(E<this.length&&l(r[E],r[x])<0&&(x=E),l(r[x],b)>=0)break;r[t]=r[x],t=x}r[t]=b}}function D0(s,t=1,r=!1){let l=1/0,p=1/0,b=-1/0,x=-1/0;const E=s[0];for(let j=0;j<E.length;j++){const V=E[j];(!j||V.x<l)&&(l=V.x),(!j||V.y<p)&&(p=V.y),(!j||V.x>b)&&(b=V.x),(!j||V.y>x)&&(x=V.y)}const S=Math.min(b-l,x-p);let R=S/2;const O=new vm([],Tm);if(S===0)return new Qe(l,p);for(let j=l;j<b;j+=S)for(let V=p;V<x;V+=S)O.push(new Wn(j+R,V+R,R,s));let B=function(j){let V=0,Y=0,ee=0;const oe=j[0];for(let xe=0,ue=oe.length,H=ue-1;xe<ue;H=xe++){const J=oe[xe],de=oe[H],Oe=J.x*de.y-de.x*J.y;Y+=(J.x+de.x)*Oe,ee+=(J.y+de.y)*Oe,V+=3*Oe}return new Wn(Y/V,ee/V,0,j)}(s),U=O.length;for(;O.length;){const j=O.pop();(j.d>B.d||!B.d)&&(B=j,r&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,U)),j.max-B.d<=t||(R=j.h/2,O.push(new Wn(j.p.x-R,j.p.y-R,R,s)),O.push(new Wn(j.p.x+R,j.p.y-R,R,s)),O.push(new Wn(j.p.x-R,j.p.y+R,R,s)),O.push(new Wn(j.p.x+R,j.p.y+R,R,s)),U+=4)}return r&&(console.log(`num probes: ${U}`),console.log(`best distance: ${B.d}`)),B.p}function Tm(s,t){return t.max-s.max}function Wn(s,t,r,l){this.p=new Qe(s,t),this.h=r,this.d=function(p,b){let x=!1,E=1/0;for(let S=0;S<b.length;S++){const R=b[S];for(let O=0,B=R.length,U=B-1;O<B;U=O++){const j=R[O],V=R[U];j.y>p.y!=V.y>p.y&&p.x<(V.x-j.x)*(p.y-j.y)/(V.y-j.y)+j.x&&(x=!x),E=Math.min(E,$f(p,j,V))}}return(x?1:-1)*Math.sqrt(E)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var rn;M.aB=void 0,(rn=M.aB||(M.aB={}))[rn.center=1]="center",rn[rn.left=2]="left",rn[rn.right=3]="right",rn[rn.top=4]="top",rn[rn.bottom=5]="bottom",rn[rn["top-left"]=6]="top-left",rn[rn["top-right"]=7]="top-right",rn[rn["bottom-left"]=8]="bottom-left",rn[rn["bottom-right"]=9]="bottom-right";const Cu=7,Ef=Number.POSITIVE_INFINITY;function ph(s,t){return t[1]!==Ef?function(r,l,p){let b=0,x=0;switch(l=Math.abs(l),p=Math.abs(p),r){case"top-right":case"top-left":case"top":x=p-Cu;break;case"bottom-right":case"bottom-left":case"bottom":x=-p+Cu}switch(r){case"top-right":case"bottom-right":case"right":b=-l;break;case"top-left":case"bottom-left":case"left":b=l}return[b,x]}(s,t[0],t[1]):function(r,l){let p=0,b=0;l<0&&(l=0);const x=l/Math.SQRT2;switch(r){case"top-right":case"top-left":b=x-Cu;break;case"bottom-right":case"bottom-left":b=-x+Cu;break;case"bottom":b=-l+Cu;break;case"top":b=l-Cu}switch(r){case"top-right":case"bottom-right":p=-x;break;case"top-left":case"bottom-left":p=x;break;case"left":p=l;break;case"right":p=-l}return[p,b]}(s,t[0])}function Wr(s,t,r){var l;const p=s.layout,b=(l=p.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},r);if(b){const E=b.values,S=[];for(let R=0;R<E.length;R+=2){const O=S[R]=E[R],B=E[R+1].map(U=>U*ka);O.startsWith("top")?B[1]-=Cu:O.startsWith("bottom")&&(B[1]+=Cu),S[R+1]=B}return new ma(S)}const x=p.get("text-variable-anchor");if(x){let E;E=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(t,{},r)*ka,Ef]:p.get("text-offset").evaluate(t,{},r).map(R=>R*ka);const S=[];for(const R of x)S.push(R,ph(R,E));return new ma(S)}return null}function wf(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Af(s,t,r,l,p,b,x,E,S,R,O,B){let U=b.textMaxSize.evaluate(t,{});U===void 0&&(U=x);const j=s.layers[0].layout,V=j.get("icon-offset").evaluate(t,{},O),Y=Lp(r.horizontal),ee=x/24,oe=s.tilePixelRatio*ee,xe=s.tilePixelRatio*U/24,ue=s.tilePixelRatio*E,H=s.tilePixelRatio*j.get("symbol-spacing"),J=j.get("text-padding")*s.tilePixelRatio,de=function(Lt,Pt,Ct,ui=1){const Pi=Lt.get("icon-padding").evaluate(Pt,{},Ct),ea=Pi&&Pi.values;return[ea[0]*ui,ea[1]*ui,ea[2]*ui,ea[3]*ui]}(j,t,O,s.tilePixelRatio),Oe=j.get("text-max-angle")/180*Math.PI,at=j.get("text-rotation-alignment")!=="viewport"&&j.get("symbol-placement")!=="point",Ue=j.get("icon-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",Ye=j.get("symbol-placement"),ot=H/2,rt=j.get("icon-text-fit");let ct;l&&rt!=="none"&&(s.allowVerticalPlacement&&r.vertical&&(ct=Ep(l,r.vertical,rt,j.get("icon-text-fit-padding"),V,ee)),Y&&(l=Ep(l,Y,rt,j.get("icon-text-fit-padding"),V,ee)));const Xe=O?B.line.getGranularityForZoomLevel(O.z):1,Tt=(Lt,Pt)=>{Pt.x<0||Pt.x>=bt||Pt.y<0||Pt.y>=bt||function(Ct,ui,Pi,ea,ba,Fn,dn,ha,da,Ya,Ba,fn,Un,Jn,$a,Tr,Da,za,Xa,fa,Vi,Or,hc,io,If){const a=Ct.addToLineVertexArray(ui,Pi);let u,h,_,w,D=0,q=0,Q=0,ge=0,ze=-1,tt=-1;const nt={};let qe=mr("");if(Ct.allowVerticalPlacement&&ea.vertical){const Hn=ha.layout.get("text-rotate").evaluate(Vi,{},io)+90;_=new Tf(da,ui,Ya,Ba,fn,ea.vertical,Un,Jn,$a,Hn),dn&&(w=new Tf(da,ui,Ya,Ba,fn,dn,Da,za,$a,Hn))}if(ba){const Hn=ha.layout.get("icon-rotate").evaluate(Vi,{}),ao=ha.layout.get("icon-text-fit")!=="none",cd=Pp(ba,Hn,hc,ao),Mu=dn?Pp(dn,Hn,hc,ao):void 0;h=new Tf(da,ui,Ya,Ba,fn,ba,Da,za,!1,Hn),D=4*cd.length;const hd=Ct.iconSizeData;let vl=null;hd.kind==="source"?(vl=[No*ha.layout.get("icon-size").evaluate(Vi,{})],vl[0]>_l&&on(`${Ct.layerIds[0]}: Value for "icon-size" is >= ${oh}. Reduce your "icon-size".`)):hd.kind==="composite"&&(vl=[No*Or.compositeIconSizes[0].evaluate(Vi,{},io),No*Or.compositeIconSizes[1].evaluate(Vi,{},io)],(vl[0]>_l||vl[1]>_l)&&on(`${Ct.layerIds[0]}: Value for "icon-size" is >= ${oh}. Reduce your "icon-size".`)),Ct.addSymbols(Ct.icon,cd,vl,fa,Xa,Vi,M.al.none,ui,a.lineStartIndex,a.lineLength,-1,io),ze=Ct.icon.placedSymbolArray.length-1,Mu&&(q=4*Mu.length,Ct.addSymbols(Ct.icon,Mu,vl,fa,Xa,Vi,M.al.vertical,ui,a.lineStartIndex,a.lineLength,-1,io),tt=Ct.icon.placedSymbolArray.length-1)}const Ze=Object.keys(ea.horizontal);for(const Hn of Ze){const ao=ea.horizontal[Hn];if(!u){qe=mr(ao.text);const Mu=ha.layout.get("text-rotate").evaluate(Vi,{},io);u=new Tf(da,ui,Ya,Ba,fn,ao,Un,Jn,$a,Mu)}const cd=ao.positionedLines.length===1;if(Q+=Oo(Ct,ui,ao,Fn,ha,$a,Vi,Tr,a,ea.vertical?M.al.horizontal:M.al.horizontalOnly,cd?Ze:[Hn],nt,ze,Or,io),cd)break}ea.vertical&&(ge+=Oo(Ct,ui,ea.vertical,Fn,ha,$a,Vi,Tr,a,M.al.vertical,["vertical"],nt,tt,Or,io));const Wt=u?u.boxStartIndex:Ct.collisionBoxArray.length,Yt=u?u.boxEndIndex:Ct.collisionBoxArray.length,ta=_?_.boxStartIndex:Ct.collisionBoxArray.length,De=_?_.boxEndIndex:Ct.collisionBoxArray.length,Se=h?h.boxStartIndex:Ct.collisionBoxArray.length,ke=h?h.boxEndIndex:Ct.collisionBoxArray.length,st=w?w.boxStartIndex:Ct.collisionBoxArray.length,Nt=w?w.boxEndIndex:Ct.collisionBoxArray.length;let Jt=-1;const Ht=(Hn,ao)=>Hn&&Hn.circleDiameter?Math.max(Hn.circleDiameter,ao):ao;Jt=Ht(u,Jt),Jt=Ht(_,Jt),Jt=Ht(h,Jt),Jt=Ht(w,Jt);const $t=Jt>-1?1:0;$t&&(Jt*=If/ka),Ct.glyphOffsetArray.length>=ch.MAX_GLYPHS&&on("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Vi.sortKey!==void 0&&Ct.addToSortKeyRanges(Ct.symbolInstances.length,Vi.sortKey);const Dn=Wr(ha,Vi,io),[Li,xl]=function(Hn,ao){const cd=Hn.length,Mu=ao==null?void 0:ao.values;if((Mu==null?void 0:Mu.length)>0)for(let hd=0;hd<Mu.length;hd+=2){const vl=Mu[hd+1];Hn.emplaceBack(M.aB[Mu[hd]],vl[0],vl[1])}return[cd,Hn.length]}(Ct.textAnchorOffsets,Dn);Ct.symbolInstances.emplaceBack(ui.x,ui.y,nt.right>=0?nt.right:-1,nt.center>=0?nt.center:-1,nt.left>=0?nt.left:-1,nt.vertical||-1,ze,tt,qe,Wt,Yt,ta,De,Se,ke,st,Nt,Ya,Q,ge,D,q,$t,0,Un,Jt,Li,xl)}(s,Pt,Lt,r,l,p,ct,s.layers[0],s.collisionBoxArray,t.index,t.sourceLayerIndex,s.index,oe,[J,J,J,J],at,S,ue,de,Ue,V,t,b,R,O,x)};if(Ye==="line")for(const Lt of yf(t.geometry,0,0,bt,bt)){const Pt=cl(Lt,Xe),Ct=Dp(Pt,H,Oe,r.vertical||Y,l,24,xe,s.overscaling,bt);for(const ui of Ct)Y&&Em(s,Y.text,ot,ui)||Tt(Pt,ui)}else if(Ye==="line-center"){for(const Lt of t.geometry)if(Lt.length>1){const Pt=cl(Lt,Xe),Ct=xm(Pt,Oe,r.vertical||Y,l,24,xe);Ct&&Tt(Pt,Ct)}}else if(t.type==="Polygon")for(const Lt of Ll(t.geometry,0)){const Pt=D0(Lt,16);Tt(cl(Lt[0],Xe,!0),new to(Pt.x,Pt.y,0))}else if(t.type==="LineString")for(const Lt of t.geometry){const Pt=cl(Lt,Xe);Tt(Pt,new to(Pt[0].x,Pt[0].y,0))}else if(t.type==="Point")for(const Lt of t.geometry)for(const Pt of Lt)Tt([Pt],new to(Pt.x,Pt.y,0))}function Oo(s,t,r,l,p,b,x,E,S,R,O,B,U,j,V){const Y=function(xe,ue,H,J,de,Oe,at,Ue){const Ye=J.layout.get("text-rotate").evaluate(Oe,{})*Math.PI/180,ot=[];for(const rt of ue.positionedLines)for(const ct of rt.positionedGlyphs){if(!ct.rect)continue;const Xe=ct.rect||{};let Tt=mm+1,Lt=!0,Pt=1,Ct=0;const ui=(de||Ue)&&ct.vertical,Pi=ct.metrics.advance*ct.scale/2;if(Ue&&ue.verticalizable&&(Ct=rt.lineOffset/2-(ct.imageName?-(ka-ct.metrics.width*ct.scale)/2:(ct.scale-1)*ka)),ct.imageName){const za=at[ct.imageName];Lt=za.sdf,Pt=za.pixelRatio,Tt=Mn/Pt}const ea=de?[ct.x+Pi,ct.y]:[0,0];let ba=de?[0,0]:[ct.x+Pi+H[0],ct.y+H[1]-Ct],Fn=[0,0];ui&&(Fn=ba,ba=[0,0]);const dn=ct.metrics.isDoubleResolution?2:1,ha=(ct.metrics.left-Tt)*ct.scale-Pi+ba[0],da=(-ct.metrics.top-Tt)*ct.scale+ba[1],Ya=ha+Xe.w/dn*ct.scale/Pt,Ba=da+Xe.h/dn*ct.scale/Pt,fn=new Qe(ha,da),Un=new Qe(Ya,da),Jn=new Qe(ha,Ba),$a=new Qe(Ya,Ba);if(ui){const za=new Qe(-Pi,Pi-td),Xa=-Math.PI/2,fa=ka/2-Pi,Vi=new Qe(5-td-fa,-(ct.imageName?fa:0)),Or=new Qe(...Fn);fn._rotateAround(Xa,za)._add(Vi)._add(Or),Un._rotateAround(Xa,za)._add(Vi)._add(Or),Jn._rotateAround(Xa,za)._add(Vi)._add(Or),$a._rotateAround(Xa,za)._add(Vi)._add(Or)}if(Ye){const za=Math.sin(Ye),Xa=Math.cos(Ye),fa=[Xa,-za,za,Xa];fn._matMult(fa),Un._matMult(fa),Jn._matMult(fa),$a._matMult(fa)}const Tr=new Qe(0,0),Da=new Qe(0,0);ot.push({tl:fn,tr:Un,bl:Jn,br:$a,tex:Xe,writingMode:ue.writingMode,glyphOffset:ea,sectionIndex:ct.sectionIndex,isSDF:Lt,pixelOffsetTL:Tr,pixelOffsetBR:Da,minFontScaleX:0,minFontScaleY:0})}return ot}(0,r,E,p,b,x,l,s.allowVerticalPlacement),ee=s.textSizeData;let oe=null;ee.kind==="source"?(oe=[No*p.layout.get("text-size").evaluate(x,{})],oe[0]>_l&&on(`${s.layerIds[0]}: Value for "text-size" is >= ${oh}. Reduce your "text-size".`)):ee.kind==="composite"&&(oe=[No*j.compositeTextSizes[0].evaluate(x,{},V),No*j.compositeTextSizes[1].evaluate(x,{},V)],(oe[0]>_l||oe[1]>_l)&&on(`${s.layerIds[0]}: Value for "text-size" is >= ${oh}. Reduce your "text-size".`)),s.addSymbols(s.text,Y,oe,E,b,x,R,t,S.lineStartIndex,S.lineLength,U,V);for(const xe of O)B[xe]=s.text.placedSymbolArray.length-1;return 4*Y.length}function Lp(s){for(const t in s)return s[t];return null}function Em(s,t,r,l){const p=s.compareText;if(t in p){const b=p[t];for(let x=b.length-1;x>=0;x--)if(l.dist(b[x])<r)return!0}else p[t]=[];return p[t].push(l),!1}const lc=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Sf{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,l]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=l>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const b=lc[15&l];if(!b)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(t,2,1),[E]=new Uint32Array(t,4,1);return new Sf(E,x,b,t)}constructor(t,r=64,l=Float64Array,p){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const b=lc.indexOf(this.ArrayType),x=2*t*this.ArrayType.BYTES_PER_ELEMENT,E=t*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-E%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${l}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+E+S,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+x+E+S),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+E+S,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=r,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return R0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,l,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:x,nodeSize:E}=this,S=[0,b.length-1,0],R=[];for(;S.length;){const O=S.pop()||0,B=S.pop()||0,U=S.pop()||0;if(B-U<=E){for(let ee=U;ee<=B;ee++){const oe=x[2*ee],xe=x[2*ee+1];oe>=t&&oe<=l&&xe>=r&&xe<=p&&R.push(b[ee])}continue}const j=U+B>>1,V=x[2*j],Y=x[2*j+1];V>=t&&V<=l&&Y>=r&&Y<=p&&R.push(b[j]),(O===0?t<=V:r<=Y)&&(S.push(U),S.push(j-1),S.push(1-O)),(O===0?l>=V:p>=Y)&&(S.push(j+1),S.push(B),S.push(1-O))}return R}within(t,r,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:b,nodeSize:x}=this,E=[0,p.length-1,0],S=[],R=l*l;for(;E.length;){const O=E.pop()||0,B=E.pop()||0,U=E.pop()||0;if(B-U<=x){for(let ee=U;ee<=B;ee++)Op(b[2*ee],b[2*ee+1],t,r)<=R&&S.push(p[ee]);continue}const j=U+B>>1,V=b[2*j],Y=b[2*j+1];Op(V,Y,t,r)<=R&&S.push(p[j]),(O===0?t-l<=V:r-l<=Y)&&(E.push(U),E.push(j-1),E.push(1-O)),(O===0?t+l>=V:r+l>=Y)&&(E.push(j+1),E.push(B),E.push(1-O))}return S}}function R0(s,t,r,l,p,b){if(p-l<=r)return;const x=l+p>>1;Np(s,t,x,l,p,b),R0(s,t,r,l,x-1,1-b),R0(s,t,r,x+1,p,1-b)}function Np(s,t,r,l,p,b){for(;p>l;){if(p-l>600){const R=p-l+1,O=r-l+1,B=Math.log(R),U=.5*Math.exp(2*B/3),j=.5*Math.sqrt(B*U*(R-U)/R)*(O-R/2<0?-1:1);Np(s,t,r,Math.max(l,Math.floor(r-O*U/R+j)),Math.min(p,Math.floor(r+(R-O)*U/R+j)),b)}const x=t[2*r+b];let E=l,S=p;for(ld(s,t,l,r),t[2*p+b]>x&&ld(s,t,l,p);E<S;){for(ld(s,t,E,S),E++,S--;t[2*E+b]<x;)E++;for(;t[2*S+b]>x;)S--}t[2*l+b]===x?ld(s,t,l,S):(S++,ld(s,t,S,p)),S<=r&&(l=S+1),r<=S&&(p=S-1)}}function ld(s,t,r,l){P0(s,r,l),P0(t,2*r,2*l),P0(t,2*r+1,2*l+1)}function P0(s,t,r){const l=s[t];s[t]=s[r],s[r]=l}function Op(s,t,r,l){const p=s-r,b=t-l;return p*p+b*b}var L0;M.co=void 0,(L0=M.co||(M.co={})).create="create",L0.load="load",L0.fullLoad="fullLoad";let Cf=null,mh=[];const bl=1e3/60,cc="loadTime",Mf="fullLoadTime",wm={mark(s){performance.mark(s)},frame(s){const t=s;Cf!=null&&mh.push(t-Cf),Cf=t},clearMetrics(){Cf=null,mh=[],performance.clearMeasures(cc),performance.clearMeasures(Mf);for(const s in M.co)performance.clearMarks(M.co[s])},getPerformanceMetrics(){performance.measure(cc,M.co.create,M.co.load),performance.measure(Mf,M.co.create,M.co.fullLoad);const s=performance.getEntriesByName(cc)[0].duration,t=performance.getEntriesByName(Mf)[0].duration,r=mh.length,l=1/(mh.reduce((b,x)=>b+x,0)/r/1e3),p=mh.filter(b=>b>bl).reduce((b,x)=>b+(x-bl)/bl,0);return{loadTime:s,fullLoadTime:t,fps:l,percentDroppedFrames:p/(r+p)*100,totalFrames:r}}};M.$=yl,M.A=Ut,M.B=as,M.C=Yi,M.D=gt,M.E=ve,M.F=Gf,M.G=function(s){if(ro==null){const t=s.navigator?s.navigator.userAgent:null;ro=!!s.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ro},M.H=class{constructor(s,t){this.target=s,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new bm(()=>this.process()),this.subscription=zo(this.target,"message",r=>this.receive(r),!1),this.globalScope=Jr(self)?s:window}registerMessageHandler(s,t){this.messageHandlers[s]=t}sendAsync(s,t){return new Promise((r,l)=>{const p=Math.round(1e18*Math.random()).toString(36).substring(0,10),b=t?zo(t.signal,"abort",()=>{b==null||b.unsubscribe(),delete this.resolveRejects[p];const S={id:p,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(S)},nd):null;this.resolveRejects[p]={resolve:S=>{b==null||b.unsubscribe(),r(S)},reject:S=>{b==null||b.unsubscribe(),l(S)}};const x=[],E=Object.assign(Object.assign({},s),{id:p,sourceMapId:this.mapId,origin:location.origin,data:fu(s.data,x)});this.target.postMessage(E,{transfer:x})})}receive(s){const t=s.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];const l=this.abortControllers[r];return delete this.abortControllers[r],void(l&&l.abort())}if(Jr(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),t=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(s,t)}processTask(s,t){return d(this,void 0,void 0,function*(){if(t.type==="<response>"){const p=this.resolveRejects[s];return delete this.resolveRejects[s],p?void(t.error?p.reject(wo(t.error)):p.resolve(wo(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const r=wo(t.data),l=new AbortController;this.abortControllers[s]=l;try{const p=yield this.messageHandlers[t.type](t.sourceMapId,r,l);this.completeTask(s,null,p)}catch(p){this.completeTask(s,p)}})}completeTask(s,t,r){const l=[];delete this.abortControllers[s];const p={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?fu(t):null,data:fu(r,l)};this.target.postMessage(p,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},M.I=ed,M.J=Pu,M.K=function(){var s=new Ut(16);return Ut!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},M.L=function(s,t,r){var l,p,b,x,E,S,R,O,B,U,j,V,Y=r[0],ee=r[1],oe=r[2];return t===s?(s[12]=t[0]*Y+t[4]*ee+t[8]*oe+t[12],s[13]=t[1]*Y+t[5]*ee+t[9]*oe+t[13],s[14]=t[2]*Y+t[6]*ee+t[10]*oe+t[14],s[15]=t[3]*Y+t[7]*ee+t[11]*oe+t[15]):(p=t[1],b=t[2],x=t[3],E=t[4],S=t[5],R=t[6],O=t[7],B=t[8],U=t[9],j=t[10],V=t[11],s[0]=l=t[0],s[1]=p,s[2]=b,s[3]=x,s[4]=E,s[5]=S,s[6]=R,s[7]=O,s[8]=B,s[9]=U,s[10]=j,s[11]=V,s[12]=l*Y+E*ee+B*oe+t[12],s[13]=p*Y+S*ee+U*oe+t[13],s[14]=b*Y+R*ee+j*oe+t[14],s[15]=x*Y+O*ee+V*oe+t[15]),s},M.M=function(s,t,r){var l=r[0],p=r[1],b=r[2];return s[0]=t[0]*l,s[1]=t[1]*l,s[2]=t[2]*l,s[3]=t[3]*l,s[4]=t[4]*p,s[5]=t[5]*p,s[6]=t[6]*p,s[7]=t[7]*p,s[8]=t[8]*b,s[9]=t[9]*b,s[10]=t[10]*b,s[11]=t[11]*b,s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s},M.N=function(s,t,r){var l=t[0],p=t[1],b=t[2],x=t[3],E=t[4],S=t[5],R=t[6],O=t[7],B=t[8],U=t[9],j=t[10],V=t[11],Y=t[12],ee=t[13],oe=t[14],xe=t[15],ue=r[0],H=r[1],J=r[2],de=r[3];return s[0]=ue*l+H*E+J*B+de*Y,s[1]=ue*p+H*S+J*U+de*ee,s[2]=ue*b+H*R+J*j+de*oe,s[3]=ue*x+H*O+J*V+de*xe,s[4]=(ue=r[4])*l+(H=r[5])*E+(J=r[6])*B+(de=r[7])*Y,s[5]=ue*p+H*S+J*U+de*ee,s[6]=ue*b+H*R+J*j+de*oe,s[7]=ue*x+H*O+J*V+de*xe,s[8]=(ue=r[8])*l+(H=r[9])*E+(J=r[10])*B+(de=r[11])*Y,s[9]=ue*p+H*S+J*U+de*ee,s[10]=ue*b+H*R+J*j+de*oe,s[11]=ue*x+H*O+J*V+de*xe,s[12]=(ue=r[12])*l+(H=r[13])*E+(J=r[14])*B+(de=r[15])*Y,s[13]=ue*p+H*S+J*U+de*ee,s[14]=ue*b+H*R+J*j+de*oe,s[15]=ue*x+H*O+J*V+de*xe,s},M.O=function(s,t){const r={};for(let l=0;l<t.length;l++){const p=t[l];p in s&&(r[p]=s[p])}return r},M.P=Qe,M.Q=Au,M.R=Lr,M.S=mf,M.T=Hh,M.U=rd,M.V=ni,M.W=Mt,M.X=Du,M.Y=Kr,M.Z=bt,M._=d,M.a=Pa,M.a$=function(s,t,r){var l=Math.sin(r),p=Math.cos(r),b=t[4],x=t[5],E=t[6],S=t[7],R=t[8],O=t[9],B=t[10],U=t[11];return t!==s&&(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[4]=b*p+R*l,s[5]=x*p+O*l,s[6]=E*p+B*l,s[7]=S*p+U*l,s[8]=R*p-b*l,s[9]=O*p-x*l,s[10]=B*p-E*l,s[11]=U*p-S*l,s},M.a0=25,M.a1=gf,M.a2=s=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(r=>{t.onloadstart=()=>{r(t)};for(const l of s){const p=window.document.createElement("source");Ce(l)||(t.crossOrigin="Anonymous"),p.src=l,t.appendChild(p)}})},M.a3=Ve,M.a4=function(){return Ni++},M.a5=re,M.a6=ch,M.a7=dr,M.a8=yr,M.a9=Qi,M.aA=function(s,t,r,l,p=!1){if(!r[0]&&!r[1])return[0,0];const b=p?l==="map"?-s.bearingInRadians:0:l==="viewport"?s.bearingInRadians:0;if(b){const x=Math.sin(b),E=Math.cos(b);r=[r[0]*E-r[1]*x,r[0]*x+r[1]*E]}return[p?r[0]:xi(t,r[0],s.zoom),p?r[1]:xi(t,r[1],s.zoom)]},M.aC=uh,M.aD=wf,M.aE=uf,M.aF=Sf,M.aG=ra,M.aH=Ma,M.aI=Ge,M.aJ=Si,M.aK=wi,M.aL=Vt,M.aM=Is,M.aN=hh,M.aO=function(s,t,r){return s[0]=t[0]*r,s[1]=t[1]*r,s[2]=t[2]*r,s},M.aP=function(s,t,r){return s[0]=t[0]+r[0],s[1]=t[1]+r[1],s[2]=t[2]+r[2],s},M.aQ=function(s){var t=new Ut(3);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t},M.aR=function(s,t,r){return s[0]=t[0]*r[0],s[1]=t[1]*r[1],s[2]=t[2]*r[2],s[3]=t[3]*r[3],s},M.aS=function(s,t,r){return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],s},M.aT=function(s,t){var r=t[0],l=t[1],p=t[2],b=r*r+l*l+p*p;return b>0&&(b=1/Math.sqrt(b)),s[0]=t[0]*b,s[1]=t[1]*b,s[2]=t[2]*b,s},M.aU=function(s,t,r){var l=t[0],p=t[1],b=t[2],x=r[0],E=r[1],S=r[2];return s[0]=p*S-b*E,s[1]=b*x-l*S,s[2]=l*E-p*x,s},M.aV=function(s,t){return s[0]*t[0]+s[1]*t[1]+s[2]*t[2]},M.aW=Mp,M.aX=uc,M.aY=function(s,t,r,l,p){var b,x=1/Math.tan(t/2);return s[0]=x/r,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,p!=null&&p!==1/0?(s[10]=(p+l)*(b=1/(l-p)),s[14]=2*p*l*b):(s[10]=-1,s[14]=-2*l),s},M.aZ=function(s){var t=new Ut(16);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],t[9]=s[9],t[10]=s[10],t[11]=s[11],t[12]=s[12],t[13]=s[13],t[14]=s[14],t[15]=s[15],t},M.a_=function(s,t,r){var l=Math.sin(r),p=Math.cos(r),b=t[0],x=t[1],E=t[2],S=t[3],R=t[4],O=t[5],B=t[6],U=t[7];return t!==s&&(s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=b*p+R*l,s[1]=x*p+O*l,s[2]=E*p+B*l,s[3]=S*p+U*l,s[4]=R*p-b*l,s[5]=O*p-x*l,s[6]=B*p-E*l,s[7]=U*p-S*l,s},M.aa=function(s){const t={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,l,p,b)=>{const x=p||b;return t[l]=!x||x.toLowerCase(),""}),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},M.ab=so,M.ac=function(s){return Math.pow(2,s)},M.ad=bi,M.ae=Xt,M.af=85.051129,M.ag=A0,M.ah=function(s){return Math.log(s)/Math.LN2},M.ai=function(s){var t=s[0],r=s[1];return t*t+r*r},M.aj=function(s,t){const r=[];for(const l in s)l in t||r.push(l);return r},M.ak=function(s,t){let r=0,l=0;if(s.kind==="constant")l=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:p,minZoom:b,maxZoom:x}=s,E=p?Xt(yn.interpolationFactor(p,t,b,x),0,1):0;s.kind==="camera"?l=as.number(s.minSize,s.maxSize,E):r=E}return{uSizeT:r,uSize:l}},M.am=function(s,{uSize:t,uSizeT:r},{lowerSize:l,upperSize:p}){return s.kind==="source"?l/No:s.kind==="composite"?as.number(l/No,p/No,r):t},M.an=function(s,t){var r=t[0],l=t[1],p=t[2],b=t[3],x=t[4],E=t[5],S=t[6],R=t[7],O=t[8],B=t[9],U=t[10],j=t[11],V=t[12],Y=t[13],ee=t[14],oe=t[15],xe=r*E-l*x,ue=r*S-p*x,H=r*R-b*x,J=l*S-p*E,de=l*R-b*E,Oe=p*R-b*S,at=O*Y-B*V,Ue=O*ee-U*V,Ye=O*oe-j*V,ot=B*ee-U*Y,rt=B*oe-j*Y,ct=U*oe-j*ee,Xe=xe*ct-ue*rt+H*ot+J*Ye-de*Ue+Oe*at;return Xe?(s[0]=(E*ct-S*rt+R*ot)*(Xe=1/Xe),s[1]=(p*rt-l*ct-b*ot)*Xe,s[2]=(Y*Oe-ee*de+oe*J)*Xe,s[3]=(U*de-B*Oe-j*J)*Xe,s[4]=(S*Ye-x*ct-R*Ue)*Xe,s[5]=(r*ct-p*Ye+b*Ue)*Xe,s[6]=(ee*H-V*Oe-oe*ue)*Xe,s[7]=(O*Oe-U*H+j*ue)*Xe,s[8]=(x*rt-E*Ye+R*at)*Xe,s[9]=(l*Ye-r*rt-b*at)*Xe,s[10]=(V*de-Y*H+oe*xe)*Xe,s[11]=(B*H-O*de-j*xe)*Xe,s[12]=(E*Ue-x*ot-S*at)*Xe,s[13]=(r*ot-l*Ue+p*at)*Xe,s[14]=(Y*ue-V*J-ee*xe)*Xe,s[15]=(O*J-B*ue+U*xe)*Xe,s):null},M.ao=Je,M.ap=function(s){return Math.hypot(s[0],s[1])},M.aq=function(s){return s[0]=0,s[1]=0,s},M.ar=function(s,t,r){return s[0]=t[0]*r,s[1]=t[1]*r,s},M.as=ad,M.at=xa,M.au=function(s,t,r,l){const p=t.y-s.y,b=t.x-s.x,x=l.y-r.y,E=l.x-r.x,S=x*b-E*p;if(S===0)return null;const R=(E*(s.y-r.y)-x*(s.x-r.x))/S;return new Qe(s.x+R*b,s.y+R*p)},M.av=yf,M.aw=Bd,M.ax=function(s){let t=1/0,r=1/0,l=-1/0,p=-1/0;for(const b of s)t=Math.min(t,b.x),r=Math.min(r,b.y),l=Math.max(l,b.x),p=Math.max(p,b.y);return[t,r,l,p]},M.ay=ka,M.az=xi,M.b=Ra,M.b$=class extends Z{},M.b0=function(){const s=new Float32Array(16);return bi(s),s},M.b1=function(){const s=new Float64Array(16);return bi(s),s},M.b2=function(){return new Float64Array(16)},M.b3=function(s,t,r){const l=new Float64Array(4);return function(p,b,x,E){var S=.5*Math.PI/180;b*=S,x*=S,E*=S;var R=Math.sin(b),O=Math.cos(b),B=Math.sin(x),U=Math.cos(x),j=Math.sin(E),V=Math.cos(E);p[0]=R*U*V-O*B*j,p[1]=O*B*V+R*U*j,p[2]=O*U*j-R*B*V,p[3]=O*U*V+R*B*j}(l,s,t-90,r),l},M.b4=function(s,t,r,l){var p,b,x,E,S,R=t[0],O=t[1],B=t[2],U=t[3],j=r[0],V=r[1],Y=r[2],ee=r[3];return(b=R*j+O*V+B*Y+U*ee)<0&&(b=-b,j=-j,V=-V,Y=-Y,ee=-ee),1-b>Et?(p=Math.acos(b),x=Math.sin(p),E=Math.sin((1-l)*p)/x,S=Math.sin(l*p)/x):(E=1-l,S=l),s[0]=E*R+S*j,s[1]=E*O+S*V,s[2]=E*B+S*Y,s[3]=E*U+S*ee,s},M.b5=function(s){const t=new Float64Array(9);var r,l,p,b,x,E,S,R,O,B,U,j,V,Y,ee,oe,xe,ue;B=(p=(l=s)[0])*(S=p+p),U=(b=l[1])*S,V=(x=l[2])*S,Y=x*(R=b+b),oe=(E=l[3])*S,xe=E*R,ue=E*(O=x+x),(r=t)[0]=1-(j=b*R)-(ee=x*O),r[3]=U-ue,r[6]=V+xe,r[1]=U+ue,r[4]=1-B-ee,r[7]=Y-oe,r[2]=V-xe,r[5]=Y+oe,r[8]=1-B-j;const H=Is(-Math.asin(Xt(t[2],-1,1)));let J,de;return Math.hypot(t[5],t[8])<.001?(J=0,de=-Is(Math.atan2(t[3],t[4]))):(J=Is(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),de=Is(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:J,pitch:H+90,bearing:de}},M.b6=function(s,t){return s.roll==t.roll&&s.pitch==t.pitch&&s.bearing==t.bearing},M.b7=pi,M.b8=Wl,M.b9=ll,M.bA=function(s){if(s.type==="custom")return new ym(s);switch(s.type){case"background":return new Sp(s);case"circle":return new rp(s);case"fill":return new o0(s);case"fill-extrusion":return new $i(s);case"heatmap":return new e0(s);case"hillshade":return new qd(s);case"line":return new Kh(s);case"raster":return new E0(s);case"symbol":return new df(s)}},M.bB=gn,M.bC=function(s,t){if(!s)return[{command:"setStyle",args:[t]}];let r=[];try{if(!Re(s.version,t.version))return[{command:"setStyle",args:[t]}];Re(s.center,t.center)||r.push({command:"setCenter",args:[t.center]}),Re(s.state,t.state)||r.push({command:"setGlobalState",args:[t.state]}),Re(s.centerAltitude,t.centerAltitude)||r.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Re(s.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),Re(s.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),Re(s.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),Re(s.roll,t.roll)||r.push({command:"setRoll",args:[t.roll]}),Re(s.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),Re(s.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),Re(s.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),Re(s.light,t.light)||r.push({command:"setLight",args:[t.light]}),Re(s.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),Re(s.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),Re(s.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});const l={},p=[];(function(x,E,S,R){let O;for(O in E=E||{},x=x||{})Object.prototype.hasOwnProperty.call(x,O)&&(Object.prototype.hasOwnProperty.call(E,O)||et(O,S,R));for(O in E)Object.prototype.hasOwnProperty.call(E,O)&&(Object.prototype.hasOwnProperty.call(x,O)?Re(x[O],E[O])||(x[O].type==="geojson"&&E[O].type==="geojson"&&_t(x,E,O)?Fe(S,{command:"setGeoJSONSourceData",args:[O,E[O].data]}):pt(O,E,S,R)):Ie(O,E,S))})(s.sources,t.sources,p,l);const b=[];s.layers&&s.layers.forEach(x=>{"source"in x&&l[x.source]?r.push({command:"removeLayer",args:[x.id]}):b.push(x)}),r=r.concat(p),function(x,E,S){E=E||[];const R=(x=x||[]).map(kt),O=E.map(kt),B=x.reduce(Rt,{}),U=E.reduce(Rt,{}),j=R.slice(),V=Object.create(null);let Y,ee,oe,xe,ue;for(let H=0,J=0;H<R.length;H++)Y=R[H],Object.prototype.hasOwnProperty.call(U,Y)?J++:(Fe(S,{command:"removeLayer",args:[Y]}),j.splice(j.indexOf(Y,J),1));for(let H=0,J=0;H<O.length;H++)Y=O[O.length-1-H],j[j.length-1-H]!==Y&&(Object.prototype.hasOwnProperty.call(B,Y)?(Fe(S,{command:"removeLayer",args:[Y]}),j.splice(j.lastIndexOf(Y,j.length-J),1)):J++,xe=j[j.length-H],Fe(S,{command:"addLayer",args:[U[Y],xe]}),j.splice(j.length-H,0,Y),V[Y]=!0);for(let H=0;H<O.length;H++)if(Y=O[H],ee=B[Y],oe=U[Y],!V[Y]&&!Re(ee,oe))if(Re(ee.source,oe.source)&&Re(ee["source-layer"],oe["source-layer"])&&Re(ee.type,oe.type)){for(ue in It(ee.layout,oe.layout,S,Y,null,"setLayoutProperty"),It(ee.paint,oe.paint,S,Y,null,"setPaintProperty"),Re(ee.filter,oe.filter)||Fe(S,{command:"setFilter",args:[Y,oe.filter]}),Re(ee.minzoom,oe.minzoom)&&Re(ee.maxzoom,oe.maxzoom)||Fe(S,{command:"setLayerZoomRange",args:[Y,oe.minzoom,oe.maxzoom]}),ee)Object.prototype.hasOwnProperty.call(ee,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?It(ee[ue],oe[ue],S,Y,ue.slice(6),"setPaintProperty"):Re(ee[ue],oe[ue])||Fe(S,{command:"setLayerProperty",args:[Y,ue,oe[ue]]}));for(ue in oe)Object.prototype.hasOwnProperty.call(oe,ue)&&!Object.prototype.hasOwnProperty.call(ee,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?It(ee[ue],oe[ue],S,Y,ue.slice(6),"setPaintProperty"):Re(ee[ue],oe[ue])||Fe(S,{command:"setLayerProperty",args:[Y,ue,oe[ue]]}))}else Fe(S,{command:"removeLayer",args:[Y]}),xe=j[j.lastIndexOf(Y)+1],Fe(S,{command:"addLayer",args:[oe,xe]})}(b,t.layers,r)}catch(l){console.warn("Unable to compute style diff:",l),r=[{command:"setStyle",args:[t]}]}return r},M.bD=function(s){const t=[],r=s.id;return r===void 0&&t.push({message:`layers.${r}: missing required property "id"`}),s.render===void 0&&t.push({message:`layers.${r}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},M.bE=function s(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let l=0;l<t.length;l++)if(!s(t[l],r[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(const l in t)if(!s(t[l],r[l]))return!1;return!0}return t===r},M.bF=qn,M.bG=Bo,M.bH=class extends Bi{constructor(s,t){super(s,t),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},M.bI=Od,M.bJ=class extends Bi{constructor(s,t){super(s,t),this.current=sl}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let t=1;t<16;t++)if(s[t]!==this.current[t]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},M.bK=jh,M.bL=class extends Bi{constructor(s,t){super(s,t),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},M.bM=class extends Bi{constructor(s,t){super(s,t),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},M.bN=Ii,M.bO=function(s,t){var r=Math.sin(t),l=Math.cos(t);return s[0]=l,s[1]=r,s[2]=0,s[3]=-r,s[4]=l,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},M.bP=function(s,t,r){var l=t[0],p=t[1],b=t[2];return s[0]=l*r[0]+p*r[3]+b*r[6],s[1]=l*r[1]+p*r[4]+b*r[7],s[2]=l*r[2]+p*r[5]+b*r[8],s},M.bQ=function(s,t,r,l,p,b,x){var E=1/(t-r),S=1/(l-p),R=1/(b-x);return s[0]=-2*E,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*S,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*R,s[11]=0,s[12]=(t+r)*E,s[13]=(p+l)*S,s[14]=(x+b)*R,s[15]=1,s},M.bR=class extends Bi{constructor(s,t){super(s,t),this.current=new Array}set(s){if(s!=this.current){this.current=s;const t=new Float32Array(4*s.length);for(let r=0;r<s.length;r++)t[4*r]=s[r].r,t[4*r+1]=s[r].g,t[4*r+2]=s[r].b,t[4*r+3]=s[r].a;this.gl.uniform4fv(this.location,t)}}},M.bS=class extends Bi{constructor(s,t){super(s,t),this.current=new Array}set(s){if(s!=this.current){this.current=s;const t=new Float32Array(s);this.gl.uniform1fv(this.location,t)}}},M.bT=class extends y{},M.bU=pl,M.bV=class extends A{},M.bW=Zh,M.bX=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},M.bY=jd,M.bZ=function(s,t,r){var l=t[0],p=t[1],b=t[2],x=r[3]*l+r[7]*p+r[11]*b+r[15];return s[0]=(r[0]*l+r[4]*p+r[8]*b+r[12])/(x=x||1),s[1]=(r[1]*l+r[5]*p+r[9]*b+r[13])/x,s[2]=(r[2]*l+r[6]*p+r[10]*b+r[14])/x,s},M.b_=class extends Vs{},M.ba=Jc,M.bb=Nr,M.bc=ut,M.bd=xt,M.be=Wa,M.bf=function(s,t,r,l,p){return ut(l,p,Xt((s-t)/(r-t),0,1))},M.bg=Te,M.bh=function(){return new Float64Array(3)},M.bi=function(s,t,r,l){return s[0]=t[0]+r[0]*l,s[1]=t[1]+r[1]*l,s[2]=t[2]+r[2]*l,s},M.bj=sn,M.bk=function(){return new Float64Array(4)},M.bl=function(s,t,r,l){var p=[],b=[];return p[0]=t[0]-r[0],p[1]=t[1]-r[1],p[2]=t[2]-r[2],b[0]=p[0]*Math.cos(l)-p[1]*Math.sin(l),b[1]=p[0]*Math.sin(l)+p[1]*Math.cos(l),b[2]=p[2],s[0]=b[0]+r[0],s[1]=b[1]+r[1],s[2]=b[2]+r[2],s},M.bm=function(s,t,r,l){var p=[],b=[];return p[0]=t[0]-r[0],p[1]=t[1]-r[1],p[2]=t[2]-r[2],b[0]=p[0],b[1]=p[1]*Math.cos(l)-p[2]*Math.sin(l),b[2]=p[1]*Math.sin(l)+p[2]*Math.cos(l),s[0]=b[0]+r[0],s[1]=b[1]+r[1],s[2]=b[2]+r[2],s},M.bn=function(s,t,r,l){var p=[],b=[];return p[0]=t[0]-r[0],p[1]=t[1]-r[1],p[2]=t[2]-r[2],b[0]=p[2]*Math.sin(l)+p[0]*Math.cos(l),b[1]=p[1],b[2]=p[2]*Math.cos(l)-p[0]*Math.sin(l),s[0]=b[0]+r[0],s[1]=b[1]+r[1],s[2]=b[2]+r[2],s},M.bo=Ms,M.bp=function(s,t,r){var l=Math.sin(r),p=Math.cos(r),b=t[0],x=t[1],E=t[2],S=t[3],R=t[8],O=t[9],B=t[10],U=t[11];return t!==s&&(s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=b*p-R*l,s[1]=x*p-O*l,s[2]=E*p-B*l,s[3]=S*p-U*l,s[8]=b*l+R*p,s[9]=x*l+O*p,s[10]=E*l+B*p,s[11]=S*l+U*p,s},M.bq=function(s,t){const r=Te(s,360),l=Te(t,360),p=l-r,b=l>r?p-360:p+360;return Math.abs(p)<Math.abs(b)?p:b},M.br=function(s){return s[0]=0,s[1]=0,s[2]=0,s},M.bs=function(s,t,r,l){const p=Math.sqrt(s*s+t*t),b=Math.sqrt(r*r+l*l);s/=p,t/=p,r/=b,l/=b;const x=Math.acos(s*r+t*l);return-t*r+s*l>0?x:-x},M.bt=function(s,t){return s[0]*t[0]+s[1]*t[1]+s[2]*t[2]+s[3]},M.bu=w0,M.bv=function(s,t){const r=Te(s,2*Math.PI),l=Te(t,2*Math.PI);return Math.min(Math.abs(r-l),Math.abs(r-l+2*Math.PI),Math.abs(r-l-2*Math.PI))},M.bw=function(){const s={},t=te.$version;for(const r in te.$root){const l=te.$root[r];if(l.required){let p=null;p=r==="version"?t:l.type==="array"?[]:{},p!=null&&(s[r]=p)}}return s},M.bx=Hc,M.by=un,M.bz=function(s){s=s.slice();const t=Object.create(null);for(let r=0;r<s.length;r++)t[s[r].id]=s[r];for(let r=0;r<s.length;r++)"ref"in s[r]&&(s[r]=Ae(s[r],t[s[r].ref]));return s},M.c=_n,M.c0=function(s,t){return s[0]===t[0]&&s[1]===t[1]&&s[2]===t[2]&&s[3]===t[3]&&s[4]===t[4]&&s[5]===t[5]&&s[6]===t[6]&&s[7]===t[7]&&s[8]===t[8]&&s[9]===t[9]&&s[10]===t[10]&&s[11]===t[11]&&s[12]===t[12]&&s[13]===t[13]&&s[14]===t[14]&&s[15]===t[15]},M.c1=function(s,t){var r=s[0],l=s[1],p=s[2],b=s[3],x=s[4],E=s[5],S=s[6],R=s[7],O=s[8],B=s[9],U=s[10],j=s[11],V=s[12],Y=s[13],ee=s[14],oe=s[15],xe=t[0],ue=t[1],H=t[2],J=t[3],de=t[4],Oe=t[5],at=t[6],Ue=t[7],Ye=t[8],ot=t[9],rt=t[10],ct=t[11],Xe=t[12],Tt=t[13],Lt=t[14],Pt=t[15];return Math.abs(r-xe)<=Et*Math.max(1,Math.abs(r),Math.abs(xe))&&Math.abs(l-ue)<=Et*Math.max(1,Math.abs(l),Math.abs(ue))&&Math.abs(p-H)<=Et*Math.max(1,Math.abs(p),Math.abs(H))&&Math.abs(b-J)<=Et*Math.max(1,Math.abs(b),Math.abs(J))&&Math.abs(x-de)<=Et*Math.max(1,Math.abs(x),Math.abs(de))&&Math.abs(E-Oe)<=Et*Math.max(1,Math.abs(E),Math.abs(Oe))&&Math.abs(S-at)<=Et*Math.max(1,Math.abs(S),Math.abs(at))&&Math.abs(R-Ue)<=Et*Math.max(1,Math.abs(R),Math.abs(Ue))&&Math.abs(O-Ye)<=Et*Math.max(1,Math.abs(O),Math.abs(Ye))&&Math.abs(B-ot)<=Et*Math.max(1,Math.abs(B),Math.abs(ot))&&Math.abs(U-rt)<=Et*Math.max(1,Math.abs(U),Math.abs(rt))&&Math.abs(j-ct)<=Et*Math.max(1,Math.abs(j),Math.abs(ct))&&Math.abs(V-Xe)<=Et*Math.max(1,Math.abs(V),Math.abs(Xe))&&Math.abs(Y-Tt)<=Et*Math.max(1,Math.abs(Y),Math.abs(Tt))&&Math.abs(ee-Lt)<=Et*Math.max(1,Math.abs(ee),Math.abs(Lt))&&Math.abs(oe-Pt)<=Et*Math.max(1,Math.abs(oe),Math.abs(Pt))},M.c2=function(s,t){return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s},M.c3=s=>s.type==="symbol",M.c4=s=>s.type==="circle",M.c5=s=>s.type==="heatmap",M.c6=s=>s.type==="line",M.c7=s=>s.type==="fill",M.c8=s=>s.type==="fill-extrusion",M.c9=s=>s.type==="hillshade",M.cA=Js,M.cB=tc,M.cC=xu,M.cD=vr,M.cE=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},M.cF=function(s,t,r,l,p){return d(this,void 0,void 0,function*(){if(Mt())try{return yield Du(s,t,r,l,p)}catch{}return function(b,x,E,S,R){const O=b.width,B=b.height;Vn&&rr||(Vn=new OffscreenCanvas(O,B),rr=Vn.getContext("2d",{willReadFrequently:!0})),Vn.width=O,Vn.height=B,rr.drawImage(b,0,0,O,B);const U=rr.getImageData(x,E,S,R);return rr.clearRect(0,0,O,B),U.data}(s,t,r,l,p)})},M.cG=S0,M.cH=K,M.cI=Pe,M.cJ=eh,M.cK=nf,M.cL=ks,M.cM=ps,M.ca=s=>s.type==="raster",M.cb=s=>s.type==="background",M.cc=s=>s.type==="custom",M.cd=At,M.ce=function(s,t,r){const l=wt(t.x-r.x,t.y-r.y),p=wt(s.x-r.x,s.y-r.y);var b,x;return Is(Math.atan2(l[0]*p[1]-l[1]*p[0],(b=l)[0]*(x=p)[0]+b[1]*x[1]))},M.cf=Ot,M.cg=function(s,t){return es[t]&&(s instanceof MouseEvent||s instanceof WheelEvent)},M.ch=function(s,t){return Ru[t]&&"touches"in s},M.ci=function(s){return Ru[s]||es[s]},M.cj=function(s,t,r){var l=t[0],p=t[1];return s[0]=r[0]*l+r[4]*p+r[12],s[1]=r[1]*l+r[5]*p+r[13],s},M.ck=function(s,t){const{x:r,y:l}=yl.fromLngLat(t);return!(s<0||s>25||l<0||l>=1||r<0||r>=1)},M.cl=function(s,t){return s[0]=t[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=t[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=t[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},M.cm=class extends mu{},M.cn=wm,M.cp=function(s){return s.message===Ka},M.cq=wr,M.cr=function(s,t){Pa.REGISTERED_PROTOCOLS[s]=t},M.cs=function(s){delete Pa.REGISTERED_PROTOCOLS[s]},M.ct=function(s,t){const r={};for(let p=0;p<s.length;p++){const b=t&&t[s[p].id]||Ur(s[p]);t&&(t[s[p].id]=b);let x=r[b];x||(x=r[b]=[]),x.push(s[p])}const l=[];for(const p in r)l.push(r[p]);return l},M.cu=yt,M.cv=od,M.cw=_f,M.cx=ac,M.cy=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=bt/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const t=s.bucket.layers[0],r=t.layout,l=t._unevaluatedLayout._values,p={layoutIconSize:l["icon-size"].possiblyEvaluate(new Yi(s.bucket.zoom+1),s.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new Yi(s.bucket.zoom+1),s.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new Yi(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:R,maxZoom:O}=s.bucket.textSizeData;p.compositeTextSizes=[l["text-size"].possiblyEvaluate(new Yi(R),s.canonical),l["text-size"].possiblyEvaluate(new Yi(O),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:R,maxZoom:O}=s.bucket.iconSizeData;p.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new Yi(R),s.canonical),l["icon-size"].possiblyEvaluate(new Yi(O),s.canonical)]}const b=r.get("text-line-height")*ka,x=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",E=r.get("text-keep-upright"),S=r.get("text-size");for(const R of s.bucket.features){const O=r.get("text-font").evaluate(R,{},s.canonical).join(","),B=S.evaluate(R,{},s.canonical),U=p.layoutTextSize.evaluate(R,{},s.canonical),j=p.layoutIconSize.evaluate(R,{},s.canonical),V={horizontal:{},vertical:void 0},Y=R.text;let ee,oe=[0,0];if(Y){const H=Y.toString(),J=r.get("text-letter-spacing").evaluate(R,{},s.canonical)*ka,de=Nd(H)?J:0,Oe=r.get("text-anchor").evaluate(R,{},s.canonical),at=Wr(t,R,s.canonical);if(!at){const rt=r.get("text-radial-offset").evaluate(R,{},s.canonical);oe=rt?ph(Oe,[rt*ka,Ef]):r.get("text-offset").evaluate(R,{},s.canonical).map(ct=>ct*ka)}let Ue=x?"center":r.get("text-justify").evaluate(R,{},s.canonical);const Ye=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(R,{},s.canonical)*ka:1/0,ot=()=>{s.bucket.allowVerticalPlacement&&Zl(H)&&(V.vertical=rh(Y,s.glyphMap,s.glyphPositions,s.imagePositions,O,Ye,b,Oe,"left",de,oe,M.al.vertical,!0,U,B))};if(!x&&at){const rt=new Set;if(Ue==="auto")for(let Xe=0;Xe<at.values.length;Xe+=2)rt.add(wf(at.values[Xe]));else rt.add(Ue);let ct=!1;for(const Xe of rt)if(!V.horizontal[Xe])if(ct)V.horizontal[Xe]=V.horizontal[0];else{const Tt=rh(Y,s.glyphMap,s.glyphPositions,s.imagePositions,O,Ye,b,"center",Xe,de,oe,M.al.horizontal,!1,U,B);Tt&&(V.horizontal[Xe]=Tt,ct=Tt.positionedLines.length===1)}ot()}else{Ue==="auto"&&(Ue=wf(Oe));const rt=rh(Y,s.glyphMap,s.glyphPositions,s.imagePositions,O,Ye,b,Oe,Ue,de,oe,M.al.horizontal,!1,U,B);rt&&(V.horizontal[Ue]=rt),ot(),Zl(H)&&x&&E&&(V.vertical=rh(Y,s.glyphMap,s.glyphPositions,s.imagePositions,O,Ye,b,Oe,Ue,de,oe,M.al.vertical,!1,U,B))}}let xe=!1;if(R.icon&&R.icon.name){const H=s.imageMap[R.icon.name];H&&(ee=la(s.imagePositions[R.icon.name],r.get("icon-offset").evaluate(R,{},s.canonical),r.get("icon-anchor").evaluate(R,{},s.canonical)),xe=!!H.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=xe:s.bucket.sdfIcons!==xe&&on("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(H.pixelRatio!==s.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const ue=Lp(V.horizontal)||V.vertical;s.bucket.iconsInText=!!ue&&ue.iconsInText,(ue||ee)&&Af(s.bucket,R,V,ee,s.imageMap,p,U,j,oe,xe,s.canonical,s.subdivisionGranularity)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},M.cz=Ia,M.d=Ce,M.e=aa,M.f=s=>d(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(t)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),M.g=oo,M.h=s=>new Promise((t,r)=>{const l=new Image;l.onload=()=>{t(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=Sl})},l.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(s)],{type:"image/png"});l.src=s.byteLength?URL.createObjectURL(p):Sl}),M.i=Jr,M.j=(s,t)=>sr(aa(s,{type:"json"}),t),M.k=he,M.l=ie,M.m=sr,M.n=(s,t)=>sr(aa(s,{type:"arrayBuffer"}),t),M.o=function(s){return new vr(s).readFields(Qr,[])},M.p=Eu,M.q=Xc,M.r=ca,M.s=zo,M.t=ql,M.u=ri,M.v=te,M.w=on,M.x=Vl,M.y=tl,M.z=function([s,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:s*Math.cos(t)*Math.sin(r),y:s*Math.sin(t)*Math.sin(r),z:s*Math.cos(r)}}}),C("worker",["./shared"],function(M){class d{constructor($){this.keyCache={},$&&this.replace($)}replace($){this._layerConfigs={},this._layers={},this.update($,[])}update($,X){for(const he of $){this._layerConfigs[he.id]=he;const ve=this._layers[he.id]=M.bA(he);ve._featureFilter=M.a7(ve.filter),this.keyCache[he.id]&&delete this.keyCache[he.id]}for(const he of X)delete this.keyCache[he],delete this._layerConfigs[he],delete this._layers[he];this.familiesBySource={};const ie=M.ct(Object.values(this._layerConfigs),this.keyCache);for(const he of ie){const ve=he.map(Ie=>this._layers[Ie.id]),te=ve[0];if(te.visibility==="none")continue;const Le=te.source||"";let Ae=this.familiesBySource[Le];Ae||(Ae=this.familiesBySource[Le]={});const Re=te.sourceLayer||"_geojsonTileLayer";let Fe=Ae[Re];Fe||(Fe=Ae[Re]=[]),Fe.push(ve)}}}class K{constructor($){const X={},ie=[];for(const Le in $){const Ae=$[Le],Re=X[Le]={};for(const Fe in Ae){const Ie=Ae[+Fe];if(!Ie||Ie.bitmap.width===0||Ie.bitmap.height===0)continue;const et={x:0,y:0,w:Ie.bitmap.width+2,h:Ie.bitmap.height+2};ie.push(et),Re[Fe]={rect:et,metrics:Ie.metrics}}}const{w:he,h:ve}=M.p(ie),te=new M.q({width:he||1,height:ve||1});for(const Le in $){const Ae=$[Le];for(const Re in Ae){const Fe=Ae[+Re];if(!Fe||Fe.bitmap.width===0||Fe.bitmap.height===0)continue;const Ie=X[Le][Re].rect;M.q.copy(Fe.bitmap,te,{x:0,y:0},{x:Ie.x+1,y:Ie.y+1},Fe.bitmap)}}this.image=te,this.positions=X}}M.cu("GlyphAtlas",K);class W{constructor($){this.tileID=new M.Y($.tileID.overscaledZ,$.tileID.wrap,$.tileID.canonical.z,$.tileID.canonical.x,$.tileID.canonical.y),this.uid=$.uid,this.zoom=$.zoom,this.pixelRatio=$.pixelRatio,this.tileSize=$.tileSize,this.source=$.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=$.showCollisionBoxes,this.collectResourceTiming=!!$.collectResourceTiming,this.returnDependencies=!!$.returnDependencies,this.promoteId=$.promoteId,this.inFlightDependencies=[]}parse($,X,ie,he,ve){return M._(this,void 0,void 0,function*(){this.status="parsing",this.data=$,this.collisionBoxArray=new M.a5;const te=new M.cv(Object.keys($.layers).sort()),Le=new M.cw(this.tileID,this.promoteId);Le.bucketLayerIDs=[];const Ae={},Re={featureIndex:Le,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ie,subdivisionGranularity:ve},Fe=X.familiesBySource[this.source];for(const jt in Fe){const We=$.layers[jt];if(!We)continue;We.version===1&&M.w(`Vector tile source "${this.source}" layer "${jt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ft=te.encode(jt),Gt=[];for(let Fi=0;Fi<We.length;Fi++){const Gi=We.feature(Fi),qa=Le.getId(Gi,jt);Gt.push({feature:Gi,id:qa,index:Fi,sourceLayerIndex:Ft})}for(const Fi of Fe[jt]){const Gi=Fi[0];Gi.source!==this.source&&M.w(`layer.source = ${Gi.source} does not equal this.source = ${this.source}`),Gi.minzoom&&this.zoom<Math.floor(Gi.minzoom)||Gi.maxzoom&&this.zoom>=Gi.maxzoom||Gi.visibility!=="none"&&(we(Fi,this.zoom,ie),(Ae[Gi.id]=Gi.createBucket({index:Le.bucketLayerIDs.length,layers:Fi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ft,sourceID:this.source})).populate(Gt,Re,this.tileID.canonical),Le.bucketLayerIDs.push(Fi.map(qa=>qa.id)))}}const Ie=M.bF(Re.glyphDependencies,jt=>Object.keys(jt).map(Number));this.inFlightDependencies.forEach(jt=>jt==null?void 0:jt.abort()),this.inFlightDependencies=[];let et=Promise.resolve({});if(Object.keys(Ie).length){const jt=new AbortController;this.inFlightDependencies.push(jt),et=he.sendAsync({type:"GG",data:{stacks:Ie,source:this.source,tileID:this.tileID,type:"glyphs"}},jt)}const pt=Object.keys(Re.iconDependencies);let _t=Promise.resolve({});if(pt.length){const jt=new AbortController;this.inFlightDependencies.push(jt),_t=he.sendAsync({type:"GI",data:{icons:pt,source:this.source,tileID:this.tileID,type:"icons"}},jt)}const It=Object.keys(Re.patternDependencies);let kt=Promise.resolve({});if(It.length){const jt=new AbortController;this.inFlightDependencies.push(jt),kt=he.sendAsync({type:"GI",data:{icons:It,source:this.source,tileID:this.tileID,type:"patterns"}},jt)}const[Rt,Ve,vi]=yield Promise.all([et,_t,kt]),fi=new K(Rt),Ti=new M.cx(Ve,vi);for(const jt in Ae){const We=Ae[jt];We instanceof M.a6?(we(We.layers,this.zoom,ie),M.cy({bucket:We,glyphMap:Rt,glyphPositions:fi.positions,imageMap:Ve,imagePositions:Ti.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Re.subdivisionGranularity})):We.hasPattern&&(We instanceof M.cz||We instanceof M.cA||We instanceof M.cB)&&(we(We.layers,this.zoom,ie),We.addFeatures(Re,this.tileID.canonical,Ti.patternPositions))}return this.status="done",{buckets:Object.values(Ae).filter(jt=>!jt.isEmpty()),featureIndex:Le,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:fi.image,imageAtlas:Ti,glyphMap:this.returnDependencies?Rt:null,iconMap:this.returnDependencies?Ve:null,glyphPositions:this.returnDependencies?fi.positions:null}})}}function we(Ce,$,X){const ie=new M.C($);for(const he of Ce)he.recalculate(ie,X)}class Pe{constructor($,X,ie){this.actor=$,this.layerIndex=X,this.availableImages=ie,this.fetching={},this.loading={},this.loaded={}}loadVectorTile($,X){return M._(this,void 0,void 0,function*(){const ie=yield M.n($.request,X);try{return{vectorTile:new M.cC.VectorTile(new M.cD(ie.data)),rawData:ie.data,cacheControl:ie.cacheControl,expires:ie.expires}}catch(he){const ve=new Uint8Array(ie.data);let te=`Unable to parse the tile at ${$.request.url}, `;throw te+=ve[0]===31&&ve[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${he.message}`,new Error(te)}})}loadTile($){return M._(this,void 0,void 0,function*(){const X=$.uid,ie=!!($&&$.request&&$.request.collectResourceTiming)&&new M.cE($.request),he=new W($);this.loading[X]=he;const ve=new AbortController;he.abort=ve;try{const te=yield this.loadVectorTile($,ve);if(delete this.loading[X],!te)return null;const Le=te.rawData,Ae={};te.expires&&(Ae.expires=te.expires),te.cacheControl&&(Ae.cacheControl=te.cacheControl);const Re={};if(ie){const Ie=ie.finish();Ie&&(Re.resourceTiming=JSON.parse(JSON.stringify(Ie)))}he.vectorTile=te.vectorTile;const Fe=he.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity);this.loaded[X]=he,this.fetching[X]={rawTileData:Le,cacheControl:Ae,resourceTiming:Re};try{const Ie=yield Fe;return M.e({rawTileData:Le.slice(0)},Ie,Ae,Re)}finally{delete this.fetching[X]}}catch(te){throw delete this.loading[X],he.status="done",this.loaded[X]=he,te}})}reloadTile($){return M._(this,void 0,void 0,function*(){const X=$.uid;if(!this.loaded||!this.loaded[X])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ie=this.loaded[X];if(ie.showCollisionBoxes=$.showCollisionBoxes,ie.status==="parsing"){const he=yield ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity);let ve;if(this.fetching[X]){const{rawTileData:te,cacheControl:Le,resourceTiming:Ae}=this.fetching[X];delete this.fetching[X],ve=M.e({rawTileData:te.slice(0)},he,Le,Ae)}else ve=he;return ve}if(ie.status==="done"&&ie.vectorTile)return ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity)})}abortTile($){return M._(this,void 0,void 0,function*(){const X=this.loading,ie=$.uid;X&&X[ie]&&X[ie].abort&&(X[ie].abort.abort(),delete X[ie])})}removeTile($){return M._(this,void 0,void 0,function*(){this.loaded&&this.loaded[$.uid]&&delete this.loaded[$.uid]})}}class Me{constructor(){this.loaded={}}loadTile($){return M._(this,void 0,void 0,function*(){const{uid:X,encoding:ie,rawImageData:he,redFactor:ve,greenFactor:te,blueFactor:Le,baseShift:Ae}=$,Re=he.width+2,Fe=he.height+2,Ie=M.b(he)?new M.R({width:Re,height:Fe},yield M.cF(he,-1,-1,Re,Fe)):he,et=new M.cG(X,Ie,ie,ve,te,Le,Ae);return this.loaded=this.loaded||{},this.loaded[X]=et,et})}removeTile($){const X=this.loaded,ie=$.uid;X&&X[ie]&&delete X[ie]}}var fe,Qe,ai=function(){if(Qe)return fe;function Ce(X,ie){if(X.length!==0){$(X[0],ie);for(var he=1;he<X.length;he++)$(X[he],!ie)}}function $(X,ie){for(var he=0,ve=0,te=0,Le=X.length,Ae=Le-1;te<Le;Ae=te++){var Re=(X[te][0]-X[Ae][0])*(X[Ae][1]+X[te][1]),Fe=he+Re;ve+=Math.abs(he)>=Math.abs(Re)?he-Fe+Re:Re-Fe+he,he=Fe}he+ve>=0!=!!ie&&X.reverse()}return Qe=1,fe=function X(ie,he){var ve,te=ie&&ie.type;if(te==="FeatureCollection")for(ve=0;ve<ie.features.length;ve++)X(ie.features[ve],he);else if(te==="GeometryCollection")for(ve=0;ve<ie.geometries.length;ve++)X(ie.geometries[ve],he);else if(te==="Feature")X(ie.geometry,he);else if(te==="Polygon")Ce(ie.coordinates,he);else if(te==="MultiPolygon")for(ve=0;ve<ie.coordinates.length;ve++)Ce(ie.coordinates[ve],he);return ie}}(),li=M.cH(ai);const ei=M.cC.VectorTileFeature.prototype.toGeoJSON;class Ci{constructor($){this._feature=$,this.extent=M.Z,this.type=$.type,this.properties=$.tags,"id"in $&&!isNaN($.id)&&(this.id=parseInt($.id,10))}loadGeometry(){if(this._feature.type===1){const $=[];for(const X of this._feature.geometry)$.push([new M.P(X[0],X[1])]);return $}{const $=[];for(const X of this._feature.geometry){const ie=[];for(const he of X)ie.push(new M.P(he[0],he[1]));$.push(ie)}return $}}toGeoJSON($,X,ie){return ei.call(this,$,X,ie)}}class ni{constructor($){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=M.Z,this.length=$.length,this._features=$}feature($){return new Ci(this._features[$])}}var Mt,Et,Ut,Ii={exports:{}},bi=function(){if(Ut)return Ii.exports;Ut=1;var Ce=M.cK(),$=function(){if(Et)return Mt;Et=1;var Fe=M.cI(),Ie=M.cJ().VectorTileFeature;function et(_t,It){this.options=It||{},this.features=_t,this.length=_t.length}function pt(_t,It){this.id=typeof _t.id=="number"?_t.id:void 0,this.type=_t.type,this.rawGeometry=_t.type===1?[_t.geometry]:_t.geometry,this.properties=_t.tags,this.extent=It||4096}return Mt=et,et.prototype.feature=function(_t){return new pt(this.features[_t],this.options.extent)},pt.prototype.loadGeometry=function(){var _t=this.rawGeometry;this.geometry=[];for(var It=0;It<_t.length;It++){for(var kt=_t[It],Rt=[],Ve=0;Ve<kt.length;Ve++)Rt.push(new Fe(kt[Ve][0],kt[Ve][1]));this.geometry.push(Rt)}return this.geometry},pt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var _t=this.geometry,It=1/0,kt=-1/0,Rt=1/0,Ve=-1/0,vi=0;vi<_t.length;vi++)for(var fi=_t[vi],Ti=0;Ti<fi.length;Ti++){var jt=fi[Ti];It=Math.min(It,jt.x),kt=Math.max(kt,jt.x),Rt=Math.min(Rt,jt.y),Ve=Math.max(Ve,jt.y)}return[It,Rt,kt,Ve]},pt.prototype.toGeoJSON=Ie.prototype.toGeoJSON,Mt}();function X(Fe){var Ie=new Ce;return function(et,pt){for(var _t in et.layers)pt.writeMessage(3,ie,et.layers[_t])}(Fe,Ie),Ie.finish()}function ie(Fe,Ie){var et;Ie.writeVarintField(15,Fe.version||1),Ie.writeStringField(1,Fe.name||""),Ie.writeVarintField(5,Fe.extent||4096);var pt={keys:[],values:[],keycache:{},valuecache:{}};for(et=0;et<Fe.length;et++)pt.feature=Fe.feature(et),Ie.writeMessage(2,he,pt);var _t=pt.keys;for(et=0;et<_t.length;et++)Ie.writeStringField(3,_t[et]);var It=pt.values;for(et=0;et<It.length;et++)Ie.writeMessage(4,Re,It[et])}function he(Fe,Ie){var et=Fe.feature;et.id!==void 0&&Ie.writeVarintField(1,et.id),Ie.writeMessage(2,ve,Fe),Ie.writeVarintField(3,et.type),Ie.writeMessage(4,Ae,et)}function ve(Fe,Ie){var et=Fe.feature,pt=Fe.keys,_t=Fe.values,It=Fe.keycache,kt=Fe.valuecache;for(var Rt in et.properties){var Ve=et.properties[Rt],vi=It[Rt];if(Ve!==null){vi===void 0&&(pt.push(Rt),It[Rt]=vi=pt.length-1),Ie.writeVarint(vi);var fi=typeof Ve;fi!=="string"&&fi!=="boolean"&&fi!=="number"&&(Ve=JSON.stringify(Ve));var Ti=fi+":"+Ve,jt=kt[Ti];jt===void 0&&(_t.push(Ve),kt[Ti]=jt=_t.length-1),Ie.writeVarint(jt)}}}function te(Fe,Ie){return(Ie<<3)+(7&Fe)}function Le(Fe){return Fe<<1^Fe>>31}function Ae(Fe,Ie){for(var et=Fe.loadGeometry(),pt=Fe.type,_t=0,It=0,kt=et.length,Rt=0;Rt<kt;Rt++){var Ve=et[Rt],vi=1;pt===1&&(vi=Ve.length),Ie.writeVarint(te(1,vi));for(var fi=pt===3?Ve.length-1:Ve.length,Ti=0;Ti<fi;Ti++){Ti===1&&pt!==1&&Ie.writeVarint(te(2,fi-1));var jt=Ve[Ti].x-_t,We=Ve[Ti].y-It;Ie.writeVarint(Le(jt)),Ie.writeVarint(Le(We)),_t+=jt,It+=We}pt===3&&Ie.writeVarint(te(7,1))}}function Re(Fe,Ie){var et=typeof Fe;et==="string"?Ie.writeStringField(1,Fe):et==="boolean"?Ie.writeBooleanField(7,Fe):et==="number"&&(Fe%1!=0?Ie.writeDoubleField(3,Fe):Fe<0?Ie.writeSVarintField(6,Fe):Ie.writeVarintField(5,Fe))}return Ii.exports=X,Ii.exports.fromVectorTileJs=X,Ii.exports.fromGeojsonVt=function(Fe,Ie){Ie=Ie||{};var et={};for(var pt in Fe)et[pt]=new $(Fe[pt].features,Ie),et[pt].name=pt,et[pt].version=Ie.version,et[pt].extent=Ie.extent;return X({layers:et})},Ii.exports.GeoJSONWrapper=$,Ii.exports}(),nr=M.cH(bi);const Ms={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ce=>Ce},mn=Math.fround||(ia=new Float32Array(1),Ce=>(ia[0]=+Ce,ia[0]));var ia;const sn=3,xa=5,Fa=6;class Je{constructor($){this.options=Object.assign(Object.create(Ms),$),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load($){const{log:X,minZoom:ie,maxZoom:he}=this.options;X&&console.time("total time");const ve=`prepare ${$.length} points`;X&&console.time(ve),this.points=$;const te=[];for(let Ae=0;Ae<$.length;Ae++){const Re=$[Ae];if(!Re.geometry)continue;const[Fe,Ie]=Re.geometry.coordinates,et=mn(xi(Fe)),pt=mn(Te(Ie));te.push(et,pt,1/0,Ae,-1,1),this.options.reduce&&te.push(0)}let Le=this.trees[he+1]=this._createTree(te);X&&console.timeEnd(ve);for(let Ae=he;Ae>=ie;Ae--){const Re=+Date.now();Le=this.trees[Ae]=this._createTree(this._cluster(Le,Ae)),X&&console.log("z%d: %d clusters in %dms",Ae,Le.numItems,+Date.now()-Re)}return X&&console.timeEnd("total time"),this}getClusters($,X){let ie=(($[0]+180)%360+360)%360-180;const he=Math.max(-90,Math.min(90,$[1]));let ve=$[2]===180?180:(($[2]+180)%360+360)%360-180;const te=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)ie=-180,ve=180;else if(ie>ve){const Ie=this.getClusters([ie,he,180,te],X),et=this.getClusters([-180,he,ve,te],X);return Ie.concat(et)}const Le=this.trees[this._limitZoom(X)],Ae=Le.range(xi(ie),Te(te),xi(ve),Te(he)),Re=Le.data,Fe=[];for(const Ie of Ae){const et=this.stride*Ie;Fe.push(Re[et+xa]>1?wt(Re,et,this.clusterProps):this.points[Re[et+sn]])}return Fe}getChildren($){const X=this._getOriginId($),ie=this._getOriginZoom($),he="No cluster with the specified id.",ve=this.trees[ie];if(!ve)throw new Error(he);const te=ve.data;if(X*this.stride>=te.length)throw new Error(he);const Le=this.options.radius/(this.options.extent*Math.pow(2,ie-1)),Ae=ve.within(te[X*this.stride],te[X*this.stride+1],Le),Re=[];for(const Fe of Ae){const Ie=Fe*this.stride;te[Ie+4]===$&&Re.push(te[Ie+xa]>1?wt(te,Ie,this.clusterProps):this.points[te[Ie+sn]])}if(Re.length===0)throw new Error(he);return Re}getLeaves($,X,ie){const he=[];return this._appendLeaves(he,$,X=X||10,ie=ie||0,0),he}getTile($,X,ie){const he=this.trees[this._limitZoom($)],ve=Math.pow(2,$),{extent:te,radius:Le}=this.options,Ae=Le/te,Re=(ie-Ae)/ve,Fe=(ie+1+Ae)/ve,Ie={features:[]};return this._addTileFeatures(he.range((X-Ae)/ve,Re,(X+1+Ae)/ve,Fe),he.data,X,ie,ve,Ie),X===0&&this._addTileFeatures(he.range(1-Ae/ve,Re,1,Fe),he.data,ve,ie,ve,Ie),X===ve-1&&this._addTileFeatures(he.range(0,Re,Ae/ve,Fe),he.data,-1,ie,ve,Ie),Ie.features.length?Ie:null}getClusterExpansionZoom($){let X=this._getOriginZoom($)-1;for(;X<=this.options.maxZoom;){const ie=this.getChildren($);if(X++,ie.length!==1)break;$=ie[0].properties.cluster_id}return X}_appendLeaves($,X,ie,he,ve){const te=this.getChildren(X);for(const Le of te){const Ae=Le.properties;if(Ae&&Ae.cluster?ve+Ae.point_count<=he?ve+=Ae.point_count:ve=this._appendLeaves($,Ae.cluster_id,ie,he,ve):ve<he?ve++:$.push(Le),$.length===ie)break}return ve}_createTree($){const X=new M.aF($.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ie=0;ie<$.length;ie+=this.stride)X.add($[ie],$[ie+1]);return X.finish(),X.data=$,X}_addTileFeatures($,X,ie,he,ve,te){for(const Le of $){const Ae=Le*this.stride,Re=X[Ae+xa]>1;let Fe,Ie,et;if(Re)Fe=bt(X,Ae,this.clusterProps),Ie=X[Ae],et=X[Ae+1];else{const It=this.points[X[Ae+sn]];Fe=It.properties;const[kt,Rt]=It.geometry.coordinates;Ie=xi(kt),et=Te(Rt)}const pt={type:1,geometry:[[Math.round(this.options.extent*(Ie*ve-ie)),Math.round(this.options.extent*(et*ve-he))]],tags:Fe};let _t;_t=Re||this.options.generateId?X[Ae+sn]:this.points[X[Ae+sn]].id,_t!==void 0&&(pt.id=_t),te.features.push(pt)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,X){const{radius:ie,extent:he,reduce:ve,minPoints:te}=this.options,Le=ie/(he*Math.pow(2,X)),Ae=$.data,Re=[],Fe=this.stride;for(let Ie=0;Ie<Ae.length;Ie+=Fe){if(Ae[Ie+2]<=X)continue;Ae[Ie+2]=X;const et=Ae[Ie],pt=Ae[Ie+1],_t=$.within(Ae[Ie],Ae[Ie+1],Le),It=Ae[Ie+xa];let kt=It;for(const Rt of _t){const Ve=Rt*Fe;Ae[Ve+2]>X&&(kt+=Ae[Ve+xa])}if(kt>It&&kt>=te){let Rt,Ve=et*It,vi=pt*It,fi=-1;const Ti=((Ie/Fe|0)<<5)+(X+1)+this.points.length;for(const jt of _t){const We=jt*Fe;if(Ae[We+2]<=X)continue;Ae[We+2]=X;const Ft=Ae[We+xa];Ve+=Ae[We]*Ft,vi+=Ae[We+1]*Ft,Ae[We+4]=Ti,ve&&(Rt||(Rt=this._map(Ae,Ie,!0),fi=this.clusterProps.length,this.clusterProps.push(Rt)),ve(Rt,this._map(Ae,We)))}Ae[Ie+4]=Ti,Re.push(Ve/kt,vi/kt,1/0,Ti,-1,kt),ve&&Re.push(fi)}else{for(let Rt=0;Rt<Fe;Rt++)Re.push(Ae[Ie+Rt]);if(kt>1)for(const Rt of _t){const Ve=Rt*Fe;if(!(Ae[Ve+2]<=X)){Ae[Ve+2]=X;for(let vi=0;vi<Fe;vi++)Re.push(Ae[Ve+vi])}}}}return Re}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,X,ie){if($[X+xa]>1){const te=this.clusterProps[$[X+Fa]];return ie?Object.assign({},te):te}const he=this.points[$[X+sn]].properties,ve=this.options.map(he);return ie&&ve===he?Object.assign({},ve):ve}}function wt(Ce,$,X){return{type:"Feature",id:Ce[$+sn],properties:bt(Ce,$,X),geometry:{type:"Point",coordinates:[(ie=Ce[$],360*(ie-.5)),ut(Ce[$+1])]}};var ie}function bt(Ce,$,X){const ie=Ce[$+xa],he=ie>=1e4?`${Math.round(ie/1e3)}k`:ie>=1e3?Math.round(ie/100)/10+"k":ie,ve=Ce[$+Fa],te=ve===-1?{}:Object.assign({},X[ve]);return Object.assign(te,{cluster:!0,cluster_id:Ce[$+sn],point_count:ie,point_count_abbreviated:he})}function xi(Ce){return Ce/360+.5}function Te(Ce){const $=Math.sin(Ce*Math.PI/180),X=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return X<0?0:X>1?1:X}function ut(Ce){const $=(180-360*Ce)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function xt(Ce,$,X,ie){let he=ie;const ve=$+(X-$>>1);let te,Le=X-$;const Ae=Ce[$],Re=Ce[$+1],Fe=Ce[X],Ie=Ce[X+1];for(let et=$+3;et<X;et+=3){const pt=At(Ce[et],Ce[et+1],Ae,Re,Fe,Ie);if(pt>he)te=et,he=pt;else if(pt===he){const _t=Math.abs(et-ve);_t<Le&&(te=et,Le=_t)}}he>ie&&(te-$>3&&xt(Ce,$,te,ie),Ce[te+2]=he,X-te>3&&xt(Ce,te,X,ie))}function At(Ce,$,X,ie,he,ve){let te=he-X,Le=ve-ie;if(te!==0||Le!==0){const Ae=((Ce-X)*te+($-ie)*Le)/(te*te+Le*Le);Ae>1?(X=he,ie=ve):Ae>0&&(X+=te*Ae,ie+=Le*Ae)}return te=Ce-X,Le=$-ie,te*te+Le*Le}function Ot(Ce,$,X,ie){const he={id:Ce??null,type:$,geometry:X,tags:ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if($==="Point"||$==="MultiPoint"||$==="LineString")Xt(he,X);else if($==="Polygon")Xt(he,X[0]);else if($==="MultiLineString")for(const ve of X)Xt(he,ve);else if($==="MultiPolygon")for(const ve of X)Xt(he,ve[0]);return he}function Xt(Ce,$){for(let X=0;X<$.length;X+=3)Ce.minX=Math.min(Ce.minX,$[X]),Ce.minY=Math.min(Ce.minY,$[X+1]),Ce.maxX=Math.max(Ce.maxX,$[X]),Ce.maxY=Math.max(Ce.maxY,$[X+1])}function Vt(Ce,$,X,ie){if(!$.geometry)return;const he=$.geometry.coordinates;if(he&&he.length===0)return;const ve=$.geometry.type,te=Math.pow(X.tolerance/((1<<X.maxZoom)*X.extent),2);let Le=[],Ae=$.id;if(X.promoteId?Ae=$.properties[X.promoteId]:X.generateId&&(Ae=ie||0),ve==="Point")aa(he,Le);else if(ve==="MultiPoint")for(const Re of he)aa(Re,Le);else if(ve==="LineString")Ni(he,Le,te,!1);else if(ve==="MultiLineString"){if(X.lineMetrics){for(const Re of he)Le=[],Ni(Re,Le,te,!1),Ce.push(Ot(Ae,"LineString",Le,$.properties));return}qn(he,Le,te,!1)}else if(ve==="Polygon")qn(he,Le,te,!0);else{if(ve!=="MultiPolygon"){if(ve==="GeometryCollection"){for(const Re of $.geometry.geometries)Vt(Ce,{id:Ae,geometry:Re,properties:$.properties},X,ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Re of he){const Fe=[];qn(Re,Fe,te,!0),Le.push(Fe)}}Ce.push(Ot(Ae,ve,Le,$.properties))}function aa(Ce,$){$.push(Bo(Ce[0]),gn(Ce[1]),0)}function Ni(Ce,$,X,ie){let he,ve,te=0;for(let Ae=0;Ae<Ce.length;Ae++){const Re=Bo(Ce[Ae][0]),Fe=gn(Ce[Ae][1]);$.push(Re,Fe,0),Ae>0&&(te+=ie?(he*Fe-Re*ve)/2:Math.sqrt(Math.pow(Re-he,2)+Math.pow(Fe-ve,2))),he=Re,ve=Fe}const Le=$.length-3;$[2]=1,xt($,0,Le,X),$[Le+2]=1,$.size=Math.abs(te),$.start=0,$.end=$.size}function qn(Ce,$,X,ie){for(let he=0;he<Ce.length;he++){const ve=[];Ni(Ce[he],ve,X,ie),$.push(ve)}}function Bo(Ce){return Ce/360+.5}function gn(Ce){const $=Math.sin(Ce*Math.PI/180),X=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return X<0?0:X>1?1:X}function Rn(Ce,$,X,ie,he,ve,te,Le){if(ie/=$,ve>=(X/=$)&&te<ie)return Ce;if(te<X||ve>=ie)return null;const Ae=[];for(const Re of Ce){const Fe=Re.geometry;let Ie=Re.type;const et=he===0?Re.minX:Re.minY,pt=he===0?Re.maxX:Re.maxY;if(et>=X&&pt<ie){Ae.push(Re);continue}if(pt<X||et>=ie)continue;let _t=[];if(Ie==="Point"||Ie==="MultiPoint")on(Fe,_t,X,ie,he);else if(Ie==="LineString")Oi(Fe,_t,X,ie,he,!1,Le.lineMetrics);else if(Ie==="MultiLineString")ro(Fe,_t,X,ie,he,!1);else if(Ie==="Polygon")ro(Fe,_t,X,ie,he,!0);else if(Ie==="MultiPolygon")for(const It of Fe){const kt=[];ro(It,kt,X,ie,he,!0),kt.length&&_t.push(kt)}if(_t.length){if(Le.lineMetrics&&Ie==="LineString"){for(const It of _t)Ae.push(Ot(Re.id,Ie,It,Re.tags));continue}Ie!=="LineString"&&Ie!=="MultiLineString"||(_t.length===1?(Ie="LineString",_t=_t[0]):Ie="MultiLineString"),Ie!=="Point"&&Ie!=="MultiPoint"||(Ie=_t.length===3?"Point":"MultiPoint"),Ae.push(Ot(Re.id,Ie,_t,Re.tags))}}return Ae.length?Ae:null}function on(Ce,$,X,ie,he){for(let ve=0;ve<Ce.length;ve+=3){const te=Ce[ve+he];te>=X&&te<=ie&&Ra($,Ce[ve],Ce[ve+1],Ce[ve+2])}}function Oi(Ce,$,X,ie,he,ve,te){let Le=Jr(Ce);const Ae=he===0?Sl:Du;let Re,Fe,Ie=Ce.start;for(let kt=0;kt<Ce.length-3;kt+=3){const Rt=Ce[kt],Ve=Ce[kt+1],vi=Ce[kt+2],fi=Ce[kt+3],Ti=Ce[kt+4],jt=he===0?Rt:Ve,We=he===0?fi:Ti;let Ft=!1;te&&(Re=Math.sqrt(Math.pow(Rt-fi,2)+Math.pow(Ve-Ti,2))),jt<X?We>X&&(Fe=Ae(Le,Rt,Ve,fi,Ti,X),te&&(Le.start=Ie+Re*Fe)):jt>ie?We<ie&&(Fe=Ae(Le,Rt,Ve,fi,Ti,ie),te&&(Le.start=Ie+Re*Fe)):Ra(Le,Rt,Ve,vi),We<X&&jt>=X&&(Fe=Ae(Le,Rt,Ve,fi,Ti,X),Ft=!0),We>ie&&jt<=ie&&(Fe=Ae(Le,Rt,Ve,fi,Ti,ie),Ft=!0),!ve&&Ft&&(te&&(Le.end=Ie+Re*Fe),$.push(Le),Le=Jr(Ce)),te&&(Ie+=Re)}let et=Ce.length-3;const pt=Ce[et],_t=Ce[et+1],It=he===0?pt:_t;It>=X&&It<=ie&&Ra(Le,pt,_t,Ce[et+2]),et=Le.length-3,ve&&et>=3&&(Le[et]!==Le[0]||Le[et+1]!==Le[1])&&Ra(Le,Le[0],Le[1],Le[2]),Le.length&&$.push(Le)}function Jr(Ce){const $=[];return $.size=Ce.size,$.start=Ce.start,$.end=Ce.end,$}function ro(Ce,$,X,ie,he,ve){for(const te of Ce)Oi(te,$,X,ie,he,ve,!1)}function Ra(Ce,$,X,ie){Ce.push($,X,ie)}function Sl(Ce,$,X,ie,he,ve){const te=(ve-$)/(ie-$);return Ra(Ce,ve,X+(he-X)*te,1),te}function Du(Ce,$,X,ie,he,ve){const te=(ve-X)/(he-X);return Ra(Ce,$+(ie-$)*te,ve,1),te}function Vn(Ce,$){const X=[];for(let ie=0;ie<Ce.length;ie++){const he=Ce[ie],ve=he.type;let te;if(ve==="Point"||ve==="MultiPoint"||ve==="LineString")te=rr(he.geometry,$);else if(ve==="MultiLineString"||ve==="Polygon"){te=[];for(const Le of he.geometry)te.push(rr(Le,$))}else if(ve==="MultiPolygon"){te=[];for(const Le of he.geometry){const Ae=[];for(const Re of Le)Ae.push(rr(Re,$));te.push(Ae)}}X.push(Ot(he.id,ve,te,he.tags))}return X}function rr(Ce,$){const X=[];X.size=Ce.size,Ce.start!==void 0&&(X.start=Ce.start,X.end=Ce.end);for(let ie=0;ie<Ce.length;ie+=3)X.push(Ce[ie]+$,Ce[ie+1],Ce[ie+2]);return X}function zo(Ce,$){if(Ce.transformed)return Ce;const X=1<<Ce.z,ie=Ce.x,he=Ce.y;for(const ve of Ce.features){const te=ve.geometry,Le=ve.type;if(ve.geometry=[],Le===1)for(let Ae=0;Ae<te.length;Ae+=2)ve.geometry.push(so(te[Ae],te[Ae+1],$,X,ie,he));else for(let Ae=0;Ae<te.length;Ae++){const Re=[];for(let Fe=0;Fe<te[Ae].length;Fe+=2)Re.push(so(te[Ae][Fe],te[Ae][Fe+1],$,X,ie,he));ve.geometry.push(Re)}}return Ce.transformed=!0,Ce}function so(Ce,$,X,ie,he,ve){return[Math.round(X*(Ce*ie-he)),Math.round(X*($*ie-ve))]}function Is(Ce,$,X,ie,he){const ve=$===he.maxZoom?0:he.tolerance/((1<<$)*he.extent),te={features:[],numPoints:0,numSimplified:0,numFeatures:Ce.length,source:null,x:X,y:ie,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Le of Ce)Ru(te,Le,ve,he);return te}function Ru(Ce,$,X,ie){const he=$.geometry,ve=$.type,te=[];if(Ce.minX=Math.min(Ce.minX,$.minX),Ce.minY=Math.min(Ce.minY,$.minY),Ce.maxX=Math.max(Ce.maxX,$.maxX),Ce.maxY=Math.max(Ce.maxY,$.maxY),ve==="Point"||ve==="MultiPoint")for(let Le=0;Le<he.length;Le+=3)te.push(he[Le],he[Le+1]),Ce.numPoints++,Ce.numSimplified++;else if(ve==="LineString")es(te,he,Ce,X,!1,!1);else if(ve==="MultiLineString"||ve==="Polygon")for(let Le=0;Le<he.length;Le++)es(te,he[Le],Ce,X,ve==="Polygon",Le===0);else if(ve==="MultiPolygon")for(let Le=0;Le<he.length;Le++){const Ae=he[Le];for(let Re=0;Re<Ae.length;Re++)es(te,Ae[Re],Ce,X,!0,Re===0)}if(te.length){let Le=$.tags||null;if(ve==="LineString"&&ie.lineMetrics){Le={};for(const Re in $.tags)Le[Re]=$.tags[Re];Le.mapbox_clip_start=he.start/he.size,Le.mapbox_clip_end=he.end/he.size}const Ae={geometry:te,type:ve==="Polygon"||ve==="MultiPolygon"?3:ve==="LineString"||ve==="MultiLineString"?2:1,tags:Le};$.id!==null&&(Ae.id=$.id),Ce.features.push(Ae)}}function es(Ce,$,X,ie,he,ve){const te=ie*ie;if(ie>0&&$.size<(he?te:ie))return void(X.numPoints+=$.length/3);const Le=[];for(let Ae=0;Ae<$.length;Ae+=3)(ie===0||$[Ae+2]>te)&&(X.numSimplified++,Le.push($[Ae],$[Ae+1])),X.numPoints++;he&&function(Ae,Re){let Fe=0;for(let Ie=0,et=Ae.length,pt=et-2;Ie<et;pt=Ie,Ie+=2)Fe+=(Ae[Ie]-Ae[pt])*(Ae[Ie+1]+Ae[pt+1]);if(Fe>0===Re)for(let Ie=0,et=Ae.length;Ie<et/2;Ie+=2){const pt=Ae[Ie],_t=Ae[Ie+1];Ae[Ie]=Ae[et-2-Ie],Ae[Ie+1]=Ae[et-1-Ie],Ae[et-2-Ie]=pt,Ae[et-1-Ie]=_t}}(Le,ve),Ce.push(Le)}const Ka={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class _n{constructor($,X){const ie=(X=this.options=function(ve,te){for(const Le in te)ve[Le]=te[Le];return ve}(Object.create(Ka),X)).debug;if(ie&&console.time("preprocess data"),X.maxZoom<0||X.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(X.promoteId&&X.generateId)throw new Error("promoteId and generateId cannot be used together.");let he=function(ve,te){const Le=[];if(ve.type==="FeatureCollection")for(let Ae=0;Ae<ve.features.length;Ae++)Vt(Le,ve.features[Ae],te,Ae);else Vt(Le,ve.type==="Feature"?ve:{geometry:ve},te);return Le}($,X);this.tiles={},this.tileCoords=[],ie&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",X.indexMaxZoom,X.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=function(ve,te){const Le=te.buffer/te.extent;let Ae=ve;const Re=Rn(ve,1,-1-Le,Le,0,-1,2,te),Fe=Rn(ve,1,1-Le,2+Le,0,-1,2,te);return(Re||Fe)&&(Ae=Rn(ve,1,-Le,1+Le,0,-1,2,te)||[],Re&&(Ae=Vn(Re,1).concat(Ae)),Fe&&(Ae=Ae.concat(Vn(Fe,-1)))),Ae}(he,X),he.length&&this.splitTile(he,0,0,0),ie&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile($,X,ie,he,ve,te,Le){const Ae=[$,X,ie,he],Re=this.options,Fe=Re.debug;for(;Ae.length;){he=Ae.pop(),ie=Ae.pop(),X=Ae.pop(),$=Ae.pop();const Ie=1<<X,et=Pa(X,ie,he);let pt=this.tiles[et];if(!pt&&(Fe>1&&console.time("creation"),pt=this.tiles[et]=Is($,X,ie,he,Re),this.tileCoords.push({z:X,x:ie,y:he}),Fe)){Fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",X,ie,he,pt.numFeatures,pt.numPoints,pt.numSimplified),console.timeEnd("creation"));const Ft=`z${X}`;this.stats[Ft]=(this.stats[Ft]||0)+1,this.total++}if(pt.source=$,ve==null){if(X===Re.indexMaxZoom||pt.numPoints<=Re.indexMaxPoints)continue}else{if(X===Re.maxZoom||X===ve)continue;if(ve!=null){const Ft=ve-X;if(ie!==te>>Ft||he!==Le>>Ft)continue}}if(pt.source=null,$.length===0)continue;Fe>1&&console.time("clipping");const _t=.5*Re.buffer/Re.extent,It=.5-_t,kt=.5+_t,Rt=1+_t;let Ve=null,vi=null,fi=null,Ti=null,jt=Rn($,Ie,ie-_t,ie+kt,0,pt.minX,pt.maxX,Re),We=Rn($,Ie,ie+It,ie+Rt,0,pt.minX,pt.maxX,Re);$=null,jt&&(Ve=Rn(jt,Ie,he-_t,he+kt,1,pt.minY,pt.maxY,Re),vi=Rn(jt,Ie,he+It,he+Rt,1,pt.minY,pt.maxY,Re),jt=null),We&&(fi=Rn(We,Ie,he-_t,he+kt,1,pt.minY,pt.maxY,Re),Ti=Rn(We,Ie,he+It,he+Rt,1,pt.minY,pt.maxY,Re),We=null),Fe>1&&console.timeEnd("clipping"),Ae.push(Ve||[],X+1,2*ie,2*he),Ae.push(vi||[],X+1,2*ie,2*he+1),Ae.push(fi||[],X+1,2*ie+1,2*he),Ae.push(Ti||[],X+1,2*ie+1,2*he+1)}}getTile($,X,ie){$=+$,X=+X,ie=+ie;const he=this.options,{extent:ve,debug:te}=he;if($<0||$>24)return null;const Le=1<<$,Ae=Pa($,X=X+Le&Le-1,ie);if(this.tiles[Ae])return zo(this.tiles[Ae],ve);te>1&&console.log("drilling down to z%d-%d-%d",$,X,ie);let Re,Fe=$,Ie=X,et=ie;for(;!Re&&Fe>0;)Fe--,Ie>>=1,et>>=1,Re=this.tiles[Pa(Fe,Ie,et)];return Re&&Re.source?(te>1&&(console.log("found parent tile z%d-%d-%d",Fe,Ie,et),console.time("drilling down")),this.splitTile(Re.source,Fe,Ie,et,$,X,ie),te>1&&console.timeEnd("drilling down"),this.tiles[Ae]?zo(this.tiles[Ae],ve):null):null}}function Pa(Ce,$,X){return 32*((1<<Ce)*X+$)+Ce}function oo(Ce,$){return $?Ce.properties[$]:Ce.id}function Pu(Ce,$){if(Ce==null)return!0;if(Ce.type==="Feature")return oo(Ce,$)!=null;if(Ce.type==="FeatureCollection"){const X=new Set;for(const ie of Ce.features){const he=oo(ie,$);if(he==null||X.has(he))return!1;X.add(he)}return!0}return!1}function wr(Ce,$){const X=new Map;if(Ce!=null)if(Ce.type==="Feature")X.set(oo(Ce,$),Ce);else for(const ie of Ce.features)X.set(oo(ie,$),ie);return X}class un extends Pe{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile($,X){return M._(this,void 0,void 0,function*(){const ie=$.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const he=this._geoJSONIndex.getTile(ie.z,ie.x,ie.y);if(!he)return null;const ve=new ni(he.features);let te=nr(ve);return te.byteOffset===0&&te.byteLength===te.buffer.byteLength||(te=new Uint8Array(te)),{vectorTile:ve,rawData:te.buffer}})}loadData($){return M._(this,void 0,void 0,function*(){var X;(X=this._pendingRequest)===null||X===void 0||X.abort();const ie=!!($&&$.request&&$.request.collectResourceTiming)&&new M.cE($.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON($,this._pendingRequest),this._geoJSONIndex=$.cluster?new Je(function({superclusterOptions:te,clusterProperties:Le}){if(!Le||!te)return te;const Ae={},Re={},Fe={accumulated:null,zoom:0},Ie={properties:null},et=Object.keys(Le);for(const pt of et){const[_t,It]=Le[pt],kt=M.cL(It),Rt=M.cL(typeof _t=="string"?[_t,["accumulated"],["get",pt]]:_t);Ae[pt]=kt.value,Re[pt]=Rt.value}return te.map=pt=>{Ie.properties=pt;const _t={};for(const It of et)_t[It]=Ae[It].evaluate(Fe,Ie);return _t},te.reduce=(pt,_t)=>{Ie.properties=_t;for(const It of et)Fe.accumulated=pt[It],pt[It]=Re[It].evaluate(Fe,Ie)},te}($)).load((yield this._pendingData).features):(he=yield this._pendingData,new _n(he,$.geojsonVtOptions)),this.loaded={};const ve={};if(ie){const te=ie.finish();te&&(ve.resourceTiming={},ve.resourceTiming[$.source]=JSON.parse(JSON.stringify(te)))}return ve}catch(ve){if(delete this._pendingRequest,M.cp(ve))return{abandoned:!0};throw ve}var he})}getData(){return M._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile($){const X=this.loaded;return X&&X[$.uid]?super.reloadTile($):this.loadTile($)}loadAndProcessGeoJSON($,X){return M._(this,void 0,void 0,function*(){let ie=yield this.loadGeoJSON($,X);if(delete this._pendingRequest,typeof ie!="object")throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`);if(li(ie,!0),$.filter){const he=M.cL($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(he.result==="error")throw new Error(he.value.map(te=>`${te.key}: ${te.message}`).join(", "));ie={type:"FeatureCollection",features:ie.features.filter(te=>he.value.evaluate({zoom:0},te))}}return ie})}loadGeoJSON($,X){return M._(this,void 0,void 0,function*(){const{promoteId:ie}=$;if($.request){const he=yield M.j($.request,X);return this._dataUpdateable=Pu(he.data,ie)?wr(he.data,ie):void 0,he.data}if(typeof $.data=="string")try{const he=JSON.parse($.data);return this._dataUpdateable=Pu(he,ie)?wr(he,ie):void 0,he}catch{throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`)}if(!$.dataDiff)throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${$.source}`);return function(he,ve,te){var Le,Ae,Re,Fe;if(ve.removeAll&&he.clear(),ve.remove)for(const Ie of ve.remove)he.delete(Ie);if(ve.add)for(const Ie of ve.add){const et=oo(Ie,te);et!=null&&he.set(et,Ie)}if(ve.update)for(const Ie of ve.update){let et=he.get(Ie.id);if(et==null)continue;const pt=!Ie.removeAllProperties&&(((Le=Ie.removeProperties)===null||Le===void 0?void 0:Le.length)>0||((Ae=Ie.addOrUpdateProperties)===null||Ae===void 0?void 0:Ae.length)>0);if((Ie.newGeometry||Ie.removeAllProperties||pt)&&(et=Object.assign({},et),he.set(Ie.id,et),pt&&(et.properties=Object.assign({},et.properties))),Ie.newGeometry&&(et.geometry=Ie.newGeometry),Ie.removeAllProperties)et.properties={};else if(((Re=Ie.removeProperties)===null||Re===void 0?void 0:Re.length)>0)for(const _t of Ie.removeProperties)Object.prototype.hasOwnProperty.call(et.properties,_t)&&delete et.properties[_t];if(((Fe=Ie.addOrUpdateProperties)===null||Fe===void 0?void 0:Fe.length)>0)for(const{key:_t,value:It}of Ie.addOrUpdateProperties)et.properties[_t]=It}}(this._dataUpdateable,$.dataDiff,ie),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource($){return M._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom($){return this._geoJSONIndex.getClusterExpansionZoom($.clusterId)}getClusterChildren($){return this._geoJSONIndex.getChildren($.clusterId)}getClusterLeaves($){return this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset)}}class sr{constructor($){this.self=$,this.actor=new M.H($),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(X,ie)=>{if(this.externalWorkerSourceTypes[X])throw new Error(`Worker source with name "${X}" already registered.`);this.externalWorkerSourceTypes[X]=ie},this.self.addProtocol=M.cr,this.self.removeProtocol=M.cs,this.self.registerRTLTextPlugin=X=>{M.cM.setMethods(X)},this.actor.registerMessageHandler("LDT",(X,ie)=>this._getDEMWorkerSource(X,ie.source).loadTile(ie)),this.actor.registerMessageHandler("RDT",(X,ie)=>M._(this,void 0,void 0,function*(){this._getDEMWorkerSource(X,ie.source).removeTile(ie)})),this.actor.registerMessageHandler("GCEZ",(X,ie)=>M._(this,void 0,void 0,function*(){return this._getWorkerSource(X,ie.type,ie.source).getClusterExpansionZoom(ie)})),this.actor.registerMessageHandler("GCC",(X,ie)=>M._(this,void 0,void 0,function*(){return this._getWorkerSource(X,ie.type,ie.source).getClusterChildren(ie)})),this.actor.registerMessageHandler("GCL",(X,ie)=>M._(this,void 0,void 0,function*(){return this._getWorkerSource(X,ie.type,ie.source).getClusterLeaves(ie)})),this.actor.registerMessageHandler("LD",(X,ie)=>this._getWorkerSource(X,ie.type,ie.source).loadData(ie)),this.actor.registerMessageHandler("GD",(X,ie)=>this._getWorkerSource(X,ie.type,ie.source).getData()),this.actor.registerMessageHandler("LT",(X,ie)=>this._getWorkerSource(X,ie.type,ie.source).loadTile(ie)),this.actor.registerMessageHandler("RT",(X,ie)=>this._getWorkerSource(X,ie.type,ie.source).reloadTile(ie)),this.actor.registerMessageHandler("AT",(X,ie)=>this._getWorkerSource(X,ie.type,ie.source).abortTile(ie)),this.actor.registerMessageHandler("RMT",(X,ie)=>this._getWorkerSource(X,ie.type,ie.source).removeTile(ie)),this.actor.registerMessageHandler("RS",(X,ie)=>M._(this,void 0,void 0,function*(){if(!this.workerSources[X]||!this.workerSources[X][ie.type]||!this.workerSources[X][ie.type][ie.source])return;const he=this.workerSources[X][ie.type][ie.source];delete this.workerSources[X][ie.type][ie.source],he.removeSource!==void 0&&he.removeSource(ie)})),this.actor.registerMessageHandler("RM",X=>M._(this,void 0,void 0,function*(){delete this.layerIndexes[X],delete this.availableImages[X],delete this.workerSources[X],delete this.demWorkerSources[X]})),this.actor.registerMessageHandler("SR",(X,ie)=>M._(this,void 0,void 0,function*(){this.referrer=ie})),this.actor.registerMessageHandler("SRPS",(X,ie)=>this._syncRTLPluginState(X,ie)),this.actor.registerMessageHandler("IS",(X,ie)=>M._(this,void 0,void 0,function*(){this.self.importScripts(ie)})),this.actor.registerMessageHandler("SI",(X,ie)=>this._setImages(X,ie)),this.actor.registerMessageHandler("UL",(X,ie)=>M._(this,void 0,void 0,function*(){this._getLayerIndex(X).update(ie.layers,ie.removedIds)})),this.actor.registerMessageHandler("SL",(X,ie)=>M._(this,void 0,void 0,function*(){this._getLayerIndex(X).replace(ie)}))}_setImages($,X){return M._(this,void 0,void 0,function*(){this.availableImages[$]=X;for(const ie in this.workerSources[$]){const he=this.workerSources[$][ie];for(const ve in he)he[ve].availableImages=X}})}_syncRTLPluginState($,X){return M._(this,void 0,void 0,function*(){return yield M.cM.syncState(X,this.self.importScripts)})}_getAvailableImages($){let X=this.availableImages[$];return X||(X=[]),X}_getLayerIndex($){let X=this.layerIndexes[$];return X||(X=this.layerIndexes[$]=new d),X}_getWorkerSource($,X,ie){if(this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][X]||(this.workerSources[$][X]={}),!this.workerSources[$][X][ie]){const he={sendAsync:(ve,te)=>(ve.targetMapId=$,this.actor.sendAsync(ve,te))};switch(X){case"vector":this.workerSources[$][X][ie]=new Pe(he,this._getLayerIndex($),this._getAvailableImages($));break;case"geojson":this.workerSources[$][X][ie]=new un(he,this._getLayerIndex($),this._getAvailableImages($));break;default:this.workerSources[$][X][ie]=new this.externalWorkerSourceTypes[X](he,this._getLayerIndex($),this._getAvailableImages($))}}return this.workerSources[$][X][ie]}_getDEMWorkerSource($,X){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][X]||(this.demWorkerSources[$][X]=new Me),this.demWorkerSources[$][X]}}return M.i(self)&&(self.worker=new sr(self)),sr}),C("index",["exports","./shared"],function(M,d){var K="5.5.0";function W(){var g=new d.A(4);return d.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g}let we,Pe;const Me={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(g,e,n){const c=requestAnimationFrame(y=>{f(),e(y)}),{unsubscribe:f}=d.s(g.signal,"abort",()=>{f(),cancelAnimationFrame(c),n(d.c())},!1)},frameAsync(g){return new Promise((e,n)=>{this.frame(g,e,n)})},getImageData(g,e=0){return this.getImageCanvasContext(g).getImageData(-e,-e,g.width+2*e,g.height+2*e)},getImageCanvasContext(g){const e=window.document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return e.width=g.width,e.height=g.height,n.drawImage(g,0,0,g.width,g.height),n},resolveURL:g=>(we||(we=document.createElement("a")),we.href=g,we.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Pe==null&&(Pe=matchMedia("(prefers-reduced-motion: reduce)")),Pe.matches)}};class fe{static testProp(e){if(!fe.docStyle)return e[0];for(let n=0;n<e.length;n++)if(e[n]in fe.docStyle)return e[n];return e[0]}static create(e,n,c){const f=window.document.createElement(e);return n!==void 0&&(f.className=n),c&&c.appendChild(f),f}static createNS(e,n){return window.document.createElementNS(e,n)}static disableDrag(){fe.docStyle&&fe.selectProp&&(fe.userSelect=fe.docStyle[fe.selectProp],fe.docStyle[fe.selectProp]="none")}static enableDrag(){fe.docStyle&&fe.selectProp&&(fe.docStyle[fe.selectProp]=fe.userSelect)}static setTransform(e,n){e.style[fe.transformProp]=n}static addEventListener(e,n,c,f={}){e.addEventListener(n,c,"passive"in f?f:f.capture)}static removeEventListener(e,n,c,f={}){e.removeEventListener(n,c,"passive"in f?f:f.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",fe.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",fe.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",fe.suppressClickInternal,!0)},0)}static getScale(e){const n=e.getBoundingClientRect();return{x:n.width/e.offsetWidth||1,y:n.height/e.offsetHeight||1,boundingClientRect:n}}static getPoint(e,n,c){const f=n.boundingClientRect;return new d.P((c.clientX-f.left)/n.x-e.clientLeft,(c.clientY-f.top)/n.y-e.clientTop)}static mousePos(e,n){const c=fe.getScale(e);return fe.getPoint(e,c,n)}static touchPos(e,n){const c=[],f=fe.getScale(e);for(let y=0;y<n.length;y++)c.push(fe.getPoint(e,f,n[y]));return c}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const n=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),c=n.querySelectorAll("script");for(const f of c)f.remove();return fe.clean(n),n.innerHTML}static isPossiblyDangerous(e,n){const c=n.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!c.includes("javascript:")&&!c.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const n=e.children;for(const c of n)fe.removeAttributes(c),fe.clean(c)}static removeAttributes(e){for(const{name:n,value:c}of e.attributes)fe.isPossiblyDangerous(n,c)&&e.removeAttribute(n)}}fe.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,fe.selectProp=fe.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),fe.transformProp=fe.testProp(["transform","WebkitTransform"]);const Qe={supported:!1,testSupport:function(g){!ei&&li&&(Ci?ni(g):ai=g)}};let ai,li,ei=!1,Ci=!1;function ni(g){const e=g.createTexture();g.bindTexture(g.TEXTURE_2D,e);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,li),g.isContextLost())return;Qe.supported=!0}catch{}g.deleteTexture(e),ei=!0}var Mt;typeof document<"u"&&(li=document.createElement("img"),li.onload=()=>{ai&&ni(ai),ai=null,Ci=!0},li.onerror=()=>{ei=!0,ai=null},li.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let e,n,c,f;g.resetRequestQueue=()=>{e=[],n=0,c=0,f={}},g.addThrottleControl=I=>{const L=c++;return f[L]=I,L},g.removeThrottleControl=I=>{delete f[I],T()},g.getImage=(I,L,k=!0)=>new Promise((F,z)=>{Qe.supported&&(I.headers||(I.headers={}),I.headers.accept="image/webp,*/*"),d.e(I,{type:"image"}),e.push({abortController:L,requestParameters:I,supportImageRefresh:k,state:"queued",onError:G=>{z(G)},onSuccess:G=>{F(G)}}),T()});const y=I=>d._(this,void 0,void 0,function*(){I.state="running";const{requestParameters:L,supportImageRefresh:k,onError:F,onSuccess:z,abortController:G}=I,Z=k===!1&&!d.i(self)&&!d.g(L.url)&&(!L.headers||Object.keys(L.headers).reduce((re,le)=>re&&le==="accept",!0));n++;const ne=Z?A(L,G):d.m(L,G);try{const re=yield ne;delete I.abortController,I.state="completed",re.data instanceof HTMLImageElement||d.b(re.data)?z(re):re.data&&z({data:yield(ae=re.data,typeof createImageBitmap=="function"?d.f(ae):d.h(ae)),cacheControl:re.cacheControl,expires:re.expires})}catch(re){delete I.abortController,F(re)}finally{n--,T()}var ae}),T=()=>{const I=(()=>{for(const L of Object.keys(f))if(f[L]())return!0;return!1})()?d.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:d.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let L=n;L<I&&e.length>0;L++){const k=e.shift();k.abortController.signal.aborted?L--:y(k)}},A=(I,L)=>new Promise((k,F)=>{const z=new Image,G=I.url,Z=I.credentials;Z&&Z==="include"?z.crossOrigin="use-credentials":(Z&&Z==="same-origin"||!d.d(G))&&(z.crossOrigin="anonymous"),L.signal.addEventListener("abort",()=>{z.src="",F(d.c())}),z.fetchPriority="high",z.onload=()=>{z.onerror=z.onload=null,k({data:z})},z.onerror=()=>{z.onerror=z.onload=null,L.signal.aborted||F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},z.src=G})}(Mt||(Mt={})),Mt.resetRequestQueue();class Et{constructor(e){this._transformRequestFn=e}transformRequest(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Ut(g){const e=[];if(typeof g=="string")e.push({id:"default",url:g});else if(g&&g.length>0){const n=[];for(const{id:c,url:f}of g){const y=`${c}${f}`;n.indexOf(y)===-1&&(n.push(y),e.push({id:c,url:f}))}}return e}function Ii(g,e,n){try{const c=new URL(g);return c.pathname+=`${e}${n}`,c.toString()}catch{throw new Error(`Invalid sprite URL "${g}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class bi{constructor(e,n,c,f){this.context=e,this.format=c,this.texture=e.gl.createTexture(),this.update(n,f)}update(e,n,c){const{width:f,height:y}=e,T=!(this.size&&this.size[0]===f&&this.size[1]===y||c),{context:A}=this,{gl:I}=A;if(this.useMipmap=!!(n&&n.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!n||n.premultiply!==!1)),T)this.size=[f,y],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||d.b(e)?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,e):I.texImage2D(I.TEXTURE_2D,0,this.format,f,y,0,this.format,I.UNSIGNED_BYTE,e.data);else{const{x:L,y:k}=c||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||d.b(e)?I.texSubImage2D(I.TEXTURE_2D,0,L,k,I.RGBA,I.UNSIGNED_BYTE,e):I.texSubImage2D(I.TEXTURE_2D,0,L,k,f,y,I.RGBA,I.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D),A.pixelStoreUnpackFlipY.setDefault(),A.pixelStoreUnpack.setDefault(),A.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,n,c){const{context:f}=this,{gl:y}=f;y.bindTexture(y.TEXTURE_2D,this.texture),c!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=y.LINEAR),e!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,e),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,c||e),this.filter=e),n!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,n),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function nr(g){const{userImage:e}=g;return!!(e&&e.render&&e.render())&&(g.data.replace(new Uint8Array(e.data.buffer)),!0)}class Ms extends d.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:n,promiseResolve:c}of this.requestors)c(this._getImagesForIds(n));this.requestors=[]}}getImage(e){const n=this.images[e];if(n&&!n.data&&n.spriteData){const c=n.spriteData;n.data=new d.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),n.spriteData=null}return n}addImage(e,n){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,n)&&(this.images[e]=n)}_validate(e,n){let c=!0;const f=n.data||n.spriteData;return this._validateStretch(n.stretchX,f&&f.width)||(this.fire(new d.k(new Error(`Image "${e}" has invalid "stretchX" value`))),c=!1),this._validateStretch(n.stretchY,f&&f.height)||(this.fire(new d.k(new Error(`Image "${e}" has invalid "stretchY" value`))),c=!1),this._validateContent(n.content,n)||(this.fire(new d.k(new Error(`Image "${e}" has invalid "content" value`))),c=!1),c}_validateStretch(e,n){if(!e)return!0;let c=0;for(const f of e){if(f[0]<c||f[1]<f[0]||n<f[1])return!1;c=f[1]}return!0}_validateContent(e,n){if(!e)return!0;if(e.length!==4)return!1;const c=n.spriteData,f=c&&c.width||n.data.width,y=c&&c.height||n.data.height;return!(e[0]<0||f<e[0]||e[1]<0||y<e[1]||e[2]<0||f<e[2]||e[3]<0||y<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,n,c=!0){const f=this.getImage(e);if(c&&(f.data.width!==n.data.width||f.data.height!==n.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${n.data.width}x${n.data.height}).`);n.version=f.version+1,this.images[e]=n,this.updatedImages[e]=!0}removeImage(e){const n=this.images[e];delete this.images[e],delete this.patterns[e],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((n,c)=>{let f=!0;if(!this.isLoaded())for(const y of e)this.images[y]||(f=!1);this.isLoaded()||f?n(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:n})})}_getImagesForIds(e){const n={};for(const c of e){let f=this.getImage(c);f||(this.fire(new d.l("styleimagemissing",{id:c})),f=this.getImage(c)),f?n[c]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:d.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){const{width:e,height:n}=this.atlasImage;return{width:e,height:n}}getPattern(e){const n=this.patterns[e],c=this.getImage(e);if(!c)return null;if(n&&n.position.version===c.version)return n.position;if(n)n.position.version=c.version;else{const f={w:c.data.width+2,h:c.data.height+2,x:0,y:0},y=new d.I(f,c);this.patterns[e]={bin:f,position:y}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new bi(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const y in this.patterns)e.push(this.patterns[y].bin);const{w:n,h:c}=d.p(e),f=this.atlasImage;f.resize({width:n||1,height:c||1});for(const y in this.patterns){const{bin:T}=this.patterns[y],A=T.x+1,I=T.y+1,L=this.getImage(y).data,k=L.width,F=L.height;d.R.copy(L,f,{x:0,y:0},{x:A,y:I},{width:k,height:F}),d.R.copy(L,f,{x:0,y:F-1},{x:A,y:I-1},{width:k,height:1}),d.R.copy(L,f,{x:0,y:0},{x:A,y:I+F},{width:k,height:1}),d.R.copy(L,f,{x:k-1,y:0},{x:A-1,y:I},{width:1,height:F}),d.R.copy(L,f,{x:0,y:0},{x:A+k,y:I},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const n of e){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const c=this.getImage(n);c||d.w(`Image with ID: "${n}" was not found`),nr(c)&&this.updateImage(n,c)}}}const mn=1e20;function ia(g,e,n,c,f,y,T,A,I){for(let L=e;L<e+c;L++)sn(g,n*y+L,y,f,T,A,I);for(let L=n;L<n+f;L++)sn(g,L*y+e,1,c,T,A,I)}function sn(g,e,n,c,f,y,T){y[0]=0,T[0]=-1e20,T[1]=mn,f[0]=g[e];for(let A=1,I=0,L=0;A<c;A++){f[A]=g[e+A*n];const k=A*A;do{const F=y[I];L=(f[A]-f[F]+k-F*F)/(A-F)/2}while(L<=T[I]&&--I>-1);I++,y[I]=A,T[I]=L,T[I+1]=mn}for(let A=0,I=0;A<c;A++){for(;T[I+1]<A;)I++;const L=y[I],k=A-L;g[e+A*n]=f[L]+k*k}}class xa{constructor(e,n){this.requestManager=e,this.localIdeographFontFamily=n,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return d._(this,void 0,void 0,function*(){const n=[];for(const y in e)for(const T of e[y])n.push(this._getAndCacheGlyphsPromise(y,T));const c=yield Promise.all(n),f={};for(const{stack:y,id:T,glyph:A}of c)f[y]||(f[y]={}),f[y][T]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics};return f})}_getAndCacheGlyphsPromise(e,n){return d._(this,void 0,void 0,function*(){let c=this.entries[e];c||(c=this.entries[e]={glyphs:{},requests:{},ranges:{}});let f=c.glyphs[n];if(f!==void 0)return{stack:e,id:n,glyph:f};if(f=this._tinySDF(c,e,n),f)return c.glyphs[n]=f,{stack:e,id:n,glyph:f};const y=Math.floor(n/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[y])return{stack:e,id:n,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[y]){const A=xa.loadGlyphRange(e,y,this.url,this.requestManager);c.requests[y]=A}const T=yield c.requests[y];for(const A in T)this._doesCharSupportLocalGlyph(+A)||(c.glyphs[+A]=T[+A]);return c.ranges[y]=!0,{stack:e,id:n,glyph:T[n]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||d.u["CJK Unified Ideographs"](e)||d.u["Hangul Syllables"](e)||d.u.Hiragana(e)||d.u.Katakana(e)||d.u["CJK Symbols and Punctuation"](e)||d.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,n,c){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let y=e.tinySDF;if(!y){let A="400";/bold/i.test(n)?A="900":/medium/i.test(n)?A="500":/light/i.test(n)&&(A="200"),y=e.tinySDF=new xa.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:A})}const T=y.draw(String.fromCharCode(c));return{id:c,bitmap:new d.q({width:T.width||60,height:T.height||60},T.data),metrics:{width:T.glyphWidth/2||24,height:T.glyphHeight/2||24,left:T.glyphLeft/2+.5||0,top:T.glyphTop/2-27.5||-8,advance:T.glyphAdvance/2||24,isDoubleResolution:!0}}}}xa.loadGlyphRange=function(g,e,n,c){return d._(this,void 0,void 0,function*(){const f=256*e,y=f+255,T=c.transformRequest(n.replace("{fontstack}",g).replace("{range}",`${f}-${y}`),"Glyphs"),A=yield d.n(T,new AbortController);if(!A||!A.data)throw new Error(`Could not load glyph range. range: ${e}, ${f}-${y}`);const I={};for(const L of d.o(A.data))I[L.id]=L;return I})},xa.TinySDF=class{constructor({fontSize:g=24,buffer:e=3,radius:n=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:y="normal",fontStyle:T="normal"}={}){this.buffer=e,this.cutoff=c,this.radius=n;const A=this.size=g+4*e,I=this._createCanvas(A),L=this.ctx=I.getContext("2d",{willReadFrequently:!0});L.font=`${T} ${y} ${g}px ${f}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(g){const e=document.createElement("canvas");return e.width=e.height=g,e}draw(g){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:y}=this.ctx.measureText(g),T=Math.ceil(n),A=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-f))),I=Math.min(this.size-this.buffer,T+Math.ceil(c)),L=A+2*this.buffer,k=I+2*this.buffer,F=Math.max(L*k,0),z=new Uint8ClampedArray(F),G={data:z,width:L,height:k,glyphWidth:A,glyphHeight:I,glyphTop:T,glyphLeft:0,glyphAdvance:e};if(A===0||I===0)return G;const{ctx:Z,buffer:ne,gridInner:ae,gridOuter:re}=this;Z.clearRect(ne,ne,A,I),Z.fillText(g,ne,ne+T);const le=Z.getImageData(ne,ne,A,I);re.fill(mn,0,F),ae.fill(0,0,F);for(let me=0;me<I;me++)for(let pe=0;pe<A;pe++){const ye=le.data[4*(me*A+pe)+3]/255;if(ye===0)continue;const Ee=(me+ne)*L+pe+ne;if(ye===1)re[Ee]=0,ae[Ee]=mn;else{const be=.5-ye;re[Ee]=be>0?be*be:0,ae[Ee]=be<0?be*be:0}}ia(re,0,0,L,k,L,this.f,this.v,this.z),ia(ae,ne,ne,A,I,L,this.f,this.v,this.z);for(let me=0;me<F;me++){const pe=Math.sqrt(re[me])-Math.sqrt(ae[me]);z[me]=Math.round(255-255*(pe/this.radius+this.cutoff))}return G}};class Fa{constructor(){this.specification=d.v.light.position}possiblyEvaluate(e,n){return d.z(e.expression.evaluate(n))}interpolate(e,n,c){return{x:d.B.number(e.x,n.x,c),y:d.B.number(e.y,n.y,c),z:d.B.number(e.z,n.z,c)}}}let Je;class wt extends d.E{constructor(e){super(),Je=Je||new d.r({anchor:new d.D(d.v.light.anchor),position:new Fa,color:new d.D(d.v.light.color),intensity:new d.D(d.v.light.intensity)}),this._transitionable=new d.T(Je),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(d.t,e,n))for(const c in e){const f=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,c){return(!c||c.validate!==!1)&&d.x(this,e.call(d.y,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:d.v}))}}const bt=new d.r({"sky-color":new d.D(d.v.sky["sky-color"]),"horizon-color":new d.D(d.v.sky["horizon-color"]),"fog-color":new d.D(d.v.sky["fog-color"]),"fog-ground-blend":new d.D(d.v.sky["fog-ground-blend"]),"horizon-fog-blend":new d.D(d.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new d.D(d.v.sky["sky-horizon-blend"]),"atmosphere-blend":new d.D(d.v.sky["atmosphere-blend"])});class xi extends d.E{constructor(e){super(),this._transitionable=new d.T(bt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new d.C(0))}setSky(e,n={}){if(!this._validate(d.F,e,n)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in e){const f=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,c={}){return(c==null?void 0:c.validate)!==!1&&d.x(this,e.call(d.y,d.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:d.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Te{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,n){const c=e.join(",")+String(n);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(e,n)),this.dashEntry[c]}getDashRanges(e,n,c){const f=[];let y=e.length%2==1?-e[e.length-1]*c:0,T=e[0]*c,A=!0;f.push({left:y,right:T,isDash:A,zeroLength:e[0]===0});let I=e[0];for(let L=1;L<e.length;L++){A=!A;const k=e[L];y=I*c,I+=k,T=I*c,f.push({left:y,right:T,isDash:A,zeroLength:k===0})}return f}addRoundDash(e,n,c){const f=n/2;for(let y=-c;y<=c;y++){const T=this.width*(this.nextRow+c+y);let A=0,I=e[A];for(let L=0;L<this.width;L++){L/I.right>1&&(I=e[++A]);const k=Math.abs(L-I.left),F=Math.abs(L-I.right),z=Math.min(k,F);let G;const Z=y/c*(f+1);if(I.isDash){const ne=f-Math.abs(Z);G=Math.sqrt(z*z+ne*ne)}else G=f-Math.sqrt(z*z+Z*Z);this.data[T+L]=Math.max(0,Math.min(255,G+128))}}}addRegularDash(e){for(let A=e.length-1;A>=0;--A){const I=e[A],L=e[A+1];I.zeroLength?e.splice(A,1):L&&L.isDash===I.isDash&&(L.left=I.left,e.splice(A,1))}const n=e[0],c=e[e.length-1];n.isDash===c.isDash&&(n.left=c.left-this.width,c.right=n.right+this.width);const f=this.width*this.nextRow;let y=0,T=e[y];for(let A=0;A<this.width;A++){A/T.right>1&&(T=e[++y]);const I=Math.abs(A-T.left),L=Math.abs(A-T.right),k=Math.min(I,L);this.data[f+A]=Math.max(0,Math.min(255,(T.isDash?k:-k)+128))}}addDash(e,n){const c=n?7:0,f=2*c+1;if(this.nextRow+f>this.height)return d.w("LineAtlas out of space"),null;let y=0;for(let A=0;A<e.length;A++)y+=e[A];if(y!==0){const A=this.width/y,I=this.getDashRanges(e,this.width,A);n?this.addRoundDash(I,A,c):this.addRegularDash(I)}const T={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:y};return this.nextRow+=f,this.dirty=!0,T}bind(e){const n=e.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,this.data))}}const ut="maplibre_preloaded_worker_pool";class xt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<xt.workerCount;)this.workers.push(new Worker(d.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ut]}numActive(){return Object.keys(this.active).length}}const At=Math.floor(Me.hardwareConcurrency/2);let Ot,Xt;function Vt(){return Ot||(Ot=new xt),Ot}xt.workerCount=d.G(globalThis)?Math.max(Math.min(At,3),1):1;class aa{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=n;const c=this.workerPool.acquire(n);for(let f=0;f<c.length;f++){const y=new d.H(c[f],n);y.name=`Worker ${f}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,n){const c=[];for(const f of this.actors)c.push(f.sendAsync({type:e,data:n}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(n=>{n.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,n){for(const c of this.actors)c.registerMessageHandler(e,n)}}function Ni(){return Xt||(Xt=new aa(Vt(),d.J),Xt.registerMessageHandler("GR",(g,e,n)=>d.m(e,n))),Xt}function qn(g,e){const n=d.K();return d.L(n,n,[1,1,0]),d.M(n,n,[.5*g.width,.5*g.height,1]),g.calculatePosMatrix?d.N(n,n,g.calculatePosMatrix(e.toUnwrapped())):n}function Bo(g,e,n,c,f,y,T){var A;const I=function(z,G,Z){if(z)for(const ne of z){const ae=G[ne];if(ae&&ae.source===Z&&ae.type==="fill-extrusion")return!0}else for(const ne in G){const ae=G[ne];if(ae.source===Z&&ae.type==="fill-extrusion")return!0}return!1}((A=f==null?void 0:f.layers)!==null&&A!==void 0?A:null,e,g.id),L=y.maxPitchScaleFactor(),k=g.tilesIn(c,L,I);k.sort(gn);const F=[];for(const z of k)F.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(e,n,g._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,f,y,L,qn(g.transform,z.tileID),T?(G,Z)=>T(z.tileID,G,Z):void 0)});return function(z,G){for(const Z in z)for(const ne of z[Z])Rn(ne,G);return z}(function(z){const G={},Z={};for(const ne of z){const ae=ne.queryResults,re=ne.wrappedTileID,le=Z[re]=Z[re]||{};for(const me in ae){const pe=ae[me],ye=le[me]=le[me]||{},Ee=G[me]=G[me]||[];for(const be of pe)ye[be.featureIndex]||(ye[be.featureIndex]=!0,Ee.push(be))}}return G}(F),g)}function gn(g,e){const n=g.tileID,c=e.tileID;return n.overscaledZ-c.overscaledZ||n.canonical.y-c.canonical.y||n.wrap-c.wrap||n.canonical.x-c.canonical.x}function Rn(g,e){const n=g.feature,c=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=c}function on(g,e,n){return d._(this,void 0,void 0,function*(){let c=g;if(g.url?c=(yield d.j(e.transformRequest(g.url,"Source"),n)).data:yield Me.frameAsync(n),!c)return null;const f=d.O(d.e(c,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(f.vectorLayerIds=c.vector_layers.map(y=>y.id)),f})}class Oi{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof d.Q?new d.Q(e.lng,e.lat):d.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof d.Q?new d.Q(e.lng,e.lat):d.Q.convert(e),this}extend(e){const n=this._sw,c=this._ne;let f,y;if(e instanceof d.Q)f=e,y=e;else{if(!(e instanceof Oi))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Oi.convert(e)):this.extend(d.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(d.Q.convert(e)):this;if(f=e._sw,y=e._ne,!f||!y)return this}return n||c?(n.lng=Math.min(f.lng,n.lng),n.lat=Math.min(f.lat,n.lat),c.lng=Math.max(y.lng,c.lng),c.lat=Math.max(y.lat,c.lat)):(this._sw=new d.Q(f.lng,f.lat),this._ne=new d.Q(y.lng,y.lat)),this}getCenter(){return new d.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new d.Q(this.getWest(),this.getNorth())}getSouthEast(){return new d.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:c}=d.Q.convert(e);let f=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(e){return e instanceof Oi?e:e&&new Oi(e)}static fromLngLat(e,n=0){const c=360*n/40075017,f=c/Math.cos(Math.PI/180*e.lat);return new Oi(new d.Q(e.lng-f,e.lat-c),new d.Q(e.lng+f,e.lat+c))}adjustAntiMeridian(){const e=new d.Q(this._sw.lng,this._sw.lat),n=new d.Q(this._ne.lng,this._ne.lat);return new Oi(e,e.lng>n.lng?new d.Q(n.lng+360,n.lat):n)}}class Jr{constructor(e,n,c){this.bounds=Oi.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=c||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),c=Math.floor(d.U(this.bounds.getWest())*n),f=Math.floor(d.S(this.bounds.getNorth())*n),y=Math.ceil(d.U(this.bounds.getEast())*n),T=Math.ceil(d.S(this.bounds.getSouth())*n);return e.x>=c&&e.x<y&&e.y>=f&&e.y<T}}class ro extends d.E{constructor(e,n,c,f){if(super(),this.id=e,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.e(this,d.O(n,["url","scheme","tileSize","promoteId"])),this._options=d.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield on(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(d.e(this,e),e.bounds&&(this.tileBounds=new Jr(e.bounds,this.minzoom,this.maxzoom)),this.fire(new d.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new d.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return d.e({},this._options)}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(n,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};c.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((y,T)=>{e.reloadPromise={resolve:y,reject:T}})}else e.actor=this.dispatcher.getActor(),f="LT";e.abortController=new AbortController;try{const y=yield e.actor.sendAsync({type:f,data:c},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,y)}catch(y){if(delete e.abortController,e.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,n){if(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),n&&this.map._refreshExpiredTiles&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),e.reloadPromise){const c=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(c.resolve).catch(c.reject)}}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ra extends d.E{constructor(e,n,c,f){super(),this.id=e,this.dispatcher=c,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.e({type:"raster"},n),d.e(this,d.O(n,["url","scheme","tileSize"]))}load(){return d._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new d.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield on(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(d.e(this,n),n.bounds&&(this.tileBounds=new Jr(n.bounds,this.minzoom,this.maxzoom)),this.fire(new d.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(n){this._tileJSONRequest=null,this.fire(new d.k(n))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return d.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const c=yield Mt.getImage(this.map._requestManager.transformRequest(n,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&(c.cacheControl||c.expires)&&e.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const f=this.map.painter.context,y=f.gl,T=c.data;e.texture=this.map.painter.getTileTexture(T.width),e.texture?e.texture.update(T,{useMipmap:!0}):(e.texture=new bi(f,T,y.RGBA,{useMipmap:!0}),e.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(c){if(delete e.abortController,e.aborted)e.state="unloaded";else if(c)throw e.state="errored",c}})}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class Sl extends Ra{constructor(e,n,c,f){super(e,n,c,f),this.type="raster-dem",this.maxzoom=22,this._options=d.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(n,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const f=yield Mt.getImage(c,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(f&&f.data){const y=f.data;this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&e.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const T=d.b(y)&&d.V()?y:yield this.readImageNow(y),A={type:this.type,uid:e.uid,source:this.id,rawImageData:T,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const I=yield e.actor.sendAsync({type:"LDT",data:A});e.dem=I,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(f){if(delete e.abortController,e.aborted)e.state="unloaded";else if(f)throw e.state="errored",f}})}readImageNow(e){return d._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&d.W()){const n=e.width+2,c=e.height+2;try{return new d.R({width:n,height:c},yield d.X(e,-1,-1,n,c))}catch{}}return Me.getImageData(e,1)})}_getNeighboringTiles(e){const n=e.canonical,c=Math.pow(2,n.z),f=(n.x-1+c)%c,y=n.x===0?e.wrap-1:e.wrap,T=(n.x+1+c)%c,A=n.x+1===c?e.wrap+1:e.wrap,I={};return I[new d.Y(e.overscaledZ,y,n.z,f,n.y).key]={backfilled:!1},I[new d.Y(e.overscaledZ,A,n.z,T,n.y).key]={backfilled:!1},n.y>0&&(I[new d.Y(e.overscaledZ,y,n.z,f,n.y-1).key]={backfilled:!1},I[new d.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},I[new d.Y(e.overscaledZ,A,n.z,T,n.y-1).key]={backfilled:!1}),n.y+1<c&&(I[new d.Y(e.overscaledZ,y,n.z,f,n.y+1).key]={backfilled:!1},I[new d.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},I[new d.Y(e.overscaledZ,A,n.z,T,n.y+1).key]={backfilled:!1}),I}unloadTile(e){return d._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Du extends d.E{constructor(e,n,c,f){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(f),this._data=n.data,this._options=d.e({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId,n.clusterMaxZoom!==void 0&&this.maxzoom<=n.clusterMaxZoom&&d.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${n.clusterMaxZoom}".`),this.workerOptions=d.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(n.buffer!==void 0?n.buffer:128),tolerance:this._pixelsToTileUnits(n.tolerance!==void 0?n.tolerance:.375),extent:d.Z,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:d.Z,radius:this._pixelsToTileUnits(n.clusterRadius||50),log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(d.Z/this.tileSize)}load(){return d._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return d._(this,void 0,void 0,function*(){const e=d.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(n=>n.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return d._(this,void 0,void 0,function*(){const e=new Oi,n=yield this.getData();let c;switch(n.type){case"FeatureCollection":c=n.features.map(f=>this.getCoordinatesFromGeometry(f.geometry)).flat(1/0);break;case"Feature":c=this.getCoordinatesFromGeometry(n.geometry);break;default:c=this.getCoordinatesFromGeometry(n)}if(c.length==0)return e;for(let f=0;f<c.length-1;f+=2)e.extend([c[f],c[f+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,n,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:n,offset:c}})}_updateWorkerData(e){return d._(this,void 0,void 0,function*(){const n=d.e({type:this.type},this.workerOptions);e?n.dataDiff=e:typeof this._data=="string"?(n.request=this.map._requestManager.transformRequest(Me.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new d.l("dataloading",{dataType:"source"}));try{const c=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||c.abandoned)return void this.fire(new d.l("dataabort",{dataType:"source"}));let f=null;c.resourceTiming&&c.resourceTiming[this.id]&&(f=c.resourceTiming[this.id].slice(0));const y={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&d.e(y,{resourceTiming:f}),this.fire(new d.l("data",Object.assign(Object.assign({},y),{sourceDataType:"metadata"}))),this.fire(new d.l("data",Object.assign(Object.assign({},y),{sourceDataType:"content"})))}catch(c){if(this._pendingLoads--,this._removed)return void this.fire(new d.l("dataabort",{dataType:"source"}));this.fire(new d.k(c))}})}loaded(){return this._pendingLoads===0}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.actor?"RT":"LT";e.actor=this.actor;const c={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const f=yield this.actor.sendAsync({type:n,data:c},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(f,this.map.painter,n==="RT")})}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return d.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Vn extends d.E{constructor(e,n,c,f){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=c,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=n}load(e){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const n=yield Mt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,n&&n.data&&(this.image=n.data,e&&(this.coordinates=e),this._finishLoading())}catch(n){this._request=null,this._loaded=!0,this.fire(new d.k(n))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const n=e.map(d.$.fromLngLat);var c;return this.tileID=function(f){let y=1/0,T=1/0,A=-1/0,I=-1/0;for(const z of f)y=Math.min(y,z.x),T=Math.min(T,z.y),A=Math.max(A,z.x),I=Math.max(I,z.y);const L=Math.max(A-y,I-T),k=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),F=Math.pow(2,k);return new d.a1(k,Math.floor((y+A)/2*F),Math.floor((T+I)/2*F))}(n),this.terrainTileRanges=this._getOverlappingTileRanges(n),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=n.map(f=>this.tileID.getTilePoint(f)._round()),this.flippedWindingOrder=((c=this.tileCoords)[1].x-c[0].x)*(c[2].y-c[0].y)-(c[1].y-c[0].y)*(c[2].x-c[0].x)<0,this.fire(new d.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,n=e.gl;this.texture||(this.texture=new bi(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,c=!0)}c&&this.fire(new d.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return d._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){let n=1/0,c=1/0,f=-1/0,y=-1/0;for(const A of e)n=Math.min(n,A.x),c=Math.min(c,A.y),f=Math.max(f,A.x),y=Math.max(y,A.y);const T={};for(let A=0;A<=d.a0;A++){const I=Math.pow(2,A),L=Math.floor(n*I),k=Math.floor(c*I),F=Math.floor(f*I),z=Math.floor(y*I);T[A]={minTileX:L,minTileY:k,maxTileX:F,maxTileY:z}}return T}}class rr extends Vn{constructor(e,n,c,f){super(e,n,c,f),this.roundZoom=!0,this.type="video",this.options=n}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,"Source").url);try{const n=yield d.a2(this.urls);if(this._loaded=!0,!n)return;this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(n){this.fire(new d.k(n))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new d.k(new d.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new bi(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,c=!0)}c&&this.fire(new d.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class zo extends Vn{constructor(e,n,c,f){super(e,n,c,f),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(T=>typeof T!="number"))||this.fire(new d.k(new d.a3(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.k(new d.a3(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new d.k(new d.a3(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new d.k(new d.a3(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.k(new d.a3(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){return d._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context,c=n.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new bi(n,this.canvas,c.RGBA,{premultiply:!0});let f=!1;for(const y in this.tiles){const T=this.tiles[y];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,f=!0)}f&&this.fire(new d.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const so={},Is=g=>{switch(g){case"geojson":return Du;case"image":return Vn;case"raster":return Ra;case"raster-dem":return Sl;case"vector":return ro;case"video":return rr;case"canvas":return zo}return so[g]},Ru="RTLPluginLoaded";class es extends d.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ni()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(n=>{throw this.status="error",n})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return d._(this,arguments,void 0,function*(n,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=Me.resolveURL(n),!this.url)throw new Error(`requested url ${n} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return d._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new d.l(Ru))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ka=null;function _n(){return Ka||(Ka=new es),Ka}class Pa{constructor(e,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=d.a4(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const n=e+this.timeAdded;n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,n,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(f,y){const T={};if(!y)return T;for(const A of f){const I=A.layerIds.map(L=>y.getLayer(L)).filter(Boolean);if(I.length!==0){A.layers=I,A.stateDependentLayerIds&&(A.stateDependentLayers=A.stateDependentLayerIds.map(L=>I.filter(k=>k.id===L)[0]));for(const L of I)T[L.id]=A}}return T}(e.buckets,n==null?void 0:n.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const y=this.buckets[f];if(y instanceof d.a6){if(this.hasSymbolBuckets=!0,!c)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const y=this.buckets[f];if(y instanceof d.a6&&y.hasRTLText){this.hasRTLText=!0,_n().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const y=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(f).queryRadius(y))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new d.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new bi(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new bi(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,c,f,y,T,A,I,L,k,F){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:y,scale:T,tileSize:this.tileSize,pixelPosMatrix:k,transform:I,params:A,queryPadding:this.queryPadding*L,getElevation:F},e,n,c):{}}querySourceFeatures(e,n){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),y=n&&n.sourceLayer?n.sourceLayer:"",T=f._geojsonTileLayer||f[y];if(!T)return;const A=d.a7(n&&n.filter),{z:I,x:L,y:k}=this.tileID.canonical,F={z:I,x:L,y:k};for(let z=0;z<T.length;z++){const G=T.feature(z);if(A.needGeometry){const ae=d.a8(G,!0);if(!A.filter(new d.C(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!A.filter(new d.C(this.tileID.overscaledZ),G))continue;const Z=c.getId(G,y),ne=new d.a9(G,I,L,k,Z);ne.tile=F,e.push(ne)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const c=d.aa(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(n)if(this.expirationTime<n)f=!0;else{const y=this.expirationTime-n;y?this.expirationTime=c+Math.max(y,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!n.style.hasLayer(f))continue;const y=this.buckets[f],T=y.layers[0].sourceLayer||"_geojsonTileLayer",A=c[T],I=e[T];if(!A||!I||Object.keys(I).length===0)continue;y.update(I,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});const L=n&&n.style&&n.style.getLayer(f);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Me.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Me.now()+e}setDependencies(e,n){const c={};for(const f of n)c[f]=!0;this.dependencies[e]=c}hasDependency(e,n){for(const c of e){const f=this.dependencies[c];if(f){for(const y of n)if(f[y])return!0}}return!1}}class oo{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,c){const f=e.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const y={value:n,timeout:void 0};if(c!==void 0&&(y.timeout=setTimeout(()=>{this.remove(e,y)},c)),this.data[f].push(y),this.order.push(f),this.order.length>this.max){const T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const c=e.wrapped().key,f=n===void 0?0:this.data[c].indexOf(n),y=this.data[c][f];return this.data[c].splice(f,1),y.timeout&&clearTimeout(y.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(y.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const c in this.data)for(const f of this.data[c])e(f.value)||n.push(f);for(const c of n)this.remove(c.value.tileID,c)}}class Pu{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,c){const f=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},d.e(this.stateChanges[e][f],c),this.deletedStates[e]===null){this.deletedStates[e]={};for(const y in this.state[e])y!==f&&(this.deletedStates[e][y]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][f]===null){this.deletedStates[e][f]={};for(const y in this.state[e][f])c[y]||(this.deletedStates[e][f][y]=null)}else for(const y in c)this.deletedStates[e]&&this.deletedStates[e][f]&&this.deletedStates[e][f][y]===null&&delete this.deletedStates[e][f][y]}removeFeatureState(e,n,c){if(this.deletedStates[e]===null)return;const f=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&n!==void 0)this.deletedStates[e][f]!==null&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][c]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][f])for(c in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][c]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}getState(e,n){const c=String(n),f=d.e({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const y=this.deletedStates[e][n];if(y===null)return{};for(const T in y)delete f[T]}return f}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const y={};for(const T in this.stateChanges[f])this.state[f][T]||(this.state[f][T]={}),d.e(this.state[f][T],this.stateChanges[f][T]),y[T]=this.state[f][T];c[f]=y}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const y={};if(this.deletedStates[f]===null)for(const T in this.state[f])y[T]={},this.state[f][T]={};else for(const T in this.deletedStates[f]){if(this.deletedStates[f][T]===null)this.state[f][T]={};else for(const A of Object.keys(this.deletedStates[f][T]))delete this.state[f][T][A];y[T]=this.state[f][T]}c[f]=c[f]||{},d.e(c[f],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in e)e[f].setFeatureState(c,n)}}const wr=89.25;function un(g,e){const n=d.ae(e.lat,-85.051129,d.af);return new d.P(d.U(e.lng)*g,d.S(n)*g)}function sr(g,e){return new d.$(e.x/g,e.y/g).toLngLat()}function Ce(g){return g.cameraToCenterDistance*Math.min(.85*Math.tan(d.ab(90-g.pitch)),Math.tan(d.ab(wr-g.pitch)))}function $(g,e){const n=g.canonical,c=e/d.ac(n.z),f=n.x+Math.pow(2,n.z)*g.wrap,y=d.ad(new Float64Array(16));return d.L(y,y,[f*c,n.y*c,0]),d.M(y,y,[c/d.Z,c/d.Z,1]),y}function X(g,e,n,c,f){const y=d.$.fromLngLat(g,e),T=f*d.ag(1,g.lat),A=T*Math.cos(d.ab(n)),I=Math.sqrt(T*T-A*A),L=I*Math.sin(d.ab(-c)),k=I*Math.cos(d.ab(-c));return new d.$(y.x+L,y.y+k,y.z+A)}function ie(g,e,n){const c=e.intersectsFrustum(g);if(!n)return c;const f=e.intersectsPlane(n);return c===0||f===0?0:c===2&&f===2?2:1}function he(g,e,n){let c=0;const f=(n-e)/10;for(let y=0;y<10;y++)c+=f*Math.pow(Math.cos(e+(y+.5)/10*(n-e)),g);return c}function ve(g,e){return function(n,c,f,y,T){const A=2*((g-1)/d.ah(Math.cos(d.ab(wr-T))/Math.cos(d.ab(wr)))-1),I=Math.acos(f/y),L=2*he(A-1,0,d.ab(T/2)),k=Math.min(d.ab(wr),I+d.ab(T/2)),F=he(A-1,Math.min(k,I-d.ab(T/2)),k),z=Math.atan(c/f),G=Math.hypot(c,f);let Z=n;return Z+=d.ah(y/G/Math.max(.5,Math.cos(d.ab(T/2)))),Z+=A*d.ah(Math.cos(z))/2,Z-=d.ah(Math.max(1,F/L/e))/2,Z}}const te=ve(9.314,3);function Le(g,e){const n=(e.roundZoom?Math.round:Math.floor)(g.zoom+d.ah(g.tileSize/e.tileSize));return Math.max(0,n)}function Ae(g,e){const n=g.getCameraFrustum(),c=g.getClippingPlane(),f=g.screenPointToMercatorCoordinate(g.getCameraPoint()),y=d.$.fromLngLat(g.center,g.elevation);f.z=y.z+Math.cos(g.pitchInRadians)*g.cameraToCenterDistance/g.worldSize;const T=g.getCoveringTilesDetailsProvider(),A=T.allowVariableZoom(g,e),I=Le(g,e),L=e.minzoom||0,k=e.maxzoom!==void 0?e.maxzoom:g.maxZoom,F=Math.min(Math.max(0,I),k),z=Math.pow(2,F),G=[z*f.x,z*f.y,0],Z=[z*y.x,z*y.y,0],ne=Math.hypot(y.x-f.x,y.y-f.y),ae=Math.abs(y.z-f.z),re=Math.hypot(ne,ae),le=ye=>({zoom:0,x:0,y:0,wrap:ye,fullyVisible:!1}),me=[],pe=[];if(g.renderWorldCopies&&T.allowWorldCopies())for(let ye=1;ye<=3;ye++)me.push(le(-ye)),me.push(le(ye));for(me.push(le(0));me.length>0;){const ye=me.pop(),Ee=ye.x,be=ye.y;let Ne=ye.fullyVisible;const $e={x:Ee,y:be,z:ye.zoom},je=T.getTileAABB($e,ye.wrap,g.elevation,e);if(!Ne){const ht=ie(n,je,c);if(ht===0)continue;Ne=ht===2}const He=T.distanceToTile2d(f.x,f.y,$e,je);let Ge=I;A&&(Ge=(e.calculateTileZoom||te)(g.zoom+d.ah(g.tileSize/e.tileSize),He,ae,re,g.fov)),Ge=(e.roundZoom?Math.round:Math.floor)(Ge),Ge=Math.max(0,Ge);const ft=Math.min(Ge,k);if(ye.wrap=T.getWrap(y,$e,ye.wrap),ye.zoom>=ft){if(ye.zoom<L)continue;const ht=F-ye.zoom,it=G[0]-.5-(Ee<<ht),St=G[1]-.5-(be<<ht),ii=e.reparseOverscaled?Math.max(ye.zoom,Ge):ye.zoom;pe.push({tileID:new d.Y(ye.zoom===k?ii:ye.zoom,ye.wrap,ye.zoom,Ee,be),distanceSq:d.ai([Z[0]-.5-Ee,Z[1]-.5-be]),tileDistanceToCamera:Math.sqrt(it*it+St*St)})}else for(let ht=0;ht<4;ht++)me.push({zoom:ye.zoom+1,x:(Ee<<1)+ht%2,y:(be<<1)+(ht>>1),wrap:ye.wrap,fullyVisible:Ne})}return pe.sort((ye,Ee)=>ye.distanceSq-Ee.distanceSq).map(ye=>ye.tileID)}class Re extends d.E{constructor(e,n,c){super(),this.id=e,this.dispatcher=c,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,y,T,A)=>{const I=new(Is(y.type))(f,y,T,A);if(I.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${I.id}`);return I})(e,n,c,this),this._tiles={},this._cache=new oo(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Pu,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,n,c){return d._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,n,c)}catch(f){e.state="errored",f.status!==404?this._source.fire(new d.k(f,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new d.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const c=this._tiles[n];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Fe).map(e=>e.key)}getRenderableIds(e){const n=[];for(const c in this._tiles)this._isIdRenderable(c,e)&&n.push(this._tiles[c]);return e?n.sort((c,f)=>{const y=c.tileID,T=f.tileID,A=new d.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians),I=new d.P(T.canonical.x,T.canonical.y)._rotate(-this.transform.bearingInRadians);return y.overscaledZ-T.overscaledZ||I.y-A.y||I.x-A.x}).map(c=>c.tileID.key):n.map(c=>c.tileID).sort(Fe).map(c=>c.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)(e||this._tiles[n].state!=="errored")&&this._reloadTile(n,"reloading")}}_reloadTile(e,n){return d._(this,void 0,void 0,function*(){const c=this._tiles[e];c&&(c.state!=="loading"&&(c.state=n),yield this._loadTile(c,e,n))})}_tileLoaded(e,n,c){e.timeAdded=Me.now(),c==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new d.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const n=this.getRenderableIds();for(let f=0;f<n.length;f++){const y=n[f];if(e.neighboringTiles&&e.neighboringTiles[y]){const T=this.getTileByID(y);c(e,T),c(T,e)}}function c(f,y){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let T=y.tileID.canonical.x-f.tileID.canonical.x;const A=y.tileID.canonical.y-f.tileID.canonical.y,I=Math.pow(2,f.tileID.canonical.z),L=y.tileID.key;T===0&&A===0||Math.abs(A)>1||(Math.abs(T)>1&&(Math.abs(T+I)===1?T+=I:Math.abs(T-I)===1&&(T-=I)),y.dem&&f.dem&&(f.dem.backfillBorder(y.dem,T,A),f.neighboringTiles&&f.neighboringTiles[L]&&(f.neighboringTiles[L].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,c,f){for(const y in this._tiles){let T=this._tiles[y];if(f[y]||!T.hasData()||T.tileID.overscaledZ<=n||T.tileID.overscaledZ>c)continue;let A=T.tileID;for(;T&&T.tileID.overscaledZ>n+1;){const L=T.tileID.scaledTo(T.tileID.overscaledZ-1);T=this._tiles[L.key],T&&T.hasData()&&(A=L)}let I=A;for(;I.overscaledZ>n;)if(I=I.scaledTo(I.overscaledZ-1),e[I.key]||e[I.canonical.key]){f[A.key]=A;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const c=this._loadedParentTiles[e.key];return c&&c.tileID.overscaledZ>=n?c:null}for(let c=e.overscaledZ-1;c>=n;c--){const f=e.scaledTo(c),y=this._getLoadedTile(f);if(y)return y}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const n=Math.ceil(e.width/this._source.tileSize)+1,c=Math.ceil(e.height/this._source.tileSize)+1,f=Math.floor(n*c*(this._maxTileCacheZoomLevels===null?d.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(y)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const c={};for(const f in this._tiles){const y=this._tiles[f];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+n),c[y.tileID.key]=y}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(e,n,c,f,y,T){const A={},I={},L=Object.keys(e),k=Me.now();for(const F of L){const z=e[F],G=this._tiles[F];if(!G||G.fadeEndTime!==0&&G.fadeEndTime<=k)continue;const Z=this.findLoadedParent(z,n),ne=this.findLoadedSibling(z),ae=Z||ne||null;ae&&(this._addTile(ae.tileID),A[ae.tileID.key]=ae.tileID),I[F]=z}this._retainLoadedChildren(I,f,c,e);for(const F in A)e[F]||(this._coveredTiles[F]=!0,e[F]=A[F]);if(T){const F={},z={};for(const G of y)this._tiles[G.key].hasData()?F[G.key]=G:z[G.key]=G;for(const G in z){const Z=z[G].children(this._source.maxzoom);this._tiles[Z[0].key]&&this._tiles[Z[1].key]&&this._tiles[Z[2].key]&&this._tiles[Z[3].key]&&(F[Z[0].key]=e[Z[0].key]=Z[0],F[Z[1].key]=e[Z[1].key]=Z[1],F[Z[2].key]=e[Z[2].key]=Z[2],F[Z[3].key]=e[Z[3].key]=Z[3],delete z[G])}for(const G in z){const Z=z[G],ne=this.findLoadedParent(Z,this._source.minzoom),ae=this.findLoadedSibling(Z),re=ne||ae||null;if(re){F[re.tileID.key]=e[re.tileID.key]=re.tileID;for(const le in F)F[le].isChildOf(re.tileID)&&delete F[le]}}for(const G in this._tiles)F[G]||(this._coveredTiles[G]=!0)}}update(e,n){if(!this._sourceLoaded||this._paused)return;let c;this.transform=e,this.terrain=n,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new d.Y(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(c=Ae(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(c=c.filter(k=>this._source.hasTile(k)))):c=[];const f=Le(e,this._source),y=Math.max(f-Re.maxOverzooming,this._source.minzoom),T=Math.max(f+Re.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const k={};for(const F of c)if(F.canonical.z>this._source.minzoom){const z=F.scaledTo(F.canonical.z-1);k[z.key]=z;const G=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));k[G.key]=G}c=c.concat(Object.values(k))}const A=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,A&&this.fire(new d.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const I=this._updateRetainedTiles(c,f);Ie(this._source.type)&&this._updateCoveredAndRetainedTiles(I,y,T,f,c,n);for(const k in I)this._tiles[k].clearFadeHold();const L=d.aj(this._tiles,I);for(const k of L){const F=this._tiles[k];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,n){var c;const f={},y={},T=Math.max(n-Re.maxOverzooming,this._source.minzoom),A=Math.max(n+Re.maxUnderzooming,this._source.minzoom),I={};for(const L of e){const k=this._addTile(L);f[L.key]=L,k.hasData()||n<this._source.maxzoom&&(I[L.key]=L)}this._retainLoadedChildren(I,n,A,f);for(const L of e){let k=this._tiles[L.key];if(k.hasData())continue;if(n+1>this._source.maxzoom){const z=L.children(this._source.maxzoom)[0],G=this.getTile(z);if(G&&G.hasData()){f[z.key]=z;continue}}else{const z=L.children(this._source.maxzoom);if(f[z[0].key]&&f[z[1].key]&&f[z[2].key]&&f[z[3].key])continue}let F=k.wasRequested();for(let z=L.overscaledZ-1;z>=T;--z){const G=L.scaledTo(z);if(y[G.key])break;if(y[G.key]=!0,k=this.getTile(G),!k&&F&&(k=this._addTile(G)),k){const Z=k.hasData();if((Z||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||F)&&(f[G.key]=G),F=k.wasRequested(),Z)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let c,f=this._tiles[e].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}n.push(f.key);const y=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(y),c)break;f=y}for(const y of n)this._loadedParentTiles[y]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const n=this._tiles[e].tileID,c=this._getLoadedTile(n);this._loadedSiblingTiles[n.key]=c}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const c=n;return n||(n=new Pa(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,e.key,n.state)),n.uses++,this._tiles[e.key]=n,c||this._source.fire(new d.l("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=n.getExpiryTimeout();c&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},c))}refreshTiles(e){for(const n in this._tiles)this._isIdRenderable(n)&&e.some(c=>c.equals(this._tiles[n].tileID.canonical))&&this._reloadTile(n,"expired")}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}_dataHandler(e){const n=e.sourceDataType;e.dataType==="source"&&n==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&n==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,n,c){const f=[],y=this.transform;if(!y)return f;const T=c?y.getCameraQueryGeometry(e):e,A=e.map(Z=>y.screenPointToMercatorCoordinate(Z,this.terrain)),I=T.map(Z=>y.screenPointToMercatorCoordinate(Z,this.terrain)),L=this.getIds();let k=1/0,F=1/0,z=-1/0,G=-1/0;for(const Z of I)k=Math.min(k,Z.x),F=Math.min(F,Z.y),z=Math.max(z,Z.x),G=Math.max(G,Z.y);for(let Z=0;Z<L.length;Z++){const ne=this._tiles[L[Z]];if(ne.holdingForFade())continue;const ae=y.getCoveringTilesDetailsProvider().allowWorldCopies()?ne.tileID:ne.tileID.unwrapTo(0),re=Math.pow(2,y.zoom-ne.tileID.overscaledZ),le=n*ne.queryPadding*d.Z/ne.tileSize/re,me=[ae.getTilePoint(new d.$(k,F)),ae.getTilePoint(new d.$(z,G))];if(me[0].x-le<d.Z&&me[0].y-le<d.Z&&me[1].x+le>=0&&me[1].y+le>=0){const pe=A.map(Ee=>ae.getTilePoint(Ee)),ye=I.map(Ee=>ae.getTilePoint(Ee));f.push({tile:ne,tileID:ae,queryGeometry:pe,cameraQueryGeometry:ye,scale:re})}}return f}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(c=>this._tiles[c].tileID);return this.transform&&this.transform.populateCache(n),n}hasTransition(){if(this._source.hasTransition())return!0;if(Ie(this._source.type)){const e=Me.now();for(const n in this._tiles)if(this._tiles[n].fadeEndTime>=e)return!0}return!1}setFeatureState(e,n,c){this._state.updateState(e=e||"_geojsonTileLayer",n,c)}removeFeatureState(e,n,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,c)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,c){const f=this._tiles[e];f&&f.setDependencies(n,c)}reloadTilesForDependencies(e,n){for(const c in this._tiles)this._tiles[c].hasDependency(e,n)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(e,n))}}function Fe(g,e){const n=Math.abs(2*g.wrap)-+(g.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return g.overscaledZ-e.overscaledZ||c-n||e.canonical.y-g.canonical.y||e.canonical.x-g.canonical.x}function Ie(g){return g==="raster"||g==="image"||g==="video"}Re.maxOverzooming=10,Re.maxUnderzooming=3;class et{constructor(e,n){this.reset(e,n)}reset(e,n){this.points=e||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=d.ae(e,0,1);let n=1,c=this._distances[n];const f=e*this.paddedLength+this.padding;for(;c<f&&n<this._distances.length;)c=this._distances[++n];const y=n-1,T=this._distances[y],A=c-T,I=A>0?(f-T)/A:0;return this.points[y].mult(1-I).add(this.points[n].mult(I))}}function pt(g,e){let n=!0;return g==="always"||g!=="never"&&e!=="never"||(n=!1),n}class _t{constructor(e,n,c){const f=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(e/c),this.yCellCount=Math.ceil(n/c);for(let T=0;T<this.xCellCount*this.yCellCount;T++)f.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,n,c,f,y){this._forEachCell(n,c,f,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(n),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(y)}insertCircle(e,n,c,f){this._forEachCell(n-f,c-f,n+f,c+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(n),this.circles.push(c),this.circles.push(f)}_insertBoxCell(e,n,c,f,y,T){this.boxCells[y].push(T)}_insertCircleCell(e,n,c,f,y,T){this.circleCells[y].push(T)}_query(e,n,c,f,y,T,A){if(c<0||e>this.width||f<0||n>this.height)return[];const I=[];if(e<=0&&n<=0&&this.width<=c&&this.height<=f){if(y)return[{key:null,x1:e,y1:n,x2:c,y2:f}];for(let L=0;L<this.boxKeys.length;L++)I.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const k=this.circles[3*L],F=this.circles[3*L+1],z=this.circles[3*L+2];I.push({key:this.circleKeys[L],x1:k-z,y1:F-z,x2:k+z,y2:F+z})}}else this._forEachCell(e,n,c,f,this._queryCell,I,{hitTest:y,overlapMode:T,seenUids:{box:{},circle:{}}},A);return I}query(e,n,c,f){return this._query(e,n,c,f,!1,null)}hitTest(e,n,c,f,y,T){return this._query(e,n,c,f,!0,y,T).length>0}hitTestCircle(e,n,c,f,y){const T=e-c,A=e+c,I=n-c,L=n+c;if(A<0||T>this.width||L<0||I>this.height)return!1;const k=[];return this._forEachCell(T,I,A,L,this._queryCellCircle,k,{hitTest:!0,overlapMode:f,circle:{x:e,y:n,radius:c},seenUids:{box:{},circle:{}}},y),k.length>0}_queryCell(e,n,c,f,y,T,A,I){const{seenUids:L,hitTest:k,overlapMode:F}=A,z=this.boxCells[y];if(z!==null){const Z=this.bboxes;for(const ne of z)if(!L.box[ne]){L.box[ne]=!0;const ae=4*ne,re=this.boxKeys[ne];if(e<=Z[ae+2]&&n<=Z[ae+3]&&c>=Z[ae+0]&&f>=Z[ae+1]&&(!I||I(re))&&(!k||!pt(F,re.overlapMode))&&(T.push({key:re,x1:Z[ae],y1:Z[ae+1],x2:Z[ae+2],y2:Z[ae+3]}),k))return!0}}const G=this.circleCells[y];if(G!==null){const Z=this.circles;for(const ne of G)if(!L.circle[ne]){L.circle[ne]=!0;const ae=3*ne,re=this.circleKeys[ne];if(this._circleAndRectCollide(Z[ae],Z[ae+1],Z[ae+2],e,n,c,f)&&(!I||I(re))&&(!k||!pt(F,re.overlapMode))){const le=Z[ae],me=Z[ae+1],pe=Z[ae+2];if(T.push({key:re,x1:le-pe,y1:me-pe,x2:le+pe,y2:me+pe}),k)return!0}}}return!1}_queryCellCircle(e,n,c,f,y,T,A,I){const{circle:L,seenUids:k,overlapMode:F}=A,z=this.boxCells[y];if(z!==null){const Z=this.bboxes;for(const ne of z)if(!k.box[ne]){k.box[ne]=!0;const ae=4*ne,re=this.boxKeys[ne];if(this._circleAndRectCollide(L.x,L.y,L.radius,Z[ae+0],Z[ae+1],Z[ae+2],Z[ae+3])&&(!I||I(re))&&!pt(F,re.overlapMode))return T.push(!0),!0}}const G=this.circleCells[y];if(G!==null){const Z=this.circles;for(const ne of G)if(!k.circle[ne]){k.circle[ne]=!0;const ae=3*ne,re=this.circleKeys[ne];if(this._circlesCollide(Z[ae],Z[ae+1],Z[ae+2],L.x,L.y,L.radius)&&(!I||I(re))&&!pt(F,re.overlapMode))return T.push(!0),!0}}}_forEachCell(e,n,c,f,y,T,A,I){const L=this._convertToXCellCoord(e),k=this._convertToYCellCoord(n),F=this._convertToXCellCoord(c),z=this._convertToYCellCoord(f);for(let G=L;G<=F;G++)for(let Z=k;Z<=z;Z++)if(y.call(this,e,n,c,f,this.xCellCount*Z+G,T,A,I))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,n,c,f,y,T){const A=f-e,I=y-n,L=c+T;return L*L>A*A+I*I}_circleAndRectCollide(e,n,c,f,y,T,A){const I=(T-f)/2,L=Math.abs(e-(f+I));if(L>I+c)return!1;const k=(A-y)/2,F=Math.abs(n-(y+k));if(F>k+c)return!1;if(L<=I||F<=k)return!0;const z=L-I,G=F-k;return z*z+G*G<=c*c}}function It(g,e,n){const c=d.K();if(!g){const{vecSouth:F,vecEast:z}=Rt(e),G=W();G[0]=z[0],G[1]=z[1],G[2]=F[0],G[3]=F[1],f=G,(k=(T=(y=G)[0])*(L=y[3])-(I=y[2])*(A=y[1]))&&(f[0]=L*(k=1/k),f[1]=-A*k,f[2]=-I*k,f[3]=T*k),c[0]=G[0],c[1]=G[1],c[4]=G[2],c[5]=G[3]}var f,y,T,A,I,L,k;return d.M(c,c,[1/n,1/n,1]),c}function kt(g,e,n,c){if(g){const f=d.K();if(!e){const{vecSouth:y,vecEast:T}=Rt(n);f[0]=T[0],f[1]=T[1],f[4]=y[0],f[5]=y[1]}return d.M(f,f,[c,c,1]),f}return n.pixelsToClipSpaceMatrix}function Rt(g){const e=Math.cos(g.rollInRadians),n=Math.sin(g.rollInRadians),c=Math.cos(g.pitchInRadians),f=Math.cos(g.bearingInRadians),y=Math.sin(g.bearingInRadians),T=d.ao();T[0]=-f*c*n-y*e,T[1]=-y*c*n+f*e;const A=d.ap(T);A<1e-9?d.aq(T):d.ar(T,T,1/A);const I=d.ao();I[0]=f*c*e-y*n,I[1]=y*c*e+f*n;const L=d.ap(I);return L<1e-9?d.aq(I):d.ar(I,I,1/L),{vecEast:I,vecSouth:T}}function Ve(g,e,n,c){let f;c?(f=[g,e,c(g,e),1],d.at(f,f,n)):(f=[g,e,0,1],uo(f,f,n));const y=f[3];return{point:new d.P(f[0]/y,f[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function vi(g,e){return .5+g/e*.5}function fi(g,e){return g.x>=-e[0]&&g.x<=e[0]&&g.y>=-e[1]&&g.y<=e[1]}function Ti(g,e,n,c,f,y,T,A,I,L,k,F,z){const G=n?g.textSizeData:g.iconSizeData,Z=d.ak(G,e.transform.zoom),ne=[256/e.width*2+1,256/e.height*2+1],ae=n?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;ae.clear();const re=g.lineVertexArray,le=n?g.text.placedSymbolArray:g.icon.placedSymbolArray,me=e.transform.width/e.transform.height;let pe=!1;for(let ye=0;ye<le.length;ye++){const Ee=le.get(ye);if(Ee.hidden||Ee.writingMode===d.al.vertical&&!pe){Ds(Ee.numGlyphs,ae);continue}pe=!1;const be=new d.P(Ee.anchorX,Ee.anchorY),Ne={getElevation:z,pitchedLabelPlaneMatrix:c,lineVertexArray:re,pitchWithMap:y,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:be,unwrappedTileID:I,width:L,height:k,translation:F},$e=Bt(Ee.anchorX,Ee.anchorY,Ne);if(!fi($e.point,ne)){Ds(Ee.numGlyphs,ae);continue}const je=vi(e.transform.cameraToCenterDistance,$e.signedDistanceFromCamera),He=d.am(G,Z,Ee),Ge=y?He*e.transform.getPitchedTextCorrection(Ee.anchorX,Ee.anchorY,I)/je:He*je,ft=Ft({projectionContext:Ne,pitchedLabelPlaneMatrixInverse:f,symbol:Ee,fontSize:Ge,flip:!1,keepUpright:T,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:ae,aspectRatio:me,rotateToLine:A});pe=ft.useVertical,(ft.notEnoughRoom||pe||ft.needsFlipping&&Ft({projectionContext:Ne,pitchedLabelPlaneMatrixInverse:f,symbol:Ee,fontSize:Ge,flip:!0,keepUpright:T,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:ae,aspectRatio:me,rotateToLine:A}).notEnoughRoom)&&Ds(Ee.numGlyphs,ae)}n?g.text.dynamicLayoutVertexBuffer.updateData(ae):g.icon.dynamicLayoutVertexBuffer.updateData(ae)}function jt(g,e,n,c,f,y,T,A){const I=y.glyphStartIndex+y.numGlyphs,L=y.lineStartIndex,k=y.lineStartIndex+y.lineLength,F=e.getoffsetX(y.glyphStartIndex),z=e.getoffsetX(I-1),G=or(g*F,n,c,f,y.segment,L,k,A,T);if(!G)return null;const Z=or(g*z,n,c,f,y.segment,L,k,A,T);return Z?A.projectionCache.anyProjectionOccluded?null:{first:G,last:Z}:null}function We(g,e,n,c){return g===d.al.horizontal&&Math.abs(n.y-e.y)>Math.abs(n.x-e.x)*c?{useVertical:!0}:(g===d.al.vertical?e.y<n.y:e.x>n.x)?{needsFlipping:!0}:null}function Ft(g){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:n,symbol:c,fontSize:f,flip:y,keepUpright:T,glyphOffsetArray:A,dynamicLayoutVertexArray:I,aspectRatio:L,rotateToLine:k}=g,F=f/24,z=c.lineOffsetX*F,G=c.lineOffsetY*F;let Z;if(c.numGlyphs>1){const ne=c.glyphStartIndex+c.numGlyphs,ae=c.lineStartIndex,re=c.lineStartIndex+c.lineLength,le=jt(F,A,z,G,y,c,k,e);if(!le)return{notEnoughRoom:!0};const me=qa(le.first.point.x,le.first.point.y,e,n),pe=qa(le.last.point.x,le.last.point.y,e,n);if(T&&!y){const ye=We(c.writingMode,me,pe,L);if(ye)return ye}Z=[le.first];for(let ye=c.glyphStartIndex+1;ye<ne-1;ye++)Z.push(or(F*A.getoffsetX(ye),z,G,y,c.segment,ae,re,e,k));Z.push(le.last)}else{if(T&&!y){const ae=Gi(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,re=c.lineStartIndex+c.segment+1,le=new d.P(e.lineVertexArray.getx(re),e.lineVertexArray.gety(re)),me=Gi(le.x,le.y,e),pe=me.signedDistanceFromCamera>0?me.point:Gt(e.tileAnchorPoint,le,ae,1,e),ye=qa(ae.x,ae.y,e,n),Ee=qa(pe.x,pe.y,e,n),be=We(c.writingMode,ye,Ee,L);if(be)return be}const ne=or(F*A.getoffsetX(c.glyphStartIndex),z,G,y,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,e,k);if(!ne||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Z=[ne]}for(const ne of Z)d.as(I,ne.point,ne.angle);return{}}function Gt(g,e,n,c,f){const y=g.add(g.sub(e)._unit()),T=Gi(y.x,y.y,f).point,A=n.sub(T);return n.add(A._mult(c/A.mag()))}function Fi(g,e,n){const c=e.projectionCache;if(c.projections[g])return c.projections[g];const f=new d.P(e.lineVertexArray.getx(g),e.lineVertexArray.gety(g)),y=Gi(f.x,f.y,e);if(y.signedDistanceFromCamera>0)return c.projections[g]=y.point,c.anyProjectionOccluded=c.anyProjectionOccluded||y.isOccluded,y.point;const T=g-n.direction;return Gt(n.distanceFromAnchor===0?e.tileAnchorPoint:new d.P(e.lineVertexArray.getx(T),e.lineVertexArray.gety(T)),f,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,e)}function Gi(g,e,n){const c=g+n.translation[0],f=e+n.translation[1];let y;return n.pitchWithMap?(y=Ve(c,f,n.pitchedLabelPlaneMatrix,n.getElevation),y.isOccluded=!1):(y=n.transform.projectTileCoordinates(c,f,n.unwrappedTileID,n.getElevation),y.point.x=(.5*y.point.x+.5)*n.width,y.point.y=(.5*-y.point.y+.5)*n.height),y}function qa(g,e,n,c){if(n.pitchWithMap){const f=[g,e,0,1];return d.at(f,f,c),n.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],n.unwrappedTileID,n.getElevation).point}return{x:g/n.width*2-1,y:e/n.height*2-1}}function Bt(g,e,n){return n.transform.projectTileCoordinates(g,e,n.unwrappedTileID,n.getElevation)}function Fo(g,e,n){return g._unit()._perp()._mult(e*n)}function Lu(g,e,n,c,f,y,T,A,I){if(A.projectionCache.offsets[g])return A.projectionCache.offsets[g];const L=n.add(e);if(g+I.direction<c||g+I.direction>=f)return A.projectionCache.offsets[g]=L,L;const k=Fi(g+I.direction,A,I),F=Fo(k.sub(n),T,I.direction),z=n.add(F),G=k.add(F);return A.projectionCache.offsets[g]=d.au(y,L,z,G)||L,A.projectionCache.offsets[g]}function or(g,e,n,c,f,y,T,A,I){const L=c?g-e:g+e;let k=L>0?1:-1,F=0;c&&(k*=-1,F=Math.PI),k<0&&(F+=Math.PI);let z,G=k>0?y+f:y+f+1;A.projectionCache.cachedAnchorPoint?z=A.projectionCache.cachedAnchorPoint:(z=Gi(A.tileAnchorPoint.x,A.tileAnchorPoint.y,A).point,A.projectionCache.cachedAnchorPoint=z);let Z,ne,ae=z,re=z,le=0,me=0;const pe=Math.abs(L),ye=[];let Ee;for(;le+me<=pe;){if(G+=k,G<y||G>=T)return null;le+=me,re=ae,ne=Z;const $e={absOffsetX:pe,direction:k,distanceFromAnchor:le,previousVertex:re};if(ae=Fi(G,A,$e),n===0)ye.push(re),Ee=ae.sub(re);else{let je;const He=ae.sub(re);je=He.mag()===0?Fo(Fi(G+k,A,$e).sub(ae),n,k):Fo(He,n,k),ne||(ne=re.add(je)),Z=Lu(G,je,ae,y,T,ne,n,A,$e),ye.push(ne),Ee=Z.sub(ne)}me=Ee.mag()}const be=Ee._mult((pe-le)/me)._add(ne||re),Ne=F+Math.atan2(ae.y-re.y,ae.x-re.x);return ye.push(be),{point:be,angle:I?Ne:0,path:ye}}const ts=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ds(g,e){for(let n=0;n<g;n++){const c=e.length;e.resize(c+4),e.float32.set(ts,3*c)}}function uo(g,e,n){const c=e[0],f=e[1];return g[0]=n[0]*c+n[4]*f+n[12],g[1]=n[1]*c+n[5]*f+n[13],g[3]=n[3]*c+n[7]*f+n[15],g}const va=100;class ur{constructor(e,n=new _t(e.width+200,e.height+200,25),c=new _t(e.width+200,e.height+200,25)){this.transform=e,this.grid=n,this.ignoredGrid=c,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+va,this.screenBottomBoundary=e.height+va,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,n,c,f,y,T,A,I,L,k,F,z){const G=this.projectAndGetPerspectiveRatio(e.anchorPointX+I[0],e.anchorPointY+I[1],y,k,z),Z=c*G.perspectiveRatio;let ne;if(T||A)ne=this._projectCollisionBox(e,Z,f,y,T,A,I,G,k,F,z);else{const Ee=G.x+(F?F.x*Z:0),be=G.y+(F?F.y*Z:0);ne={allPointsOccluded:!1,box:[Ee+e.x1*Z,be+e.y1*Z,Ee+e.x2*Z,be+e.y2*Z]}}const[ae,re,le,me]=ne.box,pe=T?ne.allPointsOccluded:G.isOccluded;let ye=pe;return ye||(ye=G.perspectiveRatio<this.perspectiveRatioCutoff),ye||(ye=!this.isInsideGrid(ae,re,le,me)),ye||n!=="always"&&this.grid.hitTest(ae,re,le,me,n,L)?{box:[ae,re,le,me],placeable:!1,offscreen:!1,occluded:pe}:{box:[ae,re,le,me],placeable:!0,offscreen:this.isOffscreen(ae,re,le,me),occluded:pe}}placeCollisionCircles(e,n,c,f,y,T,A,I,L,k,F,z,G,Z){const ne=[],ae=new d.P(n.anchorX,n.anchorY),re=this.getPerspectiveRatio(ae.x,ae.y,T,Z),le=(L?y*this.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,T)/re:y*re)/d.ay,me={getElevation:Z,pitchedLabelPlaneMatrix:A,lineVertexArray:c,pitchWithMap:L,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ae,unwrappedTileID:T,width:this.transform.width,height:this.transform.height,translation:G},pe=jt(le,f,n.lineOffsetX*le,n.lineOffsetY*le,!1,n,!1,me);let ye=!1,Ee=!1,be=!0;if(pe){const Ne=.5*F*re+z,$e=new d.P(-100,-100),je=new d.P(this.screenRightBoundary,this.screenBottomBoundary),He=new et,Ge=pe.first,ft=pe.last;let ht=[];for(let ii=Ge.path.length-1;ii>=1;ii--)ht.push(Ge.path[ii]);for(let ii=1;ii<ft.path.length;ii++)ht.push(ft.path[ii]);const it=2.5*Ne;if(L){const ii=this.projectPathToScreenSpace(ht,me);ht=ii.some(di=>di.signedDistanceFromCamera<=0)?[]:ii.map(di=>di.point)}let St=[];if(ht.length>0){const ii=ht[0].clone(),di=ht[0].clone();for(let oa=1;oa<ht.length;oa++)ii.x=Math.min(ii.x,ht[oa].x),ii.y=Math.min(ii.y,ht[oa].y),di.x=Math.max(di.x,ht[oa].x),di.y=Math.max(di.y,ht[oa].y);St=ii.x>=$e.x&&di.x<=je.x&&ii.y>=$e.y&&di.y<=je.y?[ht]:di.x<$e.x||ii.x>je.x||di.y<$e.y||ii.y>je.y?[]:d.av([ht],$e.x,$e.y,je.x,je.y)}for(const ii of St){He.reset(ii,.25*Ne);let di=0;di=He.length<=.5*Ne?1:Math.ceil(He.paddedLength/it)+1;for(let oa=0;oa<di;oa++){const ki=oa/Math.max(di-1,1),ua=He.lerp(ki),Ji=ua.x+va,ji=ua.y+va;ne.push(Ji,ji,Ne,0);const wi=Ji-Ne,La=ji-Ne,Za=Ji+Ne,an=ji+Ne;if(be=be&&this.isOffscreen(wi,La,Za,an),Ee=Ee||this.isInsideGrid(wi,La,Za,an),e!=="always"&&this.grid.hitTestCircle(Ji,ji,Ne,e,k)&&(ye=!0,!I))return{circles:[],offscreen:!1,collisionDetected:ye}}}}return{circles:!I&&ye||!Ee||re<this.perspectiveRatioCutoff?[]:ne,offscreen:be,collisionDetected:ye}}projectPathToScreenSpace(e,n){const c=function(f,y){const T=d.K();return d.an(T,y.pitchedLabelPlaneMatrix),f.map(A=>{const I=Ve(A.x,A.y,T,y.getElevation),L=y.transform.projectTileCoordinates(I.point.x,I.point.y,y.unwrappedTileID,y.getElevation);return L.point.x=(.5*L.point.x+.5)*y.width,L.point.y=(.5*-L.point.y+.5)*y.height,L})}(e,n);return function(f){let y=0,T=0,A=0,I=0;for(let L=0;L<f.length;L++)f[L].isOccluded?(A=L+1,I=0):(I++,I>T&&(T=I,y=A));return f.slice(y,y+T)}(c)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const n=[];let c=1/0,f=1/0,y=-1/0,T=-1/0;for(const k of e){const F=new d.P(k.x+va,k.y+va);c=Math.min(c,F.x),f=Math.min(f,F.y),y=Math.max(y,F.x),T=Math.max(T,F.y),n.push(F)}const A=this.grid.query(c,f,y,T).concat(this.ignoredGrid.query(c,f,y,T)),I={},L={};for(const k of A){const F=k.key;if(I[F.bucketInstanceId]===void 0&&(I[F.bucketInstanceId]={}),I[F.bucketInstanceId][F.featureIndex])continue;const z=[new d.P(k.x1,k.y1),new d.P(k.x2,k.y1),new d.P(k.x2,k.y2),new d.P(k.x1,k.y2)];d.aw(n,z)&&(I[F.bucketInstanceId][F.featureIndex]=!0,L[F.bucketInstanceId]===void 0&&(L[F.bucketInstanceId]=[]),L[F.bucketInstanceId].push(F.featureIndex))}return L}insertCollisionBox(e,n,c,f,y,T){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:y,collisionGroupID:T,overlapMode:n},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,n,c,f,y,T){const A=c?this.ignoredGrid:this.grid,I={bucketInstanceId:f,featureIndex:y,collisionGroupID:T,overlapMode:n};for(let L=0;L<e.length;L+=4)A.insertCircle(I,e[L],e[L+1],e[L+2])}projectAndGetPerspectiveRatio(e,n,c,f,y){if(y){let T;f?(T=[e,n,f(e,n),1],d.at(T,T,y)):(T=[e,n,0,1],uo(T,T,y));const A=T[3];return{x:(T[0]/A+1)/2*this.transform.width+va,y:(-T[1]/A+1)/2*this.transform.height+va,perspectiveRatio:.5+this.transform.cameraToCenterDistance/A*.5,isOccluded:!1,signedDistanceFromCamera:A}}{const T=this.transform.projectTileCoordinates(e,n,c,f);return{x:(T.point.x+1)/2*this.transform.width+va,y:(1-T.point.y)/2*this.transform.height+va,perspectiveRatio:.5+this.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5,isOccluded:T.isOccluded,signedDistanceFromCamera:T.signedDistanceFromCamera}}}getPerspectiveRatio(e,n,c,f){const y=this.transform.projectTileCoordinates(e,n,c,f);return .5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5}isOffscreen(e,n,c,f){return c<va||e>=this.screenRightBoundary||f<va||n>this.screenBottomBoundary}isInsideGrid(e,n,c,f){return c>=0&&e<this.gridRightBoundary&&f>=0&&n<this.gridBottomBoundary}getViewportMatrix(){const e=d.ad([]);return d.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,n,c,f,y,T,A,I,L,k,F){let z=1,G=0,Z=0,ne=1;const ae=e.anchorPointX+A[0],re=e.anchorPointY+A[1];if(T&&!y){const ht=this.projectAndGetPerspectiveRatio(ae+1,re,f,L,F),it=ht.x-I.x,St=Math.atan((ht.y-I.y)/it)+(it<0?Math.PI:0),ii=Math.sin(St),di=Math.cos(St);z=di,G=ii,Z=-ii,ne=di}else if(!T&&y){const ht=Rt(this.transform);z=ht.vecEast[0],G=ht.vecEast[1],Z=ht.vecSouth[0],ne=ht.vecSouth[1]}let le=I.x,me=I.y,pe=n;y&&(le=ae,me=re,pe=Math.pow(2,-(this.transform.zoom-c.overscaledZ)),pe*=this.transform.getPitchedTextCorrection(ae,re,f),k||(pe*=d.ae(.5+I.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),k&&(le+=z*k.x*pe+Z*k.y*pe,me+=G*k.x*pe+ne*k.y*pe);const ye=e.x1*pe,Ee=e.x2*pe,be=(ye+Ee)/2,Ne=e.y1*pe,$e=e.y2*pe,je=(Ne+$e)/2,He=[{offsetX:ye,offsetY:Ne},{offsetX:be,offsetY:Ne},{offsetX:Ee,offsetY:Ne},{offsetX:Ee,offsetY:je},{offsetX:Ee,offsetY:$e},{offsetX:be,offsetY:$e},{offsetX:ye,offsetY:$e},{offsetX:ye,offsetY:je}];let Ge=[];for(const{offsetX:ht,offsetY:it}of He)Ge.push(new d.P(le+z*ht+Z*it,me+G*ht+ne*it));let ft=!1;if(y){const ht=Ge.map(it=>this.projectAndGetPerspectiveRatio(it.x,it.y,f,L,F));ft=ht.some(it=>!it.isOccluded),Ge=ht.map(it=>new d.P(it.x,it.y))}else ft=!0;return{box:d.ax(Ge),allPointsOccluded:!ft}}}class Ui{constructor(e,n,c,f){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?n:-n))):f&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class lo{constructor(e,n,c,f,y){this.text=new Ui(e?e.text:null,n,c,y),this.icon=new Ui(e?e.icon:null,n,f,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Gn{constructor(e,n,c){this.text=e,this.icon=n,this.skipFade=c}}class Cl{constructor(e,n,c,f,y){this.bucketInstanceId=e,this.featureIndex=n,this.sourceLayerIndex=c,this.bucketIndex=f,this.tileID=y}}class co{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const n=++this.maxGroupID;this.collisionGroups[e]={ID:n,predicate:c=>c.collisionGroupID===n}}return this.collisionGroups[e]}}function Zn(g,e,n,c,f){const{horizontalAlign:y,verticalAlign:T}=d.aE(g);return new d.P(-(y-.5)*e+c[0]*f,-(T-.5)*n+c[1]*f)}class _c{constructor(e,n,c,f,y){this.transform=e.clone(),this.terrain=n,this.collisionIndex=new ur(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new co(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const n=this.terrain;return n?(c,f)=>n.getElevation(e,c,f):null}getBucketParts(e,n,c,f){const y=c.getBucket(n),T=c.latestFeatureIndex;if(!y||!T||n.id!==y.layerIds[0])return;const A=c.collisionBoxArray,I=y.layers[0].layout,L=y.layers[0].paint,k=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),F=c.tileSize/d.Z,z=c.tileID.toUnwrapped(),G=I.get("text-rotation-alignment")==="map",Z=d.az(c,1,this.transform.zoom),ne=d.aA(this.collisionIndex.transform,c,L.get("text-translate"),L.get("text-translate-anchor")),ae=d.aA(this.collisionIndex.transform,c,L.get("icon-translate"),L.get("icon-translate-anchor")),re=It(G,this.transform,Z);this.retainedQueryData[y.bucketInstanceId]=new Cl(y.bucketInstanceId,T,y.sourceLayerIndex,y.index,c.tileID);const le={bucket:y,layout:I,translationText:ne,translationIcon:ae,unwrappedTileID:z,pitchedLabelPlaneMatrix:re,scale:k,textPixelRatio:F,holdingForFade:c.holdingForFade(),collisionBoxArray:A,partiallyEvaluatedTextSize:d.ak(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(f)for(const me of y.sortKeyRanges){const{sortKey:pe,symbolInstanceStart:ye,symbolInstanceEnd:Ee}=me;e.push({sortKey:pe,symbolInstanceStart:ye,symbolInstanceEnd:Ee,parameters:le})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:le})}attemptAnchorPlacement(e,n,c,f,y,T,A,I,L,k,F,z,G,Z,ne,ae,re,le,me,pe){const ye=d.aB[e.textAnchor],Ee=[e.textOffset0,e.textOffset1],be=Zn(ye,c,f,Ee,y),Ne=this.collisionIndex.placeCollisionBox(n,z,I,L,k,A,T,ae,F.predicate,me,be,pe);if((!le||this.collisionIndex.placeCollisionBox(le,z,I,L,k,A,T,re,F.predicate,me,be,pe).placeable)&&Ne.placeable){let $e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&($e=this.prevPlacement.variableOffsets[G.crossTileID].anchor),G.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[G.crossTileID]={textOffset:Ee,width:c,height:f,anchor:ye,textBoxScale:y,prevAnchor:$e},this.markUsedJustification(Z,ye,G,ne),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,ne,G),this.placedOrientations[G.crossTileID]=ne),{shift:be,placedGlyphBoxes:Ne}}}placeLayerBucketPart(e,n,c){const{bucket:f,layout:y,translationText:T,translationIcon:A,unwrappedTileID:I,pitchedLabelPlaneMatrix:L,textPixelRatio:k,holdingForFade:F,collisionBoxArray:z,partiallyEvaluatedTextSize:G,collisionGroup:Z}=e.parameters,ne=y.get("text-optional"),ae=y.get("icon-optional"),re=d.aC(y,"text-overlap","text-allow-overlap"),le=re==="always",me=d.aC(y,"icon-overlap","icon-allow-overlap"),pe=me==="always",ye=y.get("text-rotation-alignment")==="map",Ee=y.get("text-pitch-alignment")==="map",be=y.get("icon-text-fit")!=="none",Ne=y.get("symbol-z-order")==="viewport-y",$e=le&&(pe||!f.hasIconData()||ae),je=pe&&(le||!f.hasTextData()||ne);!f.collisionArrays&&z&&f.deserializeCollisionBoxes(z);const He=this.retainedQueryData[f.bucketInstanceId].tileID,Ge=this._getTerrainElevationFunc(He),ft=this.transform.getFastPathSimpleProjectionMatrix(He),ht=(it,St,ii)=>{var di,oa;if(n[it.crossTileID])return;if(F)return void(this.placements[it.crossTileID]=new Gn(!1,!1,!1));let ki=!1,ua=!1,Ji=!0,ji=null,wi={box:null,placeable:!1,offscreen:null,occluded:!1},La={placeable:!1},Za=null,an=null,Si=null,_s=0,Zr=0,Gs=0;St.textFeatureIndex?_s=St.textFeatureIndex:it.useRuntimeCollisionCircles&&(_s=it.featureIndex),St.verticalTextFeatureIndex&&(Zr=St.verticalTextFeatureIndex);const Zs=St.textBox;if(Zs){const pr=_a=>{let Na=d.al.horizontal;if(f.allowVerticalPlacement&&!_a&&this.prevPlacement){const wn=this.prevPlacement.placedOrientations[it.crossTileID];wn&&(this.placedOrientations[it.crossTileID]=wn,Na=wn,this.markUsedOrientation(f,Na,it))}return Na},$s=(_a,Na)=>{if(f.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&St.verticalTextBox){for(const wn of f.writingModes)if(wn===d.al.vertical?(wi=Na(),La=wi):wi=_a(),wi&&wi.placeable)break}else wi=_a()},mr=it.textAnchorOffsetStartIndex,ys=it.textAnchorOffsetEndIndex;if(ys===mr){const _a=(Na,wn)=>{const Bi=this.collisionIndex.placeCollisionBox(Na,re,k,He,I,Ee,ye,T,Z.predicate,Ge,void 0,ft);return Bi&&Bi.placeable&&(this.markUsedOrientation(f,wn,it),this.placedOrientations[it.crossTileID]=wn),Bi};$s(()=>_a(Zs,d.al.horizontal),()=>{const Na=St.verticalTextBox;return f.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&Na?_a(Na,d.al.vertical):{box:null,offscreen:null}}),pr(wi&&wi.placeable)}else{let _a=d.aB[(oa=(di=this.prevPlacement)===null||di===void 0?void 0:di.variableOffsets[it.crossTileID])===null||oa===void 0?void 0:oa.anchor];const Na=(Bi,Wl,jh)=>{const Od=Bi.x2-Bi.x1,sl=Bi.y2-Bi.y1,_u=it.textBoxScale,Co=be&&me==="never"?Wl:null;let An=null,gr=re==="never"?1:2,_r="never";_a&&gr++;for(let bs=0;bs<gr;bs++){for(let Xs=mr;Xs<ys;Xs++){const Qs=f.textAnchorOffsets.get(Xs);if(_a&&Qs.textAnchor!==_a)continue;const Kn=this.attemptAnchorPlacement(Qs,Bi,Od,sl,_u,ye,Ee,k,He,I,Z,_r,it,f,jh,T,A,Co,Ge);if(Kn&&(An=Kn.placedGlyphBoxes,An&&An.placeable))return ki=!0,ji=Kn.shift,An}_a?_a=null:_r=re}return c&&!An&&(An={box:this.collisionIndex.placeCollisionBox(Zs,"always",k,He,I,Ee,ye,T,Z.predicate,Ge,void 0,ft).box,offscreen:!1,placeable:!1,occluded:!1}),An};$s(()=>Na(Zs,St.iconBox,d.al.horizontal),()=>{const Bi=St.verticalTextBox;return f.allowVerticalPlacement&&(!wi||!wi.placeable)&&it.numVerticalGlyphVertices>0&&Bi?Na(Bi,St.verticalIconBox,d.al.vertical):{box:null,occluded:!0,offscreen:null}}),wi&&(ki=wi.placeable,Ji=wi.offscreen);const wn=pr(wi&&wi.placeable);if(!ki&&this.prevPlacement){const Bi=this.prevPlacement.variableOffsets[it.crossTileID];Bi&&(this.variableOffsets[it.crossTileID]=Bi,this.markUsedJustification(f,Bi.anchor,it,wn))}}}if(Za=wi,ki=Za&&Za.placeable,Ji=Za&&Za.offscreen,it.useRuntimeCollisionCircles){const pr=f.text.placedSymbolArray.get(it.centerJustifiedTextSymbolIndex),$s=d.am(f.textSizeData,G,pr),mr=y.get("text-padding");an=this.collisionIndex.placeCollisionCircles(re,pr,f.lineVertexArray,f.glyphOffsetArray,$s,I,L,c,Ee,Z.predicate,it.collisionCircleDiameter,mr,T,Ge),an.circles.length&&an.collisionDetected&&!c&&d.w("Collisions detected, but collision boxes are not shown"),ki=le||an.circles.length>0&&!an.collisionDetected,Ji=Ji&&an.offscreen}if(St.iconFeatureIndex&&(Gs=St.iconFeatureIndex),St.iconBox){const pr=$s=>this.collisionIndex.placeCollisionBox($s,me,k,He,I,Ee,ye,A,Z.predicate,Ge,be&&ji?ji:void 0,ft);La&&La.placeable&&St.verticalIconBox?(Si=pr(St.verticalIconBox),ua=Si.placeable):(Si=pr(St.iconBox),ua=Si.placeable),Ji=Ji&&Si.offscreen}const rl=ne||it.numHorizontalGlyphVertices===0&&it.numVerticalGlyphVertices===0,Ys=ae||it.numIconVertices===0;rl||Ys?Ys?rl||(ua=ua&&ki):ki=ua&&ki:ua=ki=ua&&ki;const gu=ua&&Si.placeable;if(ki&&Za.placeable&&this.collisionIndex.insertCollisionBox(Za.box,re,y.get("text-ignore-placement"),f.bucketInstanceId,La&&La.placeable&&Zr?Zr:_s,Z.ID),gu&&this.collisionIndex.insertCollisionBox(Si.box,me,y.get("icon-ignore-placement"),f.bucketInstanceId,Gs,Z.ID),an&&ki&&this.collisionIndex.insertCollisionCircles(an.circles,re,y.get("text-ignore-placement"),f.bucketInstanceId,_s,Z.ID),c&&this.storeCollisionData(f.bucketInstanceId,ii,St,Za,Si,an),it.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[it.crossTileID]=new Gn((ki||$e)&&!(Za!=null&&Za.occluded),(ua||je)&&!(Si!=null&&Si.occluded),Ji||f.justReloaded),n[it.crossTileID]=!0};if(Ne){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const it=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let St=it.length-1;St>=0;--St){const ii=it[St];ht(f.symbolInstances.get(ii),f.collisionArrays[ii],ii)}}else for(let it=e.symbolInstanceStart;it<e.symbolInstanceEnd;it++)ht(f.symbolInstances.get(it),f.collisionArrays[it],it);f.justReloaded=!1}storeCollisionData(e,n,c,f,y,T){if(c.textBox||c.iconBox){let A,I;this.collisionBoxArrays.has(e)?A=this.collisionBoxArrays.get(e):(A=new Map,this.collisionBoxArrays.set(e,A)),A.has(n)?I=A.get(n):(I={text:null,icon:null},A.set(n,I)),c.textBox&&(I.text=f.box),c.iconBox&&(I.icon=y.box)}if(T){let A=this.collisionCircleArrays[e];A===void 0&&(A=this.collisionCircleArrays[e]=[]);for(let I=0;I<T.circles.length;I+=4)A.push(T.circles[I+0]-va),A.push(T.circles[I+1]-va),A.push(T.circles[I+2]),A.push(T.collisionDetected?1:0)}}markUsedJustification(e,n,c,f){let y;y=f===d.al.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[d.aD(n)];const T=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const A of T)A>=0&&(e.text.placedSymbolArray.get(A).crossTileID=y>=0&&A!==y?0:c.crossTileID)}markUsedOrientation(e,n,c){const f=n===d.al.horizontal||n===d.al.horizontalOnly?n:0,y=n===d.al.vertical?n:0,T=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const A of T)e.text.placedSymbolArray.get(A).placedOrientation=f;c.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const n=this.prevPlacement;let c=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;const f=n?n.symbolFadeChange(e):1,y=n?n.opacities:{},T=n?n.variableOffsets:{},A=n?n.placedOrientations:{};for(const I in this.placements){const L=this.placements[I],k=y[I];k?(this.opacities[I]=new lo(k,f,L.text,L.icon),c=c||L.text!==k.text.placed||L.icon!==k.icon.placed):(this.opacities[I]=new lo(null,f,L.text,L.icon,L.skipFade),c=c||L.text||L.icon)}for(const I in y){const L=y[I];if(!this.opacities[I]){const k=new lo(L,f,!1,!1);k.isHidden()||(this.opacities[I]=k,c=c||L.text.placed||L.icon.placed)}}for(const I in T)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=T[I]);for(const I in A)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=A[I]);if(n&&n.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:e)}updateLayerOpacities(e,n){const c={};for(const f of n){const y=f.getBucket(e);y&&f.latestFeatureIndex&&e.id===y.layerIds[0]&&this.updateBucketOpacities(y,f.tileID,c,f.collisionBoxArray)}}updateBucketOpacities(e,n,c,f){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const y=e.layers[0],T=y.layout,A=new lo(null,0,!1,!1,!0),I=T.get("text-allow-overlap"),L=T.get("icon-allow-overlap"),k=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),F=T.get("text-rotation-alignment")==="map",z=T.get("text-pitch-alignment")==="map",G=T.get("icon-text-fit")!=="none",Z=new lo(null,0,I&&(L||!e.hasIconData()||T.get("icon-optional")),L&&(I||!e.hasTextData()||T.get("text-optional")),!0);!e.collisionArrays&&f&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(f);const ne=(re,le,me)=>{for(let pe=0;pe<le/4;pe++)re.opacityVertexArray.emplaceBack(me);re.hasVisibleVertices=re.hasVisibleVertices||me!==Ho},ae=this.collisionBoxArrays.get(e.bucketInstanceId);for(let re=0;re<e.symbolInstances.length;re++){const le=e.symbolInstances.get(re),{numHorizontalGlyphVertices:me,numVerticalGlyphVertices:pe,crossTileID:ye}=le;let Ee=this.opacities[ye];c[ye]?Ee=A:Ee||(Ee=Z,this.opacities[ye]=Ee),c[ye]=!0;const be=le.numIconVertices>0,Ne=this.placedOrientations[le.crossTileID],$e=Ne===d.al.vertical,je=Ne===d.al.horizontal||Ne===d.al.horizontalOnly;if(me>0||pe>0){const Ge=Nu(Ee.text);ne(e.text,me,$e?Ho:Ge),ne(e.text,pe,je?Ho:Ge);const ft=Ee.text.isHidden();[le.rightJustifiedTextSymbolIndex,le.centerJustifiedTextSymbolIndex,le.leftJustifiedTextSymbolIndex].forEach(St=>{St>=0&&(e.text.placedSymbolArray.get(St).hidden=ft||$e?1:0)}),le.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(le.verticalPlacedTextSymbolIndex).hidden=ft||je?1:0);const ht=this.variableOffsets[le.crossTileID];ht&&this.markUsedJustification(e,ht.anchor,le,Ne);const it=this.placedOrientations[le.crossTileID];it&&(this.markUsedJustification(e,"left",le,it),this.markUsedOrientation(e,it,le))}if(be){const Ge=Nu(Ee.icon),ft=!(G&&le.verticalPlacedIconSymbolIndex&&$e);le.placedIconSymbolIndex>=0&&(ne(e.icon,le.numIconVertices,ft?Ge:Ho),e.icon.placedSymbolArray.get(le.placedIconSymbolIndex).hidden=Ee.icon.isHidden()),le.verticalPlacedIconSymbolIndex>=0&&(ne(e.icon,le.numVerticalIconVertices,ft?Ho:Ge),e.icon.placedSymbolArray.get(le.verticalPlacedIconSymbolIndex).hidden=Ee.icon.isHidden())}const He=ae&&ae.has(re)?ae.get(re):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ge=e.collisionArrays[re];if(Ge){let ft=new d.P(0,0);if(Ge.textBox||Ge.verticalTextBox){let ht=!0;if(k){const it=this.variableOffsets[ye];it?(ft=Zn(it.anchor,it.width,it.height,it.textOffset,it.textBoxScale),F&&ft._rotate(z?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ht=!1}if(Ge.textBox||Ge.verticalTextBox){let it;Ge.textBox&&(it=$e),Ge.verticalTextBox&&(it=je),Ml(e.textCollisionBox.collisionVertexArray,Ee.text.placed,!ht||it,He.text,ft.x,ft.y)}}if(Ge.iconBox||Ge.verticalIconBox){const ht=!!(!je&&Ge.verticalIconBox);let it;Ge.iconBox&&(it=ht),Ge.verticalIconBox&&(it=!ht),Ml(e.iconCollisionBox.collisionVertexArray,Ee.icon.placed,it,He.icon,G?ft.x:0,G?ft.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,n){const c=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*c>e}setStale(){this.stale=!0}}function Ml(g,e,n,c,f,y){c&&c.length!==0||(c=[0,0,0,0]);const T=c[0]-va,A=c[1]-va,I=c[2]-va,L=c[3]-va;g.emplaceBack(e?1:0,n?1:0,f||0,y||0,T,A),g.emplaceBack(e?1:0,n?1:0,f||0,y||0,I,A),g.emplaceBack(e?1:0,n?1:0,f||0,y||0,I,L),g.emplaceBack(e?1:0,n?1:0,f||0,y||0,T,L)}const xd=Math.pow(2,25),Uo=Math.pow(2,24),lr=Math.pow(2,17),vd=Math.pow(2,16),Ff=Math.pow(2,9),yc=Math.pow(2,8),Eh=Math.pow(2,1);function Nu(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const e=g.placed?1:0,n=Math.floor(127*g.opacity);return n*xd+e*Uo+n*lr+e*vd+n*Ff+e*yc+n*Eh+e}const Ho=0;class Yn{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,n,c,f,y){const T=this._bucketParts;for(;this._currentTileIndex<e.length;)if(n.getBucketParts(T,f,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((A,I)=>A.sortKey-I.sortKey));this._currentPartIndex<T.length;)if(n.placeLayerBucketPart(T[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,y())return!0;return!1}}class bc{constructor(e,n,c,f,y,T,A,I){this.placement=new _c(e,n,T,A,I),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(e,n,c){const f=Me.now(),y=()=>!this._forceFullPlacement&&Me.now()-f>2;for(;this._currentPlacementIndex>=0;){const T=n[e[this._currentPlacementIndex]],A=this.placement.collisionIndex.transform.zoom;if(T.type==="symbol"&&(!T.minzoom||T.minzoom<=A)&&(!T.maxzoom||T.maxzoom>A)){if(this._inProgressLayer||(this._inProgressLayer=new Yn(T)),this._inProgressLayer.continuePlacement(c[T.source],this.placement,this._showCollisionBoxes,T,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const ho=512/d.Z/2;class Il{constructor(e,n,c){this.tileID=e,this.bucketInstanceId=c,this._symbolsByKey={};const f=new Map;for(let y=0;y<n.length;y++){const T=n.get(y),A=T.key,I=f.get(A);I?I.push(T):f.set(A,[T])}for(const[y,T]of f){const A={positions:T.map(I=>({x:Math.floor(I.anchorX*ho),y:Math.floor(I.anchorY*ho)})),crossTileIDs:T.map(I=>I.crossTileID)};if(A.positions.length>128){const I=new d.aF(A.positions.length,16,Uint16Array);for(const{x:L,y:k}of A.positions)I.add(L,k);I.finish(),delete A.positions,A.index=I}this._symbolsByKey[y]=A}}getScaledCoordinates(e,n){const{x:c,y:f,z:y}=this.tileID.canonical,{x:T,y:A,z:I}=n.canonical,L=ho/Math.pow(2,I-y),k=(A*d.Z+e.anchorY)*L,F=f*d.Z*ho;return{x:Math.floor((T*d.Z+e.anchorX)*L-c*d.Z*ho),y:Math.floor(k-F)}}findMatches(e,n,c){const f=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z);for(let y=0;y<e.length;y++){const T=e.get(y);if(T.crossTileID)continue;const A=this._symbolsByKey[T.key];if(!A)continue;const I=this.getScaledCoordinates(T,n);if(A.index){const L=A.index.range(I.x-f,I.y-f,I.x+f,I.y+f).sort();for(const k of L){const F=A.crossTileIDs[k];if(!c[F]){c[F]=!0,T.crossTileID=F;break}}}else if(A.positions)for(let L=0;L<A.positions.length;L++){const k=A.positions[L],F=A.crossTileIDs[L];if(Math.abs(k.x-I.x)<=f&&Math.abs(k.y-I.y)<=f&&!c[F]){c[F]=!0,T.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Ou{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ku{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const n=Math.round((e-this.lng)/360);if(n!==0)for(const c in this.indexes){const f=this.indexes[c],y={};for(const T in f){const A=f[T];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+n),y[A.tileID.key]=A}this.indexes[c]=y}this.lng=e}addBucket(e,n,c){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let y=0;y<n.symbolInstances.length;y++)n.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const f=this.usedCrossTileIDs[e.overscaledZ];for(const y in this.indexes){const T=this.indexes[y];if(Number(y)>e.overscaledZ)for(const A in T){const I=T[A];I.tileID.isChildOf(e)&&I.findMatches(n.symbolInstances,e,f)}else{const A=T[e.scaledTo(Number(y)).key];A&&A.findMatches(n.symbolInstances,e,f)}}for(let y=0;y<n.symbolInstances.length;y++){const T=n.symbolInstances.get(y);T.crossTileID||(T.crossTileID=c.generate(),f[T.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Il(e,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(e,n){for(const c of n.getCrossTileIDsLists())for(const f of c)delete this.usedCrossTileIDs[e][f]}removeStaleBuckets(e){let n=!1;for(const c in this.indexes){const f=this.indexes[c];for(const y in f)e[f[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,f[y]),delete f[y],n=!0)}return n}}class Bu{constructor(){this.layerIndexes={},this.crossTileIDs=new Ou,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,n,c){let f=this.layerIndexes[e.id];f===void 0&&(f=this.layerIndexes[e.id]=new ku);let y=!1;const T={};f.handleWrapJump(c);for(const A of n){const I=A.getBucket(e);I&&e.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(A.tileID,I,this.crossTileIDs)&&(y=!0),T[I.bucketInstanceId]=!0)}return f.removeStaleBuckets(T)&&(y=!0),y}pruneUnusedLayers(e){const n={};e.forEach(c=>{n[c]=!0});for(const c in this.layerIndexes)n[c]||delete this.layerIndexes[c]}}var fo="void main() {fragColor=vec4(1.0);}";const Pn={prelude:mi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:mi("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:mi("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:mi(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:mi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:mi(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:mi(fo,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:mi(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:mi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:mi("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:mi("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:mi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:mi(fo,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:mi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:mi(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:mi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:mi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:mi(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:mi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:mi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:mi(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:mi(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:mi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:mi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:mi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:mi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:mi(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:mi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:mi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:mi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:mi("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:mi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:mi("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:mi(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:mi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function mi(g,e){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=e.match(/in ([\w]+) ([\w]+)/g),f=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=y?y.concat(f):f,A={};return{fragmentSource:g=g.replace(n,(I,L,k,F,z)=>(A[z]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_${z}
in ${k} ${F} ${z};
#else
uniform ${k} ${F} u_${z};
#endif
`:`
#ifdef HAS_UNIFORM_u_${z}
    ${k} ${F} ${z} = u_${z};
#endif
`)),vertexSource:e=e.replace(n,(I,L,k,F,z)=>{const G=F==="float"?"vec2":"vec4",Z=z.match(/color/)?"color":G;return A[z]?L==="define"?`
#ifndef HAS_UNIFORM_u_${z}
uniform lowp float u_${z}_t;
in ${k} ${G} a_${z};
out ${k} ${F} ${z};
#else
uniform ${k} ${F} u_${z};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${z}
    ${z} = a_${z};
#else
    ${k} ${F} ${z} = u_${z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${z}
    ${z} = unpack_mix_${Z}(a_${z}, u_${z}_t);
#else
    ${k} ${F} ${z} = u_${z};
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_${z}
uniform lowp float u_${z}_t;
in ${k} ${G} a_${z};
#else
uniform ${k} ${F} u_${z};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${z}
    ${k} ${F} ${z} = a_${z};
#else
    ${k} ${F} ${z} = u_${z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${z}
    ${k} ${F} ${z} = unpack_mix_${Z}(a_${z}, u_${z}_t);
#else
    ${k} ${F} ${z} = u_${z};
#endif
`}),staticAttributes:c,staticUniforms:T}}class jo{constructor(e,n,c){this.vertexBuffer=e,this.indexBuffer=n,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ln=d.aG([{name:"a_pos",type:"Int16",components:2}]);const qo="#define PROJECTION_MERCATOR",pi="mercator";class po{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return pi}get shaderDefine(){return qo}get shaderPreludeCode(){return Pn.projectionMercator}get vertexShaderPreludeCode(){return Pn.projectionMercator.vertexSource}get subdivisionGranularity(){return d.aH.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,n,c,f,y){if(this._cachedMesh)return this._cachedMesh;const T=new d.aI;T.emplaceBack(0,0),T.emplaceBack(d.Z,0),T.emplaceBack(0,d.Z),T.emplaceBack(d.Z,d.Z);const A=e.createVertexBuffer(T,ln.members),I=d.aJ.simpleSegment(0,0,4,2),L=new d.aK;L.emplaceBack(1,0,2),L.emplaceBack(1,2,3);const k=e.createIndexBuffer(L);return this._cachedMesh=new jo(A,k,I),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Vo{constructor(e=0,n=0,c=0,f=0){if(isNaN(e)||e<0||isNaN(n)||n<0||isNaN(c)||c<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=n,this.left=c,this.right=f}interpolate(e,n,c){return n.top!=null&&e.top!=null&&(this.top=d.B.number(e.top,n.top,c)),n.bottom!=null&&e.bottom!=null&&(this.bottom=d.B.number(e.bottom,n.bottom,c)),n.left!=null&&e.left!=null&&(this.left=d.B.number(e.left,n.left,c)),n.right!=null&&e.right!=null&&(this.right=d.B.number(e.right,n.right,c)),this}getCenter(e,n){const c=d.ae((this.left+e-this.right)/2,0,e),f=d.ae((this.top+n-this.bottom)/2,0,n);return new d.P(c,f)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Vo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function mo(g,e){if(!g.renderWorldCopies||g.lngRange)return;const n=e.lng-g.center.lng;e.lng+=n>180?-360:n<-180?360:0}function Va(g){return Math.max(0,Math.floor(g))}class Ta{constructor(e,n,c,f,y,T){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=T===void 0||!!T,this._minZoom=n||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=y??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new d.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Va(this._zoom),this._scale=d.ac(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Vo,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,n,c){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Va(this._zoom),this._scale=d.ac(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Vo(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!c&&e.autoCalculateNearFarZ,n&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new d.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const n=d.aL(e,-180,180)*Math.PI/180;var c,f,y,T,A,I,L,k,F;this._bearingInRadians!==n&&(this._unmodified=!1,this._bearingInRadians=n,this._calcMatrices(),this._rotationMatrix=W(),c=this._rotationMatrix,y=-this._bearingInRadians,T=(f=this._rotationMatrix)[0],A=f[1],I=f[2],L=f[3],k=Math.sin(y),F=Math.cos(y),c[0]=T*F+I*k,c[1]=A*F+L*k,c[2]=T*-k+I*F,c[3]=A*-k+L*F)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const n=d.ae(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==n&&(this._unmodified=!1,this._pitchInRadians=n,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const n=e/180*Math.PI;this._rollInRadians!==n&&(this._unmodified=!1,this._rollInRadians=n,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return d.aM(this._fovInRadians)}setFov(e){e=d.ae(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=d.ab(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const n=this.getConstrained(this._center,e).zoom;this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this._tileZoom=Math.max(0,Math.floor(n)),this._scale=d.ac(n),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,n){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=n,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,n,c){this._unmodified=!1,this._edgeInsets.interpolate(e,n,c),this._constrain(),this._calcMatrices()}resize(e,n,c=!0){this._width=e,this._height=n,c&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Oi([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,d.af])}getConstrained(e,n){return this._callbacks.getConstrained(e,n)}getCameraQueryGeometry(e,n){if(n.length===1)return[n[0],e];{let c=e.x,f=e.y,y=e.x,T=e.y;for(const A of n)c=Math.min(c,A.x),f=Math.min(f,A.y),y=Math.max(y,A.x),T=Math.max(T,A.y);return[new d.P(c,f),new d.P(y,f),new d.P(y,T),new d.P(c,T),new d.P(c,f)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:n,zoom:c}=this.getConstrained(this.center,this.zoom);this.setCenter(n),this.setZoom(c),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=d.ad(new Float64Array(16));d.M(e,e,[this._width/2,-this._height/2,1]),d.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=d.ad(new Float64Array(16)),d.M(e,e,[1,-1,1]),d.L(e,e,[-1,-1,0]),d.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,n,c,f){const y=c!==void 0?c:this.bearing,T=f=f!==void 0?f:this.pitch,A=d.$.fromLngLat(e,n),I=-Math.cos(d.ab(T)),L=Math.sin(d.ab(T)),k=L*Math.sin(d.ab(y)),F=-L*Math.cos(d.ab(y));let z=this.elevation;const G=n-z;let Z;I*G>=0||Math.abs(I)<.1?(Z=1e4,z=n+Z*I):Z=-G/I;let ne,ae,re=d.aN(1,A.y),le=0;do{if(le+=1,le>10)break;ae=Z/re,ne=new d.$(A.x+k*ae,A.y+F*ae),re=1/ne.meterInMercatorCoordinateUnits()}while(Math.abs(Z-ae*re)>1e-12);return{center:ne.toLngLat(),elevation:z,zoom:d.ah(this.height/2/Math.tan(this.fovInRadians/2)/ae/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const n=d.ag(1,this.center.lat)*this.worldSize,c=this.cameraToCenterDistance/n,f=d.$.fromLngLat(this.center,this.elevation),y=X(this.center,this.elevation,this.pitch,this.bearing,c);this._elevation=e;const T=this.calculateCenterFromCameraLngLatAlt(y.toLngLat(),d.aN(y.z,f.y),this.bearing,this.pitch);this._elevation=T.elevation,this._center=T.center,this.setZoom(T.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=d.ag(1,this.center.lat)*this.worldSize;return X(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const n=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/n,e.canonical.y/n,1/n/d.Z,1/n/d.Z]}}class Ea{constructor(e,n){this.min=e,this.max=n,this.center=d.aO([],d.aP([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],c=d.aQ(this.min),f=d.aQ(this.max);for(let y=0;y<n.length;y++)c[y]=n[y]?this.min[y]:this.center[y],f[y]=n[y]?this.center[y]:this.max[y];return f[2]=this.max[2],new Ea(c,f)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let n=!0;for(let c=0;c<e.planes.length;c++){const f=this.intersectsPlane(e.planes[c]);if(f===0)return 0;f===1&&(n=!1)}return n?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let n=e[3],c=e[3];for(let f=0;f<3;f++)e[f]>0?(n+=e[f]*this.min[f],c+=e[f]*this.max[f]):(c+=e[f]*this.min[f],n+=e[f]*this.max[f]);return n>=0?2:c<0?0:1}}class Ga{distanceToTile2d(e,n,c,f){const y=f.distanceX([e,n]),T=f.distanceY([e,n]);return Math.hypot(y,T)}getWrap(e,n,c){return c}getTileAABB(e,n,c,f){var y,T;let A=c,I=c;if(f.terrain){const k=new d.Y(e.z,n,e.z,e.x,e.y),F=f.terrain.getMinMaxElevation(k);A=(y=F.minElevation)!==null&&y!==void 0?y:c,I=(T=F.maxElevation)!==null&&T!==void 0?T:c}const L=1<<e.z;return new Ea([n+e.x/L,e.y/L,A],[n+(e.x+1)/L,(e.y+1)/L,I])}allowVariableZoom(e,n){const c=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,f=d.ae(78.5-c/2,0,60);return!!n.terrain||e.pitch>f}allowWorldCopies(){return!0}recalculateCache(){}}class Zi{constructor(e,n,c){this.points=e,this.planes=n,this.aabb=c}static fromInvProjectionMatrix(e,n=1,c=0){const f=Math.pow(2,c),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(L=>{const k=1/(L=d.at([],L,e))[3]/n*f;return d.aR(L,L,[k,k,1/L[3],k])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(L=>{const k=d.aS([],y[L[0]],y[L[1]]),F=d.aS([],y[L[2]],y[L[1]]),z=d.aT([],d.aU([],k,F)),G=-d.aV(z,y[L[1]]);return z.concat(G)}),A=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],I=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const L of y)for(let k=0;k<3;k++)A[k]=Math.min(A[k],L[k]),I[k]=Math.max(I[k],L[k]);return new Zi(y,T,new Ea(A,I))}}class is{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,c){return this._helper.interpolatePadding(e,n,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,c=!0){this._helper.resize(e,n,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,n){}constructor(e,n,c,f,y){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Ta({calcMatrices:()=>{this._calcMatrices()},getConstrained:(T,A)=>this.getConstrained(T,A)},e,n,c,f,y),this._coveringTilesDetailsProvider=new Ga}clone(){const e=new is;return e.apply(this),e}apply(e,n,c){this._helper.apply(e,n,c)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const n=[new d.aW(0,e)];if(this._helper._renderWorldCopies){const c=this.screenPointToMercatorCoordinate(new d.P(0,0)),f=this.screenPointToMercatorCoordinate(new d.P(this._helper._width,0)),y=this.screenPointToMercatorCoordinate(new d.P(this._helper._width,this._helper._height)),T=this.screenPointToMercatorCoordinate(new d.P(0,this._helper._height)),A=Math.floor(Math.min(c.x,f.x,y.x,T.x)),I=Math.floor(Math.max(c.x,f.x,y.x,T.x)),L=1;for(let k=A-L;k<=I+L;k++)k!==0&&n.push(new d.aW(k,e))}return n}getCameraFrustum(){return Zi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const n=this.screenPointToLocation(this.centerPoint,e),c=e?e.getElevationForLngLatZoom(n,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(c)}setLocationAtPoint(e,n){const c=d.ag(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(n,c),y=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,c),T=d.$.fromLngLat(e),A=new d.$(T.x-(f.x-y.x),T.y-(f.y-y.y));this.setCenter(A==null?void 0:A.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,n){return n?this.coordinatePoint(d.$.fromLngLat(e),n.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(d.$.fromLngLat(e))}screenPointToLocation(e,n){var c;return(c=this.screenPointToMercatorCoordinate(e,n))===null||c===void 0?void 0:c.toLngLat()}screenPointToMercatorCoordinate(e,n){if(n){const c=n.pointCoordinate(e);if(c!=null)return c}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,n){const c=n||0,f=[e.x,e.y,0,1],y=[e.x,e.y,1,1];d.at(f,f,this._pixelMatrixInverse),d.at(y,y,this._pixelMatrixInverse);const T=f[3],A=y[3],I=f[1]/T,L=y[1]/A,k=f[2]/T,F=y[2]/A,z=k===F?0:(c-k)/(F-k);return new d.$(d.B.number(f[0]/T,y[0]/A,z)/this.worldSize,d.B.number(I,L,z)/this.worldSize,c)}coordinatePoint(e,n=0,c=this._pixelMatrix){const f=[e.x*this.worldSize,e.y*this.worldSize,n,1];return d.at(f,f,c),new d.P(f[0]/f[3],f[1]/f[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Ce(this));return new Oi().extend(this.screenPointToLocation(new d.P(0,e))).extend(this.screenPointToLocation(new d.P(this._helper._width,e))).extend(this.screenPointToLocation(new d.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new d.P(0,this._helper._height)))}isPointOnMapSurface(e,n){return n?n.pointCoordinate(e)!=null:e.y>this.height/2-Ce(this)}calculatePosMatrix(e,n=!1,c){var f;const y=(f=e.key)!==null&&f!==void 0?f:d.aX(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),T=n?this._alignedPosMatrixCache:this._posMatrixCache;if(T.has(y)){const L=T.get(y);return c?L.f32:L.f64}const A=$(e,this.worldSize);d.N(A,n?this._alignedProjMatrix:this._viewProjMatrix,A);const I={f64:A,f32:new Float32Array(A)};return T.set(y,I),c?I.f32:I.f64}calculateFogMatrix(e){const n=e.key,c=this._fogMatrixCacheF32;if(c.has(n))return c.get(n);const f=$(e,this.worldSize);return d.N(f,this._fogMatrix,f),c.set(n,new Float32Array(f)),c.get(n)}getConstrained(e,n){n=d.ae(+n,this.minZoom,this.maxZoom);const c={center:new d.Q(e.lng,e.lat),zoom:n};let f=this._helper._lngRange;this._helper._renderWorldCopies||f!==null||(f=[-179.9999999999,180-1e-10]);const y=this.tileSize*d.ac(c.zoom);let T=0,A=y,I=0,L=y,k=0,F=0;const{x:z,y:G}=this.size;if(this._helper._latRange){const me=this._helper._latRange;T=d.S(me[1])*y,A=d.S(me[0])*y,A-T<G&&(k=G/(A-T))}f&&(I=d.aL(d.U(f[0])*y,0,y),L=d.aL(d.U(f[1])*y,0,y),L<I&&(L+=y),L-I<z&&(F=z/(L-I)));const{x:Z,y:ne}=un(y,e);let ae,re;const le=Math.max(F||0,k||0);if(le){const me=new d.P(F?(L+I)/2:Z,k?(A+T)/2:ne);return c.center=sr(y,me).wrap(),c.zoom+=d.ah(le),c}if(this._helper._latRange){const me=G/2;ne-me<T&&(re=T+me),ne+me>A&&(re=A-me)}if(f){const me=(I+L)/2;let pe=Z;this._helper._renderWorldCopies&&(pe=d.aL(Z,me-y/2,me+y/2));const ye=z/2;pe-ye<I&&(ae=I+ye),pe+ye>L&&(ae=L-ye)}if(ae!==void 0||re!==void 0){const me=new d.P(ae??Z,re??ne);c.center=sr(y,me).wrap()}return c}calculateCenterFromCameraLngLatAlt(e,n,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,c,f)}_calculateNearFarZIfNeeded(e,n,c){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),y=e-f*this._helper._pixelPerMeter/Math.cos(n),T=f<0?y:e,A=Math.PI/2+this.pitchInRadians,I=d.ab(this.fov)*(Math.abs(Math.cos(d.ab(this.roll)))*this.height+Math.abs(Math.sin(d.ab(this.roll)))*this.width)/this.height*(.5+c.y/this.height),L=Math.sin(I)*T/Math.sin(d.ae(Math.PI-A-I,.01,Math.PI-.01)),k=Ce(this),F=Math.atan(k/this._helper.cameraToCenterDistance),z=d.ab(.75),G=F>z?2*F*(.5+c.y/(2*k)):z,Z=Math.sin(G)*T/Math.sin(d.ae(Math.PI-A-G,.01,Math.PI-.01)),ne=Math.min(L,Z);this._helper._farZ=1.01*(Math.cos(Math.PI/2-n)*ne+T),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,n=un(this.worldSize,this.center),c=n.x,f=n.y;this._helper._pixelPerMeter=d.ag(1,this.center.lat)*this.worldSize;const y=d.ab(Math.min(this.pitch,wr)),T=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(y));let A;this._calculateNearFarZIfNeeded(T,y,e),A=new Float64Array(16),d.aY(A,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),d.an(this._invProjMatrix,A),A[8]=2*-e.x/this._helper._width,A[9]=2*e.y/this._helper._height,this._projectionMatrix=d.aZ(A),d.M(A,A,[1,-1,1]),d.L(A,A,[0,0,-this._helper.cameraToCenterDistance]),d.a_(A,A,-this.rollInRadians),d.a$(A,A,this.pitchInRadians),d.a_(A,A,-this.bearingInRadians),d.L(A,A,[-c,-f,0]),this._mercatorMatrix=d.M([],A,[this.worldSize,this.worldSize,this.worldSize]),d.M(A,A,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=d.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,A),d.L(A,A,[0,0,-this.elevation]),this._viewProjMatrix=A,this._invViewProjMatrix=d.an([],A);const I=[0,0,-1,1];d.at(I,I,this._invViewProjMatrix),this._cameraPosition=[I[0]/I[3],I[1]/I[3],I[2]/I[3]],this._fogMatrix=new Float64Array(16),d.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,T,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,d.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),d.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),d.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),d.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),d.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),d.L(this._fogMatrix,this._fogMatrix,[-c,-f,0]),d.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),d.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=d.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,A);const L=this._helper._width%2/2,k=this._helper._height%2/2,F=Math.cos(this.bearingInRadians),z=Math.sin(-this.bearingInRadians),G=c-Math.round(c)+F*L+z*k,Z=f-Math.round(f)+F*k+z*L,ne=new Float64Array(A);if(d.L(ne,ne,[G>.5?G-1:G,Z>.5?Z-1:Z,0]),this._alignedProjMatrix=ne,A=d.an(new Float64Array(16),this._pixelMatrix),!A)throw new Error("failed to invert matrix");this._pixelMatrixInverse=A,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new d.P(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return d.at(n,n,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=d.ag(1,this.center.lat)*this.worldSize;return X(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,n){const c=d.$.fromLngLat(e),f=[c.x*this.worldSize,c.y*this.worldSize,n,1];return d.at(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(e){const{overscaledTileID:n,aligned:c,applyTerrainMatrix:f}=e,y=this._helper.getMercatorTileCoordinates(n),T=n?this.calculatePosMatrix(n,c,!0):null;let A;return A=n&&n.terrainRttPosMatrix32f&&f?n.terrainRttPosMatrix32f:T||d.b0(),{mainMatrix:A,tileMercatorCoords:y,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:A}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,n,c){return 1}transformLightDirection(e){return d.aQ(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,n,c,f){const y=this.calculatePosMatrix(c);let T;f?(T=[e,n,f(e,n),1],d.at(T,T,y)):(T=[e,n,0,1],uo(T,T,y));const A=T[3];return{point:new d.P(T[0]/A,T[1]/A),signedDistanceFromCamera:A,isOccluded:!1}}populateCache(e){for(const n of e)this.calculatePosMatrix(n)}getMatrixForModel(e,n){const c=d.$.fromLngLat(e,n),f=c.meterInMercatorCoordinateUnits(),y=d.b1();return d.L(y,y,[c.x,c.y,c.z]),d.a_(y,y,Math.PI),d.a$(y,y,Math.PI/2),d.M(y,y,[-f,f,f]),y}getProjectionDataForCustomLayer(e=!0){const n=new d.Y(0,0,0,0,0),c=this.getProjectionData({overscaledTileID:n,applyGlobeMatrix:e}),f=$(n,this.worldSize);d.N(f,this._viewProjMatrix,f),c.tileMercatorCoords=[0,0,1,1];const y=[d.Z,d.Z,this.worldSize/this._helper.pixelsPerMeter],T=d.b2();return d.M(T,f,y),c.fallbackMatrix=T,c.mainMatrix=T,c}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function ma(){d.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ln(g){if(g.useSlerp)if(g.k<1){const e=d.b3(g.startEulerAngles.roll,g.startEulerAngles.pitch,g.startEulerAngles.bearing),n=d.b3(g.endEulerAngles.roll,g.endEulerAngles.pitch,g.endEulerAngles.bearing),c=new Float64Array(4);d.b4(c,e,n,g.k);const f=d.b5(c);g.tr.setRoll(f.roll),g.tr.setPitch(f.pitch),g.tr.setBearing(f.bearing)}else g.tr.setRoll(g.endEulerAngles.roll),g.tr.setPitch(g.endEulerAngles.pitch),g.tr.setBearing(g.endEulerAngles.bearing);else g.tr.setRoll(d.B.number(g.startEulerAngles.roll,g.endEulerAngles.roll,g.k)),g.tr.setPitch(d.B.number(g.startEulerAngles.pitch,g.endEulerAngles.pitch,g.k)),g.tr.setBearing(d.B.number(g.startEulerAngles.bearing,g.endEulerAngles.bearing,g.k))}function Wa(g,e,n,c,f){const y=f.padding,T=un(f.worldSize,n.getNorthWest()),A=un(f.worldSize,n.getNorthEast()),I=un(f.worldSize,n.getSouthEast()),L=un(f.worldSize,n.getSouthWest()),k=d.ab(-c),F=T.rotate(k),z=A.rotate(k),G=I.rotate(k),Z=L.rotate(k),ne=new d.P(Math.max(F.x,z.x,Z.x,G.x),Math.max(F.y,z.y,Z.y,G.y)),ae=new d.P(Math.min(F.x,z.x,Z.x,G.x),Math.min(F.y,z.y,Z.y,G.y)),re=ne.sub(ae),le=(f.width-(y.left+y.right+e.left+e.right))/re.x,me=(f.height-(y.top+y.bottom+e.top+e.bottom))/re.y;if(me<0||le<0)return void ma();const pe=Math.min(d.ah(f.scale*Math.min(le,me)),g.maxZoom),ye=d.P.convert(g.offset),Ee=new d.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(d.ab(c)),be=ye.add(Ee).mult(f.scale/d.ac(pe));return{center:sr(f.worldSize,T.add(I).div(2).sub(be)),zoom:pe,bearing:c}}class Ar{get useGlobeControls(){return!1}handlePanInertia(e,n){return{easingOffset:e,easingCenter:n.center}}handleMapControlsRollPitchBearingZoom(e,n){e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta),e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta)}handleMapControlsPan(e,n,c){e.around.distSqr(n.centerPoint)<.01||n.setLocationAtPoint(c,e.around)}cameraForBoxAndBearing(e,n,c,f,y){return Wa(e,n,c,f,y)}handleJumpToCenterZoom(e,n){e.zoom!==(n.zoom!==void 0?+n.zoom:e.zoom)&&e.setZoom(+n.zoom),n.center!==void 0&&e.setCenter(d.Q.convert(n.center))}handleEaseTo(e,n){const c=e.zoom,f=e.padding,y={roll:e.roll,pitch:e.pitch,bearing:e.bearing},T={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},A=n.zoom!==void 0,I=!e.isPaddingEqual(n.padding);let L=!1;const k=A?+n.zoom:e.zoom;let F=e.centerPoint.add(n.offsetAsPoint);const z=e.screenPointToLocation(F),{center:G,zoom:Z}=e.getConstrained(d.Q.convert(n.center||z),k??c);mo(e,G);const ne=un(e.worldSize,z),ae=un(e.worldSize,G).sub(ne),re=d.ac(Z-c);return L=Z!==c,{easeFunc:le=>{if(L&&e.setZoom(d.B.number(c,Z,le)),d.b6(y,T)||Ln({startEulerAngles:y,endEulerAngles:T,tr:e,k:le,useSlerp:y.roll!=T.roll}),I&&(e.interpolatePadding(f,n.padding,le),F=e.centerPoint.add(n.offsetAsPoint)),n.around)e.setLocationAtPoint(n.around,n.aroundPoint);else{const me=d.ac(e.zoom-c),pe=Z>c?Math.min(2,re):Math.max(.5,re),ye=Math.pow(pe,1-le),Ee=sr(e.worldSize,ne.add(ae.mult(le*ye)).mult(me));e.setLocationAtPoint(e.renderWorldCopies?Ee.wrap():Ee,F)}},isZooming:L,elevationCenter:G}}handleFlyTo(e,n){const c=n.zoom!==void 0,f=e.zoom,y=e.getConstrained(d.Q.convert(n.center||n.locationAtOffset),c?+n.zoom:f),T=y.center,A=y.zoom;mo(e,T);const I=un(e.worldSize,n.locationAtOffset),L=un(e.worldSize,T).sub(I),k=L.mag(),F=d.ac(A-f);let z;if(n.minZoom!==void 0){const G=Math.min(+n.minZoom,f,A),Z=e.getConstrained(T,G).zoom;z=d.ac(Z-f)}return{easeFunc:(G,Z,ne,ae)=>{e.setZoom(G===1?A:f+d.ah(Z));const re=G===1?T:sr(e.worldSize,I.add(L.mult(ne)).mult(Z));e.setLocationAtPoint(e.renderWorldCopies?re.wrap():re,ae)},scaleOfZoom:F,targetCenter:T,scaleOfMinZoom:z,pixelPathLength:k}}}class Di{constructor(e,n,c){this.blendFunction=e,this.blendColor=n,this.mask=c}}Di.Replace=[1,0],Di.disabled=new Di(Di.Replace,d.b7.transparent,[!1,!1,!1,!1]),Di.unblended=new Di(Di.Replace,d.b7.transparent,[!0,!0,!0,!0]),Di.alphaBlended=new Di([1,771],d.b7.transparent,[!0,!0,!0,!0]);const Wi=2305;class ci{constructor(e,n,c){this.enable=e,this.mode=n,this.frontFace=c}}ci.disabled=new ci(!1,1029,Wi),ci.backCCW=new ci(!0,1029,Wi),ci.frontCCW=new ci(!0,1028,Wi);class Zt{constructor(e,n,c){this.func=e,this.mask=n,this.range=c}}Zt.ReadOnly=!1,Zt.ReadWrite=!0,Zt.disabled=new Zt(519,Zt.ReadOnly,[0,1]);const Rs=7680;class ti{constructor(e,n,c,f,y,T){this.test=e,this.ref=n,this.mask=c,this.fail=f,this.depthFail=y,this.pass=T}}ti.disabled=new ti({func:519,mask:0},0,0,Rs,Rs,Rs);const cn=new WeakMap;function wa(g){var e;if(cn.has(g))return cn.get(g);{const n=(e=g.getParameter(g.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return cn.set(g,n),n}}class zu{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const n=e.context,c=n.gl;this._texFormat=c.RGBA,this._texType=c.UNSIGNED_BYTE;const f=new d.aI;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const y=new d.aK;y.emplaceBack(0,1,2),this._fullscreenTriangle=new jo(n.createVertexBuffer(f,ln.members),n.createIndexBuffer(y),d.aJ.simpleSegment(0,0,f.length,y.length)),this._resultBuffer=new Uint8Array(4),n.activeTexture.set(c.TEXTURE1);const T=c.createTexture();c.bindTexture(c.TEXTURE_2D,T),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=n.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(T),wa(c)&&(this._pbo=c.createBuffer(),c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.bufferData(c.PIXEL_PACK_BUFFER,4,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,n){const c=this._updateCount;return this._readbackQueue?c>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():c>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,n),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,n=e.gl;e.activeTexture.set(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,n){const c=this._cachedRenderContext.context,f=c.gl;if(this._bindFramebuffer(),c.viewport.set([0,0,this._texWidth,this._texHeight]),c.clear({color:d.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(c,f.TRIANGLES,Zt.disabled,ti.disabled,Di.unblended,ci.disabled,((y,T)=>({u_input:y,u_output_expected:T}))(e,n),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&wa(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const y=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:y}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&wa(e)){const n=e.clientWaitSync(this._readbackQueue.sync,0,0);if(n===e.WAIT_FAILED)return d.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(n===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=zu._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let n=0;return n+=e[0]/256,n+=e[1]/65536,n+=e[2]/16777216,e[3]<127&&(n=-n),n/128}}const Go=d.Z/128;function Dl(g,e){const n=g.granularity!==void 0?Math.max(g.granularity,1):1,c=n+(g.generateBorders?2:0),f=n+(g.extendToNorthPole||g.generateBorders?1:0)+(g.extendToSouthPole||g.generateBorders?1:0),y=c+1,T=f+1,A=g.generateBorders?-1:0,I=g.generateBorders||g.extendToNorthPole?-1:0,L=n+(g.generateBorders?1:0),k=n+(g.generateBorders||g.extendToSouthPole?1:0),F=y*T,z=c*f*6,G=y*T>65536;if(G&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Z=G||e==="32bit",ne=new Int16Array(2*F);let ae=0;for(let me=I;me<=k;me++)for(let pe=A;pe<=L;pe++){let ye=pe/n*d.Z;pe===-1&&(ye=-64),pe===n+1&&(ye=d.Z+Go);let Ee=me/n*d.Z;me===-1&&(Ee=g.extendToNorthPole?d.b9:-64),me===n+1&&(Ee=g.extendToSouthPole?d.ba:d.Z+Go),ne[ae++]=ye,ne[ae++]=Ee}const re=Z?new Uint32Array(z):new Uint16Array(z);let le=0;for(let me=0;me<f;me++)for(let pe=0;pe<c;pe++){const ye=pe+1+me*y,Ee=pe+(me+1)*y,be=pe+1+(me+1)*y;re[le++]=pe+me*y,re[le++]=Ee,re[le++]=ye,re[le++]=ye,re[le++]=Ee,re[le++]=be}return{vertices:ne.buffer.slice(0),indices:re.buffer.slice(0),uses32bitIndices:Z}}const go=new d.aH({fill:new d.bb(128,2),line:new d.bb(512,0),tile:new d.bb(128,32),stencil:new d.bb(128,1),circle:3});class Zo{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Pn.projectionGlobe}get vertexShaderPreludeCode(){return Pn.projectionMercator.vertexSource}get subdivisionGranularity(){return go}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new zu(e));const n=d.S(this._errorQueryLatitudeDegrees),c=2*Math.atan(Math.exp(Math.PI-n*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(n,c),y=Me.now();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=y);const T=Math.min(Math.max((y-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=d.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,d.bd(T))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,n,c,f,y){const T=(y==="stencil"?go.stencil:go.tile).getGranularityForZoomLevel(n.z);return this._getMesh(e,{granularity:T,generateBorders:c,extendToNorthPole:n.y===0&&f,extendToSouthPole:n.y===(1<<n.z)-1&&f})}_getMesh(e,n){const c=this._getMeshKey(n);if(c in this._tileMeshCache)return this._tileMeshCache[c];const f=function(y,T){const A=Dl(T,"16bit"),I=d.aI.deserialize({arrayBuffer:A.vertices,length:A.vertices.byteLength/2/2}),L=d.aK.deserialize({arrayBuffer:A.indices,length:A.indices.byteLength/2/3});return new jo(y.createVertexBuffer(I,ln.members),y.createIndexBuffer(L),d.aJ.simpleSegment(0,0,I.length,L.length))}(e,n);return this._tileMeshCache[c]=f,f}recalculate(e){}hasTransition(){const e=Me.now();let n=!1;return n=n||(e-this._errorMeasurementLastChangeTime)/1e3<.7,n=n||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,n}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Yo=new d.r({type:new d.D(d.v.projection.type)});class $o extends d.E{constructor(e){super(),this._transitionable=new d.T(Yo),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new d.C(0)),this._mercatorProjection=new po,this._verticalPerspectiveProjection=new Zo}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof d.be){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,n,c,f,y){return this.currentProjection.getMeshFromTileID(e,n,c,f,y)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Fu(g){const e=Qo(g.worldSize,g.center.lat);return 2*Math.PI*e}function Xo(g,e,n,c,f){const y=1/(1<<f),T=e/d.Z*y+c*y,A=d.bg((g/d.Z*y+n*y)*Math.PI*2+Math.PI,2*Math.PI),I=2*Math.atan(Math.exp(Math.PI-T*Math.PI*2))-.5*Math.PI,L=Math.cos(I),k=new Float64Array(3);return k[0]=Math.sin(A)*L,k[1]=Math.sin(I),k[2]=Math.cos(A)*L,k}function Ja(g){return function(e,n){const c=Math.cos(n),f=new Float64Array(3);return f[0]=Math.sin(e)*c,f[1]=Math.sin(n),f[2]=Math.cos(e)*c,f}(g.lng*Math.PI/180,g.lat*Math.PI/180)}function Qo(g,e){return g/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Ko(g){const e=Math.asin(g[1])/Math.PI*180,n=Math.sqrt(g[0]*g[0]+g[2]*g[2]);if(n>1e-6){const c=g[0]/n,f=Math.acos(g[2]/n),y=(c>0?f:-f)/Math.PI*180;return new d.Q(d.aL(y,-180,180),e)}return new d.Q(0,e)}function _o(g){return Math.cos(g*Math.PI/180)}function en(g,e){const n=_o(g),c=_o(e);return d.ah(c/n)}function xc(g,e){const n=g.rotate(e.bearingInRadians),c=e.zoom+en(e.center.lat,0),f=d.bc(1/_o(e.center.lat),1/_o(Math.min(Math.abs(e.center.lat),60)),d.bf(c,7,3,0,1)),y=360/Fu({worldSize:e.worldSize,center:{lat:e.center.lat}});return new d.Q(e.center.lng-n.x*y*f,d.ae(e.center.lat+n.y*y,-85.051129,d.af))}function vc(g){const e=.5*g,n=Math.sin(e),c=Math.cos(e);return Math.log(n+c)-Math.log(c-n)}function Td(g,e,n,c){const f=g.lat+n*c;if(Math.abs(n)>1){const y=(Math.sign(g.lat+n)!==Math.sign(g.lat)?-Math.abs(g.lat):Math.abs(g.lat))*Math.PI/180,T=Math.abs(g.lat+n)*Math.PI/180,A=vc(y+c*(T-y)),I=vc(y),L=vc(T);return new d.Q(g.lng+e*((A-I)/(L-I)),f)}return new d.Q(g.lng+e*c,f)}class Ed{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,n,c,f){const y=`${e.z}_${e.x}_${e.y}`,T=this._cache.get(y);if(T)return T;const A=this._cachePrevious.get(y);if(A)return this._cache.set(y,A),A;const I=this._aabbFactory(e,n,c,f);return this._cache.set(y,I),this._hadAnyChanges=!0,I}}function yn(g,e,n){const c=g-e;return c<0?-c:Math.max(0,c-n)}function Rl(g,e,n,c,f){const y=g-n;let T;return T=y<0?Math.min(-y,1+y-f):y>1?Math.min(Math.max(y-f,0),1-y):0,Math.max(T,yn(e,c,f))}class as{constructor(){this._aabbCache=new Ed(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,n,c,f){const y=1<<c.z,T=1/y,A=c.x/y,I=c.y/y;let L=2;return L=Math.min(L,Rl(e,n,A,I,T)),L=Math.min(L,Rl(e,n,A+.5,-I-T,T)),L=Math.min(L,Rl(e,n,A+.5,2-I-T,T)),L}getWrap(e,n,c){const f=1<<n.z,y=1/f,T=n.x/f,A=yn(e.x,T,y),I=yn(e.x,T-1,y),L=yn(e.x,T+1,y),k=Math.min(A,I,L);return k===L?1:k===I?-1:0}allowVariableZoom(e,n){return Le(e,n)>4}allowWorldCopies(){return!1}getTileAABB(e,n,c,f){return this._aabbCache.getTileAABB(e,n,c,f)}_computeTileAABB(e,n,c,f){if(e.z<=0)return new Ea([-1,-1,-1],[1,1,1]);if(e.z===1)return new Ea([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const y=[Xo(0,0,e.x,e.y,e.z),Xo(d.Z,0,e.x,e.y,e.z),Xo(d.Z,d.Z,e.x,e.y,e.z),Xo(0,d.Z,e.x,e.y,e.z)],T=[1,1,1],A=[-1,-1,-1];for(const I of y)for(let L=0;L<3;L++)T[L]=Math.min(T[L],I[L]),A[L]=Math.max(A[L],I[L]);if(e.y===0||e.y===(1<<e.z)-1){const I=[0,e.y===0?1:-1,0];for(let L=0;L<3;L++)T[L]=Math.min(T[L],I[L]),A[L]=Math.max(A[L],I[L])}return new Ea(T,A)}}}class Wo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,c){return this._helper.interpolatePadding(e,n,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n){this._helper.resize(e,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=d.bk(),this._projectionMatrix=d.b1(),this._globeViewProjMatrix32f=d.b0(),this._globeViewProjMatrixNoCorrection=d.b1(),this._globeViewProjMatrixNoCorrectionInverted=d.b1(),this._globeProjMatrixInverted=d.b1(),this._cameraPosition=d.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Ta({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._coveringTilesDetailsProvider=new as}clone(){const e=new Wo;return e.apply(this),e}apply(e,n){this._globeLatitudeErrorCorrectionRadians=n||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=d.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:n,applyGlobeMatrix:c}=e,f=this._helper.getMercatorTileCoordinates(n);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:c?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const n=this.pitchInRadians,c=this.cameraToCenterDistance/e,f=Math.sin(n)*c,y=Math.cos(n)*c+1,T=1/Math.sqrt(f*f+y*y)*1;let A=-f,I=y;const L=Math.sqrt(A*A+I*I);A/=L,I/=L;const k=[0,A,I];d.bl(k,k,[0,0,0],-this.bearingInRadians),d.bm(k,k,[0,0,0],-1*this.center.lat*Math.PI/180),d.bn(k,k,[0,0,0],this.center.lng*Math.PI/180);const F=1/d.bo(k);return d.aO(k,k,F),[...k,-T*F]}isLocationOccluded(e){return!this.isSurfacePointVisible(Ja(e))}transformLightDirection(e){const n=this._helper._center.lng*Math.PI/180,c=this._helper._center.lat*Math.PI/180,f=Math.cos(c),y=[Math.sin(n)*f,Math.sin(c),Math.cos(n)*f],T=[y[2],0,-y[0]],A=[0,0,0];d.aU(A,T,y),d.aT(T,T),d.aT(A,A);const I=[0,0,0];return d.aT(I,[T[0]*e[0]+A[0]*e[1]+y[0]*e[2],T[1]*e[0]+A[1]*e[1]+y[1]*e[2],T[2]*e[0]+A[2]*e[1]+y[2]*e[2]]),I}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,n,c){const f=function(A,I,L){const k=1/(1<<L.z);return new d.$(A/d.Z*k+L.x*k,I/d.Z*k+L.y*k)}(e,n,c.canonical),y=(T=f.y,[d.bg(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-T*Math.PI*2))-.5*Math.PI]);var T;return this.getCircleRadiusCorrection()/Math.cos(y[1])}projectTileCoordinates(e,n,c,f){const y=c.canonical,T=Xo(e,n,y.x,y.y,y.z),A=1+(f?f(e,n):0)/d.bu,I=[T[0]*A,T[1]*A,T[2]*A,1];d.at(I,I,this._globeViewProjMatrixNoCorrection);const L=this._cachedClippingPlane,k=L[0]*T[0]+L[1]*T[1]+L[2]*T[2]+L[3]<0;return{point:new d.P(I[0]/I[3],I[1]/I[3]),signedDistanceFromCamera:I[3],isOccluded:k}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Qo(this.worldSize,this.center.lat),n=d.b2(),c=d.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),d.aY(n,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;n[8]=2*-f.x/this._helper._width,n[9]=2*f.y/this._helper._height,this._projectionMatrix=d.aZ(n),this._globeProjMatrixInverted=d.b2(),d.an(this._globeProjMatrixInverted,n),d.L(n,n,[0,0,-this.cameraToCenterDistance]),d.a_(n,n,this.rollInRadians),d.a$(n,n,-this.pitchInRadians),d.a_(n,n,this.bearingInRadians),d.L(n,n,[0,0,-e]);const y=d.bh();y[0]=e,y[1]=e,y[2]=e,d.a$(c,n,this.center.lat*Math.PI/180),d.bp(c,c,-this.center.lng*Math.PI/180),d.M(c,c,y),this._globeViewProjMatrixNoCorrection=c,d.a$(n,n,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),d.bp(n,n,-this.center.lng*Math.PI/180),d.M(n,n,y),this._globeViewProjMatrix32f=new Float32Array(n),this._globeViewProjMatrixNoCorrectionInverted=d.b2(),d.an(this._globeViewProjMatrixNoCorrectionInverted,c);const T=d.bh();this._cameraPosition=d.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,d.bl(this._cameraPosition,this._cameraPosition,T,-this.rollInRadians),d.bm(this._cameraPosition,this._cameraPosition,T,this.pitchInRadians),d.bl(this._cameraPosition,this._cameraPosition,T,-this.bearingInRadians),d.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),d.bm(this._cameraPosition,this._cameraPosition,T,-this.center.lat*Math.PI/180),d.bn(this._cameraPosition,this._cameraPosition,T,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const A=d.aZ(this._globeViewProjMatrixNoCorrectionInverted);d.M(A,A,[1,1,-1]),this._cachedFrustum=Zi.fromInvProjectionMatrix(A)}calculateFogMatrix(e){d.w("calculateFogMatrix is not supported on globe projection.");const n=d.b2();return d.ad(n),n}getVisibleUnwrappedCoordinates(e){return[new d.aW(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&d.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){if(!this._globeViewProjMatrixNoCorrection)return 1;const c=Ja(e);d.aO(c,c,1+n/d.bu);const f=d.bk();return d.at(f,[c[0],c[1],c[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(e){}getBounds(){const e=.5*this.width,n=.5*this.height,c=[new d.P(0,0),new d.P(e,0),new d.P(this.width,0),new d.P(this.width,n),new d.P(this.width,this.height),new d.P(e,this.height),new d.P(0,this.height),new d.P(0,n)],f=[];for(const F of c)f.push(this.unprojectScreenPoint(F));let y=0,T=0,A=0,I=0;const L=this.center;for(const F of f){const z=d.bq(L.lng,F.lng),G=d.bq(L.lat,F.lat);z<T&&(T=z),z>y&&(y=z),G<I&&(I=G),G>A&&(A=G)}const k=[L.lng+T,L.lat+I,L.lng+y,L.lat+A];return this.isSurfacePointOnScreen([0,1,0])&&(k[3]=90,k[0]=-180,k[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(k[1]=-90,k[0]=-180,k[2]=180),new Oi(k)}getConstrained(e,n){const c=d.ae(e.lat,-85.051129,d.af),f=d.ae(+n,this.minZoom+en(0,c),this.maxZoom);return{center:new d.Q(e.lng,c),zoom:f}}calculateCenterFromCameraLngLatAlt(e,n,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,c,f)}setLocationAtPoint(e,n){const c=Ja(this.unprojectScreenPoint(n)),f=Ja(e),y=d.bh();d.br(y);const T=d.bh();d.bn(T,c,y,-this.center.lng*Math.PI/180),d.bm(T,T,y,this.center.lat*Math.PI/180);const A=f[0]*f[0]+f[2]*f[2],I=T[0]*T[0];if(A<I)return;const L=Math.sqrt(A-I),k=-L,F=d.bs(f[0],f[2],T[0],L),z=d.bs(f[0],f[2],T[0],k),G=d.bh();d.bn(G,f,y,-F);const Z=d.bs(G[1],G[2],T[1],T[2]),ne=d.bh();d.bn(ne,f,y,-z);const ae=d.bs(ne[1],ne[2],T[1],T[2]),re=.5*Math.PI,le=Z>=-re&&Z<=re,me=ae>=-re&&ae<=re;let pe,ye;if(le&&me){const $e=this.center.lng*Math.PI/180,je=this.center.lat*Math.PI/180;d.bv(F,$e)+d.bv(Z,je)<d.bv(z,$e)+d.bv(ae,je)?(pe=F,ye=Z):(pe=z,ye=ae)}else if(le)pe=F,ye=Z;else{if(!me)return;pe=z,ye=ae}const Ee=pe/Math.PI*180,be=ye/Math.PI*180,Ne=this.center.lat;this.setCenter(new d.Q(Ee,d.ae(be,-90,90))),this.setZoom(this.zoom+en(Ne,this.center.lat))}locationToScreenPoint(e,n){const c=Ja(e);if(n){const f=n.getElevationForLngLatZoom(e,this._helper._tileZoom);d.aO(c,c,1+f/d.bu)}return this._projectSurfacePointToScreen(c)}_projectSurfacePointToScreen(e){const n=d.bk();return d.at(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],new d.P((.5*n[0]+.5)*this.width,(.5*-n[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,n){if(n){const c=n.pointCoordinate(e);if(c)return c}return d.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,n){var c;return(c=this.screenPointToMercatorCoordinate(e,n))===null||c===void 0?void 0:c.toLngLat()}isPointOnMapSurface(e,n){const c=this._cameraPosition,f=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(c,f)}getRayDirectionFromPixel(e){const n=d.bk();n[0]=e.x/this.width*2-1,n[1]=-1*(e.y/this.height*2-1),n[2]=1,n[3]=1,d.at(n,n,this._globeViewProjMatrixNoCorrectionInverted),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3];const c=d.bh();c[0]=n[0]-this._cameraPosition[0],c[1]=n[1]-this._cameraPosition[1],c[2]=n[2]-this._cameraPosition[2];const f=d.bh();return d.aT(f,c),f}isSurfacePointVisible(e){const n=this._cachedClippingPlane;return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const n=d.bk();return d.at(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[0]>-1&&n[0]<1&&n[1]>-1&&n[1]<1&&n[2]>-1&&n[2]<1}rayPlanetIntersection(e,n){const c=d.aV(e,n),f=d.bh(),y=d.bh();d.aO(y,n,c),d.aS(f,e,y);const T=1-d.aV(f,f);if(T<0)return null;const A=d.aV(e,e)-1,I=-c+(c<0?1:-1)*Math.sqrt(T),L=A/I,k=I;return{tMin:Math.min(L,k),tMax:Math.max(L,k)}}unprojectScreenPoint(e){const n=this._cameraPosition,c=this.getRayDirectionFromPixel(e),f=this.rayPlanetIntersection(n,c);if(f){const k=d.bh();d.aP(k,n,[c[0]*f.tMin,c[1]*f.tMin,c[2]*f.tMin]);const F=d.bh();return d.aT(F,k),Ko(F)}const y=this._cachedClippingPlane,T=y[0]*c[0]+y[1]*c[1]+y[2]*c[2],A=-d.bt(y,n)/T,I=d.bh();if(A>0)d.aP(I,n,[c[0]*A,c[1]*A,c[2]*A]);else{const k=d.bh();d.aP(k,n,[2*c[0],2*c[1],2*c[2]]);const F=d.bt(this._cachedClippingPlane,k);d.aS(I,k,[this._cachedClippingPlane[0]*F,this._cachedClippingPlane[1]*F,this._cachedClippingPlane[2]*F])}const L=function(k){const F=d.bh();return F[0]=k[0]*-k[3],F[1]=k[1]*-k[3],F[2]=k[2]*-k[3],{center:F,radius:Math.sqrt(1-k[3]*k[3])}}(y);return Ko(function(k,F,z){const G=d.bh();d.aS(G,z,k);const Z=d.bh();return d.bi(Z,k,G,F/d.bj(G)),Z}(L.center,L.radius,I))}getMatrixForModel(e,n){const c=d.Q.convert(e),f=1/d.bu,y=d.b1();return d.bp(y,y,c.lng/180*Math.PI),d.a$(y,y,-c.lat/180*Math.PI),d.L(y,y,[0,0,1+n/d.bu]),d.a$(y,y,.5*Math.PI),d.M(y,y,[f,f,f]),y}getProjectionDataForCustomLayer(e=!0){const n=this.getProjectionData({overscaledTileID:new d.Y(0,0,0,0,0),applyGlobeMatrix:e});return n.tileMercatorCoords=[0,0,1,1],n}getFastPathSimpleProjectionMatrix(e){}}class Jo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,c){return this._helper.interpolatePadding(e,n,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,c=!0){this._helper.resize(e,n,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,n){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=n,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Ta({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._globeness=1,this._mercatorTransform=new is,this._verticalPerspectiveTransform=new Wo}clone(){const e=new Jo;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const n=this._mercatorTransform.getProjectionData(e),c=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?c.mainMatrix:n.mainMatrix,clippingPlane:c.clippingPlane,tileMercatorCoords:c.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:n.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return d.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return d.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,n,c){const f=this._mercatorTransform.getPitchedTextCorrection(e,n,c),y=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,n,c);return d.bc(f,y,this._globeness)}projectTileCoordinates(e,n,c,f){return this.currentTransform.projectTileCoordinates(e,n,c,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){return this.currentTransform.lngLatToCameraDepth(e,n)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,n){return this.currentTransform.getConstrained(e,n)}calculateCenterFromCameraLngLatAlt(e,n,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,c,f)}setLocationAtPoint(e,n){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,n),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,n),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,n){return this.currentTransform.locationToScreenPoint(e,n)}screenPointToMercatorCoordinate(e,n){return this.currentTransform.screenPointToMercatorCoordinate(e,n)}screenPointToLocation(e,n){return this.currentTransform.screenPointToLocation(e,n)}isPointOnMapSurface(e,n){return this.currentTransform.isPointOnMapSurface(e,n)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,n){return this.currentTransform.getMatrixForModel(e,n)}getProjectionDataForCustomLayer(e=!0){const n=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return n;const c=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return c.fallbackMatrix=n.mainMatrix,c}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Sr{get useGlobeControls(){return!0}handlePanInertia(e,n){const c=xc(e,n);return Math.abs(c.lng-n.center.lng)>180&&(c.lng=n.center.lng+179.5*Math.sign(c.lng-n.center.lng)),{easingCenter:c,easingOffset:new d.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,n){const c=e.around,f=n.screenPointToLocation(c);e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta);const y=n.zoom;e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta);const T=n.zoom-y;if(T===0)return;const A=d.bq(n.center.lng,f.lng),I=A/(Math.abs(A/180)+1),L=d.bq(n.center.lat,f.lat),k=n.getRayDirectionFromPixel(c),F=n.cameraPosition,z=-1*d.aV(F,k),G=d.bh();d.aP(G,F,[k[0]*z,k[1]*z,k[2]*z]);const Z=d.bo(G)-1,ne=Math.exp(.5*-Math.max(Z-.3,0)),ae=Qo(n.worldSize,n.center.lat)/Math.min(n.width,n.height),re=d.bf(ae,.9,.5,1,.25),le=(1-d.ac(-T))*Math.min(ne,re),me=n.center.lat,pe=n.zoom,ye=new d.Q(n.center.lng+I*le,d.ae(n.center.lat+L*le,-85.051129,d.af));n.setLocationAtPoint(f,c);const Ee=n.center,be=d.bf(Math.abs(A),45,85,0,1),Ne=d.bf(ae,.75,.35,0,1),$e=Math.pow(Math.max(be,Ne),.25),je=d.bq(Ee.lng,ye.lng),He=d.bq(Ee.lat,ye.lat);n.setCenter(new d.Q(Ee.lng+je*$e,Ee.lat+He*$e).wrap()),n.setZoom(pe+en(me,n.center.lat))}handleMapControlsPan(e,n,c){if(!e.panDelta)return;const f=n.center.lat,y=n.zoom;n.setCenter(xc(e.panDelta,n).wrap()),n.setZoom(y+en(f,n.center.lat))}cameraForBoxAndBearing(e,n,c,f,y){const T=Wa(e,n,c,f,y),A=n.left/y.width*2-1,I=(y.width-n.right)/y.width*2-1,L=n.top/y.height*-2+1,k=(y.height-n.bottom)/y.height*-2+1,F=d.bq(c.getWest(),c.getEast())<0,z=F?c.getEast():c.getWest(),G=F?c.getWest():c.getEast(),Z=Math.max(c.getNorth(),c.getSouth()),ne=Math.min(c.getNorth(),c.getSouth()),ae=z+.5*d.bq(z,G),re=Z+.5*d.bq(Z,ne),le=y.clone();le.setCenter(T.center),le.setBearing(T.bearing),le.setPitch(0),le.setRoll(0),le.setZoom(T.zoom);const me=le.modelViewProjectionMatrix,pe=[Ja(c.getNorthWest()),Ja(c.getNorthEast()),Ja(c.getSouthWest()),Ja(c.getSouthEast()),Ja(new d.Q(G,re)),Ja(new d.Q(z,re)),Ja(new d.Q(ae,Z)),Ja(new d.Q(ae,ne))],ye=Ja(T.center);let Ee=Number.POSITIVE_INFINITY;for(const be of pe)A<0&&(Ee=Sr.getLesserNonNegativeNonNull(Ee,Sr.solveVectorScale(be,ye,me,"x",A))),I>0&&(Ee=Sr.getLesserNonNegativeNonNull(Ee,Sr.solveVectorScale(be,ye,me,"x",I))),L>0&&(Ee=Sr.getLesserNonNegativeNonNull(Ee,Sr.solveVectorScale(be,ye,me,"y",L))),k<0&&(Ee=Sr.getLesserNonNegativeNonNull(Ee,Sr.solveVectorScale(be,ye,me,"y",k)));if(Number.isFinite(Ee)&&Ee!==0)return T.zoom=le.zoom+d.ah(Ee),T;ma()}handleJumpToCenterZoom(e,n){const c=e.center.lat,f=e.getConstrained(n.center?d.Q.convert(n.center):e.center,e.zoom).center;e.setCenter(f.wrap());const y=n.zoom!==void 0?+n.zoom:e.zoom+en(c,f.lat);e.zoom!==y&&e.setZoom(y)}handleEaseTo(e,n){const c=e.zoom,f=e.center,y=e.padding,T={roll:e.roll,pitch:e.pitch,bearing:e.bearing},A={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},I=n.zoom!==void 0,L=!e.isPaddingEqual(n.padding);let k=!1;const F=n.center?d.Q.convert(n.center):f,z=e.getConstrained(F,c).center;mo(e,z);const G=e.clone();G.setCenter(z),G.setZoom(I?+n.zoom:c+en(f.lat,F.lat)),G.setBearing(n.bearing);const Z=new d.P(d.ae(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),d.ae(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));G.setLocationAtPoint(z,Z);const ne=(n.offset&&n.offsetAsPoint.mag())>0?G.center:z,ae=I?+n.zoom:c+en(f.lat,ne.lat),re=c+en(f.lat,0),le=ae+en(ne.lat,0),me=d.bq(f.lng,ne.lng),pe=d.bq(f.lat,ne.lat),ye=d.ac(le-re);return k=ae!==c,{easeFunc:Ee=>{if(d.b6(T,A)||Ln({startEulerAngles:T,endEulerAngles:A,tr:e,k:Ee,useSlerp:T.roll!=A.roll}),L&&e.interpolatePadding(y,n.padding,Ee),n.around)d.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(n.around,n.aroundPoint);else{const be=le>re?Math.min(2,ye):Math.max(.5,ye),Ne=Math.pow(be,1-Ee),$e=Td(f,me,pe,Ee*Ne);e.setCenter($e.wrap())}if(k){const be=d.B.number(re,le,Ee)+en(0,e.center.lat);e.setZoom(be)}},isZooming:k,elevationCenter:ne}}handleFlyTo(e,n){const c=n.zoom!==void 0,f=e.center,y=e.zoom,T=e.padding,A=!e.isPaddingEqual(n.padding),I=e.getConstrained(d.Q.convert(n.center||n.locationAtOffset),y).center,L=c?+n.zoom:e.zoom+en(e.center.lat,I.lat),k=e.clone();k.setCenter(I),k.setZoom(L),k.setBearing(n.bearing);const F=new d.P(d.ae(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),d.ae(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));k.setLocationAtPoint(I,F);const z=k.center;mo(e,z);const G=function(pe,ye,Ee){const be=Ja(ye),Ne=Ja(Ee),$e=d.aV(be,Ne),je=Math.acos($e),He=Fu(pe);return je/(2*Math.PI)*He}(e,f,z),Z=y+en(f.lat,0),ne=L+en(z.lat,0),ae=d.ac(ne-Z);let re;if(typeof n.minZoom=="number"){const pe=+n.minZoom+en(z.lat,0),ye=Math.min(pe,Z,ne)+en(0,z.lat),Ee=e.getConstrained(z,ye).zoom+en(z.lat,0);re=d.ac(Ee-Z)}const le=d.bq(f.lng,z.lng),me=d.bq(f.lat,z.lat);return{easeFunc:(pe,ye,Ee,be)=>{const Ne=Td(f,le,me,Ee);A&&e.interpolatePadding(T,n.padding,pe);const $e=pe===1?z:Ne;e.setCenter($e.wrap());const je=Z+d.ah(ye);e.setZoom(pe===1?L:je+en(0,$e.lat))},scaleOfZoom:ae,targetCenter:z,scaleOfMinZoom:re,pixelPathLength:G}}static solveVectorScale(e,n,c,f,y){const T=f==="x"?[c[0],c[4],c[8],c[12]]:[c[1],c[5],c[9],c[13]],A=[c[3],c[7],c[11],c[15]],I=e[0]*T[0]+e[1]*T[1]+e[2]*T[2],L=e[0]*A[0]+e[1]*A[1]+e[2]*A[2],k=n[0]*T[0]+n[1]*T[1]+n[2]*T[2],F=n[0]*A[0]+n[1]*A[1]+n[2]*A[2];return k+y*L===I+y*F||A[3]*(I-k)+T[3]*(F-L)+I*F==k*L?null:(k+T[3]-y*F-y*A[3])/(k-I-y*F+y*L)}static getLesserNonNegativeNonNull(e,n){return n!==null&&n>=0&&n<e?n:e}}class eu{constructor(e){this._globe=e,this._mercatorCameraHelper=new Ar,this._verticalPerspectiveCameraHelper=new Sr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,n){return this.currentHelper.handlePanInertia(e,n)}handleMapControlsRollPitchBearingZoom(e,n){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,n)}handleMapControlsPan(e,n,c){this.currentHelper.handleMapControlsPan(e,n,c)}cameraForBoxAndBearing(e,n,c,f,y){return this.currentHelper.cameraForBoxAndBearing(e,n,c,f,y)}handleJumpToCenterZoom(e,n){this.currentHelper.handleJumpToCenterZoom(e,n)}handleEaseTo(e,n){return this.currentHelper.handleEaseTo(e,n)}handleFlyTo(e,n){return this.currentHelper.handleFlyTo(e,n)}}const Tc=(g,e)=>d.x(g,e&&e.filter(n=>n.identifier!=="source.canvas")),wd=d.bw();class wh extends d.E{constructor(e,n={}){super(),this._rtlPluginLoaded=()=>{for(const c in this.sourceCaches){const f=this.sourceCaches[c].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[c].reload()}},this.map=e,this.dispatcher=new aa(Vt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(c,f)=>this.getGlyphs(c,f)),this.dispatcher.registerMessageHandler("GI",(c,f)=>this.getImages(c,f)),this.imageManager=new Ms,this.imageManager.setEventedParent(this),this.glyphManager=new xa(e._requestManager,n.localIdeographFontFamily),this.lineAtlas=new Te(256,512),this.crossTileSymbolIndex=new Bu,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.bx,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",d.by()),_n().on(Ru,this._rtlPluginLoaded),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const f=this.sourceCaches[c.sourceId];if(!f)return;const y=f.getSource();if(y&&y.vectorLayerIds)for(const T in this._layers){const A=this._layers[T];A.source===y.id&&this._validateLayer(A)}})}loadURL(e,n={},c){this.fire(new d.l("dataloading",{dataType:"style"})),n.validate=typeof n.validate!="boolean"||n.validate;const f=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;d.j(f,this._loadStyleRequest).then(T=>{this._loadStyleRequest=null,this._load(T.data,n,c)}).catch(T=>{this._loadStyleRequest=null,T&&!y.signal.aborted&&this.fire(new d.k(T))})}loadJSON(e,n={},c){this.fire(new d.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,Me.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=n.validate!==!1,this._load(e,n,c)}).catch(()=>{})}loadEmpty(){this.fire(new d.l("dataloading",{dataType:"style"})),this._load(wd,{validate:!1})}_load(e,n,c){var f,y;const T=n.transformStyle?n.transformStyle(c,e):e;if(!n.validate||!Tc(this,d.y(T))){this._loaded=!0,this.stylesheet=T;for(const A in T.sources)this.addSource(A,T.sources[A],{validate:!1});T.sprite?this._loadSprite(T.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(T.glyphs),this._createLayers(),this.light=new wt(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new xi(this.stylesheet.sky),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.fire(new d.l("data",{dataType:"style"})),this.fire(new d.l("style.load"))}}_createLayers(){const e=d.bz(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(n=>n.id),this._layers={},this._serializedLayers=null;for(const n of e){const c=d.bA(n);c.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=c}}_loadSprite(e,n=!1,c=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(y,T,A,I){return d._(this,void 0,void 0,function*(){const L=Ut(y),k=A>1?"@2x":"",F={},z={};for(const{id:G,url:Z}of L){const ne=T.transformRequest(Ii(Z,k,".json"),"SpriteJSON");F[G]=d.j(ne,I);const ae=T.transformRequest(Ii(Z,k,".png"),"SpriteImage");z[G]=Mt.getImage(ae,I)}return yield Promise.all([...Object.values(F),...Object.values(z)]),function(G,Z){return d._(this,void 0,void 0,function*(){const ne={};for(const ae in G){ne[ae]={};const re=Me.getImageCanvasContext((yield Z[ae]).data),le=(yield G[ae]).data;for(const me in le){const{width:pe,height:ye,x:Ee,y:be,sdf:Ne,pixelRatio:$e,stretchX:je,stretchY:He,content:Ge,textFitWidth:ft,textFitHeight:ht}=le[me];ne[ae][me]={data:null,pixelRatio:$e,sdf:Ne,stretchX:je,stretchY:He,content:Ge,textFitWidth:ft,textFitHeight:ht,spriteData:{width:pe,height:ye,x:Ee,y:be,context:re}}}}return ne})}(F,z)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(y=>{if(this._spriteRequest=null,y)for(const T in y){this._spritesImagesIds[T]=[];const A=this._spritesImagesIds[T]?this._spritesImagesIds[T].filter(I=>!(I in y)):[];for(const I of A)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in y[T]){const L=T==="default"?I:`${T}:${I}`;this._spritesImagesIds[T].push(L),L in this.imageManager.images?this.imageManager.updateImage(L,y[T][I],!1):this.imageManager.addImage(L,y[T][I]),n&&(this._changedImages[L]=!0)}}}).catch(y=>{this._spriteRequest=null,f=y,this.fire(new d.k(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),n&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"})),c&&c(f)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"}))}_validateLayer(e){const n=this.sourceCaches[e.source];if(!n)return;const c=e.sourceLayer;if(!c)return;const f=n.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(c)===-1)&&this.fire(new d.k(new Error(`Source layer "${c}" does not exist on source "${f.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,n=!1){const c=this._serializedAllLayers();if(!e||e.length===0)return Object.values(n?d.bB(c):c);const f=[];for(const y of e)if(c[y]){const T=n?d.bB(c[y]):c[y];f.push(T)}return f}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const n=Object.keys(this._layers);for(const c of n){const f=this._layers[c];f.type!=="custom"&&(e[c]=f.serialize())}return e}hasTransitions(){var e,n,c;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((n=this.sky)===null||n===void 0)&&n.hasTransition()||!((c=this.projection)===null||c===void 0)&&c.hasTransition())return!0;for(const f in this.sourceCaches)if(this.sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const n=this._changed;if(n){const f=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(f.length||y.length)&&this._updateWorkerLayers(f,y);for(const T in this._updatedSources){const A=this._updatedSources[T];if(A==="reload")this._reloadSource(T);else{if(A!=="clear")throw new Error(`Invalid action ${A}`);this._clearSource(T)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const c={};for(const f in this.sourceCaches){const y=this.sourceCaches[f];c[f]=y.used,y.used=!1}for(const f of this._order){const y=this._layers[f];y.recalculate(e,this._availableImages),!y.isHidden(e.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const f in c){const y=this.sourceCaches[f];!!c[f]!=!!y.used&&y.fire(new d.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,n&&this.fire(new d.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,n){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:n})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,n={}){var c;this._checkLoaded();const f=this.serialize();if(e=n.transformStyle?n.transformStyle(f,e):e,((c=n.validate)===null||c===void 0||c)&&Tc(this,d.y(e)))return!1;(e=d.bB(e)).layers=d.bz(e.layers);const y=d.bC(f,e),T=this._getOperationsToPerform(y);if(T.unimplemented.length>0)throw new Error(`Unimplemented: ${T.unimplemented.join(", ")}.`);if(T.operations.length===0)return!1;for(const A of T.operations)A();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const n=[],c=[];for(const f of e)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":n.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":n.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":n.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":n.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":n.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":n.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":n.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":n.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":n.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":n.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":n.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":n.push(()=>this.setSprite.apply(this,f.args));break;case"setTerrain":n.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setSky":n.push(()=>this.setSky.apply(this,f.args));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setTransition":n.push(()=>{});break;default:c.push(f.command)}return{operations:n,unimplemented:c}}addImage(e,n){if(this.getImage(e))return this.fire(new d.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(e,n){this.imageManager.updateImage(e,n)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new d.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,c={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(d.y.source,`sources.${e}`,n,null,c))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const f=this.sourceCaches[e]=new Re(e,n,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:e})),f.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===e)return this.fire(new d.k(new Error(`Source "${e}" cannot be removed while layer "${c}" is using it.`)));const n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new d.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,n){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const c=this.sourceCaches[e].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(n),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,n,c={}){this._checkLoaded();const f=e.id;if(this.getLayer(f))return void this.fire(new d.k(new Error(`Layer "${f}" already exists on this map.`)));let y;if(e.type==="custom"){if(Tc(this,d.bD(e)))return;y=d.bA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(f,e.source),e=d.bB(e),e=d.e(e,{source:f})),this._validate(d.y.layer,`layers.${f}`,e,{arrayIndex:-1},c))return;y=d.bA(e),this._validateLayer(y),y.setEventedParent(this,{layer:{id:f}})}const T=n?this._order.indexOf(n):this._order.length;if(n&&T===-1)this.fire(new d.k(new Error(`Cannot add layer "${f}" before non-existing layer "${n}".`)));else{if(this._order.splice(T,0,f),this._layerOrderChanged=!0,this._layers[f]=y,this._removedLayers[f]&&y.source&&y.type!=="custom"){const A=this._removedLayers[f];delete this._removedLayers[f],A.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new d.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const c=this._order.indexOf(e);this._order.splice(c,1);const f=n?this._order.indexOf(n):this._order.length;n&&f===-1?this.fire(new d.k(new Error(`Cannot move layer "${e}" before non-existing layer "${n}".`))):(this._order.splice(f,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new d.k(new Error(`Cannot remove non-existing layer "${e}".`)));n.setEventedParent(null);const c=this._order.indexOf(e);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,n,c){this._checkLoaded();const f=this.getLayer(e);f?f.minzoom===n&&f.maxzoom===c||(n!=null&&(f.minzoom=n),c!=null&&(f.maxzoom=c),this._updateLayer(f)):this.fire(new d.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,n,c={}){this._checkLoaded();const f=this.getLayer(e);if(f){if(!d.bE(f.filter,n))return n==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(d.y.filter,`layers.${f.id}.filter`,n,null,c)||(f.filter=d.bB(n),this._updateLayer(f)))}else this.fire(new d.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return d.bB(this.getLayer(e).filter)}setLayoutProperty(e,n,c,f={}){this._checkLoaded();const y=this.getLayer(e);y?d.bE(y.getLayoutProperty(n),c)||(y.setLayoutProperty(n,c,f),this._updateLayer(y)):this.fire(new d.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,n){const c=this.getLayer(e);if(c)return c.getLayoutProperty(n);this.fire(new d.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,n,c,f={}){this._checkLoaded();const y=this.getLayer(e);y?d.bE(y.getPaintProperty(n),c)||(y.setPaintProperty(n,c,f)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new d.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,n){return this.getLayer(e).getPaintProperty(n)}setFeatureState(e,n){this._checkLoaded();const c=e.source,f=e.sourceLayer,y=this.sourceCaches[c];if(y===void 0)return void this.fire(new d.k(new Error(`The source '${c}' does not exist in the map's style.`)));const T=y.getSource().type;T==="geojson"&&f?this.fire(new d.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):T!=="vector"||f?(e.id===void 0&&this.fire(new d.k(new Error("The feature id parameter must be provided."))),y.setFeatureState(f,e.id,n)):this.fire(new d.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,n){this._checkLoaded();const c=e.source,f=this.sourceCaches[c];if(f===void 0)return void this.fire(new d.k(new Error(`The source '${c}' does not exist in the map's style.`)));const y=f.getSource().type,T=y==="vector"?e.sourceLayer:void 0;y!=="vector"||T?n&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new d.k(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(T,e.id,n):this.fire(new d.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const n=e.source,c=e.sourceLayer,f=this.sourceCaches[n];if(f!==void 0)return f.getSource().type!=="vector"||c?(e.id===void 0&&this.fire(new d.k(new Error("The feature id parameter must be provided."))),f.getFeatureState(c,e.id)):void this.fire(new d.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new d.k(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return d.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=d.bF(this.sourceCaches,y=>y.serialize()),n=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,f=this.stylesheet;return d.bG({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:e,layers:n,terrain:c},y=>y!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const n=T=>this._layers[T].type==="fill-extrusion",c={},f=[];for(let T=this._order.length-1;T>=0;T--){const A=this._order[T];if(n(A)){c[A]=T;for(const I of e){const L=I[A];if(L)for(const k of L)f.push(k)}}}f.sort((T,A)=>A.intersectionZ-T.intersectionZ);const y=[];for(let T=this._order.length-1;T>=0;T--){const A=this._order[T];if(n(A))for(let I=f.length-1;I>=0;I--){const L=f[I].feature;if(c[L.layer.id]<T)break;y.push(L),f.pop()}else for(const I of e){const L=I[A];if(L)for(const k of L)y.push(k.feature)}}return y}queryRenderedFeatures(e,n,c){n&&n.filter&&this._validate(d.y.filter,"queryRenderedFeatures.filter",n.filter,null,n);const f={};if(n&&n.layers){if(!(Array.isArray(n.layers)||n.layers instanceof Set))return this.fire(new d.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const L of n.layers){const k=this._layers[L];if(!k)return this.fire(new d.k(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];f[k.source]=!0}}const y=[];n.availableImages=this._availableImages;const T=this._serializedAllLayers(),A=n.layers instanceof Set?n.layers:Array.isArray(n.layers)?new Set(n.layers):null,I=Object.assign(Object.assign({},n),{layers:A});for(const L in this.sourceCaches)n.layers&&!f[L]||y.push(Bo(this.sourceCaches[L],this._layers,T,e,I,c,this.map.terrain?(k,F,z)=>this.map.terrain.getElevation(k,F,z):void 0));return this.placement&&y.push(function(L,k,F,z,G,Z,ne){const ae={},re=Z.queryRenderedSymbols(z),le=[];for(const me of Object.keys(re).map(Number))le.push(ne[me]);le.sort(gn);for(const me of le){const pe=me.featureIndex.lookupSymbolFeatures(re[me.bucketInstanceId],k,me.bucketIndex,me.sourceLayerIndex,G.filter,G.layers,G.availableImages,L);for(const ye in pe){const Ee=ae[ye]=ae[ye]||[],be=pe[ye];be.sort((Ne,$e)=>{const je=me.featureSortOrder;if(je){const He=je.indexOf(Ne.featureIndex);return je.indexOf($e.featureIndex)-He}return $e.featureIndex-Ne.featureIndex});for(const Ne of be)Ee.push(Ne)}}return function(me,pe,ye){for(const Ee in me)for(const be of me[Ee])Rn(be,ye[pe[Ee].source]);return me}(ae,L,F)}(this._layers,T,this.sourceCaches,e,I,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(e,n){n&&n.filter&&this._validate(d.y.filter,"querySourceFeatures.filter",n.filter,null,n);const c=this.sourceCaches[e];return c?function(f,y){const T=f.getRenderableIds().map(L=>f.getTileByID(L)),A=[],I={};for(let L=0;L<T.length;L++){const k=T[L],F=k.tileID.canonical.key;I[F]||(I[F]=!0,k.querySourceFeatures(A,y))}return A}(c,n):[]}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();const c=this.light.getLight();let f=!1;for(const T in e)if(!d.bE(e[T],c[T])){f=!0;break}if(!f)return;const y={now:Me.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(y)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,n={}){this._checkLoaded();const c=this.getSky();let f=!1;if(!e&&!c)return;if(e&&!c)f=!0;else if(!e&&c)f=!0;else for(const T in e)if(!d.bE(e[T],c[T])){f=!0;break}if(!f)return;const y={now:Me.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,n),this.sky.updateTransitions(y)}_setProjectionInternal(e){const n=function(c){if(Array.isArray(c)){const f=new $o({type:c});return{projection:f,transform:new Jo,cameraHelper:new eu(f)}}switch(c){case"mercator":return{projection:new po,transform:new is,cameraHelper:new Ar};case"globe":{const f=new $o({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:f,transform:new Jo,cameraHelper:new eu(f)}}case"vertical-perspective":return{projection:new Zo,transform:new Wo,cameraHelper:new Sr};default:return d.w(`Unknown projection name: ${c}. Falling back to mercator projection.`),{projection:new po,transform:new is,cameraHelper:new Ar}}}(e);this.projection=n.projection,this.map.migrateProjection(n.transform,n.cameraHelper);for(const c in this.sourceCaches)this.sourceCaches[c].reload()}_validate(e,n,c,f,y={}){return(!y||y.validate!==!1)&&Tc(this,e.call(d.y,d.e({key:n,style:this.serialize(),value:c,styleSpec:d.v},f)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),_n().off(Ru,this._rtlPluginLoaded);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this.sourceCaches){const c=this.sourceCaches[n];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const n in this.sourceCaches)this.sourceCaches[n].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,n,c,f,y=!1){let T=!1,A=!1;const I={};for(const L of this._order){const k=this._layers[L];if(k.type!=="symbol")continue;if(!I[k.source]){const z=this.sourceCaches[k.source];I[k.source]=z.getRenderableIds(!0).map(G=>z.getTileByID(G)).sort((G,Z)=>Z.tileID.overscaledZ-G.tileID.overscaledZ||(G.tileID.isLessThan(Z.tileID)?-1:1))}const F=this.crossTileSymbolIndex.addLayer(k,I[k.source],e.center.lng);T=T||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Me.now(),e.zoom))&&(this.pauseablePlacement=new bc(e,this.map.terrain,this._order,y,n,c,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Me.now()),A=!0),T&&this.pauseablePlacement.placement.setStale()),A||T)for(const L of this._order){const k=this._layers[L];k.type==="symbol"&&this.placement.updateLayerOpacities(k,I[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Me.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,n){return d._(this,void 0,void 0,function*(){const c=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[n.source];return f&&f.setDependencies(n.tileID.key,n.type,n.icons),c})}getGlyphs(e,n){return d._(this,void 0,void 0,function*(){const c=yield this.glyphManager.getGlyphs(n.stacks),f=this.sourceCaches[n.source];return f&&f.setDependencies(n.tileID.key,n.type,[""]),c})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,n={}){this._checkLoaded(),e&&this._validate(d.y.glyphs,"glyphs",e,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,n,c={},f){this._checkLoaded();const y=[{id:e,url:n}],T=[...Ut(this.stylesheet.sprite),...y];this._validate(d.y.sprite,"sprite",T,null,c)||(this.stylesheet.sprite=T,this._loadSprite(y,!0,f))}removeSprite(e){this._checkLoaded();const n=Ut(this.stylesheet.sprite);if(n.find(c=>c.id===e)){if(this._spritesImagesIds[e])for(const c of this._spritesImagesIds[e])this.imageManager.removeImage(c),this._changedImages[c]=!0;n.splice(n.findIndex(c=>c.id===e),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"}))}else this.fire(new d.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Ut(this.stylesheet.sprite)}setSprite(e,n={},c){this._checkLoaded(),e&&this._validate(d.y.sprite,"sprite",e,null,n)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,c):(this._unloadSprite(),c&&c(null)))}}var Uf=d.aG([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Hf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,n,c,f,y,T,A,I,L){this.context=e;let k=this.boundPaintVertexBuffers.length!==f.length;for(let F=0;!k&&F<f.length;F++)this.boundPaintVertexBuffers[F]!==f[F]&&(k=!0);!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==c||k||this.boundIndexBuffer!==y||this.boundVertexOffset!==T||this.boundDynamicVertexBuffer!==A||this.boundDynamicVertexBuffer2!==I||this.boundDynamicVertexBuffer3!==L?this.freshBind(n,c,f,y,T,A,I,L):(e.bindVertexArray.set(this.vao),A&&A.bind(),y&&y.dynamicDraw&&y.bind(),I&&I.bind(),L&&L.bind())}freshBind(e,n,c,f,y,T,A,I){const L=e.numAttributes,k=this.context,F=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=f,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=T,this.boundDynamicVertexBuffer2=A,this.boundDynamicVertexBuffer3=I,n.enableAttributes(F,e);for(const z of c)z.enableAttributes(F,e);T&&T.enableAttributes(F,e),A&&A.enableAttributes(F,e),I&&I.enableAttributes(F,e),n.bind(),n.setVertexAttribPointers(F,e,y);for(const z of c)z.bind(),z.setVertexAttribPointers(F,e,y);T&&(T.bind(),T.setVertexAttribPointers(F,e,y)),f&&f.bind(),A&&(A.bind(),A.setVertexAttribPointers(F,e,y)),I&&(I.bind(),I.setVertexAttribPointers(F,e,y)),k.currentNumAttributes=L}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const jf=(g,e,n,c,f)=>({u_texture:0,u_ele_delta:g,u_fog_matrix:e,u_fog_color:n?n.properties.get("fog-color"):d.b7.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:n?n.calculateFogBlendOpacity(c):0,u_horizon_color:n?n.properties.get("horizon-color"):d.b7.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),Ec={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Uu(g){const e=[];for(let n=0;n<g.length;n++){if(g[n]===null)continue;const c=g[n].split(" ");e.push(c.pop())}return e}class wc{constructor(e,n,c,f,y,T,A,I,L=[]){const k=e.gl;this.program=k.createProgram();const F=Uu(n.staticAttributes),z=c?c.getBinderAttributes():[],G=F.concat(z),Z=Pn.prelude.staticUniforms?Uu(Pn.prelude.staticUniforms):[],ne=A.staticUniforms?Uu(A.staticUniforms):[],ae=n.staticUniforms?Uu(n.staticUniforms):[],re=c?c.getBinderUniforms():[],le=Z.concat(ne).concat(ae).concat(re),me=[];for(const je of le)me.indexOf(je)<0&&me.push(je);const pe=c?c.defines():[];wa(k)&&pe.unshift("#version 300 es"),y&&pe.push("#define OVERDRAW_INSPECTOR;"),T&&pe.push("#define TERRAIN3D;"),I&&pe.push(I),L&&pe.push(...L);let ye=pe.concat(Pn.prelude.fragmentSource,A.fragmentSource,n.fragmentSource).join(`
`),Ee=pe.concat(Pn.prelude.vertexSource,A.vertexSource,n.vertexSource).join(`
`);wa(k)||(ye=function(je){return je.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(ye),Ee=function(je){return je.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Ee));const be=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(be,ye),k.compileShader(be),!k.getShaderParameter(be,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(be)}`);k.attachShader(this.program,be);const Ne=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(Ne,Ee),k.compileShader(Ne),!k.getShaderParameter(Ne,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(Ne)}`);k.attachShader(this.program,Ne),this.attributes={};const $e={};this.numAttributes=G.length;for(let je=0;je<this.numAttributes;je++)G[je]&&(k.bindAttribLocation(this.program,je,G[je]),this.attributes[G[je]]=je);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(Ne),k.deleteShader(be);for(let je=0;je<me.length;je++){const He=me[je];if(He&&!$e[He]){const Ge=k.getUniformLocation(this.program,He);Ge&&($e[He]=Ge)}}this.fixedUniforms=f(e,$e),this.terrainUniforms=((je,He)=>({u_depth:new d.bH(je,He.u_depth),u_terrain:new d.bH(je,He.u_terrain),u_terrain_dim:new d.b8(je,He.u_terrain_dim),u_terrain_matrix:new d.bJ(je,He.u_terrain_matrix),u_terrain_unpack:new d.bK(je,He.u_terrain_unpack),u_terrain_exaggeration:new d.b8(je,He.u_terrain_exaggeration)}))(e,$e),this.projectionUniforms=((je,He)=>({u_projection_matrix:new d.bJ(je,He.u_projection_matrix),u_projection_tile_mercator_coords:new d.bK(je,He.u_projection_tile_mercator_coords),u_projection_clipping_plane:new d.bK(je,He.u_projection_clipping_plane),u_projection_transition:new d.b8(je,He.u_projection_transition),u_projection_fallback_matrix:new d.bJ(je,He.u_projection_fallback_matrix)}))(e,$e),this.binderUniforms=c?c.getUniforms(e,$e):[]}draw(e,n,c,f,y,T,A,I,L,k,F,z,G,Z,ne,ae,re,le,me){const pe=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(c),e.setStencilMode(f),e.setColorMode(y),e.setCullFace(T),I){e.activeTexture.set(pe.TEXTURE2),pe.bindTexture(pe.TEXTURE_2D,I.depthTexture),e.activeTexture.set(pe.TEXTURE3),pe.bindTexture(pe.TEXTURE_2D,I.texture);for(const Ee in this.terrainUniforms)this.terrainUniforms[Ee].set(I[Ee])}if(L)for(const Ee in L)this.projectionUniforms[Ec[Ee]].set(L[Ee]);if(A)for(const Ee in this.fixedUniforms)this.fixedUniforms[Ee].set(A[Ee]);ae&&ae.setUniforms(e,this.binderUniforms,Z,{zoom:ne});let ye=0;switch(n){case pe.LINES:ye=2;break;case pe.TRIANGLES:ye=3;break;case pe.LINE_STRIP:ye=1}for(const Ee of G.get()){const be=Ee.vaos||(Ee.vaos={});(be[k]||(be[k]=new Hf)).bind(e,this,F,ae?ae.getPaintVertexBuffers():[],z,Ee.vertexOffset,re,le,me),pe.drawElements(n,Ee.primitiveLength*ye,pe.UNSIGNED_SHORT,Ee.primitiveOffset*ye*2)}}}function Ac(g,e,n){const c=1/d.az(n,1,e.transform.tileZoom),f=Math.pow(2,n.tileID.overscaledZ),y=n.tileSize*Math.pow(2,e.transform.tileZoom)/f,T=y*(n.tileID.canonical.x+n.tileID.wrap*f),A=y*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[c,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[T>>16,A>>16],u_pixel_coord_lower:[65535&T,65535&A]}}const Sc=(g,e,n,c)=>{const f=g.style.light,y=f.properties.get("position"),T=[y.x,y.y,y.z],A=d.bN();f.properties.get("anchor")==="viewport"&&d.bO(A,g.transform.bearingInRadians),d.bP(T,T,A);const I=g.transform.transformLightDirection(T),L=f.properties.get("color");return{u_lightpos:T,u_lightpos_globe:I,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[L.r,L.g,L.b],u_vertical_gradient:+e,u_opacity:n,u_fill_translate:c}},Cr=(g,e,n,c,f,y,T)=>d.e(Sc(g,e,n,c),Ac(y,g,T),{u_height_factor:-Math.pow(2,f.overscaledZ)/T.tileSize/8}),Hu=(g,e,n,c)=>d.e(Ac(e,g,n),{u_fill_translate:c}),Ah=(g,e)=>({u_world:g,u_fill_translate:e}),ju=(g,e,n,c,f)=>d.e(Hu(g,e,n,f),{u_world:c}),qu=(g,e,n,c,f)=>{const y=g.transform;let T,A,I=0;if(n.paint.get("circle-pitch-alignment")==="map"){const L=d.az(e,1,y.zoom);T=!0,A=[L,L],I=L/(d.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*f}else T=!1,A=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+T,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:A,u_globe_extrude_scale:I,u_translate:c}},Ad=g=>({u_pixel_extrude_scale:[1/g.width,1/g.height]}),Pl=g=>({u_viewport_size:[g.width,g.height]}),Sh=(g,e=1)=>({u_color:g,u_overlay:0,u_overlay_scale:e}),Mr=(g,e,n,c)=>{const f=d.az(g,1,e)/(d.Z*Math.pow(2,g.tileID.overscaledZ))*2*Math.PI*c;return{u_extrude_scale:d.az(g,1,e),u_intensity:n,u_globe_extrude_scale:f}},Sd=(g,e,n,c)=>{const f=d.K();d.bQ(f,0,g.width,g.height,0,0,1);const y=g.context.gl;return{u_matrix:f,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:n,u_color_ramp:c,u_opacity:e.paint.get("heatmap-opacity")}},Cd=(g,e,n)=>{const c=n.paint.get("hillshade-accent-color");let f;switch(n.paint.get("hillshade-method")){case"basic":f=4;break;case"combined":f=1;break;case"igor":f=2;break;case"multidirectional":f=3;break;default:f=0}const y=n.getIlluminationProperties();for(let T=0;T<y.directionRadians.length;T++)n.paint.get("hillshade-illumination-anchor")==="viewport"&&(y.directionRadians[T]+=g.transform.bearingInRadians);return{u_image:0,u_latrange:Ch(0,e.tileID),u_exaggeration:n.paint.get("hillshade-exaggeration"),u_altitudes:y.altitudeRadians,u_azimuths:y.directionRadians,u_accent:c,u_method:f,u_highlights:y.highlightColor,u_shadows:y.shadowColor}},qf=(g,e)=>{const n=e.stride,c=d.K();return d.bQ(c,0,d.Z,-8192,0,0,1),d.L(c,c,[0,-8192,0]),{u_matrix:c,u_image:1,u_dimension:[n,n],u_zoom:g.overscaledZ,u_unpack:e.getUnpackVector()}};function Ch(g,e){const n=Math.pow(2,e.canonical.z),c=e.canonical.y;return[new d.$(0,c/n).toLngLat().lat,new d.$(0,(c+1)/n).toLngLat().lat]}const Vu=(g,e,n,c)=>{const f=g.transform;return{u_translation:Ps(g,e,n),u_ratio:c/d.az(e,1,f.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},Gu=(g,e,n,c,f)=>d.e(Vu(g,e,n,c),{u_image:0,u_image_height:f}),Zu=(g,e,n,c,f)=>{const y=g.transform,T=Yu(e,y);return{u_translation:Ps(g,e,n),u_texsize:e.imageAtlasTexture.size,u_ratio:c/d.az(e,1,y.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[T,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Md=(g,e,n,c,f,y)=>{const T=g.lineAtlas,A=Yu(e,g.transform),I=n.layout.get("line-cap")==="round",L=T.getDash(f.from,I),k=T.getDash(f.to,I),F=L.width*y.fromScale,z=k.width*y.toScale;return d.e(Vu(g,e,n,c),{u_patternscale_a:[A/F,-L.height/2],u_patternscale_b:[A/z,-k.height/2],u_sdfgamma:T.width/(256*Math.min(F,z)*g.pixelRatio)/2,u_image:0,u_tex_y_a:L.y,u_tex_y_b:k.y,u_mix:y.t})};function Yu(g,e){return 1/d.az(g,1,e.tileZoom)}function Ps(g,e,n){return d.aA(g.transform,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const Mh=(g,e,n,c,f)=>{return{u_tl_parent:g,u_scale_parent:e,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(T=c.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(y=c.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:Cc(c.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var y,T};function Cc(g){g*=Math.PI/180;const e=Math.sin(g),n=Math.cos(g);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const yo=(g,e,n,c,f,y,T,A,I,L,k,F,z)=>{const G=T.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_pitch:G.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:G.width/G.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_label_plane_matrix:A,u_coord_matrix:I,u_is_text:+k,u_pitch_with_map:+c,u_is_along_line:f,u_is_variable_anchor:y,u_texsize:F,u_texture:0,u_translation:L,u_pitched_scale:z}},Ih=(g,e,n,c,f,y,T,A,I,L,k,F,z,G)=>{const Z=T.transform;return d.e(yo(g,e,n,c,f,y,T,A,I,L,k,F,G),{u_gamma_scale:c?Math.cos(Z.pitch*Math.PI/180)*Z.cameraToCenterDistance:1,u_device_pixel_ratio:T.pixelRatio,u_is_halo:1})},Ll=(g,e,n,c,f,y,T,A,I,L,k,F,z)=>d.e(Ih(g,e,n,c,f,y,T,A,I,L,!0,k,0,z),{u_texsize_icon:F,u_texture_icon:1}),Id=(g,e)=>({u_opacity:g,u_color:e}),Vf=(g,e,n,c,f)=>d.e(function(y,T,A,I){const L=A.imageManager.getPattern(y.from.toString()),k=A.imageManager.getPattern(y.to.toString()),{width:F,height:z}=A.imageManager.getPixelSize(),G=Math.pow(2,I.tileID.overscaledZ),Z=I.tileSize*Math.pow(2,A.transform.tileZoom)/G,ne=Z*(I.tileID.canonical.x+I.tileID.wrap*G),ae=Z*I.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:L.tl,u_pattern_br_a:L.br,u_pattern_tl_b:k.tl,u_pattern_br_b:k.br,u_texsize:[F,z],u_mix:T.t,u_pattern_size_a:L.displaySize,u_pattern_size_b:k.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/d.az(I,1,A.transform.tileZoom),u_pixel_coord_upper:[ne>>16,ae>>16],u_pixel_coord_lower:[65535&ne,65535&ae]}}(n,f,e,c),{u_opacity:g}),Dh=(g,e)=>{},Dd={fillExtrusion:(g,e)=>({u_lightpos:new d.bL(g,e.u_lightpos),u_lightpos_globe:new d.bL(g,e.u_lightpos_globe),u_lightintensity:new d.b8(g,e.u_lightintensity),u_lightcolor:new d.bL(g,e.u_lightcolor),u_vertical_gradient:new d.b8(g,e.u_vertical_gradient),u_opacity:new d.b8(g,e.u_opacity),u_fill_translate:new d.bM(g,e.u_fill_translate)}),fillExtrusionPattern:(g,e)=>({u_lightpos:new d.bL(g,e.u_lightpos),u_lightpos_globe:new d.bL(g,e.u_lightpos_globe),u_lightintensity:new d.b8(g,e.u_lightintensity),u_lightcolor:new d.bL(g,e.u_lightcolor),u_vertical_gradient:new d.b8(g,e.u_vertical_gradient),u_height_factor:new d.b8(g,e.u_height_factor),u_opacity:new d.b8(g,e.u_opacity),u_fill_translate:new d.bM(g,e.u_fill_translate),u_image:new d.bH(g,e.u_image),u_texsize:new d.bM(g,e.u_texsize),u_pixel_coord_upper:new d.bM(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bM(g,e.u_pixel_coord_lower),u_scale:new d.bL(g,e.u_scale),u_fade:new d.b8(g,e.u_fade)}),fill:(g,e)=>({u_fill_translate:new d.bM(g,e.u_fill_translate)}),fillPattern:(g,e)=>({u_image:new d.bH(g,e.u_image),u_texsize:new d.bM(g,e.u_texsize),u_pixel_coord_upper:new d.bM(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bM(g,e.u_pixel_coord_lower),u_scale:new d.bL(g,e.u_scale),u_fade:new d.b8(g,e.u_fade),u_fill_translate:new d.bM(g,e.u_fill_translate)}),fillOutline:(g,e)=>({u_world:new d.bM(g,e.u_world),u_fill_translate:new d.bM(g,e.u_fill_translate)}),fillOutlinePattern:(g,e)=>({u_world:new d.bM(g,e.u_world),u_image:new d.bH(g,e.u_image),u_texsize:new d.bM(g,e.u_texsize),u_pixel_coord_upper:new d.bM(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bM(g,e.u_pixel_coord_lower),u_scale:new d.bL(g,e.u_scale),u_fade:new d.b8(g,e.u_fade),u_fill_translate:new d.bM(g,e.u_fill_translate)}),circle:(g,e)=>({u_camera_to_center_distance:new d.b8(g,e.u_camera_to_center_distance),u_scale_with_map:new d.bH(g,e.u_scale_with_map),u_pitch_with_map:new d.bH(g,e.u_pitch_with_map),u_extrude_scale:new d.bM(g,e.u_extrude_scale),u_device_pixel_ratio:new d.b8(g,e.u_device_pixel_ratio),u_globe_extrude_scale:new d.b8(g,e.u_globe_extrude_scale),u_translate:new d.bM(g,e.u_translate)}),collisionBox:(g,e)=>({u_pixel_extrude_scale:new d.bM(g,e.u_pixel_extrude_scale)}),collisionCircle:(g,e)=>({u_viewport_size:new d.bM(g,e.u_viewport_size)}),debug:(g,e)=>({u_color:new d.bI(g,e.u_color),u_overlay:new d.bH(g,e.u_overlay),u_overlay_scale:new d.b8(g,e.u_overlay_scale)}),depth:Dh,clippingMask:Dh,heatmap:(g,e)=>({u_extrude_scale:new d.b8(g,e.u_extrude_scale),u_intensity:new d.b8(g,e.u_intensity),u_globe_extrude_scale:new d.b8(g,e.u_globe_extrude_scale)}),heatmapTexture:(g,e)=>({u_matrix:new d.bJ(g,e.u_matrix),u_world:new d.bM(g,e.u_world),u_image:new d.bH(g,e.u_image),u_color_ramp:new d.bH(g,e.u_color_ramp),u_opacity:new d.b8(g,e.u_opacity)}),hillshade:(g,e)=>({u_image:new d.bH(g,e.u_image),u_latrange:new d.bM(g,e.u_latrange),u_exaggeration:new d.b8(g,e.u_exaggeration),u_altitudes:new d.bS(g,e.u_altitudes),u_azimuths:new d.bS(g,e.u_azimuths),u_accent:new d.bI(g,e.u_accent),u_method:new d.bH(g,e.u_method),u_shadows:new d.bR(g,e.u_shadows),u_highlights:new d.bR(g,e.u_highlights)}),hillshadePrepare:(g,e)=>({u_matrix:new d.bJ(g,e.u_matrix),u_image:new d.bH(g,e.u_image),u_dimension:new d.bM(g,e.u_dimension),u_zoom:new d.b8(g,e.u_zoom),u_unpack:new d.bK(g,e.u_unpack)}),line:(g,e)=>({u_translation:new d.bM(g,e.u_translation),u_ratio:new d.b8(g,e.u_ratio),u_device_pixel_ratio:new d.b8(g,e.u_device_pixel_ratio),u_units_to_pixels:new d.bM(g,e.u_units_to_pixels)}),lineGradient:(g,e)=>({u_translation:new d.bM(g,e.u_translation),u_ratio:new d.b8(g,e.u_ratio),u_device_pixel_ratio:new d.b8(g,e.u_device_pixel_ratio),u_units_to_pixels:new d.bM(g,e.u_units_to_pixels),u_image:new d.bH(g,e.u_image),u_image_height:new d.b8(g,e.u_image_height)}),linePattern:(g,e)=>({u_translation:new d.bM(g,e.u_translation),u_texsize:new d.bM(g,e.u_texsize),u_ratio:new d.b8(g,e.u_ratio),u_device_pixel_ratio:new d.b8(g,e.u_device_pixel_ratio),u_image:new d.bH(g,e.u_image),u_units_to_pixels:new d.bM(g,e.u_units_to_pixels),u_scale:new d.bL(g,e.u_scale),u_fade:new d.b8(g,e.u_fade)}),lineSDF:(g,e)=>({u_translation:new d.bM(g,e.u_translation),u_ratio:new d.b8(g,e.u_ratio),u_device_pixel_ratio:new d.b8(g,e.u_device_pixel_ratio),u_units_to_pixels:new d.bM(g,e.u_units_to_pixels),u_patternscale_a:new d.bM(g,e.u_patternscale_a),u_patternscale_b:new d.bM(g,e.u_patternscale_b),u_sdfgamma:new d.b8(g,e.u_sdfgamma),u_image:new d.bH(g,e.u_image),u_tex_y_a:new d.b8(g,e.u_tex_y_a),u_tex_y_b:new d.b8(g,e.u_tex_y_b),u_mix:new d.b8(g,e.u_mix)}),raster:(g,e)=>({u_tl_parent:new d.bM(g,e.u_tl_parent),u_scale_parent:new d.b8(g,e.u_scale_parent),u_buffer_scale:new d.b8(g,e.u_buffer_scale),u_fade_t:new d.b8(g,e.u_fade_t),u_opacity:new d.b8(g,e.u_opacity),u_image0:new d.bH(g,e.u_image0),u_image1:new d.bH(g,e.u_image1),u_brightness_low:new d.b8(g,e.u_brightness_low),u_brightness_high:new d.b8(g,e.u_brightness_high),u_saturation_factor:new d.b8(g,e.u_saturation_factor),u_contrast_factor:new d.b8(g,e.u_contrast_factor),u_spin_weights:new d.bL(g,e.u_spin_weights),u_coords_top:new d.bK(g,e.u_coords_top),u_coords_bottom:new d.bK(g,e.u_coords_bottom)}),symbolIcon:(g,e)=>({u_is_size_zoom_constant:new d.bH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.bH(g,e.u_is_size_feature_constant),u_size_t:new d.b8(g,e.u_size_t),u_size:new d.b8(g,e.u_size),u_camera_to_center_distance:new d.b8(g,e.u_camera_to_center_distance),u_pitch:new d.b8(g,e.u_pitch),u_rotate_symbol:new d.bH(g,e.u_rotate_symbol),u_aspect_ratio:new d.b8(g,e.u_aspect_ratio),u_fade_change:new d.b8(g,e.u_fade_change),u_label_plane_matrix:new d.bJ(g,e.u_label_plane_matrix),u_coord_matrix:new d.bJ(g,e.u_coord_matrix),u_is_text:new d.bH(g,e.u_is_text),u_pitch_with_map:new d.bH(g,e.u_pitch_with_map),u_is_along_line:new d.bH(g,e.u_is_along_line),u_is_variable_anchor:new d.bH(g,e.u_is_variable_anchor),u_texsize:new d.bM(g,e.u_texsize),u_texture:new d.bH(g,e.u_texture),u_translation:new d.bM(g,e.u_translation),u_pitched_scale:new d.b8(g,e.u_pitched_scale)}),symbolSDF:(g,e)=>({u_is_size_zoom_constant:new d.bH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.bH(g,e.u_is_size_feature_constant),u_size_t:new d.b8(g,e.u_size_t),u_size:new d.b8(g,e.u_size),u_camera_to_center_distance:new d.b8(g,e.u_camera_to_center_distance),u_pitch:new d.b8(g,e.u_pitch),u_rotate_symbol:new d.bH(g,e.u_rotate_symbol),u_aspect_ratio:new d.b8(g,e.u_aspect_ratio),u_fade_change:new d.b8(g,e.u_fade_change),u_label_plane_matrix:new d.bJ(g,e.u_label_plane_matrix),u_coord_matrix:new d.bJ(g,e.u_coord_matrix),u_is_text:new d.bH(g,e.u_is_text),u_pitch_with_map:new d.bH(g,e.u_pitch_with_map),u_is_along_line:new d.bH(g,e.u_is_along_line),u_is_variable_anchor:new d.bH(g,e.u_is_variable_anchor),u_texsize:new d.bM(g,e.u_texsize),u_texture:new d.bH(g,e.u_texture),u_gamma_scale:new d.b8(g,e.u_gamma_scale),u_device_pixel_ratio:new d.b8(g,e.u_device_pixel_ratio),u_is_halo:new d.bH(g,e.u_is_halo),u_translation:new d.bM(g,e.u_translation),u_pitched_scale:new d.b8(g,e.u_pitched_scale)}),symbolTextAndIcon:(g,e)=>({u_is_size_zoom_constant:new d.bH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.bH(g,e.u_is_size_feature_constant),u_size_t:new d.b8(g,e.u_size_t),u_size:new d.b8(g,e.u_size),u_camera_to_center_distance:new d.b8(g,e.u_camera_to_center_distance),u_pitch:new d.b8(g,e.u_pitch),u_rotate_symbol:new d.bH(g,e.u_rotate_symbol),u_aspect_ratio:new d.b8(g,e.u_aspect_ratio),u_fade_change:new d.b8(g,e.u_fade_change),u_label_plane_matrix:new d.bJ(g,e.u_label_plane_matrix),u_coord_matrix:new d.bJ(g,e.u_coord_matrix),u_is_text:new d.bH(g,e.u_is_text),u_pitch_with_map:new d.bH(g,e.u_pitch_with_map),u_is_along_line:new d.bH(g,e.u_is_along_line),u_is_variable_anchor:new d.bH(g,e.u_is_variable_anchor),u_texsize:new d.bM(g,e.u_texsize),u_texsize_icon:new d.bM(g,e.u_texsize_icon),u_texture:new d.bH(g,e.u_texture),u_texture_icon:new d.bH(g,e.u_texture_icon),u_gamma_scale:new d.b8(g,e.u_gamma_scale),u_device_pixel_ratio:new d.b8(g,e.u_device_pixel_ratio),u_is_halo:new d.bH(g,e.u_is_halo),u_translation:new d.bM(g,e.u_translation),u_pitched_scale:new d.b8(g,e.u_pitched_scale)}),background:(g,e)=>({u_opacity:new d.b8(g,e.u_opacity),u_color:new d.bI(g,e.u_color)}),backgroundPattern:(g,e)=>({u_opacity:new d.b8(g,e.u_opacity),u_image:new d.bH(g,e.u_image),u_pattern_tl_a:new d.bM(g,e.u_pattern_tl_a),u_pattern_br_a:new d.bM(g,e.u_pattern_br_a),u_pattern_tl_b:new d.bM(g,e.u_pattern_tl_b),u_pattern_br_b:new d.bM(g,e.u_pattern_br_b),u_texsize:new d.bM(g,e.u_texsize),u_mix:new d.b8(g,e.u_mix),u_pattern_size_a:new d.bM(g,e.u_pattern_size_a),u_pattern_size_b:new d.bM(g,e.u_pattern_size_b),u_scale_a:new d.b8(g,e.u_scale_a),u_scale_b:new d.b8(g,e.u_scale_b),u_pixel_coord_upper:new d.bM(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bM(g,e.u_pixel_coord_lower),u_tile_units_to_pixels:new d.b8(g,e.u_tile_units_to_pixels)}),terrain:(g,e)=>({u_texture:new d.bH(g,e.u_texture),u_ele_delta:new d.b8(g,e.u_ele_delta),u_fog_matrix:new d.bJ(g,e.u_fog_matrix),u_fog_color:new d.bI(g,e.u_fog_color),u_fog_ground_blend:new d.b8(g,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new d.b8(g,e.u_fog_ground_blend_opacity),u_horizon_color:new d.bI(g,e.u_horizon_color),u_horizon_fog_blend:new d.b8(g,e.u_horizon_fog_blend),u_is_globe_mode:new d.b8(g,e.u_is_globe_mode)}),terrainDepth:(g,e)=>({u_ele_delta:new d.b8(g,e.u_ele_delta)}),terrainCoords:(g,e)=>({u_texture:new d.bH(g,e.u_texture),u_terrain_coords_id:new d.b8(g,e.u_terrain_coords_id),u_ele_delta:new d.b8(g,e.u_ele_delta)}),projectionErrorMeasurement:(g,e)=>({u_input:new d.b8(g,e.u_input),u_output_expected:new d.b8(g,e.u_output_expected)}),atmosphere:(g,e)=>({u_sun_pos:new d.bL(g,e.u_sun_pos),u_atmosphere_blend:new d.b8(g,e.u_atmosphere_blend),u_globe_position:new d.bL(g,e.u_globe_position),u_globe_radius:new d.b8(g,e.u_globe_radius),u_inv_proj_matrix:new d.bJ(g,e.u_inv_proj_matrix)}),sky:(g,e)=>({u_sky_color:new d.bI(g,e.u_sky_color),u_horizon_color:new d.bI(g,e.u_horizon_color),u_horizon:new d.bM(g,e.u_horizon),u_horizon_normal:new d.bM(g,e.u_horizon_normal),u_sky_horizon_blend:new d.b8(g,e.u_sky_horizon_blend),u_sky_blend:new d.b8(g,e.u_sky_blend)})};class Rd{constructor(e,n,c){this.context=e;const f=e.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const n=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Rh={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class $n{constructor(e,n,c,f){this.length=n.length,this.attributes=c,this.itemSize=n.bytesPerElement,this.dynamicDraw=f,this.context=e;const y=e.gl;this.buffer=y.createBuffer(),e.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,n){for(let c=0;c<this.attributes.length;c++){const f=n.attributes[this.attributes[c].name];f!==void 0&&e.enableVertexAttribArray(f)}}setVertexAttribPointers(e,n,c){for(let f=0;f<this.attributes.length;f++){const y=this.attributes[f],T=n.attributes[y.name];T!==void 0&&e.vertexAttribPointer(T,y.components,e[Rh[y.type]],!1,this.itemSize,y.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class hi{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ns extends hi{getDefault(){return d.b7.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Mc extends hi{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Ic extends hi{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Dc extends hi{getDefault(){return[!0,!0,!0,!0]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Rc extends hi{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Ph extends hi{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Ir extends hi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const n=this.current;(e.func!==n.func||e.ref!==n.ref||e.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Nl extends hi{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Ol extends hi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=e,this.dirty=!1}}class Lh extends hi{getDefault(){return[0,1]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Pd extends hi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=e,this.dirty=!1}}class tu extends hi{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class iu extends hi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.BLEND):n.disable(n.BLEND),this.current=e,this.dirty=!1}}class Nh extends hi{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Oh extends hi{getDefault(){return d.b7.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class rs extends hi{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class kl extends hi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=e,this.dirty=!1}}class Bl extends hi{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Pc extends hi{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class au extends hi{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Lc extends hi{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class $u extends hi{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class cr extends hi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class kh extends hi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Nc extends hi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindTexture(n.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class hr extends hi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class bo extends hi{getDefault(){return null}set(e){const n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Nn extends hi{getDefault(){return null}set(e){var n;if(e===this.current&&!this.dirty)return;const c=this.gl;wa(c)?c.bindVertexArray(e):(n=c.getExtension("OES_vertex_array_object"))===null||n===void 0||n.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class On extends hi{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class ss extends hi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Xu extends hi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class nu extends hi{constructor(e,n){super(e),this.context=e,this.parent=n}getDefault(){return null}}class Ls extends nu{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class xo extends nu{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ru extends nu{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const zl="Framebuffer is not complete";class si{constructor(e,n,c,f,y){this.context=e,this.width=n,this.height=c;const T=e.gl,A=this.framebuffer=T.createFramebuffer();if(this.colorAttachment=new Ls(e,A),f)this.depthAttachment=y?new ru(e,A):new xo(e,A);else if(y)throw new Error("Stencil cannot be set without depth");if(T.checkFramebufferStatus(T.FRAMEBUFFER)!==T.FRAMEBUFFER_COMPLETE)throw new Error(zl)}destroy(){const e=this.context.gl,n=this.colorAttachment.get();if(n&&e.deleteTexture(n),this.depthAttachment){const c=this.depthAttachment.get();c&&e.deleteRenderbuffer(c)}e.deleteFramebuffer(this.framebuffer)}}class Ns{constructor(e){var n,c;if(this.gl=e,this.clearColor=new ns(this),this.clearDepth=new Mc(this),this.clearStencil=new Ic(this),this.colorMask=new Dc(this),this.depthMask=new Rc(this),this.stencilMask=new Ph(this),this.stencilFunc=new Ir(this),this.stencilOp=new Nl(this),this.stencilTest=new Ol(this),this.depthRange=new Lh(this),this.depthTest=new Pd(this),this.depthFunc=new tu(this),this.blend=new iu(this),this.blendFunc=new Nh(this),this.blendColor=new Oh(this),this.blendEquation=new rs(this),this.cullFace=new kl(this),this.cullFaceSide=new Bl(this),this.frontFace=new Pc(this),this.program=new au(this),this.activeTexture=new Lc(this),this.viewport=new $u(this),this.bindFramebuffer=new cr(this),this.bindRenderbuffer=new kh(this),this.bindTexture=new Nc(this),this.bindVertexBuffer=new hr(this),this.bindElementBuffer=new bo(this),this.bindVertexArray=new Nn(this),this.pixelStoreUnpack=new On(this),this.pixelStoreUnpackPremultiplyAlpha=new ss(this),this.pixelStoreUnpackFlipY=new Xu(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),wa(e)){this.HALF_FLOAT=e.HALF_FLOAT;const f=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(n=e.RGBA16F)!==null&&n!==void 0?n:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(c=e.RGB16F)!==null&&c!==void 0?c:f==null?void 0:f.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const f=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,n){return new Rd(this,e,n)}createVertexBuffer(e,n,c){return new $n(this,e,n,c)}createRenderbuffer(e,n,c){const f=this.gl,y=f.createRenderbuffer();return this.bindRenderbuffer.set(y),f.renderbufferStorage(f.RENDERBUFFER,e,n,c),this.bindRenderbuffer.set(null),y}createFramebuffer(e,n,c,f){return new si(this,e,n,c,f)}clear({color:e,depth:n,stencil:c}){const f=this.gl;let y=0;e&&(y|=f.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(y|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),c!==void 0&&(y|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),f.clear(y)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){d.bE(e.blendFunction,Di.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return wa(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var n;return wa(this.gl)?this.gl.deleteVertexArray(e):(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Oc;function kn(g,e,n,c,f){const y=g.context,T=g.transform,A=y.gl,I=g.useProgram("collisionBox"),L=[];let k=0,F=0;for(let re=0;re<c.length;re++){const le=c[re],me=e.getTile(le).getBucket(n);if(!me)continue;const pe=f?me.textCollisionBox:me.iconCollisionBox,ye=me.collisionCircleArray;ye.length>0&&(L.push({circleArray:ye,circleOffset:F,coord:le}),k+=ye.length/4,F=k),pe&&I.draw(y,A.LINES,Zt.disabled,ti.disabled,g.colorModeForRenderPass(),ci.disabled,Ad(g.transform),g.style.map.terrain&&g.style.map.terrain.getTerrainData(le),T.getProjectionData({overscaledTileID:le,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,null,g.transform.zoom,null,null,pe.collisionVertexBuffer)}if(!f||!L.length)return;const z=g.useProgram("collisionCircle"),G=new d.bT;G.resize(4*k),G._trim();let Z=0;for(const re of L)for(let le=0;le<re.circleArray.length/4;le++){const me=4*le,pe=re.circleArray[me+0],ye=re.circleArray[me+1],Ee=re.circleArray[me+2],be=re.circleArray[me+3];G.emplace(Z++,pe,ye,Ee,be,0),G.emplace(Z++,pe,ye,Ee,be,1),G.emplace(Z++,pe,ye,Ee,be,2),G.emplace(Z++,pe,ye,Ee,be,3)}(!Oc||Oc.length<2*k)&&(Oc=function(re){const le=2*re,me=new d.bV;me.resize(le),me._trim();for(let pe=0;pe<le;pe++){const ye=6*pe;me.uint16[ye+0]=4*pe+0,me.uint16[ye+1]=4*pe+1,me.uint16[ye+2]=4*pe+2,me.uint16[ye+3]=4*pe+2,me.uint16[ye+4]=4*pe+3,me.uint16[ye+5]=4*pe+0}return me}(k));const ne=y.createIndexBuffer(Oc,!0),ae=y.createVertexBuffer(G,d.bU.members,!0);for(const re of L){const le=Pl(g.transform);z.draw(y,A.TRIANGLES,Zt.disabled,ti.disabled,g.colorModeForRenderPass(),ci.disabled,le,g.style.map.terrain&&g.style.map.terrain.getTerrainData(re.coord),null,n.id,ae,ne,d.aJ.simpleSegment(0,2*re.circleOffset,re.circleArray.length,re.circleArray.length/2),null,g.transform.zoom,null,null,null)}ae.destroy(),ne.destroy()}const su=d.ad(new Float32Array(16));function Os(g,e,n,c,f,y){const{horizontalAlign:T,verticalAlign:A}=d.aE(g);return new d.P((-(T-.5)*e/f+c[0])*y,(-(A-.5)*n/f+c[1])*y)}function Ld(g,e,n,c,f,y){const T=e.tileAnchorPoint.add(new d.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let A=c.mult(y);n||(A=A.rotate(-f));const I=T.add(A);return Ve(I.x,I.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(n){const A=Gi(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(g),I=Math.atan(A.y/A.x)+(A.x<0?Math.PI:0);return g.add(c.rotate(I))}return g.add(c)}function Fl(g,e,n,c,f,y,T,A,I,L,k,F){const z=g.text.placedSymbolArray,G=g.text.dynamicLayoutVertexArray,Z=g.icon.dynamicLayoutVertexArray,ne={};G.clear();for(let ae=0;ae<z.length;ae++){const re=z.get(ae),le=re.hidden||!re.crossTileID||g.allowVerticalPlacement&&!re.placedOrientation?null:c[re.crossTileID];if(le){const me=new d.P(re.anchorX,re.anchorY),pe={getElevation:F,width:f.width,height:f.height,pitchedLabelPlaneMatrix:y,pitchWithMap:n,transform:f,tileAnchorPoint:me,translation:L,unwrappedTileID:k},ye=n?Bt(me.x,me.y,pe):Gi(me.x,me.y,pe),Ee=vi(f.cameraToCenterDistance,ye.signedDistanceFromCamera);let be=d.am(g.textSizeData,A,re)*Ee/d.ay;n&&(be*=g.tilePixelRatio/T);const{width:Ne,height:$e,anchor:je,textOffset:He,textBoxScale:Ge}=le,ft=Os(je,Ne,$e,He,Ge,be),ht=f.getPitchedTextCorrection(me.x+L[0],me.y+L[1],k),it=Ld(ye.point,pe,e,ft,-f.bearingInRadians,ht),St=g.allowVerticalPlacement&&re.placedOrientation===d.al.vertical?Math.PI/2:0;for(let ii=0;ii<re.numGlyphs;ii++)d.as(G,it,St);I&&re.associatedIconIndex>=0&&(ne[re.associatedIconIndex]={shiftedAnchor:it,angle:St})}else Ds(re.numGlyphs,G)}if(I){Z.clear();const ae=g.icon.placedSymbolArray;for(let re=0;re<ae.length;re++){const le=ae.get(re);if(le.hidden)Ds(le.numGlyphs,Z);else{const me=ne[re];if(me)for(let pe=0;pe<le.numGlyphs;pe++)d.as(Z,me.shiftedAnchor,me.angle);else Ds(le.numGlyphs,Z)}}g.icon.dynamicLayoutVertexBuffer.updateData(Z)}g.text.dynamicLayoutVertexBuffer.updateData(G)}function ou(g,e,n){return n.iconsInText&&e?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function Qu(g,e,n,c,f,y,T,A,I,L,k,F,z){const G=g.context,Z=G.gl,ne=g.transform,ae=A==="map",re=I==="map",le=A!=="viewport"&&n.layout.get("symbol-placement")!=="point",me=ae&&!re&&!le,pe=!n.layout.get("symbol-sort-key").isConstant();let ye=!1;const Ee=g.getDepthModeForSublayer(0,Zt.ReadOnly),be=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ne=[],$e=ne.getCircleRadiusCorrection();for(const je of c){const He=e.getTile(je),Ge=He.getBucket(n);if(!Ge)continue;const ft=f?Ge.text:Ge.icon;if(!ft||!ft.segments.get().length||!ft.hasVisibleVertices)continue;const ht=ft.programConfigurations.get(n.id),it=f||Ge.sdfIcons,St=f?Ge.textSizeData:Ge.iconSizeData,ii=re||ne.pitch!==0,di=g.useProgram(ou(it,f,Ge),ht),oa=d.ak(St,ne.zoom),ki=g.style.map.terrain&&g.style.map.terrain.getTerrainData(je);let ua,Ji,ji,wi,La=[0,0],Za=null;if(f)Ji=He.glyphAtlasTexture,ji=Z.LINEAR,ua=He.glyphAtlasTexture.size,Ge.iconsInText&&(La=He.imageAtlasTexture.size,Za=He.imageAtlasTexture,wi=ii||g.options.rotating||g.options.zooming||St.kind==="composite"||St.kind==="camera"?Z.LINEAR:Z.NEAREST);else{const _a=n.layout.get("icon-size").constantOr(0)!==1||Ge.iconsNeedLinear;Ji=He.imageAtlasTexture,ji=it||g.options.rotating||g.options.zooming||_a||ii?Z.LINEAR:Z.NEAREST,ua=He.imageAtlasTexture.size}const an=d.az(He,1,g.transform.zoom),Si=It(ae,g.transform,an),_s=d.K();d.an(_s,Si);const Zr=kt(re,ae,g.transform,an),Gs=d.aA(ne,He,y,T),Zs=ne.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),rl=be&&Ge.hasTextData(),Ys=n.layout.get("icon-text-fit")!=="none"&&rl&&Ge.hasIconData();if(le){const _a=g.style.map.terrain?(wn,Bi)=>g.style.map.terrain.getElevation(je,wn,Bi):null,Na=n.layout.get("text-rotation-alignment")==="map";Ti(Ge,g,f,Si,_s,re,L,Na,je.toUnwrapped(),ne.width,ne.height,Gs,_a)}const gu=f&&be||Ys,pr=le||gu?su:re?Si:g.transform.clipSpaceToPixelsMatrix,$s=it&&n.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let mr;mr=it?Ge.iconsInText?Ll(St.kind,oa,me,re,le,gu,g,pr,Zr,Gs,ua,La,$e):Ih(St.kind,oa,me,re,le,gu,g,pr,Zr,Gs,f,ua,0,$e):yo(St.kind,oa,me,re,le,gu,g,pr,Zr,Gs,f,ua,$e);const ys={program:di,buffers:ft,uniformValues:mr,projectionData:Zs,atlasTexture:Ji,atlasTextureIcon:Za,atlasInterpolation:ji,atlasInterpolationIcon:wi,isSDF:it,hasHalo:$s};if(pe&&Ge.canOverlap){ye=!0;const _a=ft.segments.get();for(const Na of _a)Ne.push({segments:new d.aJ([Na]),sortKey:Na.sortKey,state:ys,terrainData:ki})}else Ne.push({segments:ft.segments,sortKey:0,state:ys,terrainData:ki})}ye&&Ne.sort((je,He)=>je.sortKey-He.sortKey);for(const je of Ne){const He=je.state;if(G.activeTexture.set(Z.TEXTURE0),He.atlasTexture.bind(He.atlasInterpolation,Z.CLAMP_TO_EDGE),He.atlasTextureIcon&&(G.activeTexture.set(Z.TEXTURE1),He.atlasTextureIcon&&He.atlasTextureIcon.bind(He.atlasInterpolationIcon,Z.CLAMP_TO_EDGE)),He.isSDF){const Ge=He.uniformValues;He.hasHalo&&(Ge.u_is_halo=1,uu(He.buffers,je.segments,n,g,He.program,Ee,k,F,Ge,He.projectionData,je.terrainData)),Ge.u_is_halo=0}uu(He.buffers,je.segments,n,g,He.program,Ee,k,F,He.uniformValues,He.projectionData,je.terrainData)}}function uu(g,e,n,c,f,y,T,A,I,L,k){const F=c.context;f.draw(F,F.gl.TRIANGLES,y,T,A,ci.backCCW,I,k,L,n.id,g.layoutVertexBuffer,g.indexBuffer,e,n.paint,c.transform.zoom,g.programConfigurations.get(n.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function ks(g,e,n,c,f){const y=g.context,T=y.gl,A=ti.disabled,I=new Di([T.ONE,T.ONE],d.b7.transparent,[!0,!0,!0,!0]),L=e.getBucket(n);if(!L)return;const k=c.key;let F=n.heatmapFbos.get(k);F||(F=lu(y,e.tileSize,e.tileSize),n.heatmapFbos.set(k,F)),y.bindFramebuffer.set(F.framebuffer),y.viewport.set([0,0,e.tileSize,e.tileSize]),y.clear({color:d.b7.transparent});const z=L.programConfigurations.get(n.id),G=g.useProgram("heatmap",z,!f),Z=g.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ne=g.style.map.terrain.getTerrainData(c);G.draw(y,T.TRIANGLES,Zt.disabled,A,I,ci.disabled,Mr(e,g.transform.zoom,n.paint.get("heatmap-intensity"),1),ne,Z,n.id,L.layoutVertexBuffer,L.indexBuffer,L.segments,n.paint,g.transform.zoom,z)}function vo(g,e,n,c,f){const y=g.context,T=y.gl,A=g.transform;y.setColorMode(g.colorModeForRenderPass());const I=Ku(y,e),L=n.key,k=e.heatmapFbos.get(L);if(!k)return;y.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,k.colorAttachment.get()),y.activeTexture.set(T.TEXTURE1),I.bind(T.LINEAR,T.CLAMP_TO_EDGE);const F=A.getProjectionData({overscaledTileID:n,applyTerrainMatrix:f,applyGlobeMatrix:!c});g.useProgram("heatmapTexture").draw(y,T.TRIANGLES,Zt.disabled,ti.disabled,g.colorModeForRenderPass(),ci.disabled,Sd(g,e,0,1),null,F,e.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,e.paint,A.zoom),k.destroy(),e.heatmapFbos.delete(L)}function lu(g,e,n){var c,f;const y=g.gl,T=y.createTexture();y.bindTexture(y.TEXTURE_2D,T),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const A=(c=g.HALF_FLOAT)!==null&&c!==void 0?c:y.UNSIGNED_BYTE,I=(f=g.RGBA16F)!==null&&f!==void 0?f:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,I,e,n,0,y.RGBA,A,null);const L=g.createFramebuffer(e,n,!1,!1);return L.colorAttachment.set(T),L}function Ku(g,e){return e.colorRampTexture||(e.colorRampTexture=new bi(g,e.colorRamp,g.gl.RGBA)),e.colorRampTexture}function bn(g,e,n,c,f){if(!n||!c||!c.imageAtlas)return;const y=c.imageAtlas.patternPositions;let T=y[n.to.toString()],A=y[n.from.toString()];if(!T&&A&&(T=A),!A&&T&&(A=T),!T||!A){const I=f.getPaintProperty(e);T=y[I],A=y[I]}T&&A&&g.setConstantPatternPositions(T,A)}function xn(g,e,n,c,f,y,T,A){const I=g.context.gl,L="fill-pattern",k=n.paint.get(L),F=k&&k.constantOr(1),z=n.getCrossfadeParameters();let G,Z,ne,ae,re;const le=g.transform,me=n.paint.get("fill-translate"),pe=n.paint.get("fill-translate-anchor");T?(Z=F&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",G=I.LINES):(Z=F?"fillPattern":"fill",G=I.TRIANGLES);const ye=k.constantOr(null);for(const Ee of c){const be=e.getTile(Ee);if(F&&!be.patternsLoaded())continue;const Ne=be.getBucket(n);if(!Ne)continue;const $e=Ne.programConfigurations.get(n.id),je=g.useProgram(Z,$e),He=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Ee);F&&(g.context.activeTexture.set(I.TEXTURE0),be.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),$e.updatePaintBuffers(z)),bn($e,L,ye,be,n);const Ge=le.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!A,applyTerrainMatrix:!0}),ft=d.aA(le,be,me,pe);if(T){ae=Ne.indexBuffer2,re=Ne.segments2;const it=[I.drawingBufferWidth,I.drawingBufferHeight];ne=Z==="fillOutlinePattern"&&F?ju(g,z,be,it,ft):Ah(it,ft)}else ae=Ne.indexBuffer,re=Ne.segments,ne=F?Hu(g,z,be,ft):{u_fill_translate:ft};const ht=g.stencilModeForClipping(Ee);je.draw(g.context,G,f,ht,y,ci.backCCW,ne,He,Ge,n.id,Ne.layoutVertexBuffer,ae,re,n.paint,g.transform.zoom,$e)}}function zr(g,e,n,c,f,y,T,A){const I=g.context,L=I.gl,k="fill-extrusion-pattern",F=n.paint.get(k),z=F.constantOr(1),G=n.getCrossfadeParameters(),Z=n.paint.get("fill-extrusion-opacity"),ne=F.constantOr(null),ae=g.transform;for(const re of c){const le=e.getTile(re),me=le.getBucket(n);if(!me)continue;const pe=g.style.map.terrain&&g.style.map.terrain.getTerrainData(re),ye=me.programConfigurations.get(n.id),Ee=g.useProgram(z?"fillExtrusionPattern":"fillExtrusion",ye);z&&(g.context.activeTexture.set(L.TEXTURE0),le.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),ye.updatePaintBuffers(G));const be=ae.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!A,applyTerrainMatrix:!0});bn(ye,k,ne,le,n);const Ne=d.aA(ae,le,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),$e=n.paint.get("fill-extrusion-vertical-gradient"),je=z?Cr(g,$e,Z,Ne,re,G,le):Sc(g,$e,Z,Ne);Ee.draw(I,I.gl.TRIANGLES,f,y,T,ci.backCCW,je,pe,be,n.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,n.paint,g.transform.zoom,ye,g.style.map.terrain&&me.centroidVertexBuffer)}}function Fr(g,e,n,c,f,y,T,A,I){var L;const k=g.style.projection,F=g.context,z=g.transform,G=F.gl,Z=[`#define NUM_ILLUMINATION_SOURCES ${n.paint.get("hillshade-highlight-color").values.length}`],ne=g.useProgram("hillshade",null,!1,Z),ae=!g.options.moving;for(const re of c){const le=e.getTile(re),me=le.fbo;if(!me)continue;const pe=k.getMeshFromTileID(F,re.canonical,A,!0,"raster"),ye=(L=g.style.map.terrain)===null||L===void 0?void 0:L.getTerrainData(re);F.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,me.colorAttachment.get());const Ee=z.getProjectionData({overscaledTileID:re,aligned:ae,applyGlobeMatrix:!I,applyTerrainMatrix:!0});ne.draw(F,G.TRIANGLES,y,f[re.overscaledZ],T,ci.backCCW,Cd(g,le,n),ye,Ee,n.id,pe.vertexBuffer,pe.indexBuffer,pe.segments)}}const dr=[new d.P(0,0),new d.P(d.Z,0),new d.P(d.Z,d.Z),new d.P(0,d.Z)];function os(g,e,n,c,f,y,T,A,I=!1,L=!1){const k=c[c.length-1].overscaledZ,F=g.context,z=F.gl,G=g.useProgram("raster"),Z=g.transform,ne=g.style.projection,ae=g.colorModeForRenderPass(),re=!g.options.moving;for(const le of c){const me=g.getDepthModeForSublayer(le.overscaledZ-k,n.paint.get("raster-opacity")===1?Zt.ReadWrite:Zt.ReadOnly,z.LESS),pe=e.getTile(le);pe.registerFadeDuration(n.paint.get("raster-fade-duration"));const ye=e.findLoadedParent(le,0),Ee=e.findLoadedSibling(le),be=Bh(pe,ye||Ee||null,e,n,g.transform,g.style.map.terrain);let Ne,$e;const je=n.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;F.activeTexture.set(z.TEXTURE0),pe.texture.bind(je,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),F.activeTexture.set(z.TEXTURE1),ye?(ye.texture.bind(je,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),Ne=Math.pow(2,ye.tileID.overscaledZ-pe.tileID.overscaledZ),$e=[pe.tileID.canonical.x*Ne%1,pe.tileID.canonical.y*Ne%1]):pe.texture.bind(je,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),pe.texture.useMipmap&&F.extTextureFilterAnisotropic&&g.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,F.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,F.extTextureFilterAnisotropicMax);const He=g.style.map.terrain&&g.style.map.terrain.getTerrainData(le),Ge=Z.getProjectionData({overscaledTileID:le,aligned:re,applyGlobeMatrix:!L,applyTerrainMatrix:!0}),ft=Mh($e||[0,0],Ne||1,be,n,A),ht=ne.getMeshFromTileID(F,le.canonical,y,T,"raster");G.draw(F,z.TRIANGLES,me,f?f[le.overscaledZ]:ti.disabled,ae,I?ci.frontCCW:ci.backCCW,ft,He,Ge,n.id,ht.vertexBuffer,ht.indexBuffer,ht.segments)}}function Bh(g,e,n,c,f,y){const T=c.paint.get("raster-fade-duration");if(!y&&T>0){const A=Me.now(),I=(A-g.timeAdded)/T,L=e?(A-e.timeAdded)/T:-1,k=n.getSource(),F=Le(f,{tileSize:k.tileSize,roundZoom:k.roundZoom}),z=!e||Math.abs(e.tileID.overscaledZ-F)>Math.abs(g.tileID.overscaledZ-F),G=z&&g.refreshedUponExpiration?1:d.ae(z?I:1-L,0,1);return g.refreshedUponExpiration&&I>=1&&(g.refreshedUponExpiration=!1),e?{opacity:1,mix:1-G}:{opacity:G,mix:0}}return{opacity:1,mix:0}}const Wu=new d.b7(1,0,0,1),Ul=new d.b7(0,1,0,1),vn=new d.b7(0,0,1,1),ga=new d.b7(1,0,1,1),Ei=new d.b7(0,1,1,1);function us(g,e,n,c){cu(g,0,e+n/2,g.transform.width,n,c)}function Ur(g,e,n,c){cu(g,e-n/2,0,n,g.transform.height,c)}function cu(g,e,n,c,f,y){const T=g.context,A=T.gl;A.enable(A.SCISSOR_TEST),A.scissor(e*g.pixelRatio,n*g.pixelRatio,c*g.pixelRatio,f*g.pixelRatio),T.clear({color:y}),A.disable(A.SCISSOR_TEST)}function Hi(g,e,n){const c=g.context,f=c.gl,y=g.useProgram("debug"),T=Zt.disabled,A=ti.disabled,I=g.colorModeForRenderPass(),L="$debug",k=g.style.map.terrain&&g.style.map.terrain.getTerrainData(n);c.activeTexture.set(f.TEXTURE0);const F=e.getTileByID(n.key).latestRawTileData,z=Math.floor((F&&F.byteLength||0)/1024),G=e.getTile(n).tileSize,Z=512/Math.min(G,512)*(n.overscaledZ/g.transform.zoom)*.5;let ne=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(ne+=` => ${n.overscaledZ}`),function(re,le){re.initDebugOverlayCanvas();const me=re.debugOverlayCanvas,pe=re.context.gl,ye=re.debugOverlayCanvas.getContext("2d");ye.clearRect(0,0,me.width,me.height),ye.shadowColor="white",ye.shadowBlur=2,ye.lineWidth=1.5,ye.strokeStyle="white",ye.textBaseline="top",ye.font="bold 36px Open Sans, sans-serif",ye.fillText(le,5,5),ye.strokeText(le,5,5),re.debugOverlayTexture.update(me),re.debugOverlayTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)}(g,`${ne} ${z}kB`);const ae=g.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(c,f.TRIANGLES,T,A,Di.alphaBlended,ci.disabled,Sh(d.b7.transparent,Z),null,ae,L,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),y.draw(c,f.LINE_STRIP,T,A,I,ci.disabled,Sh(d.b7.red),k,ae,L,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function Bs(g,e,n,c){const{isRenderingGlobe:f}=c,y=g.context,T=y.gl,A=g.transform,I=g.colorModeForRenderPass(),L=g.getDepthModeFor3D(),k=g.useProgram("terrain");y.bindFramebuffer.set(null),y.viewport.set([0,0,g.width,g.height]);for(const F of n){const z=e.getTerrainMesh(F.tileID),G=g.renderToTexture.getTexture(F),Z=e.getTerrainData(F.tileID);y.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,G.texture);const ne=e.getMeshFrameDelta(A.zoom),ae=A.calculateFogMatrix(F.tileID.toUnwrapped()),re=jf(ne,ae,g.style.sky,A.pitch,f),le=A.getProjectionData({overscaledTileID:F.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});k.draw(y,T.TRIANGLES,L,ti.disabled,I,ci.backCCW,re,Z,le,"terrain",z.vertexBuffer,z.indexBuffer,z.segments)}}function Xn(g,e){if(!e.mesh){const n=new d.aI;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);const c=new d.aK;c.emplaceBack(0,1,2),c.emplaceBack(0,2,3),e.mesh=new jo(g.createVertexBuffer(n,ln.members),g.createIndexBuffer(c),d.aJ.simpleSegment(0,0,n.length,c.length))}return e.mesh}class hu{constructor(e,n){this.context=new Ns(e),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:d.ad(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Re.maxUnderzooming+Re.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Bu}resize(e,n,c){if(this.width=Math.floor(e*c),this.height=Math.floor(n*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const e=this.context,n=new d.aI;n.emplaceBack(0,0),n.emplaceBack(d.Z,0),n.emplaceBack(0,d.Z),n.emplaceBack(d.Z,d.Z),this.tileExtentBuffer=e.createVertexBuffer(n,ln.members),this.tileExtentSegments=d.aJ.simpleSegment(0,0,4,2);const c=new d.aI;c.emplaceBack(0,0),c.emplaceBack(d.Z,0),c.emplaceBack(0,d.Z),c.emplaceBack(d.Z,d.Z),this.debugBuffer=e.createVertexBuffer(c,ln.members),this.debugSegments=d.aJ.simpleSegment(0,0,4,5);const f=new d.b_;f.emplaceBack(0,0,0,0),f.emplaceBack(d.Z,0,d.Z,0),f.emplaceBack(0,d.Z,0,d.Z),f.emplaceBack(d.Z,d.Z,d.Z,d.Z),this.rasterBoundsBuffer=e.createVertexBuffer(f,Uf.members),this.rasterBoundsSegments=d.aJ.simpleSegment(0,0,4,2);const y=new d.aI;y.emplaceBack(0,0),y.emplaceBack(d.Z,0),y.emplaceBack(0,d.Z),y.emplaceBack(d.Z,d.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(y,ln.members),this.rasterBoundsSegmentsPosOnly=d.aJ.simpleSegment(0,0,4,5);const T=new d.aI;T.emplaceBack(0,0),T.emplaceBack(1,0),T.emplaceBack(0,1),T.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(T,ln.members),this.viewportSegments=d.aJ.simpleSegment(0,0,4,2);const A=new d.b$;A.emplaceBack(0),A.emplaceBack(1),A.emplaceBack(3),A.emplaceBack(2),A.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(A);const I=new d.aK;I.emplaceBack(1,0,2),I.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(I);const L=this.context.gl;this.stencilClearMode=new ti({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.tileExtentMesh=new jo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=d.K();d.bQ(c,0,this.width,this.height,0,0,1),d.M(c,c,[n.drawingBufferWidth,n.drawingBufferHeight,0]);const f={mainMatrix:c,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:c};this.useProgram("clippingMask",null,!0).draw(e,n.TRIANGLES,Zt.disabled,this.stencilClearMode,Di.disabled,ci.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,n,c){if(this.currentStencilSource===e.source||!e.isTileClipped()||!n||!n.length)return;this.currentStencilSource=e.source,this.nextStencilID+n.length>256&&this.clearStencil();const f=this.context;f.setColorMode(Di.disabled),f.setDepthMode(Zt.disabled);const y={};for(const T of n)y[T.key]=this.nextStencilID++;this._renderTileMasks(y,n,c,!0),this._renderTileMasks(y,n,c,!1),this._tileClippingMaskIDs=y}_renderTileMasks(e,n,c,f){const y=this.context,T=y.gl,A=this.style.projection,I=this.transform,L=this.useProgram("clippingMask");for(const k of n){const F=e[k.key],z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k),G=A.getMeshFromTileID(this.context,k.canonical,f,!0,"stencil"),Z=I.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!c,applyTerrainMatrix:!0});L.draw(y,T.TRIANGLES,Zt.disabled,new ti({func:T.ALWAYS,mask:0},F,255,T.KEEP,T.KEEP,T.REPLACE),Di.disabled,c?ci.disabled:ci.backCCW,null,z,Z,"$clipping",G.vertexBuffer,G.indexBuffer,G.segments)}}_renderTilesDepthBuffer(){const e=this.context,n=e.gl,c=this.style.projection,f=this.transform,y=this.useProgram("depth"),T=this.getDepthModeFor3D(),A=Ae(f,{tileSize:f.tileSize});for(const I of A){const L=this.style.map.terrain&&this.style.map.terrain.getTerrainData(I),k=c.getMeshFromTileID(this.context,I.canonical,!0,!0,"raster"),F=f.getProjectionData({overscaledTileID:I,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(e,n.TRIANGLES,T,ti.disabled,Di.disabled,ci.backCCW,null,L,F,"$clipping",k.vertexBuffer,k.indexBuffer,k.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new ti({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){const n=this.context.gl;return new ti({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const n=this.context.gl,c=e.sort((T,A)=>A.overscaledZ-T.overscaledZ),f=c[c.length-1].overscaledZ,y=c[0].overscaledZ-f+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const T={};for(let A=0;A<y;A++)T[A+f]=new ti({func:n.GEQUAL,mask:255},A+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=y,[T,c]}return[{[f]:ti.disabled},c]}stencilConfigForOverlapTwoPass(e){const n=this.context.gl,c=e.sort((T,A)=>A.overscaledZ-T.overscaledZ),f=c[c.length-1].overscaledZ,y=c[0].overscaledZ-f+1;if(this.clearStencil(),y>1){const T={},A={};for(let I=0;I<y;I++)T[I+f]=new ti({func:n.GREATER,mask:255},y+1+I,255,n.KEEP,n.KEEP,n.REPLACE),A[I+f]=new ti({func:n.GREATER,mask:255},1+I,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID=2*y+1,[T,A,c]}return this.nextStencilID=3,[{[f]:new ti({func:n.GREATER,mask:255},2,255,n.KEEP,n.KEEP,n.REPLACE)},{[f]:new ti({func:n.GREATER,mask:255},1,255,n.KEEP,n.KEEP,n.REPLACE)},c]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Di([e.CONSTANT_COLOR,e.ONE],new d.b7(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Di.unblended:Di.alphaBlended}getDepthModeForSublayer(e,n,c){if(!this.opaquePassEnabledForLayer())return Zt.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Zt(c||this.context.gl.LEQUAL,n,[f,f])}getDepthModeFor3D(){return new Zt(this.context.gl.LEQUAL,Zt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){var c,f;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(Me.now()),this.imageManager.beginFrame();const y=this.style._order,T=this.style.sourceCaches,A={},I={},L={},k={isRenderingToTexture:!1,isRenderingGlobe:((c=e.projection)===null||c===void 0?void 0:c.transitionState)>0};for(const z in T){const G=T[z];G.used&&G.prepare(this.context),A[z]=G.getVisibleCoordinates(!1),I[z]=A[z].slice().reverse(),L[z]=G.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let z=0;z<y.length;z++)if(this.style._layers[y[z]].is3D()){this.opaquePassCutoff=z;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const z of y){const G=this.style._layers[z];if(!G.hasOffscreenPass()||G.isHidden(this.transform.zoom))continue;const Z=I[G.source];(G.type==="custom"||Z.length)&&this.renderLayer(this,T[G.source],G,Z,k)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:z=>this.useProgram(z)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?d.b7.black:d.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(z,G){const Z=z.context,ne=Z.gl,ae=((Ee,be,Ne)=>{const $e=Math.cos(be.rollInRadians),je=Math.sin(be.rollInRadians),He=Ce(be),Ge=be.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ee.properties.get("sky-color"),u_horizon_color:Ee.properties.get("horizon-color"),u_horizon:[(be.width/2-He*je)*Ne,(be.height/2+He*$e)*Ne],u_horizon_normal:[-je,$e],u_sky_horizon_blend:Ee.properties.get("sky-horizon-blend")*be.height/2*Ne,u_sky_blend:Ge}})(G,z.style.map.transform,z.pixelRatio),re=new Zt(ne.LEQUAL,Zt.ReadWrite,[0,1]),le=ti.disabled,me=z.colorModeForRenderPass(),pe=z.useProgram("sky"),ye=Xn(Z,G);pe.draw(Z,ne.TRIANGLES,re,le,me,ci.disabled,ae,null,void 0,"sky",ye.vertexBuffer,ye.indexBuffer,ye.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const z=this.style._layers[y[this.currentLayer]],G=T[z.source],Z=A[z.source];this._renderTileClippingMasks(z,Z,!1),this.renderLayer(this,G,z,Z,k)}this.renderPass="translucent";let F=!1;for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const z=this.style._layers[y[this.currentLayer]],G=T[z.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(z,k))continue;this.opaquePassEnabledForLayer()||F||(F=!0,k.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Z=(z.type==="symbol"?L:I)[z.source];this._renderTileClippingMasks(z,A[z.source],!!this.renderToTexture),this.renderLayer(this,G,z,Z,k)}if(k.isRenderingGlobe&&function(z,G,Z){const ne=z.context,ae=ne.gl,re=z.useProgram("atmosphere"),le=new Zt(ae.LEQUAL,Zt.ReadOnly,[0,1]),me=z.transform,pe=function(Ge,ft){const ht=Ge.properties.get("position"),it=[-ht.x,-ht.y,-ht.z],St=d.ad(new Float64Array(16));return Ge.properties.get("anchor")==="map"&&(d.a_(St,St,ft.rollInRadians),d.a$(St,St,-ft.pitchInRadians),d.a_(St,St,ft.bearingInRadians),d.a$(St,St,ft.center.lat*Math.PI/180),d.bp(St,St,-ft.center.lng*Math.PI/180)),d.bZ(it,it,St),it}(Z,z.transform),ye=me.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ee=G.properties.get("atmosphere-blend")*ye.projectionTransition;if(Ee===0)return;const be=Qo(me.worldSize,me.center.lat),Ne=me.inverseProjectionMatrix,$e=new Float64Array(4);$e[3]=1,d.at($e,$e,me.modelViewProjectionMatrix),$e[0]/=$e[3],$e[1]/=$e[3],$e[2]/=$e[3],$e[3]=1,d.at($e,$e,Ne),$e[0]/=$e[3],$e[1]/=$e[3],$e[2]/=$e[3],$e[3]=1;const je=((Ge,ft,ht,it,St)=>({u_sun_pos:Ge,u_atmosphere_blend:ft,u_globe_position:ht,u_globe_radius:it,u_inv_proj_matrix:St}))(pe,Ee,[$e[0],$e[1],$e[2]],be,Ne),He=Xn(ne,G);re.draw(ne,ae.TRIANGLES,le,ti.disabled,Di.alphaBlended,ci.disabled,je,null,null,"atmosphere",He.vertexBuffer,He.indexBuffer,He.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const z=function(G,Z){let ne=null;const ae=Object.values(G._layers).flatMap(pe=>pe.source&&!pe.isHidden(Z)?[G.sourceCaches[pe.source]]:[]),re=ae.filter(pe=>pe.getSource().type==="vector"),le=ae.filter(pe=>pe.getSource().type!=="vector"),me=pe=>{(!ne||ne.getSource().maxzoom<pe.getSource().maxzoom)&&(ne=pe)};return re.forEach(pe=>me(pe)),ne||le.forEach(pe=>me(pe)),ne}(this.style,this.transform.zoom);z&&function(G,Z,ne){for(let ae=0;ae<ne.length;ae++)Hi(G,Z,ne[ae])}(this,z,z.getVisibleCoordinates())}this.options.showPadding&&function(z){const G=z.transform.padding;us(z,z.transform.height-(G.top||0),3,Wu),us(z,G.bottom||0,3,Ul),Ur(z,G.left||0,3,vn),Ur(z,z.transform.width-(G.right||0),3,ga);const Z=z.transform.centerPoint;(function(ne,ae,re,le){cu(ne,ae-1,re-10,2,20,le),cu(ne,ae-10,re-1,20,2,le)})(z,Z.x,z.transform.height-Z.y,Ei)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=e?!d.c0(n,c):!d.c1(n,c)),f||(f=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(d.c2(n,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(y,T){const A=y.context,I=A.gl,L=y.transform,k=Di.unblended,F=new Zt(I.LEQUAL,Zt.ReadWrite,[0,1]),z=T.sourceCache.getRenderableTiles(),G=y.useProgram("terrainDepth");A.bindFramebuffer.set(T.getFramebuffer("depth").framebuffer),A.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),A.clear({color:d.b7.transparent,depth:1});for(const Z of z){const ne=T.getTerrainMesh(Z.tileID),ae=T.getTerrainData(Z.tileID),re=L.getProjectionData({overscaledTileID:Z.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),le={u_ele_delta:T.getMeshFrameDelta(L.zoom)};G.draw(A,I.TRIANGLES,F,ti.disabled,k,ci.backCCW,le,ae,re,"terrain",ne.vertexBuffer,ne.indexBuffer,ne.segments)}A.bindFramebuffer.set(null),A.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain),function(y,T){const A=y.context,I=A.gl,L=y.transform,k=Di.unblended,F=new Zt(I.LEQUAL,Zt.ReadWrite,[0,1]),z=T.getCoordsTexture(),G=T.sourceCache.getRenderableTiles(),Z=y.useProgram("terrainCoords");A.bindFramebuffer.set(T.getFramebuffer("coords").framebuffer),A.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),A.clear({color:d.b7.transparent,depth:1}),T.coordsIndex=[];for(const ne of G){const ae=T.getTerrainMesh(ne.tileID),re=T.getTerrainData(ne.tileID);A.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,z.texture);const le={u_terrain_coords_id:(255-T.coordsIndex.length)/255,u_texture:0,u_ele_delta:T.getMeshFrameDelta(L.zoom)},me=L.getProjectionData({overscaledTileID:ne.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Z.draw(A,I.TRIANGLES,F,ti.disabled,k,ci.backCCW,le,re,me,"terrain",ae.vertexBuffer,ae.indexBuffer,ae.segments),T.coordsIndex.push(ne.tileID.key)}A.bindFramebuffer.set(null),A.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain))}renderLayer(e,n,c,f,y){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(f||[]).length)&&(this.id=c.id,d.c3(c)?function(T,A,I,L,k,F){if(T.renderPass!=="translucent")return;const{isRenderingToTexture:z}=F,G=ti.disabled,Z=T.colorModeForRenderPass();(I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ne,ae,re,le,me,pe,ye,Ee,be){const Ne=ae.transform,$e=ae.style.map.terrain,je=me==="map",He=pe==="map";for(const Ge of ne){const ft=le.getTile(Ge),ht=ft.getBucket(re);if(!ht||!ht.text||!ht.text.segments.get().length)continue;const it=d.ak(ht.textSizeData,Ne.zoom),St=d.az(ft,1,ae.transform.zoom),ii=It(je,ae.transform,St),di=re.layout.get("icon-text-fit")!=="none"&&ht.hasIconData();if(it){const oa=Math.pow(2,Ne.zoom-ft.tileID.overscaledZ),ki=$e?(ua,Ji)=>$e.getElevation(Ge,ua,Ji):null;Fl(ht,je,He,be,Ne,ii,oa,it,di,d.aA(Ne,ft,ye,Ee),Ge.toUnwrapped(),ki)}}}(L,T,I,A,I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),k),I.paint.get("icon-opacity").constantOr(1)!==0&&Qu(T,A,I,L,!1,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),I.layout.get("icon-rotation-alignment"),I.layout.get("icon-pitch-alignment"),I.layout.get("icon-keep-upright"),G,Z,z),I.paint.get("text-opacity").constantOr(1)!==0&&Qu(T,A,I,L,!0,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.layout.get("text-keep-upright"),G,Z,z),A.map.showCollisionBoxes&&(kn(T,A,I,L,!0),kn(T,A,I,L,!1))}(e,n,c,f,this.style.placement.variableOffsets,y):d.c4(c)?function(T,A,I,L,k){if(T.renderPass!=="translucent")return;const{isRenderingToTexture:F}=k,z=I.paint.get("circle-opacity"),G=I.paint.get("circle-stroke-width"),Z=I.paint.get("circle-stroke-opacity"),ne=!I.layout.get("circle-sort-key").isConstant();if(z.constantOr(1)===0&&(G.constantOr(1)===0||Z.constantOr(1)===0))return;const ae=T.context,re=ae.gl,le=T.transform,me=T.getDepthModeForSublayer(0,Zt.ReadOnly),pe=ti.disabled,ye=T.colorModeForRenderPass(),Ee=[],be=le.getCircleRadiusCorrection();for(let Ne=0;Ne<L.length;Ne++){const $e=L[Ne],je=A.getTile($e),He=je.getBucket(I);if(!He)continue;const Ge=I.paint.get("circle-translate"),ft=I.paint.get("circle-translate-anchor"),ht=d.aA(le,je,Ge,ft),it=He.programConfigurations.get(I.id),St=T.useProgram("circle",it),ii=He.layoutVertexBuffer,di=He.indexBuffer,oa=T.style.map.terrain&&T.style.map.terrain.getTerrainData($e),ki={programConfiguration:it,program:St,layoutVertexBuffer:ii,indexBuffer:di,uniformValues:qu(T,je,I,ht,be),terrainData:oa,projectionData:le.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!F,applyTerrainMatrix:!0})};if(ne){const ua=He.segments.get();for(const Ji of ua)Ee.push({segments:new d.aJ([Ji]),sortKey:Ji.sortKey,state:ki})}else Ee.push({segments:He.segments,sortKey:0,state:ki})}ne&&Ee.sort((Ne,$e)=>Ne.sortKey-$e.sortKey);for(const Ne of Ee){const{programConfiguration:$e,program:je,layoutVertexBuffer:He,indexBuffer:Ge,uniformValues:ft,terrainData:ht,projectionData:it}=Ne.state;je.draw(ae,re.TRIANGLES,me,pe,ye,ci.backCCW,ft,ht,it,I.id,He,Ge,Ne.segments,I.paint,T.transform.zoom,$e)}}(e,n,c,f,y):d.c5(c)?function(T,A,I,L,k){if(I.paint.get("heatmap-opacity")===0)return;const F=T.context,{isRenderingToTexture:z,isRenderingGlobe:G}=k;if(T.style.map.terrain){for(const Z of L){const ne=A.getTile(Z);A.hasRenderableParent(Z)||(T.renderPass==="offscreen"?ks(T,ne,I,Z,G):T.renderPass==="translucent"&&vo(T,I,Z,z,G))}F.viewport.set([0,0,T.width,T.height])}else T.renderPass==="offscreen"?function(Z,ne,ae,re){const le=Z.context,me=le.gl,pe=Z.transform,ye=ti.disabled,Ee=new Di([me.ONE,me.ONE],d.b7.transparent,[!0,!0,!0,!0]);(function(be,Ne,$e){const je=be.gl;be.activeTexture.set(je.TEXTURE1),be.viewport.set([0,0,Ne.width/4,Ne.height/4]);let He=$e.heatmapFbos.get(d.bW);He?(je.bindTexture(je.TEXTURE_2D,He.colorAttachment.get()),be.bindFramebuffer.set(He.framebuffer)):(He=lu(be,Ne.width/4,Ne.height/4),$e.heatmapFbos.set(d.bW,He))})(le,Z,ae),le.clear({color:d.b7.transparent});for(let be=0;be<re.length;be++){const Ne=re[be];if(ne.hasRenderableParent(Ne))continue;const $e=ne.getTile(Ne),je=$e.getBucket(ae);if(!je)continue;const He=je.programConfigurations.get(ae.id),Ge=Z.useProgram("heatmap",He),ft=pe.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ht=pe.getCircleRadiusCorrection();Ge.draw(le,me.TRIANGLES,Zt.disabled,ye,Ee,ci.backCCW,Mr($e,pe.zoom,ae.paint.get("heatmap-intensity"),ht),null,ft,ae.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,ae.paint,pe.zoom,He)}le.viewport.set([0,0,Z.width,Z.height])}(T,A,I,L):T.renderPass==="translucent"&&function(Z,ne){const ae=Z.context,re=ae.gl;ae.setColorMode(Z.colorModeForRenderPass());const le=ne.heatmapFbos.get(d.bW);le&&(ae.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_2D,le.colorAttachment.get()),ae.activeTexture.set(re.TEXTURE1),Ku(ae,ne).bind(re.LINEAR,re.CLAMP_TO_EDGE),Z.useProgram("heatmapTexture").draw(ae,re.TRIANGLES,Zt.disabled,ti.disabled,Z.colorModeForRenderPass(),ci.disabled,Sd(Z,ne,0,1),null,null,ne.id,Z.viewportBuffer,Z.quadTriangleIndexBuffer,Z.viewportSegments,ne.paint,Z.transform.zoom))}(T,I)}(e,n,c,f,y):d.c6(c)?function(T,A,I,L,k){if(T.renderPass!=="translucent")return;const{isRenderingToTexture:F}=k,z=I.paint.get("line-opacity"),G=I.paint.get("line-width");if(z.constantOr(1)===0||G.constantOr(1)===0)return;const Z=T.getDepthModeForSublayer(0,Zt.ReadOnly),ne=T.colorModeForRenderPass(),ae=I.paint.get("line-dasharray"),re=I.paint.get("line-pattern"),le=re.constantOr(1),me=I.paint.get("line-gradient"),pe=I.getCrossfadeParameters(),ye=le?"linePattern":ae?"lineSDF":me?"lineGradient":"line",Ee=T.context,be=Ee.gl,Ne=T.transform;let $e=!0;for(const je of L){const He=A.getTile(je);if(le&&!He.patternsLoaded())continue;const Ge=He.getBucket(I);if(!Ge)continue;const ft=Ge.programConfigurations.get(I.id),ht=T.context.program.get(),it=T.useProgram(ye,ft),St=$e||it.program!==ht,ii=T.style.map.terrain&&T.style.map.terrain.getTerrainData(je),di=re.constantOr(null);if(di&&He.imageAtlas){const ji=He.imageAtlas,wi=ji.patternPositions[di.to.toString()],La=ji.patternPositions[di.from.toString()];wi&&La&&ft.setConstantPatternPositions(wi,La)}const oa=Ne.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),ki=Ne.getPixelScale(),ua=le?Zu(T,He,I,ki,pe):ae?Md(T,He,I,ki,ae,pe):me?Gu(T,He,I,ki,Ge.lineClipsArray.length):Vu(T,He,I,ki);if(le)Ee.activeTexture.set(be.TEXTURE0),He.imageAtlasTexture.bind(be.LINEAR,be.CLAMP_TO_EDGE),ft.updatePaintBuffers(pe);else if(ae&&(St||T.lineAtlas.dirty))Ee.activeTexture.set(be.TEXTURE0),T.lineAtlas.bind(Ee);else if(me){const ji=Ge.gradients[I.id];let wi=ji.texture;if(I.gradientVersion!==ji.version){let La=256;if(I.stepInterpolant){const Za=A.getSource().maxzoom,an=je.canonical.z===Za?Math.ceil(1<<T.transform.maxZoom-je.canonical.z):1;La=d.ae(d.bX(Ge.maxLineLength/d.Z*1024*an),256,Ee.maxTextureSize)}ji.gradient=d.bY({expression:I.gradientExpression(),evaluationKey:"lineProgress",resolution:La,image:ji.gradient||void 0,clips:Ge.lineClipsArray}),ji.texture?ji.texture.update(ji.gradient):ji.texture=new bi(Ee,ji.gradient,be.RGBA),ji.version=I.gradientVersion,wi=ji.texture}Ee.activeTexture.set(be.TEXTURE0),wi.bind(I.stepInterpolant?be.NEAREST:be.LINEAR,be.CLAMP_TO_EDGE)}const Ji=T.stencilModeForClipping(je);it.draw(Ee,be.TRIANGLES,Z,Ji,ne,ci.disabled,ua,ii,oa,I.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,I.paint,T.transform.zoom,ft,Ge.layoutVertexBuffer2),$e=!1}}(e,n,c,f,y):d.c7(c)?function(T,A,I,L,k){const F=I.paint.get("fill-color"),z=I.paint.get("fill-opacity");if(z.constantOr(1)===0)return;const{isRenderingToTexture:G}=k,Z=T.colorModeForRenderPass(),ne=I.paint.get("fill-pattern"),ae=T.opaquePassEnabledForLayer()&&!ne.constantOr(1)&&F.constantOr(d.b7.transparent).a===1&&z.constantOr(0)===1?"opaque":"translucent";if(T.renderPass===ae){const re=T.getDepthModeForSublayer(1,T.renderPass==="opaque"?Zt.ReadWrite:Zt.ReadOnly);xn(T,A,I,L,re,Z,!1,G)}if(T.renderPass==="translucent"&&I.paint.get("fill-antialias")){const re=T.getDepthModeForSublayer(I.getPaintProperty("fill-outline-color")?2:0,Zt.ReadOnly);xn(T,A,I,L,re,Z,!0,G)}}(e,n,c,f,y):d.c8(c)?function(T,A,I,L,k){const F=I.paint.get("fill-extrusion-opacity");if(F===0)return;const{isRenderingToTexture:z}=k;if(T.renderPass==="translucent"){const G=new Zt(T.context.gl.LEQUAL,Zt.ReadWrite,T.depthRangeFor3D);if(F!==1||I.paint.get("fill-extrusion-pattern").constantOr(1))zr(T,A,I,L,G,ti.disabled,Di.disabled,z),zr(T,A,I,L,G,T.stencilModeFor3D(),T.colorModeForRenderPass(),z);else{const Z=T.colorModeForRenderPass();zr(T,A,I,L,G,ti.disabled,Z,z)}}}(e,n,c,f,y):d.c9(c)?function(T,A,I,L,k){if(T.renderPass!=="offscreen"&&T.renderPass!=="translucent")return;const{isRenderingToTexture:F}=k,z=T.context,G=T.style.projection.useSubdivision,Z=T.getDepthModeForSublayer(0,Zt.ReadOnly),ne=T.colorModeForRenderPass();if(T.renderPass==="offscreen")(function(ae,re,le,me,pe,ye,Ee){const be=ae.context,Ne=be.gl;for(const $e of le){const je=re.getTile($e),He=je.dem;if(!He||!He.data||!je.needsHillshadePrepare)continue;const Ge=He.dim,ft=He.stride,ht=He.getPixels();if(be.activeTexture.set(Ne.TEXTURE1),be.pixelStoreUnpackPremultiplyAlpha.set(!1),je.demTexture=je.demTexture||ae.getTileTexture(ft),je.demTexture){const St=je.demTexture;St.update(ht,{premultiply:!1}),St.bind(Ne.NEAREST,Ne.CLAMP_TO_EDGE)}else je.demTexture=new bi(be,ht,Ne.RGBA,{premultiply:!1}),je.demTexture.bind(Ne.NEAREST,Ne.CLAMP_TO_EDGE);be.activeTexture.set(Ne.TEXTURE0);let it=je.fbo;if(!it){const St=new bi(be,{width:Ge,height:Ge,data:null},Ne.RGBA);St.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE),it=je.fbo=be.createFramebuffer(Ge,Ge,!0,!1),it.colorAttachment.set(St.texture)}be.bindFramebuffer.set(it.framebuffer),be.viewport.set([0,0,Ge,Ge]),ae.useProgram("hillshadePrepare").draw(be,Ne.TRIANGLES,pe,ye,Ee,ci.disabled,qf(je.tileID,He),null,null,me.id,ae.rasterBoundsBuffer,ae.quadTriangleIndexBuffer,ae.rasterBoundsSegments),je.needsHillshadePrepare=!1}})(T,A,L,I,Z,ti.disabled,ne),z.viewport.set([0,0,T.width,T.height]);else if(T.renderPass==="translucent")if(G){const[ae,re,le]=T.stencilConfigForOverlapTwoPass(L);Fr(T,A,I,le,ae,Z,ne,!1,F),Fr(T,A,I,le,re,Z,ne,!0,F)}else{const[ae,re]=T.getStencilConfigForOverlapAndUpdateStencilID(L);Fr(T,A,I,re,ae,Z,ne,!1,F)}}(e,n,c,f,y):d.ca(c)?function(T,A,I,L,k){if(T.renderPass!=="translucent"||I.paint.get("raster-opacity")===0||!L.length)return;const{isRenderingToTexture:F}=k,z=A.getSource(),G=T.style.projection.useSubdivision;if(z instanceof Vn)os(T,A,I,L,null,!1,!1,z.tileCoords,z.flippedWindingOrder,F);else if(G){const[Z,ne,ae]=T.stencilConfigForOverlapTwoPass(L);os(T,A,I,ae,Z,!1,!0,dr,!1,F),os(T,A,I,ae,ne,!0,!0,dr,!1,F)}else{const[Z,ne]=T.getStencilConfigForOverlapAndUpdateStencilID(L);os(T,A,I,ne,Z,!1,!0,dr,!1,F)}}(e,n,c,f,y):d.cb(c)?function(T,A,I,L,k){const F=I.paint.get("background-color"),z=I.paint.get("background-opacity");if(z===0)return;const{isRenderingToTexture:G}=k,Z=T.context,ne=Z.gl,ae=T.style.projection,re=T.transform,le=re.tileSize,me=I.paint.get("background-pattern");if(T.isPatternMissing(me))return;const pe=!me&&F.a===1&&z===1&&T.opaquePassEnabledForLayer()?"opaque":"translucent";if(T.renderPass!==pe)return;const ye=ti.disabled,Ee=T.getDepthModeForSublayer(0,pe==="opaque"?Zt.ReadWrite:Zt.ReadOnly),be=T.colorModeForRenderPass(),Ne=T.useProgram(me?"backgroundPattern":"background"),$e=L||Ae(re,{tileSize:le,terrain:T.style.map.terrain});me&&(Z.activeTexture.set(ne.TEXTURE0),T.imageManager.bind(T.context));const je=I.getCrossfadeParameters();for(const He of $e){const Ge=re.getProjectionData({overscaledTileID:He,applyGlobeMatrix:!G,applyTerrainMatrix:!0}),ft=me?Vf(z,T,me,{tileID:He,tileSize:le},je):Id(z,F),ht=T.style.map.terrain&&T.style.map.terrain.getTerrainData(He),it=ae.getMeshFromTileID(Z,He.canonical,!1,!0,"raster");Ne.draw(Z,ne.TRIANGLES,Ee,ye,be,ci.backCCW,ft,ht,Ge,I.id,it.vertexBuffer,it.indexBuffer,it.segments)}}(e,0,c,f,y):d.cc(c)&&function(T,A,I,L){const{isRenderingGlobe:k}=L,F=T.context,z=I.implementation,G=T.style.projection,Z=T.transform,ne=Z.getProjectionDataForCustomLayer(k),ae={farZ:Z.farZ,nearZ:Z.nearZ,fov:Z.fov*Math.PI/180,modelViewProjectionMatrix:Z.modelViewProjectionMatrix,projectionMatrix:Z.projectionMatrix,shaderData:{variantName:G.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${G.shaderPreludeCode.vertexSource}`,define:G.shaderDefine},defaultProjectionData:ne},re=z.renderingMode?z.renderingMode:"2d";if(T.renderPass==="offscreen"){const le=z.prerender;le&&(T.setCustomLayerDefaults(),F.setColorMode(T.colorModeForRenderPass()),le.call(z,F.gl,ae),F.setDirty(),T.setBaseState())}else if(T.renderPass==="translucent"){T.setCustomLayerDefaults(),F.setColorMode(T.colorModeForRenderPass()),F.setStencilMode(ti.disabled);const le=re==="3d"?T.getDepthModeFor3D():T.getDepthModeForSublayer(0,Zt.ReadOnly);F.setDepthMode(le),z.render(F.gl,ae),F.setDirty(),T.setBaseState(),F.bindFramebuffer.set(null)}}(e,0,c,y))}saveTileTexture(e){const n=this._tileTextures[e.size[0]];n?n.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const n=this._tileTextures[e];return n&&n.length>0?n.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const n=this.imageManager.getPattern(e.from.toString()),c=this.imageManager.getPattern(e.to.toString());return!n||!c}useProgram(e,n,c=!1,f=[]){this.cache=this.cache||{};const y=!!this.style.map.terrain,T=this.style.projection,A=c?Pn.projectionMercator:T.shaderPreludeCode,I=c?qo:T.shaderDefine,L=e+(n?n.cacheKey:"")+`/${c?pi:T.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(y?"/terrain":"")+(f?`/${f.join("/")}`:"");return this.cache[L]||(this.cache[L]=new wc(this.context,Pn[e],n,Dd[e],this._showOverdrawInspector,y,A,I,f)),this.cache[L]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new bi(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:n}=this.context.gl;return this.width!==e||this.height!==n}}function zs(g,e){let n,c=!1,f=null,y=null;const T=()=>{f=null,c&&(g.apply(y,n),f=setTimeout(T,e),c=!1)};return(...A)=>(c=!0,y=this,n=A,f||T(),f)}class kc{constructor(e){this._getCurrentHash=()=>{const n=window.location.hash.replace("#","");if(this._hashName){let c;return n.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return n.split("/")},this._onHashChange=()=>{const n=this._getCurrentHash();if(!this._isValidHash(n))return!1;const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:c,pitch:+(n[4]||0)}),!0},this._updateHashUnthrottled=()=>{const n=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,n)},this._removeHash=()=>{const n=this._getCurrentHash();if(n.length===0)return;const c=n.join("/");let f=c;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${c}`);let y=window.location.hash.replace(f,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let T=window.location.href.replace(/(#.+)?$/,y);T=T.replace("&&","&"),window.history.replaceState(window.history.state,null,T)},this._updateHash=zs(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const n=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,f=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,f),T=Math.round(n.lng*y)/y,A=Math.round(n.lat*y)/y,I=this._map.getBearing(),L=this._map.getPitch();let k="";if(k+=e?`/${T}/${A}/${c}`:`${c}/${A}/${T}`,(I||L)&&(k+="/"+Math.round(10*I)/10),L&&(k+=`/${Math.round(L)}`),this._hashName){const F=this._hashName;let z=!1;const G=window.location.hash.slice(1).split("&").map(Z=>{const ne=Z.split("=")[0];return ne===F?(z=!0,`${ne}=${k}`):Z}).filter(Z=>Z);return z||G.push(`${F}=${k}`),`#${G.join("&")}`}return`#${k}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new d.Q(+e[2],+e[1])}catch{return!1}const n=+e[0],c=+(e[3]||0),f=+(e[4]||0);return n>=this._map.getMinZoom()&&n<=this._map.getMaxZoom()&&c>=-180&&c<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const Qn={linearity:.3,easing:d.cd(0,0,.3,1)},Hl=d.e({deceleration:2500,maxSpeed:1400},Qn),Hr=d.e({deceleration:20,maxSpeed:1400},Qn),jr=d.e({deceleration:1e3,maxSpeed:360},Qn),Fs=d.e({deceleration:1e3,maxSpeed:90},Qn),ls=d.e({deceleration:1e3,maxSpeed:360},Qn);class Bc{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Me.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=Me.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,roll:0,pan:new d.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)n.zoom+=y.zoomDelta||0,n.bearing+=y.bearingDelta||0,n.pitch+=y.pitchDelta||0,n.roll+=y.rollDelta||0,y.panDelta&&n.pan._add(y.panDelta),y.around&&(n.around=y.around),y.pinchAround&&(n.pinchAround=y.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(n.pan.mag()){const y=cs(n.pan.mag(),c,d.e({},Hl,e||{})),T=n.pan.mult(y.amount/n.pan.mag()),A=this._map.cameraHelper.handlePanInertia(T,this._map.transform);f.center=A.easingCenter,f.offset=A.easingOffset,To(f,y)}if(n.zoom){const y=cs(n.zoom,c,Hr);f.zoom=this._map.transform.zoom+y.amount,To(f,y)}if(n.bearing){const y=cs(n.bearing,c,jr);f.bearing=this._map.transform.bearing+d.ae(y.amount,-179,179),To(f,y)}if(n.pitch){const y=cs(n.pitch,c,Fs);f.pitch=this._map.transform.pitch+y.amount,To(f,y)}if(n.roll){const y=cs(n.roll,c,ls);f.roll=this._map.transform.roll+d.ae(y.amount,-179,179),To(f,y)}if(f.zoom||f.bearing){const y=n.pinchAround===void 0?n.around:n.pinchAround;f.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),d.e(f,{noMoveStart:!0})}}function To(g,e){(!g.duration||g.duration<e.duration)&&(g.duration=e.duration,g.easing=e.easing)}function cs(g,e,n){const{maxSpeed:c,linearity:f,deceleration:y}=n,T=d.ae(g*f/(e/1e3),-c,c),A=Math.abs(T)/(y*f);return{easing:n.easing,duration:1e3*A,amount:T*(A/2)}}class Aa extends d.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,c,f={}){c=c instanceof MouseEvent?c:new MouseEvent(e,c);const y=fe.mousePos(n.getCanvas(),c),T=n.unproject(y);super(e,d.e({point:y,lngLat:T,originalEvent:c},f)),this._defaultPrevented=!1,this.target=n}}class Dr extends d.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,c){const f=e==="touchend"?c.changedTouches:c.touches,y=fe.touchPos(n.getCanvasContainer(),f),T=y.map(I=>n.unproject(I)),A=y.reduce((I,L,k,F)=>I.add(L.div(F.length)),new d.P(0,0));super(e,{points:y,point:A,lngLats:T,lngLat:n.unproject(A),originalEvent:c}),this._defaultPrevented=!1}}class tn extends d.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,c){super(e,{originalEvent:c}),this._defaultPrevented=!1}}class jl{constructor(e,n){this._map=e,this._clickTolerance=n.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new tn(e.type,this._map,e))}mousedown(e,n){return this._mousedownPos=n,this._firePreventable(new Aa(e.type,this._map,e))}mouseup(e){this._map.fire(new Aa(e.type,this._map,e))}click(e,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||this._map.fire(new Aa(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Aa(e.type,this._map,e))}mouseover(e){this._map.fire(new Aa(e.type,this._map,e))}mouseout(e){this._map.fire(new Aa(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Dr(e.type,this._map,e))}touchmove(e){this._map.fire(new Dr(e.type,this._map,e))}touchend(e){this._map.fire(new Dr(e.type,this._map,e))}touchcancel(e){this._map.fire(new Dr(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class zh{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Aa(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Aa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Aa(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ju{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(d.P.convert(e),this._map.terrain)}}class Fh{constructor(e,n){this._map=e,this._tr=new Ju(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,n){this.isEnabled()&&e.shiftKey&&e.button===0&&(fe.disableDrag(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(e,n){if(!this._active)return;const c=n;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=c,this._box||(this._box=fe.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const y=Math.min(f.x,c.x),T=Math.max(f.x,c.x),A=Math.min(f.y,c.y),I=Math.max(f.y,c.y);fe.setTransform(this._box,`translate(${y}px,${A}px)`),this._box.style.width=T-y+"px",this._box.style.height=I-A+"px"}mouseupWindow(e,n){if(!this._active||e.button!==0)return;const c=this._startPos,f=n;if(this.reset(),fe.suppressClick(),c.x!==f.x||c.y!==f.y)return this._map.fire(new d.l("boxzoomend",{originalEvent:e})),{cameraAnimation:y=>y.fitScreenCoordinates(c,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(fe.remove(this._box),this._box=null),fe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new d.l(e,{originalEvent:n}))}}function zc(g,e){if(g.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${e.length}`);const n={};for(let c=0;c<g.length;c++)n[g[c].identifier]=e[c];return n}class Ua{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),c.length===this.numTouches&&(this.centroid=function(f){const y=new d.P(0,0);for(const T of f)y._add(T);return y.div(f.length)}(n),this.touches=zc(c,n)))}touchmove(e,n,c){if(this.aborted||!this.centroid)return;const f=zc(c,n);for(const y in this.touches){const T=f[y];(!T||T.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(e,n,c){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class Eo{constructor(e){this.singleTap=new Ua(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,n,c){this.singleTap.touchstart(e,n,c)}touchmove(e,n,c){this.singleTap.touchmove(e,n,c)}touchend(e,n,c){const f=this.singleTap.touchend(e,n,c);if(f){const y=e.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(f)<30;if(y&&T||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class el{constructor(e){this._tr=new Ju(e),this._zoomIn=new Eo({numTouches:1,numTaps:2}),this._zoomOut=new Eo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,n,c){this._zoomIn.touchstart(e,n,c),this._zoomOut.touchstart(e,n,c)}touchmove(e,n,c){this._zoomIn.touchmove(e,n,c),this._zoomOut.touchmove(e,n,c)}touchend(e,n,c){const f=this._zoomIn.touchend(e,n,c),y=this._zoomOut.touchend(e,n,c),T=this._tr;return f?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:T.zoom+1,around:T.unproject(f)},{originalEvent:e})}):y?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:T.zoom-1,around:T.unproject(y)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ha{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const n=this._moveFunction(...e);if(n.bearingDelta||n.pitchDelta||n.rollDelta||n.around||n.panDelta)return this._active=!0,n}dragStart(e,n){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(n)?n[0]:n,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,n){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const f=Array.isArray(n)?n[0]:n;return!this._moved&&f.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(c,f))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&fe.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const fr={0:1,2:2};class qr{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const n=fe.mouseButton(e);this._eventButton=n}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(n,c){const f=fr[c];return n.buttons===void 0||(n.buttons&f)!==f}(e,this._eventButton)}isValidEndEvent(e){return fe.mouseButton(e)===this._eventButton}}class Tn{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class tl{constructor(e=new qr({checkCorrectEvent:()=>!0}),n=new Tn){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=n}_executeRelevantHandler(e,n,c){return e instanceof MouseEvent?n(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?c(e):void 0}startMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.startMove(n),n=>this.oneFingerTouchMoveStateManager.startMove(n))}endMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.endMove(n),n=>this.oneFingerTouchMoveStateManager.endMove(n))}isValidStartEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidStartEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidStartEvent(n))}isValidMoveEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidMoveEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(n))}isValidEndEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidEndEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidEndEvent(n))}}const ql=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=e=>{e.preventDefault()}};class Gf{constructor(e,n){this._clickTolerance=e.clickTolerance||1,this._map=n,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new d.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,n,c){return this._calculateTransform(e,n,c)}touchmove(e,n,c){if(this._active){if(!this._shouldBePrevented(c.length))return e.preventDefault(),this._calculateTransform(e,n,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,n,c){this._calculateTransform(e,n,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,c){c.length>0&&(this._active=!0);const f=zc(c,n),y=new d.P(0,0),T=new d.P(0,0);let A=0;for(const L in f){const k=f[L],F=this._touches[L];F&&(y._add(k),T._add(k.sub(F)),A++,f[L]=k)}if(this._touches=f,this._shouldBePrevented(A)||!T.mag())return;const I=T.div(A);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(A),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,n,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([n[0],n[1]]))}touchmove(e,n,c){if(!this._firstTwoTouches)return;e.preventDefault();const[f,y]=this._firstTwoTouches,T=hs(c,n,f),A=hs(c,n,y);if(!T||!A)return;const I=this._aroundCenter?null:T.add(A).div(2);return this._move([T,A],I,e)}touchend(e,n,c){if(!this._firstTwoTouches)return;const[f,y]=this._firstTwoTouches,T=hs(c,n,f),A=hs(c,n,y);T&&A||(this._active&&fe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function hs(g,e,n){for(let c=0;c<g.length;c++)if(g[c].identifier===n)return e[c]}function Vl(g,e){return Math.log(g/e)/Math.LN2}class Us extends Fc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,n){const c=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Vl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Vl(this._distance,c),pinchAround:n}}}function Vr(g,e){return 180*g.angleWith(e)/Math.PI}class yt extends Fc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,n,c){const f=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Vr(this._vector,f),pinchAround:n}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const n=25/(Math.PI*this._minDiameter)*360,c=Vr(e,this._startVector);return Math.abs(c)<n}}function Gl(g){return Math.abs(g.y)>Math.abs(g.x)}class du extends Fc{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,n,c){super.touchstart(e,n,c),this._currentTouchCount=c.length}_start(e){this._lastPoints=e,Gl(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,n,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=e[0].sub(this._lastPoints[0]),y=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,y,c.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(f.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(e,n,c){if(this._valid!==void 0)return this._valid;const f=e.mag()>=2,y=n.mag()>=2;if(!f&&!y)return;if(!f||!y)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const T=e.y>0==n.y>0;return Gl(e)&&Gl(n)&&T}}const Uc={panStep:100,bearingStep:15,pitchStep:10};class fu{constructor(e){this._tr=new Ju(e);const n=Uc;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let n=0,c=0,f=0,y=0,T=0;switch(e.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:e.shiftKey?c=-1:(e.preventDefault(),y=-1);break;case 39:e.shiftKey?c=1:(e.preventDefault(),y=1);break;case 38:e.shiftKey?f=1:(e.preventDefault(),T=-1);break;case 40:e.shiftKey?f=-1:(e.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(c=0,f=0),{cameraAnimation:A=>{const I=this._tr;A.easeTo({duration:300,easeId:"keyboardHandler",easing:wo,zoom:n?Math.round(I.zoom)+n*(e.shiftKey?2:1):I.zoom,bearing:I.bearing+c*this._bearingStep,pitch:I.pitch+f*this._pitchStep,offset:[-y*this._panStep,-T*this._panStep],center:I.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function wo(g){return g*(2-g)}const Hc=4.000244140625;class ri{constructor(e,n){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=e,this._tr=new Ju(e),this._triggerRenderFrame=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const c=Me.now(),f=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,n!==0&&n%Hc==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(f*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=fe.mousePos(this._map.getCanvas(),e),c=this._tr;this._aroundPoint=this._aroundCenter?c.transform.locationToScreenPoint(d.Q.convert(c.center)):n,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const A=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=A),typeof this._targetZoom=="number"&&(this._targetZoom+=A)}if(this._delta!==0){const A=this._type==="wheel"&&Math.abs(this._delta)>Hc?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&I!==0&&(I=1/I);const L=typeof this._targetZoom!="number"?e.scale:d.ac(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),d.ah(L*I)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,c=this._startZoom,f=this._easing;let y,T=!1;if(this._type==="wheel"&&c&&f){const A=Me.now()-this._lastWheelEventTime,I=Math.min((A+5)/200,1),L=f(I);y=d.B.number(c,n,L),I<1?this._frameId||(this._frameId=!0):T=!0}else y=n,T=!0;return this._active=!0,T&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=y,{noInertia:!0,needsRenderFrame:!T,zoomDelta:y-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=d.cf;if(this._prevEase){const c=this._prevEase,f=(Me.now()-c.start)/c.duration,y=c.easing(f+.01)-c.easing(f),T=.27/Math.sqrt(y*y+1e-4)*.01,A=Math.sqrt(.0729-T*T);n=d.cd(T,A,.25,1)}return this._prevEase={start:Me.now(),duration:e,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Zl{constructor(e,n){this._clickZoom=e,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Nd{constructor(e){this._tr=new Ju(e),this.reset()}reset(){this._active=!1}dblclick(e,n){return e.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(n)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ds{constructor(){this._tap=new Eo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,n,c){if(!this._swipePoint)if(this._tapTime){const f=n[0],y=e.timeStamp-this._tapTime<500,T=this._tapPoint.dist(f)<30;y&&T?c.length>0&&(this._swipePoint=f,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(e,n,c)}touchmove(e,n,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const f=n[0],y=f.y-this._swipePoint.y;return this._swipePoint=f,e.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(e,n,c)}touchend(e,n,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const f=this._tap.touchend(e,n,c);f&&(this._tapTime=e.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jc{constructor(e,n,c){this._el=e,this._mousePan=n,this._touchPan=c}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qc{constructor(e,n,c,f){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=n,this._mousePitch=c,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class fs{constructor(e,n,c,f){this._el=e,this._touchZoom=n,this._touchRotate=c,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Gr{constructor(e,n){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=n,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=fe.create("div","maplibregl-cooperative-gesture-screen",e);let n=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(n=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=n,this._container.appendChild(f);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=c,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(fe.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,n){this._enabled&&(this._map.fire(new d.l("cooperativegestureprevented",{gestureType:e,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Hs=g=>g.zoom||g.drag||g.roll||g.pitch||g.rotate;class Uh extends d.l{}function il(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta||g.rollDelta}class Yl{constructor(e,n){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,y)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const T=f.type==="renderFrame"?void 0:f,A={needsRenderFrame:!1},I={},L={};for(const{handlerName:z,handler:G,allowed:Z}of this._handlers){if(!G.isEnabled())continue;let ne;if(this._blockedByActive(L,Z,z))G.reset();else if(G[y||f.type]){if(d.cg(f,y||f.type)){const ae=fe.mousePos(this._map.getCanvas(),f);ne=G[y||f.type](f,ae)}else if(d.ch(f,y||f.type)){const ae=this._getMapTouches(f.touches),re=fe.touchPos(this._map.getCanvas(),ae);ne=G[y||f.type](f,re,ae)}else d.ci(y||f.type)||(ne=G[y||f.type](f));this.mergeHandlerResult(A,I,ne,z,T),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()}(ne||G.isActive())&&(L[z]=G)}const k={};for(const z in this._previousActiveHandlers)L[z]||(k[z]=T);this._previousActiveHandlers=L,(Object.keys(k).length||il(A))&&(this._changes.push([A,I,k]),this._triggerRenderFrame()),(Object.keys(L).length||il(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:F}=A;F&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],F(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Bc(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,y,T]of this._listeners)fe.addEventListener(f,y,f===document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[e,n,c]of this._listeners)fe.removeEventListener(e,n,e===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(e){const n=this._map,c=n.getCanvasContainer();this._add("mapEvent",new jl(n,e));const f=n.boxZoom=new Fh(n,e);this._add("boxZoom",f),e.interactive&&e.boxZoom&&f.enable();const y=n.cooperativeGestures=new Gr(n,e.cooperativeGestures);this._add("cooperativeGestures",y),e.cooperativeGestures&&y.enable();const T=new el(n),A=new Nd(n);n.doubleClickZoom=new Zl(A,T),this._add("tapZoom",T),this._add("clickZoom",A),e.interactive&&e.doubleClickZoom&&n.doubleClickZoom.enable();const I=new ds;this._add("tapDragZoom",I);const L=n.touchPitch=new du(n);this._add("touchPitch",L),e.interactive&&e.touchPitch&&n.touchPitch.enable(e.touchPitch);const k=()=>n.project(n.getCenter()),F=function({enable:pe,clickTolerance:ye,aroundCenter:Ee=!0,minPixelCenterThreshold:be=100,rotateDegreesPerPixelMoved:Ne=.8},$e){const je=new qr({checkCorrectEvent:He=>fe.mouseButton(He)===0&&He.ctrlKey||fe.mouseButton(He)===2&&!He.ctrlKey});return new Ha({clickTolerance:ye,move:(He,Ge)=>{const ft=$e();if(Ee&&Math.abs(ft.y-He.y)>be)return{bearingDelta:d.ce(new d.P(He.x,Ge.y),Ge,ft)};let ht=(Ge.x-He.x)*Ne;return Ee&&Ge.y<ft.y&&(ht=-ht),{bearingDelta:ht}},moveStateManager:je,enable:pe,assignEvents:ql})}(e,k),z=function({enable:pe,clickTolerance:ye,pitchDegreesPerPixelMoved:Ee=-.5}){const be=new qr({checkCorrectEvent:Ne=>fe.mouseButton(Ne)===0&&Ne.ctrlKey||fe.mouseButton(Ne)===2});return new Ha({clickTolerance:ye,move:(Ne,$e)=>({pitchDelta:($e.y-Ne.y)*Ee}),moveStateManager:be,enable:pe,assignEvents:ql})}(e),G=function({enable:pe,clickTolerance:ye,rollDegreesPerPixelMoved:Ee=.3},be){const Ne=new qr({checkCorrectEvent:$e=>fe.mouseButton($e)===2&&$e.ctrlKey});return new Ha({clickTolerance:ye,move:($e,je)=>{const He=be();let Ge=(je.x-$e.x)*Ee;return je.y<He.y&&(Ge=-Ge),{rollDelta:Ge}},moveStateManager:Ne,enable:pe,assignEvents:ql})}(e,k);n.dragRotate=new qc(e,F,z,G),this._add("mouseRotate",F,["mousePitch"]),this._add("mousePitch",z,["mouseRotate","mouseRoll"]),this._add("mouseRoll",G,["mousePitch"]),e.interactive&&e.dragRotate&&n.dragRotate.enable();const Z=function({enable:pe,clickTolerance:ye}){const Ee=new qr({checkCorrectEvent:be=>fe.mouseButton(be)===0&&!be.ctrlKey});return new Ha({clickTolerance:ye,move:(be,Ne)=>({around:Ne,panDelta:Ne.sub(be)}),activateOnStart:!0,moveStateManager:Ee,enable:pe,assignEvents:ql})}(e),ne=new Gf(e,n);n.dragPan=new jc(c,Z,ne),this._add("mousePan",Z),this._add("touchPan",ne,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&n.dragPan.enable(e.dragPan);const ae=new yt,re=new Us;n.touchZoomRotate=new fs(c,re,ae,I),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&n.touchZoomRotate.enable(e.touchZoomRotate);const le=n.scrollZoom=new ri(n,()=>this._triggerRenderFrame());this._add("scrollZoom",le,["mousePan"]),e.interactive&&e.scrollZoom&&n.scrollZoom.enable(e.scrollZoom);const me=n.keyboard=new fu(n);this._add("keyboard",me),e.interactive&&e.keyboard&&n.keyboard.enable(),this._add("blockableMapEvent",new zh(n))}_add(e,n,c){this._handlers.push({handlerName:e,handler:n,allowed:c}),this._handlersById[e]=n}stop(e){if(!this._updatingCamera){for(const{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Hs(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,n,c){for(const f in e)if(f!==c&&(!n||n.indexOf(f)<0))return!0;return!1}_getMapTouches(e){const n=[];for(const c of e)this._el.contains(c.target)&&n.push(c);return n}mergeHandlerResult(e,n,c,f,y){if(!c)return;d.e(e,c);const T={handlerName:f,originalEvent:c.originalEvent||y};c.zoomDelta!==void 0&&(n.zoom=T),c.panDelta!==void 0&&(n.drag=T),c.rollDelta!==void 0&&(n.roll=T),c.pitchDelta!==void 0&&(n.pitch=T),c.bearingDelta!==void 0&&(n.rotate=T)}_applyChanges(){const e={},n={},c={};for(const[f,y,T]of this._changes)f.panDelta&&(e.panDelta=(e.panDelta||new d.P(0,0))._add(f.panDelta)),f.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(e.rollDelta=(e.rollDelta||0)+f.rollDelta),f.around!==void 0&&(e.around=f.around),f.pinchAround!==void 0&&(e.pinchAround=f.pinchAround),f.noInertia&&(e.noInertia=f.noInertia),d.e(n,y),d.e(c,T);this._updateMapTransform(e,n,c),this._changes=[]}_updateMapTransform(e,n,c){const f=this._map,y=f._getTransformForUpdate(),T=f.terrain;if(!(il(e)||T&&this._terrainMovement))return this._fireEvents(n,c,!0);f._stop(!0);let{panDelta:A,zoomDelta:I,bearingDelta:L,pitchDelta:k,rollDelta:F,around:z,pinchAround:G}=e;G!==void 0&&(z=G),z=z||f.transform.centerPoint,T&&!y.isPointOnMapSurface(z)&&(z=y.centerPoint);const Z={panDelta:A,zoomDelta:I,rollDelta:F,pitchDelta:k,bearingDelta:L,around:z};this._map.cameraHelper.useGlobeControls&&!y.isPointOnMapSurface(z)&&(z=y.centerPoint);const ne=z.distSqr(y.centerPoint)<.01?y.center:y.screenPointToLocation(A?z.sub(A):z);T?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Z,y),this._terrainMovement||!n.drag&&!n.zoom?n.drag&&this._terrainMovement?y.setCenter(y.screenPointToLocation(y.centerPoint.sub(A))):this._map.cameraHelper.handleMapControlsPan(Z,y,ne):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Z,y,ne))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Z,y),this._map.cameraHelper.handleMapControlsPan(Z,y,ne)),f._applyUpdatedTransform(y),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,c,!0)}_fireEvents(e,n,c){const f=Hs(this._eventsInProgress),y=Hs(e),T={};for(const F in e){const{originalEvent:z}=e[F];this._eventsInProgress[F]||(T[`${F}start`]=z),this._eventsInProgress[F]=e[F]}!f&&y&&this._fireEvent("movestart",y.originalEvent);for(const F in T)this._fireEvent(F,T[F]);y&&this._fireEvent("move",y.originalEvent);for(const F in e){const{originalEvent:z}=e[F];this._fireEvent(F,z)}const A={};let I;for(const F in this._eventsInProgress){const{handlerName:z,originalEvent:G}=this._eventsInProgress[F];this._handlersById[z].isActive()||(delete this._eventsInProgress[F],I=n[z]||G,A[`${F}end`]=I)}for(const F in A)this._fireEvent(F,A[F]);const L=Hs(this._eventsInProgress),k=(f||y)&&!L;if(k&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const F=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&F.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(F)}if(c&&k){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),z=G=>G!==0&&-this._bearingSnap<G&&G<this._bearingSnap;!F||!F.essential&&Me.prefersReducedMotion?(this._map.fire(new d.l("moveend",{originalEvent:I})),z(this._map.getBearing())&&this._map.resetNorth()):(z(F.bearing||this._map.getBearing())&&(F.bearing=0),F.freezeElevation=!0,this._map.easeTo(F,{originalEvent:I})),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new d.l(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Uh("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class $l extends d.E{constructor(e,n,c){super(),this._renderFrameCallback=()=>{const f=Math.min((Me.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=c.bearingSnap,this.cameraHelper=n,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,n){e.apply(this.transform),this.transform=e,this.cameraHelper=n}getCenter(){return new d.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,n){return this.jumpTo({center:e},n)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,n){return this.jumpTo({elevation:e},n),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,n,c){return e=d.P.convert(e).mult(-1),this.panTo(this.transform.center,d.e({offset:e},n),c)}panTo(e,n,c){return this.easeTo(d.e({center:e},n),c)}getZoom(){return this.transform.zoom}setZoom(e,n){return this.jumpTo({zoom:e},n),this}zoomTo(e,n,c){return this.easeTo(d.e({zoom:e},n),c)}zoomIn(e,n){return this.zoomTo(this.getZoom()+1,e,n),this}zoomOut(e,n){return this.zoomTo(this.getZoom()-1,e,n),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,n){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new d.l("movestart",n)).fire(new d.l("move",n)).fire(new d.l("moveend",n))),this}getBearing(){return this.transform.bearing}setBearing(e,n){return this.jumpTo({bearing:e},n),this}getPadding(){return this.transform.padding}setPadding(e,n){return this.jumpTo({padding:e},n),this}rotateTo(e,n,c){return this.easeTo(d.e({bearing:e},n),c)}resetNorth(e,n){return this.rotateTo(0,d.e({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(d.e({bearing:0,pitch:0,roll:0,duration:1e3},e),n),this}snapToNorth(e,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,n):this}getPitch(){return this.transform.pitch}setPitch(e,n){return this.jumpTo({pitch:e},n),this}getRoll(){return this.transform.roll}setRoll(e,n){return this.jumpTo({roll:e},n),this}cameraForBounds(e,n){e=Oi.convert(e).adjustAntiMeridian();const c=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),c,n)}_cameraForBoxAndBearing(e,n,c,f){const y={top:0,bottom:0,right:0,left:0};if(typeof(f=d.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const L=f.padding;f.padding={top:L,bottom:L,right:L,left:L}}const T=d.e(y,f.padding);f.padding=T;const A=this.transform,I=new Oi(e,n);return this.cameraHelper.cameraForBoxAndBearing(f,T,I,c,A)}fitBounds(e,n,c){return this._fitInternal(this.cameraForBounds(e,n),n,c)}fitScreenCoordinates(e,n,c,f,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(d.P.convert(e)),this.transform.screenPointToLocation(d.P.convert(n)),c,f),f,y)}_fitInternal(e,n,c){return e?(delete(n=d.e(e,n)).padding,n.linear?this.easeTo(n,c):this.flyTo(n,c)):this}jumpTo(e,n){this.stop();const c=this._getTransformForUpdate();let f=!1,y=!1,T=!1;const A=c.zoom;this.cameraHelper.handleJumpToCenterZoom(c,e);const I=c.zoom!==A;return"elevation"in e&&c.elevation!==+e.elevation&&c.setElevation(+e.elevation),"bearing"in e&&c.bearing!==+e.bearing&&(f=!0,c.setBearing(+e.bearing)),"pitch"in e&&c.pitch!==+e.pitch&&(y=!0,c.setPitch(+e.pitch)),"roll"in e&&c.roll!==+e.roll&&(T=!0,c.setRoll(+e.roll)),e.padding==null||c.isPaddingEqual(e.padding)||c.setPadding(e.padding),this._applyUpdatedTransform(c),this.fire(new d.l("movestart",n)).fire(new d.l("move",n)),I&&this.fire(new d.l("zoomstart",n)).fire(new d.l("zoom",n)).fire(new d.l("zoomend",n)),f&&this.fire(new d.l("rotatestart",n)).fire(new d.l("rotate",n)).fire(new d.l("rotateend",n)),y&&this.fire(new d.l("pitchstart",n)).fire(new d.l("pitch",n)).fire(new d.l("pitchend",n)),T&&this.fire(new d.l("rollstart",n)).fire(new d.l("roll",n)).fire(new d.l("rollend",n)),this.fire(new d.l("moveend",n))}calculateCameraOptionsFromTo(e,n,c,f=0){const y=d.$.fromLngLat(e,n),T=d.$.fromLngLat(c,f),A=T.x-y.x,I=T.y-y.y,L=T.z-y.z,k=Math.hypot(A,I,L);if(k===0)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(A,I),z=d.ah(this.transform.cameraToCenterDistance/k/this.transform.tileSize),G=180*Math.atan2(A,-I)/Math.PI;let Z=180*Math.acos(F/k)/Math.PI;return Z=L<0?90-Z:90+Z,{center:T.toLngLat(),elevation:f,zoom:z,pitch:Z,bearing:G}}calculateCameraOptionsFromCameraLngLatAltRotation(e,n,c,f,y){const T=this.transform.calculateCenterFromCameraLngLatAlt(e,n,c,f);return{center:T.center,elevation:T.elevation,zoom:T.zoom,bearing:c,pitch:f,roll:y}}easeTo(e,n){this._stop(!1,e.easeId),((e=d.e({offset:[0,0],duration:500,easing:d.cf},e)).animate===!1||!e.essential&&Me.prefersReducedMotion)&&(e.duration=0);const c=this._getTransformForUpdate(),f=this.getBearing(),y=c.pitch,T=c.roll,A="bearing"in e?this._normalizeBearing(e.bearing,f):f,I="pitch"in e?+e.pitch:y,L="roll"in e?this._normalizeBearing(e.roll,T):T,k="padding"in e?e.padding:c.padding,F=d.P.convert(e.offset);let z,G;e.around&&(z=d.Q.convert(e.around),G=c.locationToScreenPoint(z));const Z={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ne=this.cameraHelper.handleEaseTo(c,{bearing:A,pitch:I,roll:L,padding:k,around:z,aroundPoint:G,offsetAsPoint:F,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||f!==A,this._pitching=this._pitching||I!==y,this._rolling=this._rolling||L!==T,this._padding=!c.isPaddingEqual(k),this._zooming=this._zooming||ne.isZooming,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,Z),this.terrain&&this._prepareElevation(ne.elevationCenter),this._ease(ae=>{ne.easeFunc(ae),this.terrain&&!e.freezeElevation&&this._updateElevation(ae),this._applyUpdatedTransform(c),this._fireMoveEvents(n)},ae=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n,ae)},e),this}_prepareEase(e,n,c={}){this._moving=!0,n||c.moving||this.fire(new d.l("movestart",e)),this._zooming&&!c.zooming&&this.fire(new d.l("zoomstart",e)),this._rotating&&!c.rotating&&this.fire(new d.l("rotatestart",e)),this._pitching&&!c.pitching&&this.fire(new d.l("pitchstart",e)),this._rolling&&!c.rolling&&this.fire(new d.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&n!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(c-(n-(c*e+this._elevationStart))/(1-e)),this._elevationTarget=n}this.transform.setElevation(d.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const n=e.getCameraLngLat(),c=e.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(n,e.zoom):0;if(c<f){const y=this.calculateCameraOptionsFromTo(n,f,e.center,e.elevation);return{pitch:y.pitch,zoom:y.zoom}}return{}}_applyUpdatedTransform(e){const n=[];if(n.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&n.push(f=>this.transformCameraUpdate(f)),!n.length)return;const c=e.clone();for(const f of n){const y=c.clone(),{center:T,zoom:A,roll:I,pitch:L,bearing:k,elevation:F}=f(y);T&&y.setCenter(T),F!==void 0&&y.setElevation(F),A!==void 0&&y.setZoom(A),I!==void 0&&y.setRoll(I),L!==void 0&&y.setPitch(L),k!==void 0&&y.setBearing(k),c.apply(y)}this.transform.apply(c)}_fireMoveEvents(e){this.fire(new d.l("move",e)),this._zooming&&this.fire(new d.l("zoom",e)),this._rotating&&this.fire(new d.l("rotate",e)),this._pitching&&this.fire(new d.l("pitch",e)),this._rolling&&this.fire(new d.l("roll",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const c=this._zooming,f=this._rotating,y=this._pitching,T=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,c&&this.fire(new d.l("zoomend",e)),f&&this.fire(new d.l("rotateend",e)),y&&this.fire(new d.l("pitchend",e)),T&&this.fire(new d.l("rollend",e)),this.fire(new d.l("moveend",e))}flyTo(e,n){if(!e.essential&&Me.prefersReducedMotion){const Ge=d.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ge,n)}this.stop(),e=d.e({offset:[0,0],speed:1.2,curve:1.42,easing:d.cf},e);const c=this._getTransformForUpdate(),f=c.bearing,y=c.pitch,T=c.roll,A=c.padding,I="bearing"in e?this._normalizeBearing(e.bearing,f):f,L="pitch"in e?+e.pitch:y,k="roll"in e?this._normalizeBearing(e.roll,T):T,F="padding"in e?e.padding:c.padding,z=d.P.convert(e.offset);let G=c.centerPoint.add(z);const Z=c.screenPointToLocation(G),ne=this.cameraHelper.handleFlyTo(c,{bearing:I,pitch:L,roll:k,padding:F,locationAtOffset:Z,offsetAsPoint:z,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ae=e.curve;const re=Math.max(c.width,c.height),le=re/ne.scaleOfZoom,me=ne.pixelPathLength;typeof ne.scaleOfMinZoom=="number"&&(ae=Math.sqrt(re/ne.scaleOfMinZoom/me*2));const pe=ae*ae;function ye(Ge){const ft=(le*le-re*re+(Ge?-1:1)*pe*pe*me*me)/(2*(Ge?le:re)*pe*me);return Math.log(Math.sqrt(ft*ft+1)-ft)}function Ee(Ge){return(Math.exp(Ge)-Math.exp(-Ge))/2}function be(Ge){return(Math.exp(Ge)+Math.exp(-Ge))/2}const Ne=ye(!1);let $e=function(Ge){return be(Ne)/be(Ne+ae*Ge)},je=function(Ge){return re*((be(Ne)*(Ee(ft=Ne+ae*Ge)/be(ft))-Ee(Ne))/pe)/me;var ft},He=(ye(!0)-Ne)/ae;if(Math.abs(me)<2e-6||!isFinite(He)){if(Math.abs(re-le)<1e-6)return this.easeTo(e,n);const Ge=le<re?-1:1;He=Math.abs(Math.log(le/re))/ae,je=()=>0,$e=ft=>Math.exp(Ge*ae*ft)}return e.duration="duration"in e?+e.duration:1e3*He/("screenSpeed"in e?+e.screenSpeed/ae:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=f!==I,this._pitching=L!==y,this._rolling=k!==T,this._padding=!c.isPaddingEqual(F),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(ne.targetCenter),this._ease(Ge=>{const ft=Ge*He,ht=1/$e(ft),it=je(ft);this._rotating&&c.setBearing(d.B.number(f,I,Ge)),this._pitching&&c.setPitch(d.B.number(y,L,Ge)),this._rolling&&c.setRoll(d.B.number(T,k,Ge)),this._padding&&(c.interpolatePadding(A,F,Ge),G=c.centerPoint.add(z)),ne.easeFunc(Ge,ht,it,G),this.terrain&&!e.freezeElevation&&this._updateElevation(Ge),this._applyUpdatedTransform(c),this._fireMoveEvents(n)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,n){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,n)}return e||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(e,n,c){c.animate===!1||c.duration===0?(e(1),n()):(this._easeStart=Me.now(),this._easeOptions=c,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,n){e=d.aL(e,-180,180);const c=Math.abs(e-n);return Math.abs(e-360-n)<c&&(e-=360),Math.abs(e+360-n)<c&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(d.Q.convert(e),this.transform.tileZoom):null}}const ps={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Yi{constructor(e=ps){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=n=>{!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=fe.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=fe.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=fe.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){fe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,n){const c=this._map._getUIString(`AttributionControl.${n}`);e.title=c,e.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const n=this._map.style.sourceCaches;for(const f in n){const y=n[f];if(y.used||y.usedForTerrain){const T=y.getSource();T.attribution&&e.indexOf(T.attribution)<0&&e.push(T.attribution)}}e=e.filter(f=>String(f).trim()),e.sort((f,y)=>f.length-y.length),e=e.filter((f,y)=>{for(let T=y+1;T<e.length;T++)if(e[T].indexOf(f)>=0)return!1;return!0});const c=e.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,e.length?(this._innerContainer.innerHTML=fe.sanitize(c),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ms{constructor(e={}){this._updateCompact=()=>{const n=this._container.children;if(n.length){const c=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=fe.create("div","maplibregl-ctrl");const n=fe.create("a","maplibregl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://maplibre.org/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){fe.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class al{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const n=++this._id;return this._queue.push({callback:e,id:n,cancelled:!1}),n}remove(e){const n=this._currentlyRunning,c=n?this._queue.concat(n):this._queue;for(const f of c)if(f.id===e)return void(f.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const n=this._currentlyRunning=this._queue;this._queue=[];for(const c of n)if(!c.cancelled&&(c.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Hh=d.aG([{name:"a_pos3d",type:"Int16",components:3}]);class Vc extends d.E{constructor(e){super(),this._lastTilesetChange=Me.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];const c={};for(const f of Ae(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))c[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),d.bQ(f.terrainRttPosMatrix32f,0,d.Z,d.Z,0,0,1),this._tiles[f.key]=new Pa(f,this.tileSize),this._lastTilesetChange=Me.now());for(const f in this._tiles)c[f]||delete this._tiles[f]}freeRtt(e){for(const n in this._tiles){const c=this._tiles[n];(!e||c.tileID.equals(e)||c.tileID.isChildOf(e)||e.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,n){return n?this._getTerrainCoordsForTileRanges(e,n):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const n={};for(const c of this._renderableTilesKeys){const f=this._tiles[c].tileID,y=e.clone(),T=d.b2();if(f.canonical.equals(e.canonical))d.bQ(T,0,d.Z,d.Z,0,0,1);else if(f.canonical.isChildOf(e.canonical)){const A=f.canonical.z-e.canonical.z,I=f.canonical.x-(f.canonical.x>>A<<A),L=f.canonical.y-(f.canonical.y>>A<<A),k=d.Z>>A;d.bQ(T,0,k,k,0,0,1),d.L(T,T,[-I*k,-L*k,0])}else{if(!e.canonical.isChildOf(f.canonical))continue;{const A=e.canonical.z-f.canonical.z,I=e.canonical.x-(e.canonical.x>>A<<A),L=e.canonical.y-(e.canonical.y>>A<<A),k=d.Z>>A;d.bQ(T,0,d.Z,d.Z,0,0,1),d.L(T,T,[I*k,L*k,0]),d.M(T,T,[1/2**A,1/2**A,0])}}y.terrainRttPosMatrix32f=new Float32Array(T),n[c]=y}return n}_getTerrainCoordsForTileRanges(e,n){const c={};for(const f of this._renderableTilesKeys){const y=this._tiles[f].tileID;if(!this._isWithinTileRanges(y,n))continue;const T=e.clone(),A=d.b2();if(y.canonical.z===e.canonical.z){const I=e.canonical.x-y.canonical.x,L=e.canonical.y-y.canonical.y;d.bQ(A,0,d.Z,d.Z,0,0,1),d.L(A,A,[I*d.Z,L*d.Z,0])}else if(y.canonical.z>e.canonical.z){const I=y.canonical.z-e.canonical.z,L=y.canonical.x-(y.canonical.x>>I<<I),k=y.canonical.y-(y.canonical.y>>I<<I),F=e.canonical.x-(y.canonical.x>>I),z=e.canonical.y-(y.canonical.y>>I),G=d.Z>>I;d.bQ(A,0,G,G,0,0,1),d.L(A,A,[-L*G+F*d.Z,-k*G+z*d.Z,0])}else{const I=e.canonical.z-y.canonical.z,L=e.canonical.x-(e.canonical.x>>I<<I),k=e.canonical.y-(e.canonical.y>>I<<I),F=(e.canonical.x>>I)-y.canonical.x,z=(e.canonical.y>>I)-y.canonical.y,G=d.Z<<I;d.bQ(A,0,G,G,0,0,1),d.L(A,A,[L*d.Z+F*G,k*d.Z+z*G,0])}T.terrainRttPosMatrix32f=new Float32Array(A),c[f]=T}return c}getSourceTile(e,n){const c=this.sourceCache._source;let f=e.overscaledZ-this.deltaZoom;if(f>c.maxzoom&&(f=c.maxzoom),f<c.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(f).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!y||!y.dem)&&n)for(;f>=c.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(e.scaledTo(f--).key);return y}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,n){return n[e.canonical.z]&&e.canonical.x>=n[e.canonical.z].minTileX&&e.canonical.x<=n[e.canonical.z].maxTileX&&e.canonical.y>=n[e.canonical.z].minTileY&&e.canonical.y<=n[e.canonical.z].maxTileY}}class Gc{constructor(e,n,c){this._meshCache={},this.painter=e,this.sourceCache=new Vc(n),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,n,c,f=d.Z){var y;if(!(n>=0&&n<f&&c>=0&&c<f))return 0;const T=this.getTerrainData(e),A=(y=T.tile)===null||y===void 0?void 0:y.dem;if(!A)return 0;const I=d.cj([],[n/f*d.Z,c/f*d.Z],T.u_terrain_matrix),L=[I[0]*A.dim,I[1]*A.dim],k=Math.floor(L[0]),F=Math.floor(L[1]),z=L[0]-k,G=L[1]-F;return A.get(k,F)*(1-z)*(1-G)+A.get(k+1,F)*z*(1-G)+A.get(k,F+1)*(1-z)*G+A.get(k+1,F+1)*z*G}getElevationForLngLatZoom(e,n){if(!d.ck(n,e.wrap()))return 0;const{tileID:c,mercatorX:f,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(e,n);return this.getElevation(c,f%d.Z,y%d.Z,d.Z)}getElevation(e,n,c,f=d.Z){return this.getDEMElevation(e,n,c,f)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const f=this.painter.context,y=new d.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new bi(f,y,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new bi(f,new d.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=d.ad([])}const n=this.sourceCache.getSourceTile(e,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const f=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new bi(f,n.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),n.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const c=n&&n+n.tileID.key+e.key;if(c&&!this._demMatrixCache[c]){const f=this.sourceCache.sourceCache._source.maxzoom;let y=e.canonical.z-n.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=f?y=e.canonical.z-f:d.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const T=e.canonical.x-(e.canonical.x>>y<<y),A=e.canonical.y-(e.canonical.y>>y<<y),I=d.cl(new Float64Array(16),[1/(d.Z<<y),1/(d.Z<<y),0]);d.L(I,I,[T*d.Z,A*d.Z,0]),this._demMatrixCache[e.key]={matrix:I,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(e){const n=this.painter,c=n.width/devicePixelRatio,f=n.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new bi(n.context,{width:c,height:f,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new bi(n.context,{width:c,height:f,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=n.context.createFramebuffer(c,f,!0,!1),this._fbo.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,c,f))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,T=0;y<this._coordsTextureSize;y++)for(let A=0;A<this._coordsTextureSize;A++,T+=4)n[T+0]=255&A,n[T+1]=255&y,n[T+2]=A>>8<<4|y>>8,n[T+3]=0;const c=new d.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),f=new bi(e,c,e.gl.RGBA,{premultiply:!1});return f.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),c=this.painter.context,f=c.gl,y=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),T=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),A=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(y,A-T-1,1,1,f.RGBA,f.UNSIGNED_BYTE,n),c.bindFramebuffer.set(null);const I=n[0]+(n[2]>>4<<8),L=n[1]+((15&n[2])<<8),k=this.coordsIndex[255-n[3]],F=k&&this.sourceCache.getTileByID(k);if(!F)return null;const z=this._coordsTextureSize,G=(1<<F.tileID.canonical.z)*z;return new d.$((F.tileID.canonical.x*z+I)/G+F.tileID.wrap,(F.tileID.canonical.y*z+L)/G,this.getElevation(F.tileID,I,L,z))}depthAtPoint(e){const n=new Uint8Array(4),c=this.painter.context,f=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,n),c.bindFramebuffer.set(null),(n[0]/16777216+n[1]/65536+n[2]/256+n[3])/256}getTerrainMesh(e){var n;const c=((n=this.painter.style.projection)===null||n===void 0?void 0:n.transitionState)>0,f=c&&e.canonical.y===0,y=c&&e.canonical.y===(1<<e.canonical.z)-1,T=`m_${f?"n":""}_${y?"s":""}`;if(this._meshCache[T])return this._meshCache[T];const A=this.painter.context,I=new d.cm,L=new d.aK,k=this.meshSize,F=d.Z/k,z=k*k;for(let be=0;be<=k;be++)for(let Ne=0;Ne<=k;Ne++)I.emplaceBack(Ne*F,be*F,0);for(let be=0;be<z;be+=k+1)for(let Ne=0;Ne<k;Ne++)L.emplaceBack(Ne+be,k+Ne+be+1,k+Ne+be+2),L.emplaceBack(Ne+be,k+Ne+be+2,Ne+be+1);const G=I.length,Z=G+(k+1),ne=(k+1)*k,ae=f?d.b9:0,re=f?0:1,le=y?d.ba:d.Z,me=y?0:1;for(let be=0;be<=k;be++)I.emplaceBack(be*F,ae,re);for(let be=0;be<=k;be++)I.emplaceBack(be*F,le,me);for(let be=0;be<k;be++)L.emplaceBack(ne+be,Z+be,Z+be+1),L.emplaceBack(ne+be,Z+be+1,ne+be+1),L.emplaceBack(0+be,G+be+1,G+be),L.emplaceBack(0+be,0+be+1,G+be+1);const pe=I.length,ye=pe+2*(k+1);for(const be of[0,1])for(let Ne=0;Ne<=k;Ne++)for(const $e of[0,1])I.emplaceBack(be*d.Z,Ne*F,$e);for(let be=0;be<2*k;be+=2)L.emplaceBack(pe+be,pe+be+1,pe+be+3),L.emplaceBack(pe+be,pe+be+3,pe+be+2),L.emplaceBack(ye+be,ye+be+3,ye+be+1),L.emplaceBack(ye+be,ye+be+2,ye+be+3);const Ee=new jo(A.createVertexBuffer(I,Hh.members),A.createIndexBuffer(L),d.aJ.simpleSegment(0,0,I.length,L.length));return this._meshCache[T]=Ee,Ee}getMeshFrameDelta(e){return 2*Math.PI*d.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,n){var c;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(e,n);return(c=this.getMinMaxElevation(f).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(e){const n=this.getTerrainData(e).tile,c={minElevation:null,maxElevation:null};return n&&n.dem&&(c.minElevation=n.dem.min*this.exaggeration,c.maxElevation=n.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(e,n){const c=d.$.fromLngLat(e.wrap()),f=(1<<n)*d.Z,y=c.x*f,T=c.y*f,A=Math.floor(y/d.Z),I=Math.floor(T/d.Z);return{tileID:new d.Y(n,0,n,A,I),mercatorX:y,mercatorY:T}}}class Ao{constructor(e,n,c){this._context=e,this._size=n,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const n=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new bi(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),n.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),n.colorAttachment.set(c.texture),{id:e,fbo:n,texture:c,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(n=>e.id!==n),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const n of this._recentlyUsed)if(!this._objects[n].inUse)return this._objects[n];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const qt={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ri{constructor(e,n){this.painter=e,this.terrain=n,this.pool=new Ao(e.context,30,n.sourceCache.tileSize*n.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,n){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(c=>!e._layers[c].isHidden(n)),this._coordsAscending={};for(const c in e.sourceCaches){this._coordsAscending[c]={};const f=e.sourceCaches[c].getVisibleCoordinates(),y=e.sourceCaches[c].getSource(),T=y instanceof Vn?y.terrainTileRanges:null;for(const A of f){const I=this.terrain.sourceCache.getTerrainCoords(A,T);for(const L in I)this._coordsAscending[c][L]||(this._coordsAscending[c][L]=[]),this._coordsAscending[c][L].push(I[L])}}this._coordsAscendingStr={};for(const c of e._order){const f=e._layers[c],y=f.source;if(qt[f.type]&&!this._coordsAscendingStr[y]){this._coordsAscendingStr[y]={};for(const T in this._coordsAscending[y])this._coordsAscendingStr[y][T]=this._coordsAscending[y][T].map(A=>A.key).sort().join()}}for(const c of this._renderableTiles)for(const f in this._coordsAscendingStr){const y=this._coordsAscendingStr[f][c.tileID.key];y&&y!==c.rttCoords[f]&&(c.rtt=[])}}renderLayer(e,n){if(e.isHidden(this.painter.transform.zoom))return!1;const c=Object.assign(Object.assign({},n),{isRenderingToTexture:!0}),f=e.type,y=this.painter,T=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(qt[f]&&(this._prevType&&qt[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(e.id),!T))return!0;if(qt[this._prevType]||qt[f]&&T){this._prevType=f;const A=this._stacks.length-1,I=this._stacks[A]||[];for(const L of this._renderableTiles){if(this.pool.isFull()&&(Bs(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(L),L.rtt[A]){const F=this.pool.getObjectForId(L.rtt[A].id);if(F.stamp===L.rtt[A].stamp){this.pool.useObject(F);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),L.rtt[A]={id:k.id,stamp:k.stamp},y.context.bindFramebuffer.set(k.fbo.framebuffer),y.context.clear({color:d.b7.transparent,stencil:0}),y.currentStencilSource=void 0;for(let F=0;F<I.length;F++){const z=y.style._layers[I[F]],G=z.source?this._coordsAscending[z.source][L.tileID.key]:[L.tileID];y.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),y._renderTileClippingMasks(z,G,!0),y.renderLayer(y,y.style.sourceCaches[z.source],z,G,c),z.source&&(L.rttCoords[z.source]=this._coordsAscendingStr[z.source][L.tileID.key])}}return Bs(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects(),qt[f]}return!1}}const gt={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},zt=K,gs={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ps,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:d.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},js={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class nl{constructor(e,n,c=!1){this.mousedown=y=>{this.startMove(y,fe.mousePos(this.element,y)),fe.addEventListener(window,"mousemove",this.mousemove),fe.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=y=>{this.move(y,fe.mousePos(this.element,y))},this.mouseup=y=>{this._rotatePitchHanlder.dragEnd(y),this.offTemp()},this.touchstart=y=>{y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=fe.touchPos(this.element,y.targetTouches)[0],this.startMove(y,this._startPos),fe.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),fe.addEventListener(window,"touchend",this.touchend))},this.touchmove=y=>{y.targetTouches.length!==1?this.reset():(this._lastPos=fe.touchPos(this.element,y.targetTouches)[0],this.move(y,this._lastPos))},this.touchend=y=>{y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=n;const f=new tl;this._rotatePitchHanlder=new Ha({clickTolerance:3,move:(y,T)=>{const A=n.getBoundingClientRect(),I=new d.P((A.bottom-A.top)/2,(A.right-A.left)/2);return{bearingDelta:d.ce(new d.P(y.x,T.y),T,I),pitchDelta:c?-.5*(T.y-y.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=e,fe.addEventListener(n,"mousedown",this.mousedown),fe.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),fe.addEventListener(n,"touchcancel",this.reset)}startMove(e,n){this._rotatePitchHanlder.dragStart(e,n),fe.disableDrag()}move(e,n){const c=this.map,{bearingDelta:f,pitchDelta:y}=this._rotatePitchHanlder.dragMove(e,n)||{};f&&c.setBearing(c.getBearing()+f),y&&c.setPitch(c.getPitch()+y)}off(){const e=this.element;fe.removeEventListener(e,"mousedown",this.mousedown),fe.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),fe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),fe.removeEventListener(window,"touchend",this.touchend),fe.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){fe.enableDrag(),fe.removeEventListener(window,"mousemove",this.mousemove),fe.removeEventListener(window,"mouseup",this.mouseup),fe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),fe.removeEventListener(window,"touchend",this.touchend)}}let ca;function So(g,e,n,c=!1){if(c||!n.getCoveringTilesDetailsProvider().allowWorldCopies())return g==null?void 0:g.wrap();const f=new d.Q(g.lng,g.lat);if(g=new d.Q(g.lng,g.lat),e){const y=new d.Q(g.lng-360,g.lat),T=new d.Q(g.lng+360,g.lat),A=n.locationToScreenPoint(g).distSqr(e);n.locationToScreenPoint(y).distSqr(e)<A?g=y:n.locationToScreenPoint(T).distSqr(e)<A&&(g=T)}for(;Math.abs(g.lng-n.center.lng)>180;){const y=n.locationToScreenPoint(g);if(y.x>=0&&y.y>=0&&y.x<=n.width&&y.y<=n.height)break;g.lng>n.center.lng?g.lng-=360:g.lng+=360}return g.lng!==f.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(g))?g:f}const Rr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Sa(g,e,n){const c=g.classList;for(const f in Rr)c.remove(`maplibregl-${n}-anchor-${f}`);c.add(`maplibregl-${n}-anchor-${e}`)}class qs extends d.E{constructor(e){if(super(),this._onKeyPress=n=>{const c=n.code,f=n.charCode||n.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=n=>{const c=n.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()},this._update=n=>{if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();((n==null?void 0:n.type)==="terrain"||(n==null?void 0:n.type)==="render"&&!c)&&this._map.once("render",this._update),this._lngLat=So(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||n&&n.type!=="moveend"||(this._pos=this._pos.round()),fe.setTransform(this._element,`${Rr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${f}`),Me.frameAsync(new AbortController).then(()=>{this._updateOpacity(n&&n.type==="moveend")}).catch(()=>{})},this._onMove=n=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new d.l("dragstart"))),this.fire(new d.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new d.l("dragend")),this._state="inactive"},this._addDragHandler=n=>{this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=d.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=fe.create("div");const n=fe.createNS("http://www.w3.org/2000/svg","svg"),c=41,f=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${c}px`),n.setAttributeNS(null,"width",`${f}px`),n.setAttributeNS(null,"viewBox",`0 0 ${f} ${c}`);const y=fe.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const T=fe.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");const A=fe.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"transform","translate(3.0, 29.0)"),A.setAttributeNS(null,"fill","#000000");const I=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const re of I){const le=fe.createNS("http://www.w3.org/2000/svg","ellipse");le.setAttributeNS(null,"opacity","0.04"),le.setAttributeNS(null,"cx","10.5"),le.setAttributeNS(null,"cy","5.80029008"),le.setAttributeNS(null,"rx",re.rx),le.setAttributeNS(null,"ry",re.ry),A.appendChild(le)}const L=fe.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill",this._color);const k=fe.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),L.appendChild(k);const F=fe.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"opacity","0.25"),F.setAttributeNS(null,"fill","#000000");const z=fe.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),F.appendChild(z);const G=fe.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(6.0, 7.0)"),G.setAttributeNS(null,"fill","#FFFFFF");const Z=fe.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ne=fe.createNS("http://www.w3.org/2000/svg","circle");ne.setAttributeNS(null,"fill","#000000"),ne.setAttributeNS(null,"opacity","0.25"),ne.setAttributeNS(null,"cx","5.5"),ne.setAttributeNS(null,"cy","5.5"),ne.setAttributeNS(null,"r","5.4999962");const ae=fe.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#FFFFFF"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962"),Z.appendChild(ne),Z.appendChild(ae),T.appendChild(A),T.appendChild(L),T.appendChild(F),T.appendChild(G),T.appendChild(Z),n.appendChild(T),n.setAttributeNS(null,"height",c*this._scale+"px"),n.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(n),this._offset=d.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",n=>{n.preventDefault()}),this._element.addEventListener("mousedown",n=>{n.preventDefault()}),Sa(this._element,this._anchor,"marker"),e&&e.className)for(const n of e.className.split(" "))this._element.classList.add(n);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),fe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=d.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const f=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var n,c;const f=(n=this._map)===null||n===void 0?void 0:n.terrain,y=this._map.transform.isLocationOccluded(this._lngLat);if(!f||y){const G=y?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==G&&(this._element.style.opacity=G))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const T=this._map,A=T.terrain.depthAtPoint(this._pos),I=T.terrain.getElevationForLngLatZoom(this._lngLat,T.transform.tileZoom);if(T.transform.lngLatToCameraDepth(this._lngLat,I)-A<.006)return void(this._element.style.opacity=this._opacity);const L=-this._offset.y/T.transform.pixelsPerMeter,k=Math.sin(T.getPitch()*Math.PI/180)*L,F=T.terrain.depthAtPoint(new d.P(this._pos.x,this._pos.y-this._offset.y)),z=T.transform.lngLatToCameraDepth(this._lngLat,I+k)-F>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&z&&this._popup.remove(),this._element.style.opacity=z?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=d.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,n){return(this._opacity===void 0||e===void 0&&n===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),n!==void 0&&(this._opacityWhenCovered=n),this._map&&this._updateOpacity(!0),this}}const na={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ra=0,pu=!1;const Xl={maxWidth:100,unit:"metric"};function mu(g,e,n){const c=n&&n.maxWidth||100,f=g._container.clientHeight/2,y=g._container.clientWidth/2,T=g.unproject([y-c/2,f]),A=g.unproject([y+c/2,f]),I=Math.round(g.project(A).x-g.project(T).x),L=Math.min(c,I,g._container.clientWidth),k=T.distanceTo(A);if(n&&n.unit==="imperial"){const F=3.2808*k;F>5280?Vs(e,L,F/5280,g._getUIString("ScaleControl.Miles")):Vs(e,L,F,g._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Vs(e,L,k/1852,g._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Vs(e,L,k/1e3,g._getUIString("ScaleControl.Kilometers")):Vs(e,L,k,g._getUIString("ScaleControl.Meters"))}function Vs(g,e,n,c){const f=function(y){const T=Math.pow(10,`${Math.floor(y)}`.length-1);let A=y/T;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:function(I){const L=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*L)/L}(A),T*A}(n);g.style.width=e*(f/n)+"px",g.innerHTML=`${f}&nbsp;${c}`}const Ql={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},En=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function sa(g){if(g){if(typeof g=="number"){const e=Math.round(Math.abs(g)/Math.SQRT2);return{center:new d.P(0,0),top:new d.P(0,g),"top-left":new d.P(e,e),"top-right":new d.P(-e,e),bottom:new d.P(0,-g),"bottom-left":new d.P(e,-e),"bottom-right":new d.P(-e,-e),left:new d.P(g,0),right:new d.P(-g,0)}}if(g instanceof d.P||Array.isArray(g)){const e=d.P.convert(g);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:d.P.convert(g.center||[0,0]),top:d.P.convert(g.top||[0,0]),"top-left":d.P.convert(g["top-left"]||[0,0]),"top-right":d.P.convert(g["top-right"]||[0,0]),bottom:d.P.convert(g.bottom||[0,0]),"bottom-left":d.P.convert(g["bottom-left"]||[0,0]),"bottom-right":d.P.convert(g["bottom-right"]||[0,0]),left:d.P.convert(g.left||[0,0]),right:d.P.convert(g.right||[0,0])}}return sa(new d.P(0,0))}const Kl=K;M.AJAXError=d.cq,M.Event=d.l,M.Evented=d.E,M.LngLat=d.Q,M.MercatorCoordinate=d.$,M.Point=d.P,M.addProtocol=d.cr,M.config=d.a,M.removeProtocol=d.cs,M.AttributionControl=Yi,M.BoxZoomHandler=Fh,M.CanvasSource=zo,M.CooperativeGesturesHandler=Gr,M.DoubleClickZoomHandler=Zl,M.DragPanHandler=jc,M.DragRotateHandler=qc,M.EdgeInsets=Vo,M.FullscreenControl=class extends d.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var e;let n=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=n==null?void 0:n.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)n=n.shadowRoot.fullscreenElement;n===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:d.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=fe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){fe.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=fe.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);fe.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new d.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new d.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},M.GeoJSONSource=Du,M.GeolocateControl=class extends d.E{constructor(g){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new d.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new d.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const n=new d.Q(e.coords.longitude,e.coords.latitude),c=e.coords.accuracy,f=this._map.getBearing(),y=d.e({bearing:f},this.options.fitBoundsOptions),T=Oi.fromLngLat(n,c);this._map.fitBounds(T,y,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const n=new d.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&pu)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new d.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=fe.create("button","maplibregl-ctrl-geolocate",this._container),fe.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){d.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=fe.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new qs({element:this._dotElement}),this._circleElement=fe.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new qs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new d.l("trackuserlocationend")),this.fire(new d.l("userlocationlostfocus")))})}},this.options=d.e({},na,g)}onAdd(g){return this._map=g,this._container=fe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return d._(this,arguments,void 0,function*(e=!1){if(ca!==void 0&&!e)return ca;if(window.navigator.permissions===void 0)return ca=!!window.navigator.geolocation,ca;try{ca=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ca=!!window.navigator.geolocation}return ca})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),fe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ra=0,pu=!1}_isOutOfMapMaxBounds(g){const e=this._map.getMaxBounds(),n=g.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),e=g.getSouthEast(),n=g.getNorthEast(),c=e.distanceTo(n),f=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return d.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ra--,pu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new d.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.l("trackuserlocationstart")),this.fire(new d.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ra++,ra>1?(g={maximumAge:6e5,timeout:0},pu=!0):(g=this.options.positionOptions,pu=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},M.GlobeControl=class{constructor(){this._toggleProjection=()=>{var g;const e=(g=this._map.getProjection())===null||g===void 0?void 0:g.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var g;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((g=this._map.getProjection())===null||g===void 0?void 0:g.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(g){return this._map=g,this._container=fe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=fe.create("button","maplibregl-ctrl-globe",this._container),fe.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){fe.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},M.Hash=kc,M.ImageSource=Vn,M.KeyboardHandler=fu,M.LngLatBounds=Oi,M.LogoControl=ms,M.Map=class extends $l{constructor(g){var e,n;d.cn.mark(d.co.create);const c=Object.assign(Object.assign(Object.assign({},gs),g),{canvasContextAttributes:Object.assign(Object.assign({},gs.canvasContextAttributes),g.canvasContextAttributes)});if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new is,y=new Ar;if(c.minZoom!==void 0&&f.setMinZoom(c.minZoom),c.maxZoom!==void 0&&f.setMaxZoom(c.maxZoom),c.minPitch!==void 0&&f.setMinPitch(c.minPitch),c.maxPitch!==void 0&&f.setMaxPitch(c.maxPitch),c.renderWorldCopies!==void 0&&f.setRenderWorldCopies(c.renderWorldCopies),super(f,y,{bearingSnap:c.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new al,this._controls=[],this._mapId=d.a4(),this._contextLost=A=>{A.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new d.l("webglcontextlost",{originalEvent:A}))},this._contextRestored=A=>{this._setupPainter(),this.resize(),this._update(),this.fire(new d.l("webglcontextrestored",{originalEvent:A}))},this._onMapScroll=A=>{if(A.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},c.canvasContextAttributes),this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._centerClampedToGround=c.centerClampedToGround,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},gt),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this.transformCameraUpdate=c.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Mt.addThrottleControl(()=>this.isMoving()),this._requestManager=new Et(c.transformRequest),typeof c.container=="string"){if(this._container=document.getElementById(c.container),!this._container)throw new Error(`Container '${c.container}' not found.`)}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let A=!1;const I=zs(L=>{this._trackResize&&!this._removed&&(this.resize(L),this.redraw())},50);this._resizeObserver=new ResizeObserver(L=>{A?I(L):A=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Yl(this,c),this._hash=c.hash&&new kc(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,elevation:c.elevation,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,roll:c.roll}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,d.e({},c.fitBoundsOptions,{duration:0}))));const T=typeof c.style=="string"||((n=(e=c.style)===null||e===void 0?void 0:e.projection)===null||n===void 0?void 0:n.type)!=="globe";this.resize(null,T),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new Yi(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new ms,c.logoPosition),this.on("style.load",()=>{if(T||this._resizeTransform(),this.transform.unmodified){const A=d.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(A)}}),this.on("data",A=>{this._update(A.dataType==="style"),this.fire(new d.l(`${A.dataType}data`,A))}),this.on("dataloading",A=>{this.fire(new d.l(`${A.dataType}dataloading`,A))}),this.on("dataabort",A=>{this.fire(new d.l("sourcedataabort",A))})}_getMapId(){return this._mapId}addControl(g,e){if(e===void 0&&(e=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new d.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=g.onAdd(this);this._controls.push(g);const c=this._controlPositions[e];return e.indexOf("bottom")!==-1?c.insertBefore(n,c.firstChild):c.appendChild(n),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new d.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(g);return e>-1&&this._controls.splice(e,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,e,n,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,e,n,c)}resize(g,e=!0){const[n,c]=this._containerDimensions(),f=this._getClampedPixelRatio(n,c);if(this._resizeCanvas(n,c,f),this.painter.resize(n,c,f),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const A=this._getClampedPixelRatio(n,c);this._resizeCanvas(n,c,A),this.painter.resize(n,c,A)}this._resizeTransform(e);const y=!this._moving;return y&&(this.stop(),this.fire(new d.l("movestart",g)).fire(new d.l("move",g))),this.fire(new d.l("resize",g)),y&&this.fire(new d.l("moveend",g)),this}_resizeTransform(g=!0){var e;const[n,c]=this._containerDimensions();this.transform.resize(n,c,g),(e=this._requestedCameraState)===null||e===void 0||e.resize(n,c,g)}_getClampedPixelRatio(g,e){const{0:n,1:c}=this._maxCanvasSize,f=this.getPixelRatio(),y=g*f,T=e*f;return Math.min(y>n?n/y:1,T>c?c/T:1)*f}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(Oi.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.setMinZoom(g),this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.setMaxZoom(g),this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.setMinPitch(g),this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(g>=this.transform.minPitch)return this.transform.setMaxPitch(g),this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.setRenderWorldCopies(g),this._update()}project(g){return this.transform.locationToScreenPoint(d.Q.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.screenPointToLocation(d.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,e,n){if(g==="mouseenter"||g==="mouseover"){let c=!1;return{layers:e,listener:n,delegates:{mousemove:y=>{const T=e.filter(I=>this.getLayer(I)),A=T.length!==0?this.queryRenderedFeatures(y.point,{layers:T}):[];A.length?c||(c=!0,n.call(this,new Aa(g,this,y.originalEvent,{features:A}))):c=!1},mouseout:()=>{c=!1}}}}if(g==="mouseleave"||g==="mouseout"){let c=!1;return{layers:e,listener:n,delegates:{mousemove:T=>{const A=e.filter(I=>this.getLayer(I));(A.length!==0?this.queryRenderedFeatures(T.point,{layers:A}):[]).length?c=!0:c&&(c=!1,n.call(this,new Aa(g,this,T.originalEvent)))},mouseout:T=>{c&&(c=!1,n.call(this,new Aa(g,this,T.originalEvent)))}}}}{const c=f=>{const y=e.filter(A=>this.getLayer(A)),T=y.length!==0?this.queryRenderedFeatures(f.point,{layers:y}):[];T.length&&(f.features=T,n.call(this,f),delete f.features)};return{layers:e,listener:n,delegates:{[g]:c}}}}_saveDelegatedListener(g,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(e)}_removeDelegatedListener(g,e,n){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const c=this._delegatedListeners[g];for(let f=0;f<c.length;f++){const y=c[f];if(y.listener===n&&y.layers.length===e.length&&y.layers.every(T=>e.includes(T))){for(const T in y.delegates)this.off(T,y.delegates[T]);return void c.splice(f,1)}}}on(g,e,n){if(n===void 0)return super.on(g,e);const c=typeof e=="string"?[e]:e,f=this._createDelegatedListener(g,c,n);this._saveDelegatedListener(g,f);for(const y in f.delegates)this.on(y,f.delegates[y]);return{unsubscribe:()=>{this._removeDelegatedListener(g,c,n)}}}once(g,e,n){if(n===void 0)return super.once(g,e);const c=typeof e=="string"?[e]:e,f=this._createDelegatedListener(g,c,n);for(const y in f.delegates){const T=f.delegates[y];f.delegates[y]=(...A)=>{this._removeDelegatedListener(g,c,n),T(...A)}}this._saveDelegatedListener(g,f);for(const y in f.delegates)this.once(y,f.delegates[y]);return this}off(g,e,n){return n===void 0?super.off(g,e):(this._removeDelegatedListener(g,typeof e=="string"?[e]:e,n),this)}queryRenderedFeatures(g,e){if(!this.style)return[];let n;const c=g instanceof d.P||Array.isArray(g),f=c?g:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(c?{}:g)||{},f instanceof d.P||typeof f[0]=="number")n=[d.P.convert(f)];else{const y=d.P.convert(f[0]),T=d.P.convert(f[1]);n=[y,new d.P(T.x,y.y),T,new d.P(y.x,T.y),y]}return this.style.queryRenderedFeatures(n,e,this.transform)}querySourceFeatures(g,e){return this.style.querySourceFeatures(g,e)}setStyle(g,e){return(e=d.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(g,e))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const e=this._locale[g];if(e==null)throw new Error(`Missing UI string '${g}'`);return e}_updateStyle(g,e){var n,c;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,e));const f=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new wh(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,e,f):this.style.loadJSON(g,e,f),this):((c=(n=this.style)===null||n===void 0?void 0:n.projection)===null||c===void 0||c.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new wh(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,e){if(typeof g=="string"){const n=this._requestManager.transformRequest(g,"Style");d.j(n,new AbortController).then(c=>{this._updateDiff(c.data,e)}).catch(c=>{c&&this.fire(new d.k(c))})}else typeof g=="object"&&this._updateDiff(g,e)}_updateDiff(g,e){try{this.style.setState(g,e)&&this._update(!0)}catch(n){d.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(g,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():d.w("There is no style added to the map.")}addSource(g,e){return this._lazyInitEmptyStyle(),this.style.addSource(g,e),this._update(!0)}isSourceLoaded(g){const e=this.style&&this.style.sourceCaches[g];if(e!==void 0)return e.loaded();this.fire(new d.k(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const e=this.style.sourceCaches[g.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&e.reload();for(const n in this.style._layers){const c=this.style._layers[n];c.type==="hillshade"&&c.source===g.source&&d.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Gc(this.painter,e,g),this.painter.renderToTexture=new Ri(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=n=>{var c;n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId!==g.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((c=n.source)===null||c===void 0?void 0:c.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new d.l("terrain",{terrain:g})),this}getTerrain(){var g,e;return(e=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const e in g){const n=g[e]._tiles;for(const c in n){const f=n[c];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}setSourceTileLodParams(g,e,n){if(n){const c=this.getSource(n);if(!c)throw new Error(`There is no source with ID "${n}", cannot set LOD parameters`);c.calculateTileZoom=ve(Math.max(1,g),Math.max(1,e))}else for(const c in this.style.sourceCaches)this.style.sourceCaches[c].getSource().calculateTileZoom=ve(Math.max(1,g),Math.max(1,e));return this._update(!0),this}refreshTiles(g,e){const n=this.style.sourceCaches[g];if(!n)throw new Error(`There is no source cache with ID "${g}", cannot refresh tile`);e===void 0?n.reload():n.refreshTiles(e.map(c=>new d.a1(c.z,c.x,c.y)))}addImage(g,e,n={}){const{pixelRatio:c=1,sdf:f=!1,stretchX:y,stretchY:T,content:A,textFitWidth:I,textFitHeight:L}=n;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||d.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new d.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:F,data:z}=e,G=e;return this.style.addImage(g,{data:new d.R({width:k,height:F},new Uint8Array(z)),pixelRatio:c,stretchX:y,stretchY:T,content:A,textFitWidth:I,textFitHeight:L,sdf:f,version:0,userImage:G}),G.onAdd&&G.onAdd(this,g),this}}{const{width:k,height:F,data:z}=Me.getImageData(e);this.style.addImage(g,{data:new d.R({width:k,height:F},z),pixelRatio:c,stretchX:y,stretchY:T,content:A,textFitWidth:I,textFitHeight:L,sdf:f,version:0})}}updateImage(g,e){const n=this.style.getImage(g);if(!n)return this.fire(new d.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=e instanceof HTMLImageElement||d.b(e)?Me.getImageData(e):e,{width:f,height:y,data:T}=c;if(f===void 0||y===void 0)return this.fire(new d.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==n.data.width||y!==n.data.height)return this.fire(new d.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const A=!(e instanceof HTMLImageElement||d.b(e));return n.data.replace(T,A),this.style.updateImage(g,n),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new d.k(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return Mt.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,e){return this._lazyInitEmptyStyle(),this.style.addLayer(g,e),this._update(!0)}moveLayer(g,e){return this.style.moveLayer(g,e),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,e,n){return this.style.setLayerZoomRange(g,e,n),this._update(!0)}setFilter(g,e,n={}){return this.style.setFilter(g,e,n),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,e,n,c={}){return this.style.setPaintProperty(g,e,n,c),this._update(!0)}getPaintProperty(g,e){return this.style.getPaintProperty(g,e)}setLayoutProperty(g,e,n,c={}){return this.style.setLayoutProperty(g,e,n,c),this._update(!0)}getLayoutProperty(g,e){return this.style.getLayoutProperty(g,e)}setGlyphs(g,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,e,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,e,n,c=>{c||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,e,n=>{n||this._update(!0)}),this}setLight(g,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(g,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(g,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,e){return this.style.setFeatureState(g,e),this._update()}removeFeatureState(g,e){return this.style.removeFeatureState(g,e),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,e=0;return this._container&&(g=this._container.clientWidth||400,e=this._container.clientHeight||300),[g,e]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const e=this._canvasContainer=fe.create("div","maplibregl-canvas-container",g);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=fe.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),c=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],c);const f=this._controlContainer=fe.create("div","maplibregl-control-container",g),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(T=>{y[T]=fe.create("div",`maplibregl-ctrl-${T} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,e,n){this._canvas.width=Math.floor(n*g),this._canvas.height=Math.floor(n*e),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const g=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{e={requestedAttributes:g},c&&(e.statusMessage=c.statusMessage,e.type=c.type)},{once:!0});let n=null;if(n=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,g):this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g),!n){const c="Failed to initialize WebGL";throw e?(e.message=c,new Error(JSON.stringify(e))):new Error(c)}this.painter=new hu(n,this.transform),Qe.testSupport(n)}migrateProjection(g,e){super.migrateProjection(g,e),this.painter.transform=g,this.fire(new d.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){var e,n,c,f,y;const T=this._idleTriggered?this._fadeDuration:0,A=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let I=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const F=this.transform.zoom,z=Me.now();this.style.zoomHistory.update(F,z);const G=new d.C(F,{now:z,fadeDuration:T,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Z=G.crossFadingFactor();Z===1&&Z===this._crossFadingFactor||(I=!0,this._crossFadingFactor=Z),this.style.update(G)}const L=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0!==A;(c=this.style.projection)===null||c===void 0||c.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(y=this.style.projection)===null||y===void 0?void 0:y.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||L)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,T,this._crossSourceCollisions,L),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,showPadding:this.showPadding}),this.fire(new d.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,d.cn.mark(d.co.load),this.fire(new d.l("load"))),this.style&&(this.style.hasTransitions()||I)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const k=this._sourcesDirty||this._styleDirty||this._placementDirty;return k||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.l("idle")),!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,d.cn.mark(d.co.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Mt.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),fe.remove(this._canvasContainer),fe.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),d.cn.clearMetrics(),this._removed=!0,this.fire(new d.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,Me.frame(this._frameRequest,g=>{d.cn.frame(g),this._frameRequest=null;try{this._render(g)}catch(e){if(!d.cp(e)&&!function(n){return n.message===zl}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return zt}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(g){return this._lazyInitEmptyStyle(),this.style.setProjection(g),this._update(!0)}},M.MapMouseEvent=Aa,M.MapTouchEvent=Dr,M.MapWheelEvent=tn,M.Marker=qs,M.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const e=this._map.getZoom(),n=e===this._map.getMaxZoom(),c=e===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,n)=>{const c=this._map._getUIString(`NavigationControl.${n}`);e.title=c,e.setAttribute("aria-label",c)},this.options=d.e({},js,g),this._container=fe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),fe.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),fe.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=fe.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new nl(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){fe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,e){const n=fe.create("button",g,this._container);return n.type="button",n.addEventListener("click",e),n}},M.Popup=class extends d.E{constructor(g){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&fe.remove(this._content),this._container&&(fe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new d.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=fe.create("div","maplibregl-popup",this._map.getContainer()),this._tip=fe.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=So(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const n=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let c=this.options.anchor;const f=sa(this.options.offset);if(!c){const T=this._container.offsetWidth,A=this._container.offsetHeight;let I;I=n.y+f.bottom.y<A?["top"]:n.y>this._map.transform.height-A?["bottom"]:[],n.x<T/2?I.push("left"):n.x>this._map.transform.width-T/2&&I.push("right"),c=I.length===0?"bottom":I.join("-")}let y=n.add(f[c]);this.options.subpixelPositioning||(y=y.round()),fe.setTransform(this._container,`${Rr[c]} translate(${y.x}px,${y.y}px)`),Sa(this._container,c,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=d.e(Object.create(Ql),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new d.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=d.Q.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const e=document.createDocumentFragment(),n=document.createElement("body");let c;for(n.innerHTML=g;c=n.firstChild,c;)e.appendChild(c);return this.setDOMContent(e)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=fe.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=fe.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(En);g&&g.focus()}},M.RasterDEMTileSource=Sl,M.RasterTileSource=Ra,M.ScaleControl=class{constructor(g){this._onMove=()=>{mu(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,mu(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Xl),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=fe.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){fe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},M.ScrollZoomHandler=ri,M.Style=wh,M.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=fe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=fe.create("button","maplibregl-ctrl-terrain",this._container),fe.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){fe.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},M.TwoFingersTouchPitchHandler=du,M.TwoFingersTouchRotateHandler=yt,M.TwoFingersTouchZoomHandler=Us,M.TwoFingersTouchZoomRotateHandler=fs,M.VectorTileSource=ro,M.VideoSource=rr,M.addSourceType=(g,e)=>d._(void 0,void 0,void 0,function*(){if(Is(g))throw new Error(`A source type called "${g}" already exists.`);((n,c)=>{so[n]=c})(g,e)}),M.clearPrewarmedResources=function(){const g=Ot;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(ut),Ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},M.createTileMesh=Dl,M.getMaxParallelImageRequests=function(){return d.a.MAX_PARALLEL_IMAGE_REQUESTS},M.getRTLTextPluginStatus=function(){return _n().getRTLTextPluginStatus()},M.getVersion=function(){return Kl},M.getWorkerCount=function(){return xt.workerCount},M.getWorkerUrl=function(){return d.a.WORKER_URL},M.importScriptInWorkers=function(g){return Ni().broadcast("IS",g)},M.prewarm=function(){Vt().acquire(ut)},M.setMaxParallelImageRequests=function(g){d.a.MAX_PARALLEL_IMAGE_REQUESTS=g},M.setRTLTextPlugin=function(g,e){return _n().setRTLTextPlugin(g,e)},M.setWorkerCount=function(g){xt.workerCount=g},M.setWorkerUrl=function(g){d.a.WORKER_URL=g}});var N=m;return N})}(Up)),Up.exports}var M_=ry();const sy=A_(M_),oy=$1({__proto__:null,default:sy},[M_]);function uy({row:i,isExpanded:o,onToggle:m,map:v,selectedRow:C,setSelectedRow:N}){const M=i.header,d=i.points&&i.points.length>0;return Dt.jsxs("div",{className:`border-b border-gray-200 last:border-0 ${o?"bg-gray-300":d?"hover:bg-gray-100":""}`,children:[Dt.jsxs("div",{className:`p-1 flex items-center justify-between ${d?"cursor-pointer":""}`,onClick:()=>{if(d&&(m(),v&&i.points&&i.points.length>0)){const K=i.points.reduce((W,we)=>W?[[Math.min(W[0][0],we.lon),Math.min(W[0][1],we.lat)],[Math.max(W[1][0],we.lon),Math.max(W[1][1],we.lat)]]:[[we.lon,we.lat],[we.lon,we.lat]],null);if(K){const W=[K[0][0],K[0][1],K[1][0],K[1][1]];v.fitBounds(W,{padding:100,duration:2e3})}}},children:[Dt.jsx("div",{className:`flex-1 overflow-hidden ${o?"":"text-ellipsis whitespace-nowrap"}`,children:M}),d&&Dt.jsx("svg",{className:`w-5 h-5 transform transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Dt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),o&&d&&i.points&&Dt.jsxs("div",{className:"p-4 pl-10",children:[Dt.jsx("h4",{className:"font-medium mb-2",children:":"}),Dt.jsx("div",{className:"space-y-2",children:i.points.map((K,W)=>Dt.jsxs("div",{className:"flex items-start space-x-2 cursor-pointer hover:bg-gray-400",onClick:()=>{v&&v.flyTo({center:[K.lon,K.lat],speed:.5,curve:1.5})},children:[Dt.jsxs("span",{className:"font-medium min-w-[24px]",children:[K.index,"."]}),Dt.jsx("span",{children:K.original})]},W))})]})]})}function ly({document:i,onBack:o,map:m,selectedRow:v,setSelectedRow:C}){const N=d=>{C(v===d?null:d)},M=vt.useRef(null);return vt.useEffect(()=>{console.log(M),M.current&&(!M.current.getBoundingClientRect().top||M.current.getBoundingClientRect().top<0||M.current.getBoundingClientRect().bottom>window.innerHeight)&&M.current.scrollIntoView({behavior:"smooth"})},[v,M]),console.log(v),Dt.jsxs("div",{className:"p-5 h-full flex flex-col",children:[Dt.jsx("div",{className:"flex items-center mb-5",children:Dt.jsxs("button",{onClick:o,className:"flex items-center text-blue-600 hover:text-blue-800 transition-colors",children:[Dt.jsx("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Dt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),""]})}),Dt.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:i.header}),i.rows.map((d,K)=>Dt.jsx("div",{ref:K===v?M:void 0,children:Dt.jsx(uy,{row:d,isExpanded:K===v,onToggle:()=>N(K),map:m,selectedRow:v,setSelectedRow:C})},K))]})}function cy({region:i,onBack:o,openedDocument:m,setOpenedDocument:v,map:C,selectedRow:N,setSelectedRow:M}){const[d,K]=vt.useState(null),W=async Pe=>{v(i.documents[Pe])},we=()=>{v(null),K(null)};return m?Dt.jsx(ly,{document:m,onBack:we,map:C,selectedRow:N,setSelectedRow:M}):Dt.jsxs("div",{className:"p-5 h-full flex flex-col",children:[Dt.jsx("div",{className:"flex items-center mb-5",children:Dt.jsxs("button",{onClick:o,className:"flex items-center text-blue-600 hover:text-blue-800 transition-colors",children:[Dt.jsx("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Dt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),""]})}),Dt.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:i.region}),Dt.jsx("div",{className:"bg-white rounded-lg shadow mb-4 flex-grow overflow-y-auto",children:Dt.jsx("div",{className:"p-4 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:i.contentHtml}})}),i.documents.length>0&&Dt.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[Dt.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:""}),d&&Dt.jsx("div",{className:"mb-3 p-3 bg-red-50 text-red-700 rounded-md",children:d}),Dt.jsx("ul",{className:"space-y-2",children:i.documents.map((Pe,Me)=>Dt.jsx("li",{className:"flex items-center p-2 mb-2 border rounded-lg cursor-pointer transition-all duration-200 hover:bg-gray-50 hover:translate-y-[-1px] hover:shadow-sm",children:Dt.jsxs("button",{onClick:()=>W(Me),className:"flex items-center text-gray-700  w-full text-left hover:cursor-pointer",children:[Dt.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Dt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),Dt.jsx("span",{children:Pe.title})]})},Me))})]})]})}function hy({regions:i,selectedRegion:o,onRegionSelect:m,selectedDocuments:v,setSelectedDocuments:C,openedDocument:N,setOpenedDocument:M,map:d,selectedRow:K,setSelectedRow:W}){const we=()=>{m(null)};return o?Dt.jsx(cy,{region:o,onBack:we,openedDocument:N,setOpenedDocument:M,map:d,selectedRow:K,setSelectedRow:W}):Dt.jsxs("div",{className:"p-5 h-full flex flex-col",children:[Dt.jsx("h2",{className:"mb-1 text-2xl font-semibold text-gray-800",children:""}),Dt.jsxs("div",{className:"p-2 border-b border-gray-200",children:[Dt.jsxs("label",{className:"flex items-center gap-2",children:[Dt.jsx("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 rounded border-gray-300",checked:v.length===i.flatMap(Pe=>Pe.documents).length,onChange:Pe=>{Pe.target.checked?C(i.flatMap(Me=>Me.documents)):C([])}}),Dt.jsx("span",{className:"text-sm font-medium",children:"  "})]}),Dt.jsxs("label",{className:"flex items-center gap-2",children:[Dt.jsx("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 rounded border-gray-300",checked:i.flatMap(Pe=>Pe.documents).filter(Pe=>{var Me;return(Me=Pe.header)==null?void 0:Me.toLowerCase().includes("")}).every(Pe=>v.includes(Pe)),onChange:Pe=>{Pe.target.checked?C(i.flatMap(Me=>Me.documents).filter(Me=>{var fe;return(fe=Me.header)==null?void 0:fe.toLowerCase().includes("")})):C(v.filter(Me=>{var fe;return!((fe=Me.header)!=null&&fe.toLowerCase().includes(""))}))}}),Dt.jsx("span",{className:"text-sm font-medium",children:" "})]}),Dt.jsxs("label",{className:"flex items-center gap-2",children:[Dt.jsx("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 rounded border-gray-300",checked:i.flatMap(Pe=>Pe.documents).filter(Pe=>{var Me;return(Me=Pe.header)==null?void 0:Me.toLowerCase().includes("")}).every(Pe=>v.includes(Pe)),onChange:Pe=>{Pe.target.checked?C(i.flatMap(Me=>Me.documents).filter(Me=>{var fe;return((fe=Me.header)==null?void 0:fe.toLowerCase().includes(""))||v.includes(Me)})):C(v.filter(Me=>{var fe;return!((fe=Me.header)!=null&&fe.toLowerCase().includes(""))}))}}),Dt.jsx("span",{className:"text-sm font-medium",children:" "})]})]}),Dt.jsx("div",{className:"flex-1 overflow-y-auto",children:i.map(Pe=>Dt.jsxs("div",{className:`flex flex-col p-2 mb-2 border rounded-lg cursor-pointer transition-all duration-200 hover:bg-gray-50 hover:translate-y-[-1px] hover:shadow-sm ${o===Pe.region?"bg-blue-50 border-blue-500":"border-gray-200"}`,children:[Dt.jsxs("span",{className:"mb text-lg",onClick:()=>m(Pe),children:[Pe.region," (",Pe.documents.length,")"]}),Pe.documents.map((Me,fe)=>{var Qe;return Dt.jsx("div",{className:"flex flex-col",children:Dt.jsxs("label",{className:"text-sm whitespace-nowrap overflow-hidden text-ellipsis flex items-center gap-1",children:[Dt.jsx("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 rounded border-gray-300",checked:v.includes(Me),onChange:ai=>{ai.target.checked?C([...v,Me]):C(v.filter(li=>li!==Me))}}),(Qe=Me.header)==null?void 0:Qe.toLowerCase()]})},fe)})]},Pe.region))})]})}const dy="modulepreload",fy=function(i){return"/"+i},zg={},py=function(o,m,v){let C=Promise.resolve();if(m&&m.length>0){let M=function(W){return Promise.all(W.map(we=>Promise.resolve(we).then(Pe=>({status:"fulfilled",value:Pe}),Pe=>({status:"rejected",reason:Pe}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),K=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));C=M(m.map(W=>{if(W=fy(W),W in zg)return;zg[W]=!0;const we=W.endsWith(".css"),Pe=we?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${W}"]${Pe}`))return;const Me=document.createElement("link");if(Me.rel=we?"stylesheet":dy,we||(Me.as="script"),Me.crossOrigin="",Me.href=W,K&&Me.setAttribute("nonce",K),document.head.appendChild(Me),we)return new Promise((fe,Qe)=>{Me.addEventListener("load",fe),Me.addEventListener("error",()=>Qe(new Error(`Unable to preload CSS for ${W}`)))})}))}function N(M){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=M,window.dispatchEvent(d),!d.defaultPrevented)throw M}return C.then(M=>{for(const d of M||[])d.status==="rejected"&&N(d.reason);return o().catch(N)})},my=vt.createContext(null);function gy(i,o){const m=Array.isArray(i)?i[0]:i?i.x:0,v=Array.isArray(i)?i[1]:i?i.y:0,C=Array.isArray(o)?o[0]:o?o.x:0,N=Array.isArray(o)?o[1]:o?o.y:0;return m===C&&v===N}function Ss(i,o){if(i===o)return!0;if(!i||!o)return!1;if(Array.isArray(i)){if(!Array.isArray(o)||i.length!==o.length)return!1;for(let m=0;m<i.length;m++)if(!Ss(i[m],o[m]))return!1;return!0}else if(Array.isArray(o))return!1;if(typeof i=="object"&&typeof o=="object"){const m=Object.keys(i),v=Object.keys(o);if(m.length!==v.length)return!1;for(const C of m)if(!o.hasOwnProperty(C)||!Ss(i[C],o[C]))return!1;return!0}return!1}function Fg(i){return{longitude:i.center.lng,latitude:i.center.lat,zoom:i.zoom,pitch:i.pitch,bearing:i.bearing,padding:i.padding}}function Ug(i,o){const m=o.viewState||o,v={};if("longitude"in m&&"latitude"in m&&(m.longitude!==i.center.lng||m.latitude!==i.center.lat)){const C=i.center.constructor;v.center=new C(m.longitude,m.latitude)}return"zoom"in m&&m.zoom!==i.zoom&&(v.zoom=m.zoom),"bearing"in m&&m.bearing!==i.bearing&&(v.bearing=m.bearing),"pitch"in m&&m.pitch!==i.pitch&&(v.pitch=m.pitch),m.padding&&i.padding&&!Ss(m.padding,i.padding)&&(v.padding=m.padding),v}const _y=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Hg(i){if(!i)return null;if(typeof i=="string"||("toJS"in i&&(i=i.toJS()),!i.layers))return i;const o={};for(const v of i.layers)o[v.id]=v;const m=i.layers.map(v=>{let C=null;"interactive"in v&&(C=Object.assign({},v),delete C.interactive);const N=o[v.ref];if(N){C=C||Object.assign({},v),delete C.ref;for(const M of _y)M in N&&(C[M]=N[M])}return C||v});return{...i,layers:m}}const jg={version:8,sources:{},layers:[]},qg={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Vg={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Gg={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},yy=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],by=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Pf{constructor(o,m,v){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=C=>{const N=this.props[Gg[C.type]];N?N(C):C.type==="error"&&console.error(C.error)},this._onCameraEvent=C=>{if(this._internalUpdate)return;C.viewState=this._propsedCameraUpdate||Fg(this._map.transform);const N=this.props[Vg[C.type]];N&&N(C)},this._onCameraUpdate=C=>this._internalUpdate?C:(this._propsedCameraUpdate=Fg(C),Ug(C,this.props)),this._onPointerEvent=C=>{(C.type==="mousemove"||C.type==="mouseout")&&this._updateHover(C);const N=this.props[qg[C.type]];N&&(this.props.interactiveLayerIds&&C.type!=="mouseover"&&C.type!=="mouseout"&&(C.features=this._hoveredFeatures||this._queryRenderedFeatures(C.point)),N(C),delete C.features)},this._MapClass=o,this.props=m,this._initialize(v)}get map(){return this._map}setProps(o){const m=this.props;this.props=o;const v=this._updateSettings(o,m),C=this._updateSize(o),N=this._updateViewState(o);this._updateStyle(o,m),this._updateStyleComponents(o),this._updateHandlers(o,m),(v||C||N&&!this._map.isMoving())&&this.redraw()}static reuse(o,m){const v=Pf.savedMaps.pop();if(!v)return null;const C=v.map,N=C.getContainer();for(m.className=N.className;N.childNodes.length>0;)m.appendChild(N.childNodes[0]);C._container=m;const M=C._resizeObserver;M&&(M.disconnect(),M.observe(m)),v.setProps({...o,styleDiffing:!1}),C.resize();const{initialViewState:d}=o;return d&&(d.bounds?C.fitBounds(d.bounds,{...d.fitBoundsOptions,duration:0}):v._updateViewState(d)),C.isStyleLoaded()?C.fire("load"):C.once("style.load",()=>C.fire("load")),C._update(),v}_initialize(o){const{props:m}=this,{mapStyle:v=jg}=m,C={...m,...m.initialViewState,container:o,style:Hg(v)},N=C.initialViewState||C.viewState||C;if(Object.assign(C,{center:[N.longitude||0,N.latitude||0],zoom:N.zoom||0,pitch:N.pitch||0,bearing:N.bearing||0}),m.gl){const d=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=d,m.gl)}const M=new this._MapClass(C);N.padding&&M.setPadding(N.padding),m.cursor&&(M.getCanvas().style.cursor=m.cursor),M.transformCameraUpdate=this._onCameraUpdate,M.on("style.load",()=>{var d;this._styleComponents={light:M.getLight(),sky:M.getSky(),projection:(d=M.getProjection)==null?void 0:d.call(M),terrain:M.getTerrain()},this._updateStyleComponents(this.props)}),M.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const d in qg)M.on(d,this._onPointerEvent);for(const d in Vg)M.on(d,this._onCameraEvent);for(const d in Gg)M.on(d,this._onEvent);this._map=M}recycle(){const m=this.map.getContainer().querySelector("[mapboxgl-children]");m==null||m.remove(),Pf.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const o=this._map;o.style&&(o._frame&&(o._frame.cancel(),o._frame=null),o._render())}_updateSize(o){const{viewState:m}=o;if(m){const v=this._map;if(m.width!==v.transform.width||m.height!==v.transform.height)return v.resize(),!0}return!1}_updateViewState(o){const m=this._map,v=m.transform;if(!m.isMoving()){const N=Ug(v,o);if(Object.keys(N).length>0)return this._internalUpdate=!0,m.jumpTo(N),this._internalUpdate=!1,!0}return!1}_updateSettings(o,m){const v=this._map;let C=!1;for(const N of yy)if(N in o&&!Ss(o[N],m[N])){C=!0;const M=v[`set${N[0].toUpperCase()}${N.slice(1)}`];M==null||M.call(v,o[N])}return C}_updateStyle(o,m){if(o.cursor!==m.cursor&&(this._map.getCanvas().style.cursor=o.cursor||""),o.mapStyle!==m.mapStyle){const{mapStyle:v=jg,styleDiffing:C=!0}=o,N={diff:C};"localIdeographFontFamily"in o&&(N.localIdeographFontFamily=o.localIdeographFontFamily),this._map.setStyle(Hg(v),N)}}_updateStyleComponents({light:o,projection:m,sky:v,terrain:C}){var d,K;const N=this._map,M=this._styleComponents;N.style._loaded&&(o&&!Ss(o,M.light)&&(M.light=o,N.setLight(o)),m&&!Ss(m,M.projection)&&m!==((d=M.projection)==null?void 0:d.type)&&(M.projection=typeof m=="string"?{type:m}:m,(K=N.setProjection)==null||K.call(N,M.projection)),v&&!Ss(v,M.sky)&&(M.sky=v,N.setSky(v)),C!==void 0&&!Ss(C,M.terrain)&&(!C||N.getSource(C.source))&&(M.terrain=C,N.setTerrain(C)))}_updateHandlers(o,m){const v=this._map;for(const C of by){const N=o[C]??!0,M=m[C]??!0;Ss(N,M)||(N?v[C].enable(N):v[C].disable())}}_queryRenderedFeatures(o){const m=this._map,{interactiveLayerIds:v=[]}=this.props;try{return m.queryRenderedFeatures(o,{layers:v.filter(m.getLayer.bind(m))})}catch{return[]}}_updateHover(o){var C;const{props:m}=this;if(m.interactiveLayerIds&&(m.onMouseMove||m.onMouseEnter||m.onMouseLeave)){const N=o.type,M=((C=this._hoveredFeatures)==null?void 0:C.length)>0,d=this._queryRenderedFeatures(o.point),K=d.length>0;!K&&M&&(o.type="mouseleave",this._onPointerEvent(o)),this._hoveredFeatures=d,K&&!M&&(o.type="mouseenter",this._onPointerEvent(o)),o.type=N}else this._hoveredFeatures=null}}Pf.savedMaps=[];const xy=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function vy(i){if(!i)return null;const o=i.map,m={getMap:()=>o};for(const v of Ty(o))!(v in m)&&!xy.includes(v)&&(m[v]=o[v].bind(o));return m}function Ty(i){const o=new Set;let m=i;for(;m;){for(const v of Object.getOwnPropertyNames(m))v[0]!=="_"&&typeof i[v]=="function"&&v!=="fire"&&v!=="setEventedParent"&&o.add(v);m=Object.getPrototypeOf(m)}return Array.from(o)}const Ey=typeof document<"u"?vt.useLayoutEffect:vt.useEffect;function wy(i,o){const{RTLTextPlugin:m,maxParallelImageRequests:v,workerCount:C,workerUrl:N}=o;if(m&&i.getRTLTextPluginStatus&&i.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:M,lazy:d=!0}=typeof m=="string"?{pluginUrl:m}:m;i.setRTLTextPlugin(M,K=>{K&&console.error(K)},d)}v!==void 0&&i.setMaxParallelImageRequests(v),C!==void 0&&i.setWorkerCount(C),N!==void 0&&i.setWorkerUrl(N)}const Of=vt.createContext(null);function Ay(i,o){const m=vt.useContext(my),[v,C]=vt.useState(null),N=vt.useRef(),{current:M}=vt.useRef({mapLib:null,map:null});vt.useEffect(()=>{const W=i.mapLib;let we=!0,Pe;return Promise.resolve(W||py(()=>Promise.resolve().then(()=>oy),void 0)).then(Me=>{if(!we)return;if(!Me)throw new Error("Invalid mapLib");const fe="Map"in Me?Me:Me.default;if(!fe.Map)throw new Error("Invalid mapLib");wy(fe,i),i.reuseMaps&&(Pe=Pf.reuse(i,N.current)),Pe||(Pe=new Pf(fe.Map,i,N.current)),M.map=vy(Pe),M.mapLib=fe,C(Pe),m==null||m.onMapMount(M.map,i.id)}).catch(Me=>{const{onError:fe}=i;fe?fe({type:"error",target:null,originalEvent:null,error:Me}):console.error(Me)}),()=>{we=!1,Pe&&(m==null||m.onMapUnmount(i.id),i.reuseMaps?Pe.recycle():Pe.destroy())}},[]),Ey(()=>{v&&v.setProps(i)}),vt.useImperativeHandle(o,()=>M.map,[v]);const d=vt.useMemo(()=>({position:"relative",width:"100%",height:"100%",...i.style}),[i.style]),K={height:"100%"};return vt.createElement("div",{id:i.id,ref:N,style:d},v&&vt.createElement(Of.Provider,{value:M},vt.createElement("div",{"mapboxgl-children":"",style:K},i.children)))}const Sy=vt.forwardRef(Ay);var I_=S_();const Cy=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function gc(i,o){if(!i||!o)return;const m=i.style;for(const v in o){const C=o[v];Number.isFinite(C)&&!Cy.test(v)?m[v]=`${C}px`:m[v]=C}}function D_(i,o){if(i===o)return null;const m=Zg(i),v=Zg(o),C=[];for(const N of v)m.has(N)||C.push(N);for(const N of m)v.has(N)||C.push(N);return C.length===0?null:C}function Zg(i){return new Set(i?i.trim().split(/\s+/):[])}vt.memo(vt.forwardRef((i,o)=>{const{map:m,mapLib:v}=vt.useContext(Of),C=vt.useRef({props:i}),N=vt.useMemo(()=>{let ei=!1;vt.Children.forEach(i.children,Mt=>{Mt&&(ei=!0)});const Ci={...i,element:ei?document.createElement("div"):void 0},ni=new v.Marker(Ci);return ni.setLngLat([i.longitude,i.latitude]),ni.getElement().addEventListener("click",Mt=>{var Et,Ut;(Ut=(Et=C.current.props).onClick)==null||Ut.call(Et,{type:"click",target:ni,originalEvent:Mt})}),ni.on("dragstart",Mt=>{var Ut,Ii;const Et=Mt;Et.lngLat=N.getLngLat(),(Ii=(Ut=C.current.props).onDragStart)==null||Ii.call(Ut,Et)}),ni.on("drag",Mt=>{var Ut,Ii;const Et=Mt;Et.lngLat=N.getLngLat(),(Ii=(Ut=C.current.props).onDrag)==null||Ii.call(Ut,Et)}),ni.on("dragend",Mt=>{var Ut,Ii;const Et=Mt;Et.lngLat=N.getLngLat(),(Ii=(Ut=C.current.props).onDragEnd)==null||Ii.call(Ut,Et)}),ni},[]);vt.useEffect(()=>(N.addTo(m.getMap()),()=>{N.remove()}),[]);const{longitude:M,latitude:d,offset:K,style:W,draggable:we=!1,popup:Pe=null,rotation:Me=0,rotationAlignment:fe="auto",pitchAlignment:Qe="auto"}=i;vt.useEffect(()=>{gc(N.getElement(),W)},[W]),vt.useImperativeHandle(o,()=>N,[]);const ai=C.current.props;(N.getLngLat().lng!==M||N.getLngLat().lat!==d)&&N.setLngLat([M,d]),K&&!gy(N.getOffset(),K)&&N.setOffset(K),N.isDraggable()!==we&&N.setDraggable(we),N.getRotation()!==Me&&N.setRotation(Me),N.getRotationAlignment()!==fe&&N.setRotationAlignment(fe),N.getPitchAlignment()!==Qe&&N.setPitchAlignment(Qe),N.getPopup()!==Pe&&N.setPopup(Pe);const li=D_(ai.className,i.className);if(li)for(const ei of li)N.toggleClassName(ei);return C.current.props=i,I_.createPortal(i.children,N.getElement())}));vt.memo(vt.forwardRef((i,o)=>{const{map:m,mapLib:v}=vt.useContext(Of),C=vt.useMemo(()=>document.createElement("div"),[]),N=vt.useRef({props:i}),M=vt.useMemo(()=>{const d={...i},K=new v.Popup(d);return K.setLngLat([i.longitude,i.latitude]),K.once("open",W=>{var we,Pe;(Pe=(we=N.current.props).onOpen)==null||Pe.call(we,W)}),K},[]);if(vt.useEffect(()=>{const d=K=>{var W,we;(we=(W=N.current.props).onClose)==null||we.call(W,K)};return M.on("close",d),M.setDOMContent(C).addTo(m.getMap()),()=>{M.off("close",d),M.isOpen()&&M.remove()}},[]),vt.useEffect(()=>{gc(M.getElement(),i.style)},[i.style]),vt.useImperativeHandle(o,()=>M,[]),M.isOpen()){const d=N.current.props;(M.getLngLat().lng!==i.longitude||M.getLngLat().lat!==i.latitude)&&M.setLngLat([i.longitude,i.latitude]),i.offset&&!Ss(d.offset,i.offset)&&M.setOffset(i.offset),(d.anchor!==i.anchor||d.maxWidth!==i.maxWidth)&&(M.options.anchor=i.anchor,M.setMaxWidth(i.maxWidth));const K=D_(d.className,i.className);if(K)for(const W of K)M.toggleClassName(W);N.current.props=i}return I_.createPortal(i.children,C)}));function _d(i,o,m,v){const C=vt.useContext(Of),N=vt.useMemo(()=>i(C),[]);return vt.useEffect(()=>{const M=o,d=null,K=typeof o=="function"?o:null,{map:W}=C;return W.hasControl(N)||(W.addControl(N,M==null?void 0:M.position),d&&d(C)),()=>{K&&K(C),W.hasControl(N)&&W.removeControl(N)}},[]),N}function My(i){const o=_d(({mapLib:m})=>new m.AttributionControl(i),{position:i.position});return vt.useEffect(()=>{gc(o._container,i.style)},[i.style]),null}vt.memo(My);function Iy(i){const o=_d(({mapLib:m})=>new m.FullscreenControl({container:i.containerId&&document.getElementById(i.containerId)}),{position:i.position});return vt.useEffect(()=>{gc(o._controlContainer,i.style)},[i.style]),null}vt.memo(Iy);function Dy(i,o){const m=vt.useRef({props:i}),v=_d(({mapLib:C})=>{const N=new C.GeolocateControl(i),M=N._setupUI;return N._setupUI=()=>{N._container.hasChildNodes()||M()},N.on("geolocate",d=>{var K,W;(W=(K=m.current.props).onGeolocate)==null||W.call(K,d)}),N.on("error",d=>{var K,W;(W=(K=m.current.props).onError)==null||W.call(K,d)}),N.on("outofmaxbounds",d=>{var K,W;(W=(K=m.current.props).onOutOfMaxBounds)==null||W.call(K,d)}),N.on("trackuserlocationstart",d=>{var K,W;(W=(K=m.current.props).onTrackUserLocationStart)==null||W.call(K,d)}),N.on("trackuserlocationend",d=>{var K,W;(W=(K=m.current.props).onTrackUserLocationEnd)==null||W.call(K,d)}),N},{position:i.position});return m.current.props=i,vt.useImperativeHandle(o,()=>v,[]),vt.useEffect(()=>{gc(v._container,i.style)},[i.style]),null}vt.memo(vt.forwardRef(Dy));function Ry(i){const o=_d(({mapLib:m})=>new m.NavigationControl(i),{position:i.position});return vt.useEffect(()=>{gc(o._container,i.style)},[i.style]),null}vt.memo(Ry);function Py(i){const o=_d(({mapLib:N})=>new N.ScaleControl(i),{position:i.position}),m=vt.useRef(i),v=m.current;m.current=i;const{style:C}=i;return i.maxWidth!==void 0&&i.maxWidth!==v.maxWidth&&(o.options.maxWidth=i.maxWidth),i.unit!==void 0&&i.unit!==v.unit&&o.setUnit(i.unit),vt.useEffect(()=>{gc(o._container,C)},[C]),null}vt.memo(Py);function Ly(i){const o=_d(({mapLib:m})=>new m.TerrainControl(i),{position:i.position});return vt.useEffect(()=>{gc(o._container,i.style)},[i.style]),null}vt.memo(Ly);function Ny(i){const o=_d(({mapLib:m})=>new m.LogoControl(i),{position:i.position});return vt.useEffect(()=>{gc(o._container,i.style)},[i.style]),null}vt.memo(Ny);function qp(i,o){if(!i)throw new Error(o)}let Oy=0;function ky(i,o,m){if(i.style&&i.style._loaded){const v={...m};return delete v.id,delete v.children,i.addSource(o,v),i.getSource(o)}return null}function By(i,o,m){var M,d,K;qp(o.id===m.id,"source id changed"),qp(o.type===m.type,"source type changed");let v="",C=0;for(const W in o)W!=="children"&&W!=="id"&&!Ss(m[W],o[W])&&(v=W,C++);if(!C)return;const N=o.type;if(N==="geojson")i.setData(o.data);else if(N==="image")i.updateImage({url:o.url,coordinates:o.coordinates});else switch(v){case"coordinates":(M=i.setCoordinates)==null||M.call(i,o.coordinates);break;case"url":(d=i.setUrl)==null||d.call(i,o.url);break;case"tiles":(K=i.setTiles)==null||K.call(i,o.tiles);break;default:console.warn(`Unable to update <Source> prop: ${v}`)}}function Rm(i){const o=vt.useContext(Of).map.getMap(),m=vt.useRef(i),[,v]=vt.useState(0),C=vt.useMemo(()=>i.id||`jsx-source-${Oy++}`,[]);vt.useEffect(()=>{if(o){const M=()=>setTimeout(()=>v(d=>d+1),0);return o.on("styledata",M),M(),()=>{var d;if(o.off("styledata",M),o.style&&o.style._loaded&&o.getSource(C)){const K=(d=o.getStyle())==null?void 0:d.layers;if(K)for(const W of K)W.source===C&&o.removeLayer(W.id);o.removeSource(C)}}}},[o]);let N=o&&o.style&&o.getSource(C);return N?By(N,i,m.current):N=ky(o,C,i),m.current=i,N&&vt.Children.map(i.children,M=>M&&vt.cloneElement(M,{source:C}))||null}function zy(i,o,m,v){if(qp(m.id===v.id,"layer id changed"),qp(m.type===v.type,"layer type changed"),m.type==="custom"||v.type==="custom")return;const{layout:C={},paint:N={},filter:M,minzoom:d,maxzoom:K,beforeId:W}=m;if(W!==v.beforeId&&i.moveLayer(o,W),C!==v.layout){const we=v.layout||{};for(const Pe in C)Ss(C[Pe],we[Pe])||i.setLayoutProperty(o,Pe,C[Pe]);for(const Pe in we)C.hasOwnProperty(Pe)||i.setLayoutProperty(o,Pe,void 0)}if(N!==v.paint){const we=v.paint||{};for(const Pe in N)Ss(N[Pe],we[Pe])||i.setPaintProperty(o,Pe,N[Pe]);for(const Pe in we)N.hasOwnProperty(Pe)||i.setPaintProperty(o,Pe,void 0)}Ss(M,v.filter)||i.setFilter(o,M),(d!==v.minzoom||K!==v.maxzoom)&&i.setLayerZoomRange(o,d,K)}function Fy(i,o,m){if(i.style&&i.style._loaded&&(!("source"in m)||i.getSource(m.source))){const v={...m,id:o};delete v.beforeId,i.addLayer(v,m.beforeId)}}let Uy=0;function Pm(i){const o=vt.useContext(Of).map.getMap(),m=vt.useRef(i),[,v]=vt.useState(0),C=vt.useMemo(()=>i.id||`jsx-layer-${Uy++}`,[]);if(vt.useEffect(()=>{if(o){const M=()=>v(d=>d+1);return o.on("styledata",M),M(),()=>{o.off("styledata",M),o.style&&o.style._loaded&&o.getLayer(C)&&o.removeLayer(C)}}},[o]),o&&o.style&&o.getLayer(C))try{zy(o,C,i,m.current)}catch(M){console.warn(M)}else Fy(o,C,i);return m.current=i,null}const Hy=({geoJson:i,onFeatureClick:o,onMapLoaded:m})=>{const[v,C]=vt.useState({longitude:37.7333,latitude:55.9833,zoom:11});return Dt.jsx("div",{className:"relative h-full",children:Dt.jsxs(Sy,{initialViewState:{longitude:37.7333,latitude:55.9833,zoom:11},...v,onMove:N=>C(N.viewState),mapStyle:"https://tiles.stadiamaps.com/styles/osm_bright.json",style:{width:"100%",height:"100%"},onLoad:N=>{console.log(N);const M=N.target;M.on("mousemove",["polygons","lines","points"],d=>{var K;M&&(K=d.features)!=null&&K[0]&&(d.features[0],d.lngLat)}),M.on("mouseleave",["polygons","lines","points"],()=>{}),M.on("click",["polygons","lines","points"],d=>{var W;if(!M)return;const K=(W=d.features)==null?void 0:W[0];K&&o(K)}),m(M)},children:[Dt.jsx(Rm,{id:"polygons",type:"geojson",data:{type:"FeatureCollection",features:i.features.filter(N=>N.geometry.type==="Polygon")},children:Dt.jsx(Pm,{id:"polygons",type:"fill",paint:{"fill-color":["get","fillColor"],"fill-opacity":["get","fillOpacity"],"fill-outline-color":["get","strokeColor"]}})}),Dt.jsx(Rm,{id:"lines",type:"geojson",data:{type:"FeatureCollection",features:i.features.filter(N=>N.geometry.type==="LineString")},children:Dt.jsx(Pm,{id:"lines",type:"line",paint:{"line-color":["get","color"],"line-width":["get","width"]}})}),Dt.jsx(Rm,{id:"points",type:"geojson",data:{type:"FeatureCollection",features:i.features.filter(N=>N.geometry.type==="Point")},children:Dt.jsx(Pm,{id:"points",type:"circle",paint:{"circle-radius":["get","radius"],"circle-color":["get","color"],"circle-stroke-width":["get","strokeWidth"],"circle-stroke-color":["get","strokeColor"]}})})]})})};var Ki;(function(i){i.Root="root",i.Text="text",i.Directive="directive",i.Comment="comment",i.Script="script",i.Style="style",i.Tag="tag",i.CDATA="cdata",i.Doctype="doctype"})(Ki||(Ki={}));function jy(i){return i.type===Ki.Tag||i.type===Ki.Script||i.type===Ki.Style}const qy=Ki.Root,Vy=Ki.Text,Gy=Ki.Directive,Zy=Ki.Comment,Yy=Ki.Script,$y=Ki.Style,Xy=Ki.Tag,Qy=Ki.CDATA,Ky=Ki.Doctype;class R_{constructor(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}get parentNode(){return this.parent}set parentNode(o){this.parent=o}get previousSibling(){return this.prev}set previousSibling(o){this.prev=o}get nextSibling(){return this.next}set nextSibling(o){this.next=o}cloneNode(o=!1){return Y0(this,o)}}class rg extends R_{constructor(o){super(),this.data=o}get nodeValue(){return this.data}set nodeValue(o){this.data=o}}class Z0 extends rg{constructor(){super(...arguments),this.type=Ki.Text}get nodeType(){return 3}}class sg extends rg{constructor(){super(...arguments),this.type=Ki.Comment}get nodeType(){return 8}}class og extends rg{constructor(o,m){super(m),this.name=o,this.type=Ki.Directive}get nodeType(){return 1}}class ug extends R_{constructor(o){super(),this.children=o}get firstChild(){var o;return(o=this.children[0])!==null&&o!==void 0?o:null}get lastChild(){return this.children.length>0?this.children[this.children.length-1]:null}get childNodes(){return this.children}set childNodes(o){this.children=o}}class P_ extends ug{constructor(){super(...arguments),this.type=Ki.CDATA}get nodeType(){return 4}}class md extends ug{constructor(){super(...arguments),this.type=Ki.Root}get nodeType(){return 9}}class lg extends ug{constructor(o,m,v=[],C=o==="script"?Ki.Script:o==="style"?Ki.Style:Ki.Tag){super(v),this.name=o,this.attribs=m,this.type=C}get nodeType(){return 1}get tagName(){return this.name}set tagName(o){this.name=o}get attributes(){return Object.keys(this.attribs).map(o=>{var m,v;return{name:o,value:this.attribs[o],namespace:(m=this["x-attribsNamespace"])===null||m===void 0?void 0:m[o],prefix:(v=this["x-attribsPrefix"])===null||v===void 0?void 0:v[o]}})}}function oi(i){return jy(i)}function tm(i){return i.type===Ki.CDATA}function Al(i){return i.type===Ki.Text}function im(i){return i.type===Ki.Comment}function Vm(i){return i.type===Ki.Directive}function vh(i){return i.type===Ki.Root}function pn(i){return Object.prototype.hasOwnProperty.call(i,"children")}function Y0(i,o=!1){let m;if(Al(i))m=new Z0(i.data);else if(im(i))m=new sg(i.data);else if(oi(i)){const v=o?Lm(i.children):[],C=new lg(i.name,{...i.attribs},v);v.forEach(N=>N.parent=C),i.namespace!=null&&(C.namespace=i.namespace),i["x-attribsNamespace"]&&(C["x-attribsNamespace"]={...i["x-attribsNamespace"]}),i["x-attribsPrefix"]&&(C["x-attribsPrefix"]={...i["x-attribsPrefix"]}),m=C}else if(tm(i)){const v=o?Lm(i.children):[],C=new P_(v);v.forEach(N=>N.parent=C),m=C}else if(vh(i)){const v=o?Lm(i.children):[],C=new md(v);v.forEach(N=>N.parent=C),i["x-mode"]&&(C["x-mode"]=i["x-mode"]),m=C}else if(Vm(i)){const v=new og(i.name,i.data);i["x-name"]!=null&&(v["x-name"]=i["x-name"],v["x-publicId"]=i["x-publicId"],v["x-systemId"]=i["x-systemId"]),m=v}else throw new Error(`Not implemented yet: ${i.type}`);return m.startIndex=i.startIndex,m.endIndex=i.endIndex,i.sourceCodeLocation!=null&&(m.sourceCodeLocation=i.sourceCodeLocation),m}function Lm(i){const o=i.map(m=>Y0(m,!0));for(let m=1;m<o.length;m++)o[m].prev=o[m-1],o[m-1].next=o[m];return o}const Yg={withStartIndices:!1,withEndIndices:!1,xmlMode:!1};class Wy{constructor(o,m,v){this.dom=[],this.root=new md(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof m=="function"&&(v=m,m=Yg),typeof o=="object"&&(m=o,o=void 0),this.callback=o??null,this.options=m??Yg,this.elementCB=v??null}onparserinit(o){this.parser=o}onreset(){this.dom=[],this.root=new md(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null}onend(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))}onerror(o){this.handleCallback(o)}onclosetag(){this.lastNode=null;const o=this.tagStack.pop();this.options.withEndIndices&&(o.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(o)}onopentag(o,m){const v=this.options.xmlMode?Ki.Tag:void 0,C=new lg(o,m,void 0,v);this.addNode(C),this.tagStack.push(C)}ontext(o){const{lastNode:m}=this;if(m&&m.type===Ki.Text)m.data+=o,this.options.withEndIndices&&(m.endIndex=this.parser.endIndex);else{const v=new Z0(o);this.addNode(v),this.lastNode=v}}oncomment(o){if(this.lastNode&&this.lastNode.type===Ki.Comment){this.lastNode.data+=o;return}const m=new sg(o);this.addNode(m),this.lastNode=m}oncommentend(){this.lastNode=null}oncdatastart(){const o=new Z0(""),m=new P_([o]);this.addNode(m),o.parent=m,this.lastNode=o}oncdataend(){this.lastNode=null}onprocessinginstruction(o,m){const v=new og(o,m);this.addNode(v)}handleCallback(o){if(typeof this.callback=="function")this.callback(o,this.dom);else if(o)throw o}addNode(o){const m=this.tagStack[this.tagStack.length-1],v=m.children[m.children.length-1];this.options.withStartIndices&&(o.startIndex=this.parser.startIndex),this.options.withEndIndices&&(o.endIndex=this.parser.endIndex),m.children.push(o),v&&(o.prev=v,v.next=o),o.parent=m,this.lastNode=null}}const L_=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(i=>i.charCodeAt(0))),N_=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(i=>i.charCodeAt(0)));var Nm;const Jy=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Gm=(Nm=String.fromCodePoint)!==null&&Nm!==void 0?Nm:function(i){let o="";return i>65535&&(i-=65536,o+=String.fromCharCode(i>>>10&1023|55296),i=56320|i&1023),o+=String.fromCharCode(i),o};function eb(i){var o;return i>=55296&&i<=57343||i>1114111?65533:(o=Jy.get(i))!==null&&o!==void 0?o:i}var ir;(function(i){i[i.NUM=35]="NUM",i[i.SEMI=59]="SEMI",i[i.EQUALS=61]="EQUALS",i[i.ZERO=48]="ZERO",i[i.NINE=57]="NINE",i[i.LOWER_A=97]="LOWER_A",i[i.LOWER_F=102]="LOWER_F",i[i.LOWER_X=120]="LOWER_X",i[i.LOWER_Z=122]="LOWER_Z",i[i.UPPER_A=65]="UPPER_A",i[i.UPPER_F=70]="UPPER_F",i[i.UPPER_Z=90]="UPPER_Z"})(ir||(ir={}));const tb=32;var yh;(function(i){i[i.VALUE_LENGTH=49152]="VALUE_LENGTH",i[i.BRANCH_LENGTH=16256]="BRANCH_LENGTH",i[i.JUMP_TABLE=127]="JUMP_TABLE"})(yh||(yh={}));function Zm(i){return i>=ir.ZERO&&i<=ir.NINE}function ib(i){return i>=ir.UPPER_A&&i<=ir.UPPER_F||i>=ir.LOWER_A&&i<=ir.LOWER_F}function ab(i){return i>=ir.UPPER_A&&i<=ir.UPPER_Z||i>=ir.LOWER_A&&i<=ir.LOWER_Z||Zm(i)}function nb(i){return i===ir.EQUALS||ab(i)}var er;(function(i){i[i.EntityStart=0]="EntityStart",i[i.NumericStart=1]="NumericStart",i[i.NumericDecimal=2]="NumericDecimal",i[i.NumericHex=3]="NumericHex",i[i.NamedEntity=4]="NamedEntity"})(er||(er={}));var El;(function(i){i[i.Legacy=0]="Legacy",i[i.Strict=1]="Strict",i[i.Attribute=2]="Attribute"})(El||(El={}));let O_=class{constructor(o,m,v){this.decodeTree=o,this.emitCodePoint=m,this.errors=v,this.state=er.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=El.Strict}startEntity(o){this.decodeMode=o,this.state=er.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(o,m){switch(this.state){case er.EntityStart:return o.charCodeAt(m)===ir.NUM?(this.state=er.NumericStart,this.consumed+=1,this.stateNumericStart(o,m+1)):(this.state=er.NamedEntity,this.stateNamedEntity(o,m));case er.NumericStart:return this.stateNumericStart(o,m);case er.NumericDecimal:return this.stateNumericDecimal(o,m);case er.NumericHex:return this.stateNumericHex(o,m);case er.NamedEntity:return this.stateNamedEntity(o,m)}}stateNumericStart(o,m){return m>=o.length?-1:(o.charCodeAt(m)|tb)===ir.LOWER_X?(this.state=er.NumericHex,this.consumed+=1,this.stateNumericHex(o,m+1)):(this.state=er.NumericDecimal,this.stateNumericDecimal(o,m))}addToNumericResult(o,m,v,C){if(m!==v){const N=v-m;this.result=this.result*Math.pow(C,N)+parseInt(o.substr(m,N),C),this.consumed+=N}}stateNumericHex(o,m){const v=m;for(;m<o.length;){const C=o.charCodeAt(m);if(Zm(C)||ib(C))m+=1;else return this.addToNumericResult(o,v,m,16),this.emitNumericEntity(C,3)}return this.addToNumericResult(o,v,m,16),-1}stateNumericDecimal(o,m){const v=m;for(;m<o.length;){const C=o.charCodeAt(m);if(Zm(C))m+=1;else return this.addToNumericResult(o,v,m,10),this.emitNumericEntity(C,2)}return this.addToNumericResult(o,v,m,10),-1}emitNumericEntity(o,m){var v;if(this.consumed<=m)return(v=this.errors)===null||v===void 0||v.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(o===ir.SEMI)this.consumed+=1;else if(this.decodeMode===El.Strict)return 0;return this.emitCodePoint(eb(this.result),this.consumed),this.errors&&(o!==ir.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(o,m){const{decodeTree:v}=this;let C=v[this.treeIndex],N=(C&yh.VALUE_LENGTH)>>14;for(;m<o.length;m++,this.excess++){const M=o.charCodeAt(m);if(this.treeIndex=rb(v,C,this.treeIndex+Math.max(1,N),M),this.treeIndex<0)return this.result===0||this.decodeMode===El.Attribute&&(N===0||nb(M))?0:this.emitNotTerminatedNamedEntity();if(C=v[this.treeIndex],N=(C&yh.VALUE_LENGTH)>>14,N!==0){if(M===ir.SEMI)return this.emitNamedEntityData(this.treeIndex,N,this.consumed+this.excess);this.decodeMode!==El.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var o;const{result:m,decodeTree:v}=this,C=(v[m]&yh.VALUE_LENGTH)>>14;return this.emitNamedEntityData(m,C,this.consumed),(o=this.errors)===null||o===void 0||o.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(o,m,v){const{decodeTree:C}=this;return this.emitCodePoint(m===1?C[o]&~yh.VALUE_LENGTH:C[o+1],v),m===3&&this.emitCodePoint(C[o+2],v),v}end(){var o;switch(this.state){case er.NamedEntity:return this.result!==0&&(this.decodeMode!==El.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case er.NumericDecimal:return this.emitNumericEntity(0,2);case er.NumericHex:return this.emitNumericEntity(0,3);case er.NumericStart:return(o=this.errors)===null||o===void 0||o.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case er.EntityStart:return 0}}};function k_(i){let o="";const m=new O_(i,v=>o+=Gm(v));return function(C,N){let M=0,d=0;for(;(d=C.indexOf("&",d))>=0;){o+=C.slice(M,d),m.startEntity(N);const W=m.write(C,d+1);if(W<0){M=d+m.end();break}M=d+W,d=W===0?M+1:M}const K=o+C.slice(M);return o="",K}}function rb(i,o,m,v){const C=(o&yh.BRANCH_LENGTH)>>7,N=o&yh.JUMP_TABLE;if(C===0)return N!==0&&v===N?m:-1;if(N){const K=v-N;return K<0||K>=C?-1:i[m+K]-1}let M=m,d=M+C-1;for(;M<=d;){const K=M+d>>>1,W=i[K];if(W<v)M=K+1;else if(W>v)d=K-1;else return i[K+C]}return-1}k_(L_);k_(N_);const $g=/["&'<>$\x80-\uFFFF]/g,sb=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),ob=String.prototype.codePointAt!=null?(i,o)=>i.codePointAt(o):(i,o)=>(i.charCodeAt(o)&64512)===55296?(i.charCodeAt(o)-55296)*1024+i.charCodeAt(o+1)-56320+65536:i.charCodeAt(o);function B_(i){let o="",m=0,v;for(;(v=$g.exec(i))!==null;){const C=v.index,N=i.charCodeAt(C),M=sb.get(N);M!==void 0?(o+=i.substring(m,C)+M,m=C+1):(o+=`${i.substring(m,C)}&#x${ob(i,C).toString(16)};`,m=$g.lastIndex+=+((N&64512)===55296))}return o+i.substr(m)}function z_(i,o){return function(v){let C,N=0,M="";for(;C=i.exec(v);)N!==C.index&&(M+=v.substring(N,C.index)),M+=o.get(C[0].charCodeAt(0)),N=C.index+1;return M+v.substring(N)}}const ub=z_(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),lb=z_(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),cb=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(i=>[i.toLowerCase(),i])),hb=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(i=>[i.toLowerCase(),i])),db=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function fb(i){return i.replace(/"/g,"&quot;")}function pb(i,o){var m;if(!i)return;const v=((m=o.encodeEntities)!==null&&m!==void 0?m:o.decodeEntities)===!1?fb:o.xmlMode||o.encodeEntities!=="utf8"?B_:ub;return Object.keys(i).map(C=>{var N,M;const d=(N=i[C])!==null&&N!==void 0?N:"";return o.xmlMode==="foreign"&&(C=(M=hb.get(C))!==null&&M!==void 0?M:C),!o.emptyAttrs&&!o.xmlMode&&d===""?C:`${C}="${v(d)}"`}).join(" ")}const Xg=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function am(i,o={}){const m="length"in i?i:[i];let v="";for(let C=0;C<m.length;C++)v+=mb(m[C],o);return v}function mb(i,o){switch(i.type){case qy:return am(i.children,o);case Ky:case Gy:return bb(i);case Zy:return Tb(i);case Qy:return vb(i);case Yy:case $y:case Xy:return yb(i,o);case Vy:return xb(i,o)}}const gb=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),_b=new Set(["svg","math"]);function yb(i,o){var m;o.xmlMode==="foreign"&&(i.name=(m=cb.get(i.name))!==null&&m!==void 0?m:i.name,i.parent&&gb.has(i.parent.name)&&(o={...o,xmlMode:!1})),!o.xmlMode&&_b.has(i.name)&&(o={...o,xmlMode:"foreign"});let v=`<${i.name}`;const C=pb(i.attribs,o);return C&&(v+=` ${C}`),i.children.length===0&&(o.xmlMode?o.selfClosingTags!==!1:o.selfClosingTags&&Xg.has(i.name))?(o.xmlMode||(v+=" "),v+="/>"):(v+=">",i.children.length>0&&(v+=am(i.children,o)),(o.xmlMode||!Xg.has(i.name))&&(v+=`</${i.name}>`)),v}function bb(i){return`<${i.data}>`}function xb(i,o){var m;let v=i.data||"";return((m=o.encodeEntities)!==null&&m!==void 0?m:o.decodeEntities)!==!1&&!(!o.xmlMode&&i.parent&&db.has(i.parent.name))&&(v=o.xmlMode||o.encodeEntities!=="utf8"?B_(v):lb(v)),v}function vb(i){return`<![CDATA[${i.children[0].data}]]>`}function Tb(i){return`<!--${i.data}-->`}function F_(i,o){return am(i,o)}function Eb(i,o){return pn(i)?i.children.map(m=>F_(m,o)).join(""):""}function Hp(i){return Array.isArray(i)?i.map(Hp).join(""):oi(i)?i.name==="br"?`
`:Hp(i.children):tm(i)?Hp(i.children):Al(i)?i.data:""}function Lf(i){return Array.isArray(i)?i.map(Lf).join(""):pn(i)&&!im(i)?Lf(i.children):Al(i)?i.data:""}function Vp(i){return Array.isArray(i)?i.map(Vp).join(""):pn(i)&&(i.type===Ki.Tag||tm(i))?Vp(i.children):Al(i)?i.data:""}function nm(i){return pn(i)?i.children:[]}function U_(i){return i.parent||null}function H_(i){const o=U_(i);if(o!=null)return nm(o);const m=[i];let{prev:v,next:C}=i;for(;v!=null;)m.unshift(v),{prev:v}=v;for(;C!=null;)m.push(C),{next:C}=C;return m}function wb(i,o){var m;return(m=i.attribs)===null||m===void 0?void 0:m[o]}function Ab(i,o){return i.attribs!=null&&Object.prototype.hasOwnProperty.call(i.attribs,o)&&i.attribs[o]!=null}function Sb(i){return i.name}function cg(i){let{next:o}=i;for(;o!==null&&!oi(o);)({next:o}=o);return o}function hg(i){let{prev:o}=i;for(;o!==null&&!oi(o);)({prev:o}=o);return o}function yd(i){if(i.prev&&(i.prev.next=i.next),i.next&&(i.next.prev=i.prev),i.parent){const o=i.parent.children,m=o.lastIndexOf(i);m>=0&&o.splice(m,1)}i.next=null,i.prev=null,i.parent=null}function Cb(i,o){const m=o.prev=i.prev;m&&(m.next=o);const v=o.next=i.next;v&&(v.prev=o);const C=o.parent=i.parent;if(C){const N=C.children;N[N.lastIndexOf(i)]=o,i.parent=null}}function Mb(i,o){if(yd(o),o.next=null,o.parent=i,i.children.push(o)>1){const m=i.children[i.children.length-2];m.next=o,o.prev=m}else o.prev=null}function Ib(i,o){yd(o);const{parent:m}=i,v=i.next;if(o.next=v,o.prev=i,i.next=o,o.parent=m,v){if(v.prev=o,m){const C=m.children;C.splice(C.lastIndexOf(v),0,o)}}else m&&m.children.push(o)}function Db(i,o){if(yd(o),o.parent=i,o.prev=null,i.children.unshift(o)!==1){const m=i.children[1];m.prev=o,o.next=m}else o.next=null}function Rb(i,o){yd(o);const{parent:m}=i;if(m){const v=m.children;v.splice(v.indexOf(i),0,o)}i.prev&&(i.prev.next=o),o.parent=m,o.prev=i.prev,o.next=i,i.prev=o}function W0(i,o,m=!0,v=1/0){return dg(i,Array.isArray(o)?o:[o],m,v)}function dg(i,o,m,v){const C=[],N=[Array.isArray(o)?o:[o]],M=[0];for(;;){if(M[0]>=N[0].length){if(M.length===1)return C;N.shift(),M.shift();continue}const d=N[0][M[0]++];if(i(d)&&(C.push(d),--v<=0))return C;m&&pn(d)&&d.children.length>0&&(M.unshift(0),N.unshift(d.children))}}function Pb(i,o){return o.find(i)}function fg(i,o,m=!0){const v=Array.isArray(o)?o:[o];for(let C=0;C<v.length;C++){const N=v[C];if(oi(N)&&i(N))return N;if(m&&pn(N)&&N.children.length>0){const M=fg(i,N.children,!0);if(M)return M}}return null}function j_(i,o){return(Array.isArray(o)?o:[o]).some(m=>oi(m)&&i(m)||pn(m)&&j_(i,m.children))}function Lb(i,o){const m=[],v=[Array.isArray(o)?o:[o]],C=[0];for(;;){if(C[0]>=v[0].length){if(v.length===1)return m;v.shift(),C.shift();continue}const N=v[0][C[0]++];oi(N)&&i(N)&&m.push(N),pn(N)&&N.children.length>0&&(C.unshift(0),v.unshift(N.children))}}const Gp={tag_name(i){return typeof i=="function"?o=>oi(o)&&i(o.name):i==="*"?oi:o=>oi(o)&&o.name===i},tag_type(i){return typeof i=="function"?o=>i(o.type):o=>o.type===i},tag_contains(i){return typeof i=="function"?o=>Al(o)&&i(o.data):o=>Al(o)&&o.data===i}};function pg(i,o){return typeof o=="function"?m=>oi(m)&&o(m.attribs[i]):m=>oi(m)&&m.attribs[i]===o}function Nb(i,o){return m=>i(m)||o(m)}function q_(i){const o=Object.keys(i).map(m=>{const v=i[m];return Object.prototype.hasOwnProperty.call(Gp,m)?Gp[m](v):pg(m,v)});return o.length===0?null:o.reduce(Nb)}function Ob(i,o){const m=q_(i);return m?m(o):!0}function kb(i,o,m,v=1/0){const C=q_(i);return C?W0(C,o,m,v):[]}function Bb(i,o,m=!0){return Array.isArray(o)||(o=[o]),fg(pg("id",i),o,m)}function kf(i,o,m=!0,v=1/0){return W0(Gp.tag_name(i),o,m,v)}function zb(i,o,m=!0,v=1/0){return W0(pg("class",i),o,m,v)}function Fb(i,o,m=!0,v=1/0){return W0(Gp.tag_type(i),o,m,v)}function Ub(i){let o=i.length;for(;--o>=0;){const m=i[o];if(o>0&&i.lastIndexOf(m,o-1)>=0){i.splice(o,1);continue}for(let v=m.parent;v;v=v.parent)if(i.includes(v)){i.splice(o,1);break}}return i}var ko;(function(i){i[i.DISCONNECTED=1]="DISCONNECTED",i[i.PRECEDING=2]="PRECEDING",i[i.FOLLOWING=4]="FOLLOWING",i[i.CONTAINS=8]="CONTAINS",i[i.CONTAINED_BY=16]="CONTAINED_BY"})(ko||(ko={}));function V_(i,o){const m=[],v=[];if(i===o)return 0;let C=pn(i)?i:i.parent;for(;C;)m.unshift(C),C=C.parent;for(C=pn(o)?o:o.parent;C;)v.unshift(C),C=C.parent;const N=Math.min(m.length,v.length);let M=0;for(;M<N&&m[M]===v[M];)M++;if(M===0)return ko.DISCONNECTED;const d=m[M-1],K=d.children,W=m[M],we=v[M];return K.indexOf(W)>K.indexOf(we)?d===o?ko.FOLLOWING|ko.CONTAINED_BY:ko.FOLLOWING:d===i?ko.PRECEDING|ko.CONTAINS:ko.PRECEDING}function Bf(i){return i=i.filter((o,m,v)=>!v.includes(o,m+1)),i.sort((o,m)=>{const v=V_(o,m);return v&ko.PRECEDING?-1:v&ko.FOLLOWING?1:0}),i}function Hb(i){const o=Zp(Zb,i);return o?o.name==="feed"?jb(o):qb(o):null}function jb(i){var o;const m=i.children,v={type:"atom",items:kf("entry",m).map(M=>{var d;const{children:K}=M,W={media:G_(K)};As(W,"id","id",K),As(W,"title","title",K);const we=(d=Zp("link",K))===null||d===void 0?void 0:d.attribs.href;we&&(W.link=we);const Pe=bh("summary",K)||bh("content",K);Pe&&(W.description=Pe);const Me=bh("updated",K);return Me&&(W.pubDate=new Date(Me)),W})};As(v,"id","id",m),As(v,"title","title",m);const C=(o=Zp("link",m))===null||o===void 0?void 0:o.attribs.href;C&&(v.link=C),As(v,"description","subtitle",m);const N=bh("updated",m);return N&&(v.updated=new Date(N)),As(v,"author","email",m,!0),v}function qb(i){var o,m;const v=(m=(o=Zp("channel",i.children))===null||o===void 0?void 0:o.children)!==null&&m!==void 0?m:[],C={type:i.name.substr(0,3),id:"",items:kf("item",i.children).map(M=>{const{children:d}=M,K={media:G_(d)};As(K,"id","guid",d),As(K,"title","title",d),As(K,"link","link",d),As(K,"description","description",d);const W=bh("pubDate",d)||bh("dc:date",d);return W&&(K.pubDate=new Date(W)),K})};As(C,"title","title",v),As(C,"link","link",v),As(C,"description","description",v);const N=bh("lastBuildDate",v);return N&&(C.updated=new Date(N)),As(C,"author","managingEditor",v,!0),C}const Vb=["url","type","lang"],Gb=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function G_(i){return kf("media:content",i).map(o=>{const{attribs:m}=o,v={medium:m.medium,isDefault:!!m.isDefault};for(const C of Vb)m[C]&&(v[C]=m[C]);for(const C of Gb)m[C]&&(v[C]=parseInt(m[C],10));return m.expression&&(v.expression=m.expression),v})}function Zp(i,o){return kf(i,o,!0,1)[0]}function bh(i,o,m=!1){return Lf(kf(i,o,m,1)).trim()}function As(i,o,m,v,C=!1){const N=bh(m,v,C);N&&(i[o]=N)}function Zb(i){return i==="rss"||i==="feed"||i==="rdf:RDF"}const rm=Object.freeze(Object.defineProperty({__proto__:null,get DocumentPosition(){return ko},append:Ib,appendChild:Mb,compareDocumentPosition:V_,existsOne:j_,filter:W0,find:dg,findAll:Lb,findOne:fg,findOneChild:Pb,getAttributeValue:wb,getChildren:nm,getElementById:Bb,getElements:kb,getElementsByClassName:zb,getElementsByTagName:kf,getElementsByTagType:Fb,getFeed:Hb,getInnerHTML:Eb,getName:Sb,getOuterHTML:F_,getParent:U_,getSiblings:H_,getText:Hp,hasAttrib:Ab,hasChildren:pn,innerText:Vp,isCDATA:tm,isComment:im,isDocument:vh,isTag:oi,isText:Al,nextElementSibling:cg,prepend:Rb,prependChild:Db,prevElementSibling:hg,removeElement:yd,removeSubsets:Ub,replaceElement:Cb,testElement:Ob,textContent:Lf,uniqueSort:Bf},Symbol.toStringTag,{value:"Module"})),Yb={_useHtmlParser2:!1};function Ym(i,o){if(!i)return o??Yb;const m={_useHtmlParser2:!!i.xmlMode,...o,...i};return i.xml?(m._useHtmlParser2=!0,m.xmlMode=!0,i.xml!==!0&&Object.assign(m,i.xml)):i.xmlMode&&(m._useHtmlParser2=!0),m}function Z_(i,o,m){return i?i(o??i._root.children,null,void 0,m).toString():""}function $b(i,o){return typeof i=="object"&&i!=null&&!("length"in i)&&!("type"in i)}function Xb(i,o){const m=$b(i)?(o=i,void 0):i,v={...this===null||this===void 0?void 0:this._options,...Ym(o)};return Z_(this,m,v)}function Qb(i){const o={...this._options,xmlMode:!0};return Z_(this,i,o)}function $0(i){const o=i??(this?this.root():[]);let m="";for(let v=0;v<o.length;v++)m+=Lf(o[v]);return m}function Kb(i,o,m=typeof o=="boolean"?o:!1){if(!i||typeof i!="string")return null;typeof o=="boolean"&&(m=o);const v=this.load(i,this._options,!1);return m||v("script").remove(),[...v.root()[0].children]}function Wb(){return this(this._root)}function Y_(i,o){if(o===i)return!1;let m=o;for(;m&&m!==m.parent;)if(m=m.parent,m===i)return!0;return!1}function Jb(i){return this.root().extract(i)}function ex(i,o){if(!Qg(i)||!Qg(o))return;let m=i.length;const v=+o.length;for(let C=0;C<v;C++)i[m++]=o[C];return i.length=m,i}function Qg(i){if(Array.isArray(i))return!0;if(typeof i!="object"||i===null||!("length"in i)||typeof i.length!="number"||i.length<0)return!1;for(let o=0;o<i.length;o++)if(!(o in i))return!1;return!0}const tx=Object.freeze(Object.defineProperty({__proto__:null,contains:Y_,extract:Jb,html:Xb,merge:ex,parseHTML:Kb,root:Wb,text:$0,xml:Qb},Symbol.toStringTag,{value:"Module"}));function mc(i){return i.cheerio!=null}function ix(i){return i.replace(/[._-](\w|$)/g,(o,m)=>m.toUpperCase())}function ax(i){return i.replace(/[A-Z]/g,"-$&").toLowerCase()}function Qa(i,o){const m=i.length;for(let v=0;v<m;v++)o(i[v],v);return i}var fd;(function(i){i[i.LowerA=97]="LowerA",i[i.LowerZ=122]="LowerZ",i[i.UpperA=65]="UpperA",i[i.UpperZ=90]="UpperZ",i[i.Exclamation=33]="Exclamation"})(fd||(fd={}));function $m(i){const o=i.indexOf("<");if(o<0||o>i.length-3)return!1;const m=i.charCodeAt(o+1);return(m>=fd.LowerA&&m<=fd.LowerZ||m>=fd.UpperA&&m<=fd.UpperZ||m===fd.Exclamation)&&i.includes(">",o+2)}const X0=Object.prototype.hasOwnProperty,Q0=/\s+/,Xm="data-",mg=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,nx=/^{[^]*}$|^\[[^]*]$/;function Yp(i,o,m){var v;if(!(!i||!oi(i))){if((v=i.attribs)!==null&&v!==void 0||(i.attribs={}),!o)return i.attribs;if(X0.call(i.attribs,o))return!m&&mg.test(o)?o:i.attribs[o];if(i.name==="option"&&o==="value")return $0(i.children);if(i.name==="input"&&(i.attribs.type==="radio"||i.attribs.type==="checkbox")&&o==="value")return"on"}}function Rf(i,o,m){m===null?X_(i,o):i.attribs[o]=`${m}`}function rx(i,o){if(typeof i=="object"||o!==void 0){if(typeof o=="function"){if(typeof i!="string")throw new Error("Bad combination of arguments.");return Qa(this,(m,v)=>{oi(m)&&Rf(m,i,o.call(m,v,m.attribs[i]))})}return Qa(this,m=>{if(oi(m))if(typeof i=="object")for(const v of Object.keys(i)){const C=i[v];Rf(m,v,C)}else Rf(m,i,o)})}return arguments.length>1?this:Yp(this[0],i,this.options.xmlMode)}function Kg(i,o,m){return o in i?i[o]:!m&&mg.test(o)?Yp(i,o,!1)!==void 0:Yp(i,o,m)}function Om(i,o,m,v){o in i?i[o]=m:Rf(i,o,!v&&mg.test(o)?m?"":null:`${m}`)}function sx(i,o){var m;if(typeof i=="string"&&o===void 0){const v=this[0];if(!v||!oi(v))return;switch(i){case"style":{const C=this.css(),N=Object.keys(C);for(let M=0;M<N.length;M++)C[M]=N[M];return C.length=N.length,C}case"tagName":case"nodeName":return v.name.toUpperCase();case"href":case"src":{const C=(m=v.attribs)===null||m===void 0?void 0:m[i];return typeof URL<"u"&&(i==="href"&&(v.tagName==="a"||v.tagName==="link")||i==="src"&&(v.tagName==="img"||v.tagName==="iframe"||v.tagName==="audio"||v.tagName==="video"||v.tagName==="source"))&&C!==void 0&&this.options.baseURI?new URL(C,this.options.baseURI).href:C}case"innerText":return Vp(v);case"textContent":return Lf(v);case"outerHTML":return this.clone().wrap("<container />").parent().html();case"innerHTML":return this.html();default:return Kg(v,i,this.options.xmlMode)}}if(typeof i=="object"||o!==void 0){if(typeof o=="function"){if(typeof i=="object")throw new TypeError("Bad combination of arguments.");return Qa(this,(v,C)=>{oi(v)&&Om(v,i,o.call(v,C,Kg(v,i,this.options.xmlMode)),this.options.xmlMode)})}return Qa(this,v=>{if(oi(v))if(typeof i=="object")for(const C of Object.keys(i)){const N=i[C];Om(v,C,N,this.options.xmlMode)}else Om(v,i,o,this.options.xmlMode)})}}function Wg(i,o,m){var v;(v=i.data)!==null&&v!==void 0||(i.data={}),typeof o=="object"?Object.assign(i.data,o):typeof o=="string"&&m!==void 0&&(i.data[o]=m)}function ox(i){for(const o of Object.keys(i.attribs)){if(!o.startsWith(Xm))continue;const m=ix(o.slice(Xm.length));X0.call(i.data,m)||(i.data[m]=$_(i.attribs[o]))}return i.data}function ux(i,o){const m=Xm+ax(o),v=i.data;if(X0.call(v,o))return v[o];if(X0.call(i.attribs,m))return v[o]=$_(i.attribs[m])}function $_(i){if(i==="null")return null;if(i==="true")return!0;if(i==="false")return!1;const o=Number(i);if(i===String(o))return o;if(nx.test(i))try{return JSON.parse(i)}catch{}return i}function lx(i,o){var m;const v=this[0];if(!v||!oi(v))return;const C=v;return(m=C.data)!==null&&m!==void 0||(C.data={}),i==null?ox(C):typeof i=="object"||o!==void 0?(Qa(this,N=>{oi(N)&&(typeof i=="object"?Wg(N,i):Wg(N,i,o))}),this):ux(C,i)}function cx(i){const o=arguments.length===0,m=this[0];if(!m||!oi(m))return o?void 0:this;switch(m.name){case"textarea":return this.text(i);case"select":{const v=this.find("option:selected");if(!o){if(this.attr("multiple")==null&&typeof i=="object")return this;this.find("option").removeAttr("selected");const C=typeof i=="object"?i:[i];for(const N of C)this.find(`option[value="${N}"]`).attr("selected","");return this}return this.attr("multiple")?v.toArray().map(C=>$0(C.children)):v.attr("value")}case"input":case"option":return o?this.attr("value"):this.attr("value",i)}}function X_(i,o){!i.attribs||!X0.call(i.attribs,o)||delete i.attribs[o]}function $p(i){return i?i.trim().split(Q0):[]}function hx(i){const o=$p(i);for(const m of o)Qa(this,v=>{oi(v)&&X_(v,m)});return this}function dx(i){return this.toArray().some(o=>{const m=oi(o)&&o.attribs.class;let v=-1;if(m&&i.length>0)for(;(v=m.indexOf(i,v+1))>-1;){const C=v+i.length;if((v===0||Q0.test(m[v-1]))&&(C===m.length||Q0.test(m[C])))return!0}return!1})}function Q_(i){if(typeof i=="function")return Qa(this,(v,C)=>{if(oi(v)){const N=v.attribs.class||"";Q_.call([v],i.call(v,C,N))}});if(!i||typeof i!="string")return this;const o=i.split(Q0),m=this.length;for(let v=0;v<m;v++){const C=this[v];if(!oi(C))continue;const N=Yp(C,"class",!1);if(N){let M=` ${N} `;for(const d of o){const K=`${d} `;M.includes(` ${K}`)||(M+=K)}Rf(C,"class",M.trim())}else Rf(C,"class",o.join(" ").trim())}return this}function K_(i){if(typeof i=="function")return Qa(this,(C,N)=>{oi(C)&&K_.call([C],i.call(C,N,C.attribs.class||""))});const o=$p(i),m=o.length,v=arguments.length===0;return Qa(this,C=>{if(oi(C))if(v)C.attribs.class="";else{const N=$p(C.attribs.class);let M=!1;for(let d=0;d<m;d++){const K=N.indexOf(o[d]);K>=0&&(N.splice(K,1),M=!0,d--)}M&&(C.attribs.class=N.join(" "))}})}function W_(i,o){if(typeof i=="function")return Qa(this,(M,d)=>{oi(M)&&W_.call([M],i.call(M,d,M.attribs.class||"",o),o)});if(!i||typeof i!="string")return this;const m=i.split(Q0),v=m.length,C=typeof o=="boolean"?o?1:-1:0,N=this.length;for(let M=0;M<N;M++){const d=this[M];if(!oi(d))continue;const K=$p(d.attribs.class);for(let W=0;W<v;W++){const we=K.indexOf(m[W]);C>=0&&we<0?K.push(m[W]):C<=0&&we>=0&&K.splice(we,1)}d.attribs.class=K.join(" ")}return this}const fx=Object.freeze(Object.defineProperty({__proto__:null,addClass:Q_,attr:rx,data:lx,hasClass:dx,prop:sx,removeAttr:hx,removeClass:K_,toggleClass:W_,val:cx},Symbol.toStringTag,{value:"Module"}));var Qt;(function(i){i.Attribute="attribute",i.Pseudo="pseudo",i.PseudoElement="pseudo-element",i.Tag="tag",i.Universal="universal",i.Adjacent="adjacent",i.Child="child",i.Descendant="descendant",i.Parent="parent",i.Sibling="sibling",i.ColumnCombinator="column-combinator"})(Qt||(Qt={}));var jn;(function(i){i.Any="any",i.Element="element",i.End="end",i.Equals="equals",i.Exists="exists",i.Hyphen="hyphen",i.Not="not",i.Start="start"})(jn||(jn={}));const Jg=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,px=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,mx=new Map([[126,jn.Element],[94,jn.Start],[36,jn.End],[42,jn.Any],[33,jn.Not],[124,jn.Hyphen]]),gx=new Set(["has","not","matches","is","where","host","host-context"]);function U0(i){switch(i.type){case Qt.Adjacent:case Qt.Child:case Qt.Descendant:case Qt.Parent:case Qt.Sibling:case Qt.ColumnCombinator:return!0;default:return!1}}const _x=new Set(["contains","icontains"]);function yx(i,o,m){const v=parseInt(o,16)-65536;return v!==v||m?o:v<0?String.fromCharCode(v+65536):String.fromCharCode(v>>10|55296,v&1023|56320)}function k0(i){return i.replace(px,yx)}function km(i){return i===39||i===34}function e_(i){return i===32||i===9||i===10||i===12||i===13}function sm(i){const o=[],m=J_(o,`${i}`,0);if(m<i.length)throw new Error(`Unmatched selector: ${i.slice(m)}`);return o}function J_(i,o,m){let v=[];function C(Me){const fe=o.slice(m+Me).match(Jg);if(!fe)throw new Error(`Expected name, found ${o.slice(m)}`);const[Qe]=fe;return m+=Me+Qe.length,k0(Qe)}function N(Me){for(m+=Me;m<o.length&&e_(o.charCodeAt(m));)m++}function M(){m+=1;const Me=m;let fe=1;for(;fe>0&&m<o.length;m++)o.charCodeAt(m)===40&&!d(m)?fe++:o.charCodeAt(m)===41&&!d(m)&&fe--;if(fe)throw new Error("Parenthesis not matched");return k0(o.slice(Me,m-1))}function d(Me){let fe=0;for(;o.charCodeAt(--Me)===92;)fe++;return(fe&1)===1}function K(){if(v.length>0&&U0(v[v.length-1]))throw new Error("Did not expect successive traversals.")}function W(Me){if(v.length>0&&v[v.length-1].type===Qt.Descendant){v[v.length-1].type=Me;return}K(),v.push({type:Me})}function we(Me,fe){v.push({type:Qt.Attribute,name:Me,action:fe,value:C(1),namespace:null,ignoreCase:"quirks"})}function Pe(){if(v.length&&v[v.length-1].type===Qt.Descendant&&v.pop(),v.length===0)throw new Error("Empty sub-selector");i.push(v)}if(N(0),o.length===m)return m;e:for(;m<o.length;){const Me=o.charCodeAt(m);switch(Me){case 32:case 9:case 10:case 12:case 13:{(v.length===0||v[0].type!==Qt.Descendant)&&(K(),v.push({type:Qt.Descendant})),N(1);break}case 62:{W(Qt.Child),N(1);break}case 60:{W(Qt.Parent),N(1);break}case 126:{W(Qt.Sibling),N(1);break}case 43:{W(Qt.Adjacent),N(1);break}case 46:{we("class",jn.Element);break}case 35:{we("id",jn.Equals);break}case 91:{N(1);let fe,Qe=null;o.charCodeAt(m)===124?fe=C(1):o.startsWith("*|",m)?(Qe="*",fe=C(2)):(fe=C(0),o.charCodeAt(m)===124&&o.charCodeAt(m+1)!==61&&(Qe=fe,fe=C(1))),N(0);let ai=jn.Exists;const li=mx.get(o.charCodeAt(m));if(li){if(ai=li,o.charCodeAt(m+1)!==61)throw new Error("Expected `=`");N(2)}else o.charCodeAt(m)===61&&(ai=jn.Equals,N(1));let ei="",Ci=null;if(ai!=="exists"){if(km(o.charCodeAt(m))){const Et=o.charCodeAt(m);let Ut=m+1;for(;Ut<o.length&&(o.charCodeAt(Ut)!==Et||d(Ut));)Ut+=1;if(o.charCodeAt(Ut)!==Et)throw new Error("Attribute value didn't end");ei=k0(o.slice(m+1,Ut)),m=Ut+1}else{const Et=m;for(;m<o.length&&(!e_(o.charCodeAt(m))&&o.charCodeAt(m)!==93||d(m));)m+=1;ei=k0(o.slice(Et,m))}N(0);const Mt=o.charCodeAt(m)|32;Mt===115?(Ci=!1,N(1)):Mt===105&&(Ci=!0,N(1))}if(o.charCodeAt(m)!==93)throw new Error("Attribute selector didn't terminate");m+=1;const ni={type:Qt.Attribute,name:fe,action:ai,value:ei,namespace:Qe,ignoreCase:Ci};v.push(ni);break}case 58:{if(o.charCodeAt(m+1)===58){v.push({type:Qt.PseudoElement,name:C(2).toLowerCase(),data:o.charCodeAt(m)===40?M():null});continue}const fe=C(1).toLowerCase();let Qe=null;if(o.charCodeAt(m)===40)if(gx.has(fe)){if(km(o.charCodeAt(m+1)))throw new Error(`Pseudo-selector ${fe} cannot be quoted`);if(Qe=[],m=J_(Qe,o,m+1),o.charCodeAt(m)!==41)throw new Error(`Missing closing parenthesis in :${fe} (${o})`);m+=1}else{if(Qe=M(),_x.has(fe)){const ai=Qe.charCodeAt(0);ai===Qe.charCodeAt(Qe.length-1)&&km(ai)&&(Qe=Qe.slice(1,-1))}Qe=k0(Qe)}v.push({type:Qt.Pseudo,name:fe,data:Qe});break}case 44:{Pe(),v=[],N(1);break}default:{if(o.startsWith("/*",m)){const ai=o.indexOf("*/",m+2);if(ai<0)throw new Error("Comment was not terminated");m=ai+2,v.length===0&&N(0);break}let fe=null,Qe;if(Me===42)m+=1,Qe="*";else if(Me===124){if(Qe="",o.charCodeAt(m+1)===124){W(Qt.ColumnCombinator),N(2);break}}else if(Jg.test(o.slice(m)))Qe=C(0);else break e;o.charCodeAt(m)===124&&o.charCodeAt(m+1)!==124&&(fe=Qe,o.charCodeAt(m+1)===42?(Qe="*",m+=2):Qe=C(1)),v.push(Qe==="*"?{type:Qt.Universal,namespace:fe}:{type:Qt.Tag,name:Qe,namespace:fe})}}}return Pe(),m}var Bm,t_;function bx(){return t_||(t_=1,Bm={trueFunc:function(){return!0},falseFunc:function(){return!1}}),Bm}var Xp=bx();const Ai=A_(Xp),e1=new Map([[Qt.Universal,50],[Qt.Tag,30],[Qt.Attribute,1],[Qt.Pseudo,0]]);function gg(i){return!e1.has(i.type)}const xx=new Map([[jn.Exists,10],[jn.Equals,8],[jn.Not,7],[jn.Start,6],[jn.End,6],[jn.Any,5]]);function vx(i){const o=i.map(t1);for(let m=1;m<i.length;m++){const v=o[m];if(!(v<0))for(let C=m-1;C>=0&&v<o[C];C--){const N=i[C+1];i[C+1]=i[C],i[C]=N,o[C+1]=o[C],o[C]=v}}}function t1(i){var o,m;let v=(o=e1.get(i.type))!==null&&o!==void 0?o:-1;return i.type===Qt.Attribute?(v=(m=xx.get(i.action))!==null&&m!==void 0?m:4,i.action===jn.Equals&&i.name==="id"&&(v=9),i.ignoreCase&&(v>>=1)):i.type===Qt.Pseudo&&(i.data?i.name==="has"||i.name==="contains"?v=0:Array.isArray(i.data)?(v=Math.min(...i.data.map(C=>Math.min(...C.map(t1)))),v<0&&(v=0)):v=2:v=3),v}const Tx=/[-[\]{}()*+?.,\\^$|#\s]/g;function i_(i){return i.replace(Tx,"\\$&")}const Ex=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function dd(i,o){return typeof i.ignoreCase=="boolean"?i.ignoreCase:i.ignoreCase==="quirks"?!!o.quirksMode:!o.xmlMode&&Ex.has(i.name)}const wx={equals(i,o,m){const{adapter:v}=m,{name:C}=o;let{value:N}=o;return dd(o,m)?(N=N.toLowerCase(),M=>{const d=v.getAttributeValue(M,C);return d!=null&&d.length===N.length&&d.toLowerCase()===N&&i(M)}):M=>v.getAttributeValue(M,C)===N&&i(M)},hyphen(i,o,m){const{adapter:v}=m,{name:C}=o;let{value:N}=o;const M=N.length;return dd(o,m)?(N=N.toLowerCase(),function(K){const W=v.getAttributeValue(K,C);return W!=null&&(W.length===M||W.charAt(M)==="-")&&W.substr(0,M).toLowerCase()===N&&i(K)}):function(K){const W=v.getAttributeValue(K,C);return W!=null&&(W.length===M||W.charAt(M)==="-")&&W.substr(0,M)===N&&i(K)}},element(i,o,m){const{adapter:v}=m,{name:C,value:N}=o;if(/\s/.test(N))return Ai.falseFunc;const M=new RegExp(`(?:^|\\s)${i_(N)}(?:$|\\s)`,dd(o,m)?"i":"");return function(K){const W=v.getAttributeValue(K,C);return W!=null&&W.length>=N.length&&M.test(W)&&i(K)}},exists(i,{name:o},{adapter:m}){return v=>m.hasAttrib(v,o)&&i(v)},start(i,o,m){const{adapter:v}=m,{name:C}=o;let{value:N}=o;const M=N.length;return M===0?Ai.falseFunc:dd(o,m)?(N=N.toLowerCase(),d=>{const K=v.getAttributeValue(d,C);return K!=null&&K.length>=M&&K.substr(0,M).toLowerCase()===N&&i(d)}):d=>{var K;return!!(!((K=v.getAttributeValue(d,C))===null||K===void 0)&&K.startsWith(N))&&i(d)}},end(i,o,m){const{adapter:v}=m,{name:C}=o;let{value:N}=o;const M=-N.length;return M===0?Ai.falseFunc:dd(o,m)?(N=N.toLowerCase(),d=>{var K;return((K=v.getAttributeValue(d,C))===null||K===void 0?void 0:K.substr(M).toLowerCase())===N&&i(d)}):d=>{var K;return!!(!((K=v.getAttributeValue(d,C))===null||K===void 0)&&K.endsWith(N))&&i(d)}},any(i,o,m){const{adapter:v}=m,{name:C,value:N}=o;if(N==="")return Ai.falseFunc;if(dd(o,m)){const M=new RegExp(i_(N),"i");return function(K){const W=v.getAttributeValue(K,C);return W!=null&&W.length>=N.length&&M.test(W)&&i(K)}}return M=>{var d;return!!(!((d=v.getAttributeValue(M,C))===null||d===void 0)&&d.includes(N))&&i(M)}},not(i,o,m){const{adapter:v}=m,{name:C}=o;let{value:N}=o;return N===""?M=>!!v.getAttributeValue(M,C)&&i(M):dd(o,m)?(N=N.toLowerCase(),M=>{const d=v.getAttributeValue(M,C);return(d==null||d.length!==N.length||d.toLowerCase()!==N)&&i(M)}):M=>v.getAttributeValue(M,C)!==N&&i(M)}},Ax=new Set([9,10,12,13,32]),a_=48,Sx=57;function Cx(i){if(i=i.trim().toLowerCase(),i==="even")return[2,0];if(i==="odd")return[2,1];let o=0,m=0,v=N(),C=M();if(o<i.length&&i.charAt(o)==="n"&&(o++,m=v*(C??1),d(),o<i.length?(v=N(),d(),C=M()):v=C=0),C===null||o<i.length)throw new Error(`n-th rule couldn't be parsed ('${i}')`);return[m,v*C];function N(){return i.charAt(o)==="-"?(o++,-1):(i.charAt(o)==="+"&&o++,1)}function M(){const K=o;let W=0;for(;o<i.length&&i.charCodeAt(o)>=a_&&i.charCodeAt(o)<=Sx;)W=W*10+(i.charCodeAt(o)-a_),o++;return o===K?null:W}function d(){for(;o<i.length&&Ax.has(i.charCodeAt(o));)o++}}function Mx(i){const o=i[0],m=i[1]-1;if(m<0&&o<=0)return Ai.falseFunc;if(o===-1)return N=>N<=m;if(o===0)return N=>N===m;if(o===1)return m<0?Ai.trueFunc:N=>N>=m;const v=Math.abs(o),C=(m%v+v)%v;return o>1?N=>N>=m&&N%v===C:N=>N<=m&&N%v===C}function kp(i){return Mx(Cx(i))}function Bp(i,o){return m=>{const v=o.getParent(m);return v!=null&&o.isTag(v)&&i(m)}}const Qm={contains(i,o,{adapter:m}){return function(C){return i(C)&&m.getText(C).includes(o)}},icontains(i,o,{adapter:m}){const v=o.toLowerCase();return function(N){return i(N)&&m.getText(N).toLowerCase().includes(v)}},"nth-child"(i,o,{adapter:m,equals:v}){const C=kp(o);return C===Ai.falseFunc?Ai.falseFunc:C===Ai.trueFunc?Bp(i,m):function(M){const d=m.getSiblings(M);let K=0;for(let W=0;W<d.length&&!v(M,d[W]);W++)m.isTag(d[W])&&K++;return C(K)&&i(M)}},"nth-last-child"(i,o,{adapter:m,equals:v}){const C=kp(o);return C===Ai.falseFunc?Ai.falseFunc:C===Ai.trueFunc?Bp(i,m):function(M){const d=m.getSiblings(M);let K=0;for(let W=d.length-1;W>=0&&!v(M,d[W]);W--)m.isTag(d[W])&&K++;return C(K)&&i(M)}},"nth-of-type"(i,o,{adapter:m,equals:v}){const C=kp(o);return C===Ai.falseFunc?Ai.falseFunc:C===Ai.trueFunc?Bp(i,m):function(M){const d=m.getSiblings(M);let K=0;for(let W=0;W<d.length;W++){const we=d[W];if(v(M,we))break;m.isTag(we)&&m.getName(we)===m.getName(M)&&K++}return C(K)&&i(M)}},"nth-last-of-type"(i,o,{adapter:m,equals:v}){const C=kp(o);return C===Ai.falseFunc?Ai.falseFunc:C===Ai.trueFunc?Bp(i,m):function(M){const d=m.getSiblings(M);let K=0;for(let W=d.length-1;W>=0;W--){const we=d[W];if(v(M,we))break;m.isTag(we)&&m.getName(we)===m.getName(M)&&K++}return C(K)&&i(M)}},root(i,o,{adapter:m}){return v=>{const C=m.getParent(v);return(C==null||!m.isTag(C))&&i(v)}},scope(i,o,m,v){const{equals:C}=m;return!v||v.length===0?Qm.root(i,o,m):v.length===1?N=>C(v[0],N)&&i(N):N=>v.includes(N)&&i(N)},hover:zm("isHovered"),visited:zm("isVisited"),active:zm("isActive")};function zm(i){return function(m,v,{adapter:C}){const N=C[i];return typeof N!="function"?Ai.falseFunc:function(d){return N(d)&&m(d)}}}const n_={empty(i,{adapter:o}){return!o.getChildren(i).some(m=>o.isTag(m)||o.getText(m)!=="")},"first-child"(i,{adapter:o,equals:m}){if(o.prevElementSibling)return o.prevElementSibling(i)==null;const v=o.getSiblings(i).find(C=>o.isTag(C));return v!=null&&m(i,v)},"last-child"(i,{adapter:o,equals:m}){const v=o.getSiblings(i);for(let C=v.length-1;C>=0;C--){if(m(i,v[C]))return!0;if(o.isTag(v[C]))break}return!1},"first-of-type"(i,{adapter:o,equals:m}){const v=o.getSiblings(i),C=o.getName(i);for(let N=0;N<v.length;N++){const M=v[N];if(m(i,M))return!0;if(o.isTag(M)&&o.getName(M)===C)break}return!1},"last-of-type"(i,{adapter:o,equals:m}){const v=o.getSiblings(i),C=o.getName(i);for(let N=v.length-1;N>=0;N--){const M=v[N];if(m(i,M))return!0;if(o.isTag(M)&&o.getName(M)===C)break}return!1},"only-of-type"(i,{adapter:o,equals:m}){const v=o.getName(i);return o.getSiblings(i).every(C=>m(i,C)||!o.isTag(C)||o.getName(C)!==v)},"only-child"(i,{adapter:o,equals:m}){return o.getSiblings(i).every(v=>m(i,v)||!o.isTag(v))}};function r_(i,o,m,v){if(m===null){if(i.length>v)throw new Error(`Pseudo-class :${o} requires an argument`)}else if(i.length===v)throw new Error(`Pseudo-class :${o} doesn't have any arguments`)}const Ix={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:`:is(
        :is(button, input, select, textarea, optgroup, option)[disabled],
        optgroup[disabled] > option,
        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)
    )`,enabled:":not(:disabled)",checked:":is(:is(input[type=radio], input[type=checkbox])[checked], option:selected)",required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(> option[selected])) > :first-of-type)",checkbox:"[type=checkbox]",file:"[type=file]",password:"[type=password]",radio:"[type=radio]",reset:"[type=reset]",image:"[type=image]",submit:"[type=submit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type=button])",input:":is(input, textarea, select, button)",text:"input:is(:not([type!='']), [type=text])"},i1={};function Dx(i,o){return i===Ai.falseFunc?Ai.falseFunc:m=>o.isTag(m)&&i(m)}function a1(i,o){const m=o.getSiblings(i);if(m.length<=1)return[];const v=m.indexOf(i);return v<0||v===m.length-1?[]:m.slice(v+1).filter(o.isTag)}function Km(i){return{xmlMode:!!i.xmlMode,lowerCaseAttributeNames:!!i.lowerCaseAttributeNames,lowerCaseTags:!!i.lowerCaseTags,quirksMode:!!i.quirksMode,cacheResults:!!i.cacheResults,pseudos:i.pseudos,adapter:i.adapter,equals:i.equals}}const Fm=(i,o,m,v,C)=>{const N=C(o,Km(m),v);return N===Ai.trueFunc?i:N===Ai.falseFunc?Ai.falseFunc:M=>N(M)&&i(M)},Um={is:Fm,matches:Fm,where:Fm,not(i,o,m,v,C){const N=C(o,Km(m),v);return N===Ai.falseFunc?i:N===Ai.trueFunc?Ai.falseFunc:M=>!N(M)&&i(M)},has(i,o,m,v,C){const{adapter:N}=m,M=Km(m);M.relativeSelector=!0;const d=o.some(we=>we.some(gg))?[i1]:void 0,K=C(o,M,d);if(K===Ai.falseFunc)return Ai.falseFunc;const W=Dx(K,N);if(d&&K!==Ai.trueFunc){const{shouldTestNextSiblings:we=!1}=K;return Pe=>{if(!i(Pe))return!1;d[0]=Pe;const Me=N.getChildren(Pe),fe=we?[...Me,...a1(Pe,N)]:Me;return N.existsOne(W,fe)}}return we=>i(we)&&N.existsOne(W,N.getChildren(we))}};function Rx(i,o,m,v,C){var N;const{name:M,data:d}=o;if(Array.isArray(d)){if(!(M in Um))throw new Error(`Unknown pseudo-class :${M}(${d})`);return Um[M](i,d,m,v,C)}const K=(N=m.pseudos)===null||N===void 0?void 0:N[M],W=typeof K=="string"?K:Ix[M];if(typeof W=="string"){if(d!=null)throw new Error(`Pseudo ${M} doesn't have any arguments`);const we=sm(W);return Um.is(i,we,m,v,C)}if(typeof K=="function")return r_(K,M,d,1),we=>K(we,d)&&i(we);if(M in Qm)return Qm[M](i,d,m,v);if(M in n_){const we=n_[M];return r_(we,M,d,2),Pe=>we(Pe,m,d)&&i(Pe)}throw new Error(`Unknown pseudo-class :${M}`)}function Hm(i,o){const m=o.getParent(i);return m&&o.isTag(m)?m:null}function Px(i,o,m,v,C){const{adapter:N,equals:M}=m;switch(o.type){case Qt.PseudoElement:throw new Error("Pseudo-elements are not supported by css-select");case Qt.ColumnCombinator:throw new Error("Column combinators are not yet supported by css-select");case Qt.Attribute:{if(o.namespace!=null)throw new Error("Namespaced attributes are not yet supported by css-select");return(!m.xmlMode||m.lowerCaseAttributeNames)&&(o.name=o.name.toLowerCase()),wx[o.action](i,o,m)}case Qt.Pseudo:return Rx(i,o,m,v,C);case Qt.Tag:{if(o.namespace!=null)throw new Error("Namespaced tag names are not yet supported by css-select");let{name:d}=o;return(!m.xmlMode||m.lowerCaseTags)&&(d=d.toLowerCase()),function(W){return N.getName(W)===d&&i(W)}}case Qt.Descendant:{if(m.cacheResults===!1||typeof WeakSet>"u")return function(W){let we=W;for(;we=Hm(we,N);)if(i(we))return!0;return!1};const d=new WeakSet;return function(W){let we=W;for(;we=Hm(we,N);)if(!d.has(we)){if(N.isTag(we)&&i(we))return!0;d.add(we)}return!1}}case"_flexibleDescendant":return function(K){let W=K;do if(i(W))return!0;while(W=Hm(W,N));return!1};case Qt.Parent:return function(K){return N.getChildren(K).some(W=>N.isTag(W)&&i(W))};case Qt.Child:return function(K){const W=N.getParent(K);return W!=null&&N.isTag(W)&&i(W)};case Qt.Sibling:return function(K){const W=N.getSiblings(K);for(let we=0;we<W.length;we++){const Pe=W[we];if(M(K,Pe))break;if(N.isTag(Pe)&&i(Pe))return!0}return!1};case Qt.Adjacent:return N.prevElementSibling?function(K){const W=N.prevElementSibling(K);return W!=null&&i(W)}:function(K){const W=N.getSiblings(K);let we;for(let Pe=0;Pe<W.length;Pe++){const Me=W[Pe];if(M(K,Me))break;N.isTag(Me)&&(we=Me)}return!!we&&i(we)};case Qt.Universal:{if(o.namespace!=null&&o.namespace!=="*")throw new Error("Namespaced universal selectors are not yet supported by css-select");return i}}}function n1(i){return i.type===Qt.Pseudo&&(i.name==="scope"||Array.isArray(i.data)&&i.data.some(o=>o.some(n1)))}const Lx={type:Qt.Descendant},Nx={type:"_flexibleDescendant"},Ox={type:Qt.Pseudo,name:"scope",data:null};function kx(i,{adapter:o},m){const v=!!(m!=null&&m.every(C=>{const N=o.isTag(C)&&o.getParent(C);return C===i1||N&&o.isTag(N)}));for(const C of i){if(!(C.length>0&&gg(C[0])&&C[0].type!==Qt.Descendant))if(v&&!C.some(n1))C.unshift(Lx);else continue;C.unshift(Ox)}}function r1(i,o,m){var v;i.forEach(vx),m=(v=o.context)!==null&&v!==void 0?v:m;const C=Array.isArray(m),N=m&&(Array.isArray(m)?m:[m]);if(o.relativeSelector!==!1)kx(i,o,N);else if(i.some(K=>K.length>0&&gg(K[0])))throw new Error("Relative selectors are not allowed when the `relativeSelector` option is disabled");let M=!1;const d=i.map(K=>{if(K.length>=2){const[W,we]=K;W.type!==Qt.Pseudo||W.name!=="scope"||(C&&we.type===Qt.Descendant?K[1]=Nx:(we.type===Qt.Adjacent||we.type===Qt.Sibling)&&(M=!0))}return Bx(K,o,N)}).reduce(zx,Ai.falseFunc);return d.shouldTestNextSiblings=M,d}function Bx(i,o,m){var v;return i.reduce((C,N)=>C===Ai.falseFunc?Ai.falseFunc:Px(C,N,o,m,r1),(v=o.rootFunc)!==null&&v!==void 0?v:Ai.trueFunc)}function zx(i,o){return o===Ai.falseFunc||i===Ai.trueFunc?i:i===Ai.falseFunc||o===Ai.trueFunc?o:function(v){return i(v)||o(v)}}const s1=(i,o)=>i===o,Fx={adapter:rm,equals:s1};function Ux(i){var o,m,v,C;const N=i??Fx;return(o=N.adapter)!==null&&o!==void 0||(N.adapter=rm),(m=N.equals)!==null&&m!==void 0||(N.equals=(C=(v=N.adapter)===null||v===void 0?void 0:v.equals)!==null&&C!==void 0?C:s1),N}function Hx(i){return function(m,v,C){const N=Ux(v);return i(m,N,C)}}const _g=Hx(r1);function o1(i,o,m=!1){return m&&(i=jx(i,o)),Array.isArray(i)?o.removeSubsets(i):o.getChildren(i)}function jx(i,o){const m=Array.isArray(i)?i.slice(0):[i],v=m.length;for(let C=0;C<v;C++){const N=a1(m[C],o);m.push(...N)}return m}const qx=new Set(["first","last","eq","gt","nth","lt","even","odd"]);function Qp(i){return i.type!=="pseudo"?!1:qx.has(i.name)?!0:i.name==="not"&&Array.isArray(i.data)?i.data.some(o=>o.some(Qp)):!1}function Vx(i,o,m){const v=o!=null?parseInt(o,10):NaN;switch(i){case"first":return 1;case"nth":case"eq":return isFinite(v)?v>=0?v+1:1/0:0;case"lt":return isFinite(v)?v>=0?Math.min(v,m):1/0:0;case"gt":return isFinite(v)?1/0:0;case"odd":return 2*m;case"even":return 2*m-1;case"last":case"not":return 1/0}}function Gx(i){for(;i.parent;)i=i.parent;return i}function yg(i){const o=[],m=[];for(const v of i)v.some(Qp)?o.push(v):m.push(v);return[m,o]}const Zx={type:Qt.Universal,namespace:null},Yx={type:Qt.Pseudo,name:"scope",data:null};function u1(i,o,m={}){return l1([i],o,m)}function l1(i,o,m={}){if(typeof o=="function")return i.some(o);const[v,C]=yg(sm(o));return v.length>0&&i.some(_g(v,m))||C.some(N=>d1(N,i,m).length>0)}function $x(i,o,m,v){const C=typeof m=="string"?parseInt(m,10):NaN;switch(i){case"first":case"lt":return o;case"last":return o.length>0?[o[o.length-1]]:o;case"nth":case"eq":return isFinite(C)&&Math.abs(C)<o.length?[C<0?o[o.length+C]:o[C]]:[];case"gt":return isFinite(C)?o.slice(C+1):[];case"even":return o.filter((N,M)=>M%2===0);case"odd":return o.filter((N,M)=>M%2===1);case"not":{const N=new Set(h1(m,o,v));return o.filter(M=>!N.has(M))}}}function c1(i,o,m={}){return h1(sm(i),o,m)}function h1(i,o,m){if(o.length===0)return[];const[v,C]=yg(i);let N;if(v.length){const M=Jm(o,v,m);if(C.length===0)return M;M.length&&(N=new Set(M))}for(let M=0;M<C.length&&(N==null?void 0:N.size)!==o.length;M++){const d=C[M];if((N?o.filter(we=>oi(we)&&!N.has(we)):o).length===0)break;const W=d1(d,o,m);if(W.length)if(N)W.forEach(we=>N.add(we));else{if(M===C.length-1)return W;N=new Set(W)}}return typeof N<"u"?N.size===o.length?o:o.filter(M=>N.has(M)):[]}function d1(i,o,m){var v;if(i.some(U0)){const C=(v=m.root)!==null&&v!==void 0?v:Gx(o[0]),N={...m,context:o,relativeSelector:!1};return i.push(Yx),Kp(C,i,N,!0,o.length)}return Kp(o,i,m,!1,o.length)}function Xx(i,o,m={},v=1/0){if(typeof i=="function")return f1(o,i);const[C,N]=yg(sm(i)),M=N.map(d=>Kp(o,d,m,!0,v));return C.length&&M.push(Wm(o,C,m,v)),M.length===0?[]:M.length===1?M[0]:Bf(M.reduce((d,K)=>[...d,...K]))}function Kp(i,o,m,v,C){const N=o.findIndex(Qp),M=o.slice(0,N),d=o[N],K=o.length-1===N?C:1/0,W=Vx(d.name,d.data,K);if(W===0)return[];const Pe=(M.length===0&&!Array.isArray(i)?nm(i).filter(oi):M.length===0?(Array.isArray(i)?i:[i]).filter(oi):v||M.some(U0)?Wm(i,[M],m,W):Jm(i,[M],m)).slice(0,W);let Me=$x(d.name,Pe,d.data,m);if(Me.length===0||o.length===N+1)return Me;const fe=o.slice(N+1),Qe=fe.some(U0);if(Qe){if(U0(fe[0])){const{type:ai}=fe[0];(ai===Qt.Sibling||ai===Qt.Adjacent)&&(Me=o1(Me,rm,!0)),fe.unshift(Zx)}m={...m,relativeSelector:!1,rootFunc:ai=>Me.includes(ai)}}else m.rootFunc&&m.rootFunc!==Xp.trueFunc&&(m={...m,rootFunc:Xp.trueFunc});return fe.some(Qp)?Kp(Me,fe,m,!1,C):Qe?Wm(Me,[fe],m,C):Jm(Me,[fe],m)}function Wm(i,o,m,v){const C=_g(o,m,i);return f1(i,C,v)}function f1(i,o,m=1/0){const v=o1(i,rm,o.shouldTestNextSiblings);return dg(C=>oi(C)&&o(C),v,!0,m)}function Jm(i,o,m){const v=(Array.isArray(i)?i:[i]).filter(oi);if(v.length===0)return v;const C=_g(o,m);return C===Xp.trueFunc?v:v.filter(C)}const Qx=/^\s*[+~]/;function Kx(i){if(!i)return this._make([]);if(typeof i!="string"){const o=mc(i)?i.toArray():[i],m=this.toArray();return this._make(o.filter(v=>m.some(C=>Y_(C,v))))}return this._findBySelector(i,Number.POSITIVE_INFINITY)}function Wx(i,o){var m;const v=this.toArray(),C=Qx.test(i)?v:this.children().toArray(),N={context:v,root:(m=this._root)===null||m===void 0?void 0:m[0],xmlMode:this.options.xmlMode,lowerCaseTags:this.options.lowerCaseTags,lowerCaseAttributeNames:this.options.lowerCaseAttributeNames,pseudos:this.options.pseudos,quirksMode:this.options.quirksMode};return this._make(Xx(i,C,N,o))}function bg(i){return function(o,...m){return function(v){var C;let N=i(o,this);return v&&(N=Tg(N,v,this.options.xmlMode,(C=this._root)===null||C===void 0?void 0:C[0])),this._make(this.length>1&&N.length>1?m.reduce((M,d)=>d(M),N):N)}}}const J0=bg((i,o)=>{let m=[];for(let v=0;v<o.length;v++){const C=i(o[v]);C.length>0&&(m=m.concat(C))}return m}),xg=bg((i,o)=>{const m=[];for(let v=0;v<o.length;v++){const C=i(o[v]);C!==null&&m.push(C)}return m});function vg(i,...o){let m=null;const v=bg((C,N)=>{const M=[];return Qa(N,d=>{for(let K;(K=C(d))&&!(m!=null&&m(K,M.length));d=K)M.push(K)}),M})(i,...o);return function(C,N){m=typeof C=="string"?d=>u1(d,C,this.options):C?ep(C):null;const M=v.call(this,N);return m=null,M}}function zf(i){return i.length>1?Array.from(new Set(i)):i}const Jx=xg(({parent:i})=>i&&!vh(i)?i:null,zf),e2=J0(i=>{const o=[];for(;i.parent&&!vh(i.parent);)o.push(i.parent),i=i.parent;return o},Bf,i=>i.reverse()),t2=vg(({parent:i})=>i&&!vh(i)?i:null,Bf,i=>i.reverse());function i2(i){var o;const m=[];if(!i)return this._make(m);const v={xmlMode:this.options.xmlMode,root:(o=this._root)===null||o===void 0?void 0:o[0]},C=typeof i=="string"?N=>u1(N,i,v):ep(i);return Qa(this,N=>{for(N&&!vh(N)&&!oi(N)&&(N=N.parent);N&&oi(N);){if(C(N,0)){m.includes(N)||m.push(N);break}N=N.parent}}),this._make(m)}const a2=xg(i=>cg(i)),n2=J0(i=>{const o=[];for(;i.next;)i=i.next,oi(i)&&o.push(i);return o},zf),r2=vg(i=>cg(i),zf),s2=xg(i=>hg(i)),o2=J0(i=>{const o=[];for(;i.prev;)i=i.prev,oi(i)&&o.push(i);return o},zf),u2=vg(i=>hg(i),zf),l2=J0(i=>H_(i).filter(o=>oi(o)&&o!==i),Bf),c2=J0(i=>nm(i).filter(oi),zf);function h2(){const i=this.toArray().reduce((o,m)=>pn(m)?o.concat(m.children):o,[]);return this._make(i)}function d2(i){let o=0;const m=this.length;for(;o<m&&i.call(this[o],o,this[o])!==!1;)++o;return this}function f2(i){let o=[];for(let m=0;m<this.length;m++){const v=this[m],C=i.call(v,m,v);C!=null&&(o=o.concat(C))}return this._make(o)}function ep(i){return typeof i=="function"?(o,m)=>i.call(o,m,o):mc(i)?o=>Array.prototype.includes.call(i,o):function(o){return i===o}}function p2(i){var o;return this._make(Tg(this.toArray(),i,this.options.xmlMode,(o=this._root)===null||o===void 0?void 0:o[0]))}function Tg(i,o,m,v){return typeof o=="string"?c1(o,i,{xmlMode:m,root:v}):i.filter(ep(o))}function m2(i){const o=this.toArray();return typeof i=="string"?l1(o.filter(oi),i,this.options):i?o.some(ep(i)):!1}function g2(i){let o=this.toArray();if(typeof i=="string"){const m=new Set(c1(i,o,this.options));o=o.filter(v=>!m.has(v))}else{const m=ep(i);o=o.filter((v,C)=>!m(v,C))}return this._make(o)}function _2(i){return this.filter(typeof i=="string"?`:has(${i})`:(o,m)=>this._make(m).find(i).length>0)}function y2(){return this.length>1?this._make(this[0]):this}function b2(){return this.length>0?this._make(this[this.length-1]):this}function x2(i){var o;return i=+i,i===0&&this.length<=1?this:(i<0&&(i=this.length+i),this._make((o=this[i])!==null&&o!==void 0?o:[]))}function v2(i){return i==null?this.toArray():this[i<0?this.length+i:i]}function T2(){return Array.prototype.slice.call(this)}function E2(i){let o,m;return i==null?(o=this.parent().children(),m=this[0]):typeof i=="string"?(o=this._make(i),m=this[0]):(o=this,m=mc(i)?i[0]:i),Array.prototype.indexOf.call(o,m)}function w2(i,o){return this._make(Array.prototype.slice.call(this,i,o))}function A2(){var i;return(i=this.prevObject)!==null&&i!==void 0?i:this._make([])}function S2(i,o){const m=this._make(i,o),v=Bf([...this.get(),...m.get()]);return this._make(v)}function C2(i){return this.prevObject?this.add(i?this.prevObject.filter(i):this.prevObject):this}const M2=Object.freeze(Object.defineProperty({__proto__:null,_findBySelector:Wx,add:S2,addBack:C2,children:c2,closest:i2,contents:h2,each:d2,end:A2,eq:x2,filter:p2,filterArray:Tg,find:Kx,first:y2,get:v2,has:_2,index:E2,is:m2,last:b2,map:f2,next:a2,nextAll:n2,nextUntil:r2,not:g2,parent:Jx,parents:e2,parentsUntil:t2,prev:s2,prevAll:o2,prevUntil:u2,siblings:l2,slice:w2,toArray:T2},Symbol.toStringTag,{value:"Module"}));function I2(i){return function(m,v,C,N){if(typeof Buffer<"u"&&Buffer.isBuffer(m)&&(m=m.toString()),typeof m=="string")return i(m,v,C,N);const M=m;if(!Array.isArray(M)&&vh(M))return M;const d=new md([]);return gd(M,d),d}}function gd(i,o){const m=Array.isArray(i)?i:[i];o?o.children=m:o=null;for(let v=0;v<m.length;v++){const C=m[v];C.parent&&C.parent.children!==m&&yd(C),o?(C.prev=m[v-1]||null,C.next=m[v+1]||null):C.prev=C.next=null,C.parent=o}return o}function D2(i,o){if(i==null)return[];if(typeof i=="string")return this._parse(i,this.options,!1,null).children.slice(0);if("length"in i){if(i.length===1)return this._makeDomArray(i[0],o);const m=[];for(let v=0;v<i.length;v++){const C=i[v];if(typeof C=="object"){if(C==null)continue;if(!("length"in C)){m.push(o?Y0(C,!0):C);continue}}m.push(...this._makeDomArray(C,o))}return m}return[o?Y0(i,!0):i]}function p1(i){return function(...o){const m=this.length-1;return Qa(this,(v,C)=>{if(!pn(v))return;const N=typeof o[0]=="function"?o[0].call(v,C,this._render(v.children)):o,M=this._makeDomArray(N,C<m);i(M,v.children,v)})}}function Th(i,o,m,v,C){var N,M;const d=[o,m,...v],K=o===0?null:i[o-1],W=o+m>=i.length?null:i[o+m];for(let we=0;we<v.length;++we){const Pe=v[we],Me=Pe.parent;if(Me){const Qe=Me.children.indexOf(Pe);Qe>-1&&(Me.children.splice(Qe,1),C===Me&&o>Qe&&d[0]--)}Pe.parent=C,Pe.prev&&(Pe.prev.next=(N=Pe.next)!==null&&N!==void 0?N:null),Pe.next&&(Pe.next.prev=(M=Pe.prev)!==null&&M!==void 0?M:null),Pe.prev=we===0?K:v[we-1],Pe.next=we===v.length-1?W:v[we+1]}return K&&(K.next=v[0]),W&&(W.prev=v[v.length-1]),i.splice(...d)}function R2(i){return(mc(i)?i:this._make(i)).append(this),this}function P2(i){return(mc(i)?i:this._make(i)).prepend(this),this}const L2=p1((i,o,m)=>{Th(o,o.length,0,i,m)}),N2=p1((i,o,m)=>{Th(o,0,0,i,m)});function m1(i){return function(o){const m=this.length-1,v=this.parents().last();for(let C=0;C<this.length;C++){const N=this[C],M=typeof o=="function"?o.call(N,C,N):typeof o=="string"&&!$m(o)?v.find(o).clone():o,[d]=this._makeDomArray(M,C<m);if(!d||!pn(d))continue;let K=d,W=0;for(;W<K.children.length;){const we=K.children[W];oi(we)?(K=we,W=0):W++}i(N,K,[d])}return this}}const O2=m1((i,o,m)=>{const{parent:v}=i;if(!v)return;const C=v.children,N=C.indexOf(i);gd([i],o),Th(C,N,0,m,v)}),k2=m1((i,o,m)=>{pn(i)&&(gd(i.children,o),gd(m,i))});function B2(i){return this.parent(i).not("body").each((o,m)=>{this._make(m).replaceWith(m.children)}),this}function z2(i){const o=this[0];if(o){const m=this._make(typeof i=="function"?i.call(o,0,o):i).insertBefore(o);let v;for(let N=0;N<m.length;N++)m[N].type==="tag"&&(v=m[N]);let C=0;for(;v&&C<v.children.length;){const N=v.children[C];N.type==="tag"?(v=N,C=0):C++}v&&this._make(v).append(this)}return this}function F2(...i){const o=this.length-1;return Qa(this,(m,v)=>{if(!pn(m)||!m.parent)return;const C=m.parent.children,N=C.indexOf(m);if(N<0)return;const M=typeof i[0]=="function"?i[0].call(m,v,this._render(m.children)):i,d=this._makeDomArray(M,v<o);Th(C,N+1,0,d,m.parent)})}function U2(i){typeof i=="string"&&(i=this._make(i)),this.remove();const o=[];for(const m of this._makeDomArray(i)){const v=this.clone().toArray(),{parent:C}=m;if(!C)continue;const N=C.children,M=N.indexOf(m);M<0||(Th(N,M+1,0,v,C),o.push(...v))}return this._make(o)}function H2(...i){const o=this.length-1;return Qa(this,(m,v)=>{if(!pn(m)||!m.parent)return;const C=m.parent.children,N=C.indexOf(m);if(N<0)return;const M=typeof i[0]=="function"?i[0].call(m,v,this._render(m.children)):i,d=this._makeDomArray(M,v<o);Th(C,N,0,d,m.parent)})}function j2(i){const o=this._make(i);this.remove();const m=[];return Qa(o,v=>{const C=this.clone().toArray(),{parent:N}=v;if(!N)return;const M=N.children,d=M.indexOf(v);d<0||(Th(M,d,0,C,N),m.push(...C))}),this._make(m)}function q2(i){const o=i?this.filter(i):this;return Qa(o,m=>{yd(m),m.prev=m.next=m.parent=null}),this}function V2(i){return Qa(this,(o,m)=>{const{parent:v}=o;if(!v)return;const C=v.children,N=typeof i=="function"?i.call(o,m,o):i,M=this._makeDomArray(N);gd(M,null);const d=C.indexOf(o);Th(C,d,1,M,v),M.includes(o)||(o.parent=o.prev=o.next=null)})}function G2(){return Qa(this,i=>{if(pn(i)){for(const o of i.children)o.next=o.prev=o.parent=null;i.children.length=0}})}function Z2(i){if(i===void 0){const o=this[0];return!o||!pn(o)?null:this._render(o.children)}return Qa(this,o=>{if(!pn(o))return;for(const v of o.children)v.next=v.prev=v.parent=null;const m=mc(i)?i.toArray():this._parse(`${i}`,this.options,!1,o).children;gd(m,o)})}function Y2(){return this._render(this)}function $2(i){return i===void 0?$0(this):typeof i=="function"?Qa(this,(o,m)=>this._make(o).text(i.call(o,m,$0([o])))):Qa(this,o=>{if(!pn(o))return;for(const v of o.children)v.next=v.prev=v.parent=null;const m=new Z0(`${i}`);gd(m,o)})}function X2(){const i=Array.prototype.map.call(this.get(),m=>Y0(m,!0)),o=new md(i);for(const m of i)m.parent=o;return this._make(i)}const Q2=Object.freeze(Object.defineProperty({__proto__:null,_makeDomArray:D2,after:F2,append:L2,appendTo:R2,before:H2,clone:X2,empty:G2,html:Z2,insertAfter:U2,insertBefore:j2,prepend:N2,prependTo:P2,remove:q2,replaceWith:V2,text:$2,toString:Y2,unwrap:B2,wrap:O2,wrapAll:z2,wrapInner:k2},Symbol.toStringTag,{value:"Module"}));function K2(i,o){if(i!=null&&o!=null||typeof i=="object"&&!Array.isArray(i))return Qa(this,(m,v)=>{oi(m)&&g1(m,i,o,v)});if(this.length!==0)return _1(this[0],i)}function g1(i,o,m,v){if(typeof o=="string"){const C=_1(i),N=typeof m=="function"?m.call(i,v,C[o]):m;N===""?delete C[o]:N!=null&&(C[o]=N),i.attribs.style=W2(C)}else if(typeof o=="object"){const C=Object.keys(o);for(let N=0;N<C.length;N++){const M=C[N];g1(i,M,o[M],N)}}}function _1(i,o){if(!i||!oi(i))return;const m=J2(i.attribs.style);if(typeof o=="string")return m[o];if(Array.isArray(o)){const v={};for(const C of o)m[C]!=null&&(v[C]=m[C]);return v}return m}function W2(i){return Object.keys(i).reduce((o,m)=>`${o}${o?" ":""}${m}: ${i[m]};`,"")}function J2(i){if(i=(i||"").trim(),!i)return{};const o={};let m;for(const v of i.split(";")){const C=v.indexOf(":");if(C<1||C===v.length-1){const N=v.trimEnd();N.length>0&&m!==void 0&&(o[m]+=`;${N}`)}else m=v.slice(0,C).trim(),o[m]=v.slice(C+1).trim()}return o}const ev=Object.freeze(Object.defineProperty({__proto__:null,css:K2},Symbol.toStringTag,{value:"Module"})),s_="input,select,textarea,keygen",tv=/%20/g,o_=/\r?\n/g;function iv(){return this.serializeArray().map(m=>`${encodeURIComponent(m.name)}=${encodeURIComponent(m.value)}`).join("&").replace(tv,"+")}function av(){return this.map((i,o)=>{const m=this._make(o);return oi(o)&&o.name==="form"?m.find(s_).toArray():m.filter(s_).toArray()}).filter('[name!=""]:enabled:not(:submit, :button, :image, :reset, :file):matches([checked], :not(:checkbox, :radio))').map((i,o)=>{var m;const v=this._make(o),C=v.attr("name"),N=(m=v.val())!==null&&m!==void 0?m:"";return Array.isArray(N)?N.map(M=>({name:C,value:M.replace(o_,`\r
`)})):{name:C,value:N.replace(o_,`\r
`)}}).toArray()}const nv=Object.freeze(Object.defineProperty({__proto__:null,serialize:iv,serializeArray:av},Symbol.toStringTag,{value:"Module"}));function rv(i){var o;return typeof i=="string"?{selector:i,value:"textContent"}:{selector:i.selector,value:(o=i.value)!==null&&o!==void 0?o:"textContent"}}function sv(i){const o={};for(const m in i){const v=i[m],C=Array.isArray(v),{selector:N,value:M}=rv(C?v[0]:v),d=typeof M=="function"?M:typeof M=="string"?K=>this._make(K).prop(M):K=>this._make(K).extract(M);if(C)o[m]=this._findBySelector(N,Number.POSITIVE_INFINITY).map((K,W)=>d(W,m,o)).get();else{const K=this._findBySelector(N,1);o[m]=K.length>0?d(K[0],m,o):void 0}}return o}const ov=Object.freeze(Object.defineProperty({__proto__:null,extract:sv},Symbol.toStringTag,{value:"Module"}));class tp{constructor(o,m,v){if(this.length=0,this.options=v,this._root=m,o){for(let C=0;C<o.length;C++)this[C]=o[C];this.length=o.length}}}tp.prototype.cheerio="[cheerio object]";tp.prototype.splice=Array.prototype.splice;tp.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];Object.assign(tp.prototype,fx,M2,Q2,ev,nv,ov);function uv(i,o){return function m(v,C,N=!0){if(v==null)throw new Error("cheerio.load() expects a string");const M=Ym(C),d=i(v,M,N,null);class K extends tp{_make(Pe,Me){const fe=W(Pe,Me);return fe.prevObject=this,fe}_parse(Pe,Me,fe,Qe){return i(Pe,Me,fe,Qe)}_render(Pe){return o(Pe,this.options)}}function W(we,Pe,Me=d,fe){if(we&&mc(we))return we;const Qe=Ym(fe,M),ai=typeof Me=="string"?[i(Me,Qe,!1,null)]:"length"in Me?Me:[Me],li=mc(ai)?ai:new K(ai,null,Qe);if(li._root=li,!we)return new K(void 0,li,Qe);const ei=typeof we=="string"&&$m(we)?i(we,Qe,!1,null).children:lv(we)?[we]:Array.isArray(we)?we:void 0,Ci=new K(ei,li,Qe);if(ei)return Ci;if(typeof we!="string")throw new TypeError("Unexpected type of selector");let ni=we;const Mt=Pe?typeof Pe=="string"?$m(Pe)?new K([i(Pe,Qe,!1,null)],li,Qe):(ni=`${Pe} ${ni}`,li):mc(Pe)?Pe:new K(Array.isArray(Pe)?Pe:[Pe],li,Qe):li;return Mt?Mt.find(ni):Ci}return Object.assign(W,tx,{load:m,_root:d,_options:M,fn:K.prototype,prototype:K.prototype}),W}}function lv(i){return!!i.name||i.type==="root"||i.type==="text"||i.type==="comment"}const cv=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),ja="";var se;(function(i){i[i.EOF=-1]="EOF",i[i.NULL=0]="NULL",i[i.TABULATION=9]="TABULATION",i[i.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",i[i.LINE_FEED=10]="LINE_FEED",i[i.FORM_FEED=12]="FORM_FEED",i[i.SPACE=32]="SPACE",i[i.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",i[i.QUOTATION_MARK=34]="QUOTATION_MARK",i[i.AMPERSAND=38]="AMPERSAND",i[i.APOSTROPHE=39]="APOSTROPHE",i[i.HYPHEN_MINUS=45]="HYPHEN_MINUS",i[i.SOLIDUS=47]="SOLIDUS",i[i.DIGIT_0=48]="DIGIT_0",i[i.DIGIT_9=57]="DIGIT_9",i[i.SEMICOLON=59]="SEMICOLON",i[i.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",i[i.EQUALS_SIGN=61]="EQUALS_SIGN",i[i.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",i[i.QUESTION_MARK=63]="QUESTION_MARK",i[i.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",i[i.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",i[i.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",i[i.GRAVE_ACCENT=96]="GRAVE_ACCENT",i[i.LATIN_SMALL_A=97]="LATIN_SMALL_A",i[i.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(se||(se={}));const ws={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function y1(i){return i>=55296&&i<=57343}function hv(i){return i>=56320&&i<=57343}function dv(i,o){return(i-55296)*1024+9216+o}function b1(i){return i!==32&&i!==10&&i!==13&&i!==9&&i!==12&&i>=1&&i<=31||i>=127&&i<=159}function x1(i){return i>=64976&&i<=65007||cv.has(i)}var Ke;(function(i){i.controlCharacterInInputStream="control-character-in-input-stream",i.noncharacterInInputStream="noncharacter-in-input-stream",i.surrogateInInputStream="surrogate-in-input-stream",i.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",i.endTagWithAttributes="end-tag-with-attributes",i.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",i.unexpectedSolidusInTag="unexpected-solidus-in-tag",i.unexpectedNullCharacter="unexpected-null-character",i.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",i.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",i.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",i.missingEndTagName="missing-end-tag-name",i.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",i.unknownNamedCharacterReference="unknown-named-character-reference",i.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",i.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",i.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",i.eofBeforeTagName="eof-before-tag-name",i.eofInTag="eof-in-tag",i.missingAttributeValue="missing-attribute-value",i.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",i.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",i.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",i.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",i.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",i.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",i.missingDoctypePublicIdentifier="missing-doctype-public-identifier",i.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",i.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",i.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",i.cdataInHtmlContent="cdata-in-html-content",i.incorrectlyOpenedComment="incorrectly-opened-comment",i.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",i.eofInDoctype="eof-in-doctype",i.nestedComment="nested-comment",i.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",i.eofInComment="eof-in-comment",i.incorrectlyClosedComment="incorrectly-closed-comment",i.eofInCdata="eof-in-cdata",i.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",i.nullCharacterReference="null-character-reference",i.surrogateCharacterReference="surrogate-character-reference",i.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",i.controlCharacterReference="control-character-reference",i.noncharacterCharacterReference="noncharacter-character-reference",i.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",i.missingDoctypeName="missing-doctype-name",i.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",i.duplicateAttribute="duplicate-attribute",i.nonConformingDoctype="non-conforming-doctype",i.missingDoctype="missing-doctype",i.misplacedDoctype="misplaced-doctype",i.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",i.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",i.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",i.openElementsLeftAfterEof="open-elements-left-after-eof",i.abandonedHeadElementChild="abandoned-head-element-child",i.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",i.nestedNoscriptInHead="nested-noscript-in-head",i.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(Ke||(Ke={}));const fv=65536;class pv{constructor(o){this.handler=o,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=fv,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(o,m){const{line:v,col:C,offset:N}=this,M=C+m,d=N+m;return{code:o,startLine:v,endLine:v,startCol:M,endCol:M,startOffset:d,endOffset:d}}_err(o){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(o,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(o){if(this.pos!==this.html.length-1){const m=this.html.charCodeAt(this.pos+1);if(hv(m))return this.pos++,this._addGap(),dv(o,m)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,se.EOF;return this._err(Ke.surrogateInInputStream),o}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(o,m){this.html.length>0?this.html+=o:this.html=o,this.endOfChunkHit=!1,this.lastChunkWritten=m}insertHtmlAtCurrentPos(o){this.html=this.html.substring(0,this.pos+1)+o+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(o,m){if(this.pos+o.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(m)return this.html.startsWith(o,this.pos);for(let v=0;v<o.length;v++)if((this.html.charCodeAt(this.pos+v)|32)!==o.charCodeAt(v))return!1;return!0}peek(o){const m=this.pos+o;if(m>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,se.EOF;const v=this.html.charCodeAt(m);return v===se.CARRIAGE_RETURN?se.LINE_FEED:v}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,se.EOF;let o=this.html.charCodeAt(this.pos);return o===se.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,se.LINE_FEED):o===se.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,y1(o)&&(o=this._processSurrogate(o)),this.handler.onParseError===null||o>31&&o<127||o===se.LINE_FEED||o===se.CARRIAGE_RETURN||o>159&&o<64976||this._checkForProblematicCharacters(o),o)}_checkForProblematicCharacters(o){b1(o)?this._err(Ke.controlCharacterInInputStream):x1(o)&&this._err(Ke.noncharacterInInputStream)}retreat(o){for(this.pos-=o;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var zi;(function(i){i[i.CHARACTER=0]="CHARACTER",i[i.NULL_CHARACTER=1]="NULL_CHARACTER",i[i.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",i[i.START_TAG=3]="START_TAG",i[i.END_TAG=4]="END_TAG",i[i.COMMENT=5]="COMMENT",i[i.DOCTYPE=6]="DOCTYPE",i[i.EOF=7]="EOF",i[i.HIBERNATION=8]="HIBERNATION"})(zi||(zi={}));function v1(i,o){for(let m=i.attrs.length-1;m>=0;m--)if(i.attrs[m].name===o)return i.attrs[m].value;return null}const mv=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(i=>i.charCodeAt(0))),gv=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);function _v(i){var o;return i>=55296&&i<=57343||i>1114111?65533:(o=gv.get(i))!==null&&o!==void 0?o:i}var ar;(function(i){i[i.NUM=35]="NUM",i[i.SEMI=59]="SEMI",i[i.EQUALS=61]="EQUALS",i[i.ZERO=48]="ZERO",i[i.NINE=57]="NINE",i[i.LOWER_A=97]="LOWER_A",i[i.LOWER_F=102]="LOWER_F",i[i.LOWER_X=120]="LOWER_X",i[i.LOWER_Z=122]="LOWER_Z",i[i.UPPER_A=65]="UPPER_A",i[i.UPPER_F=70]="UPPER_F",i[i.UPPER_Z=90]="UPPER_Z"})(ar||(ar={}));const yv=32;var xh;(function(i){i[i.VALUE_LENGTH=49152]="VALUE_LENGTH",i[i.BRANCH_LENGTH=16256]="BRANCH_LENGTH",i[i.JUMP_TABLE=127]="JUMP_TABLE"})(xh||(xh={}));function eg(i){return i>=ar.ZERO&&i<=ar.NINE}function bv(i){return i>=ar.UPPER_A&&i<=ar.UPPER_F||i>=ar.LOWER_A&&i<=ar.LOWER_F}function xv(i){return i>=ar.UPPER_A&&i<=ar.UPPER_Z||i>=ar.LOWER_A&&i<=ar.LOWER_Z||eg(i)}function vv(i){return i===ar.EQUALS||xv(i)}var tr;(function(i){i[i.EntityStart=0]="EntityStart",i[i.NumericStart=1]="NumericStart",i[i.NumericDecimal=2]="NumericDecimal",i[i.NumericHex=3]="NumericHex",i[i.NamedEntity=4]="NamedEntity"})(tr||(tr={}));var pc;(function(i){i[i.Legacy=0]="Legacy",i[i.Strict=1]="Strict",i[i.Attribute=2]="Attribute"})(pc||(pc={}));class Tv{constructor(o,m,v){this.decodeTree=o,this.emitCodePoint=m,this.errors=v,this.state=tr.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=pc.Strict}startEntity(o){this.decodeMode=o,this.state=tr.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(o,m){switch(this.state){case tr.EntityStart:return o.charCodeAt(m)===ar.NUM?(this.state=tr.NumericStart,this.consumed+=1,this.stateNumericStart(o,m+1)):(this.state=tr.NamedEntity,this.stateNamedEntity(o,m));case tr.NumericStart:return this.stateNumericStart(o,m);case tr.NumericDecimal:return this.stateNumericDecimal(o,m);case tr.NumericHex:return this.stateNumericHex(o,m);case tr.NamedEntity:return this.stateNamedEntity(o,m)}}stateNumericStart(o,m){return m>=o.length?-1:(o.charCodeAt(m)|yv)===ar.LOWER_X?(this.state=tr.NumericHex,this.consumed+=1,this.stateNumericHex(o,m+1)):(this.state=tr.NumericDecimal,this.stateNumericDecimal(o,m))}addToNumericResult(o,m,v,C){if(m!==v){const N=v-m;this.result=this.result*Math.pow(C,N)+Number.parseInt(o.substr(m,N),C),this.consumed+=N}}stateNumericHex(o,m){const v=m;for(;m<o.length;){const C=o.charCodeAt(m);if(eg(C)||bv(C))m+=1;else return this.addToNumericResult(o,v,m,16),this.emitNumericEntity(C,3)}return this.addToNumericResult(o,v,m,16),-1}stateNumericDecimal(o,m){const v=m;for(;m<o.length;){const C=o.charCodeAt(m);if(eg(C))m+=1;else return this.addToNumericResult(o,v,m,10),this.emitNumericEntity(C,2)}return this.addToNumericResult(o,v,m,10),-1}emitNumericEntity(o,m){var v;if(this.consumed<=m)return(v=this.errors)===null||v===void 0||v.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(o===ar.SEMI)this.consumed+=1;else if(this.decodeMode===pc.Strict)return 0;return this.emitCodePoint(_v(this.result),this.consumed),this.errors&&(o!==ar.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(o,m){const{decodeTree:v}=this;let C=v[this.treeIndex],N=(C&xh.VALUE_LENGTH)>>14;for(;m<o.length;m++,this.excess++){const M=o.charCodeAt(m);if(this.treeIndex=Ev(v,C,this.treeIndex+Math.max(1,N),M),this.treeIndex<0)return this.result===0||this.decodeMode===pc.Attribute&&(N===0||vv(M))?0:this.emitNotTerminatedNamedEntity();if(C=v[this.treeIndex],N=(C&xh.VALUE_LENGTH)>>14,N!==0){if(M===ar.SEMI)return this.emitNamedEntityData(this.treeIndex,N,this.consumed+this.excess);this.decodeMode!==pc.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var o;const{result:m,decodeTree:v}=this,C=(v[m]&xh.VALUE_LENGTH)>>14;return this.emitNamedEntityData(m,C,this.consumed),(o=this.errors)===null||o===void 0||o.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(o,m,v){const{decodeTree:C}=this;return this.emitCodePoint(m===1?C[o]&~xh.VALUE_LENGTH:C[o+1],v),m===3&&this.emitCodePoint(C[o+2],v),v}end(){var o;switch(this.state){case tr.NamedEntity:return this.result!==0&&(this.decodeMode!==pc.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case tr.NumericDecimal:return this.emitNumericEntity(0,2);case tr.NumericHex:return this.emitNumericEntity(0,3);case tr.NumericStart:return(o=this.errors)===null||o===void 0||o.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case tr.EntityStart:return 0}}}function Ev(i,o,m,v){const C=(o&xh.BRANCH_LENGTH)>>7,N=o&xh.JUMP_TABLE;if(C===0)return N!==0&&v===N?m:-1;if(N){const K=v-N;return K<0||K>=C?-1:i[m+K]-1}let M=m,d=M+C-1;for(;M<=d;){const K=M+d>>>1,W=i[K];if(W<v)M=K+1;else if(W>v)d=K-1;else return i[K+C]}return-1}var lt;(function(i){i.HTML="http://www.w3.org/1999/xhtml",i.MATHML="http://www.w3.org/1998/Math/MathML",i.SVG="http://www.w3.org/2000/svg",i.XLINK="http://www.w3.org/1999/xlink",i.XML="http://www.w3.org/XML/1998/namespace",i.XMLNS="http://www.w3.org/2000/xmlns/"})(lt||(lt={}));var pd;(function(i){i.TYPE="type",i.ACTION="action",i.ENCODING="encoding",i.PROMPT="prompt",i.NAME="name",i.COLOR="color",i.FACE="face",i.SIZE="size"})(pd||(pd={}));var no;(function(i){i.NO_QUIRKS="no-quirks",i.QUIRKS="quirks",i.LIMITED_QUIRKS="limited-quirks"})(no||(no={}));var Be;(function(i){i.A="a",i.ADDRESS="address",i.ANNOTATION_XML="annotation-xml",i.APPLET="applet",i.AREA="area",i.ARTICLE="article",i.ASIDE="aside",i.B="b",i.BASE="base",i.BASEFONT="basefont",i.BGSOUND="bgsound",i.BIG="big",i.BLOCKQUOTE="blockquote",i.BODY="body",i.BR="br",i.BUTTON="button",i.CAPTION="caption",i.CENTER="center",i.CODE="code",i.COL="col",i.COLGROUP="colgroup",i.DD="dd",i.DESC="desc",i.DETAILS="details",i.DIALOG="dialog",i.DIR="dir",i.DIV="div",i.DL="dl",i.DT="dt",i.EM="em",i.EMBED="embed",i.FIELDSET="fieldset",i.FIGCAPTION="figcaption",i.FIGURE="figure",i.FONT="font",i.FOOTER="footer",i.FOREIGN_OBJECT="foreignObject",i.FORM="form",i.FRAME="frame",i.FRAMESET="frameset",i.H1="h1",i.H2="h2",i.H3="h3",i.H4="h4",i.H5="h5",i.H6="h6",i.HEAD="head",i.HEADER="header",i.HGROUP="hgroup",i.HR="hr",i.HTML="html",i.I="i",i.IMG="img",i.IMAGE="image",i.INPUT="input",i.IFRAME="iframe",i.KEYGEN="keygen",i.LABEL="label",i.LI="li",i.LINK="link",i.LISTING="listing",i.MAIN="main",i.MALIGNMARK="malignmark",i.MARQUEE="marquee",i.MATH="math",i.MENU="menu",i.META="meta",i.MGLYPH="mglyph",i.MI="mi",i.MO="mo",i.MN="mn",i.MS="ms",i.MTEXT="mtext",i.NAV="nav",i.NOBR="nobr",i.NOFRAMES="noframes",i.NOEMBED="noembed",i.NOSCRIPT="noscript",i.OBJECT="object",i.OL="ol",i.OPTGROUP="optgroup",i.OPTION="option",i.P="p",i.PARAM="param",i.PLAINTEXT="plaintext",i.PRE="pre",i.RB="rb",i.RP="rp",i.RT="rt",i.RTC="rtc",i.RUBY="ruby",i.S="s",i.SCRIPT="script",i.SEARCH="search",i.SECTION="section",i.SELECT="select",i.SOURCE="source",i.SMALL="small",i.SPAN="span",i.STRIKE="strike",i.STRONG="strong",i.STYLE="style",i.SUB="sub",i.SUMMARY="summary",i.SUP="sup",i.TABLE="table",i.TBODY="tbody",i.TEMPLATE="template",i.TEXTAREA="textarea",i.TFOOT="tfoot",i.TD="td",i.TH="th",i.THEAD="thead",i.TITLE="title",i.TR="tr",i.TRACK="track",i.TT="tt",i.U="u",i.UL="ul",i.SVG="svg",i.VAR="var",i.WBR="wbr",i.XMP="xmp"})(Be||(Be={}));var P;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.A=1]="A",i[i.ADDRESS=2]="ADDRESS",i[i.ANNOTATION_XML=3]="ANNOTATION_XML",i[i.APPLET=4]="APPLET",i[i.AREA=5]="AREA",i[i.ARTICLE=6]="ARTICLE",i[i.ASIDE=7]="ASIDE",i[i.B=8]="B",i[i.BASE=9]="BASE",i[i.BASEFONT=10]="BASEFONT",i[i.BGSOUND=11]="BGSOUND",i[i.BIG=12]="BIG",i[i.BLOCKQUOTE=13]="BLOCKQUOTE",i[i.BODY=14]="BODY",i[i.BR=15]="BR",i[i.BUTTON=16]="BUTTON",i[i.CAPTION=17]="CAPTION",i[i.CENTER=18]="CENTER",i[i.CODE=19]="CODE",i[i.COL=20]="COL",i[i.COLGROUP=21]="COLGROUP",i[i.DD=22]="DD",i[i.DESC=23]="DESC",i[i.DETAILS=24]="DETAILS",i[i.DIALOG=25]="DIALOG",i[i.DIR=26]="DIR",i[i.DIV=27]="DIV",i[i.DL=28]="DL",i[i.DT=29]="DT",i[i.EM=30]="EM",i[i.EMBED=31]="EMBED",i[i.FIELDSET=32]="FIELDSET",i[i.FIGCAPTION=33]="FIGCAPTION",i[i.FIGURE=34]="FIGURE",i[i.FONT=35]="FONT",i[i.FOOTER=36]="FOOTER",i[i.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",i[i.FORM=38]="FORM",i[i.FRAME=39]="FRAME",i[i.FRAMESET=40]="FRAMESET",i[i.H1=41]="H1",i[i.H2=42]="H2",i[i.H3=43]="H3",i[i.H4=44]="H4",i[i.H5=45]="H5",i[i.H6=46]="H6",i[i.HEAD=47]="HEAD",i[i.HEADER=48]="HEADER",i[i.HGROUP=49]="HGROUP",i[i.HR=50]="HR",i[i.HTML=51]="HTML",i[i.I=52]="I",i[i.IMG=53]="IMG",i[i.IMAGE=54]="IMAGE",i[i.INPUT=55]="INPUT",i[i.IFRAME=56]="IFRAME",i[i.KEYGEN=57]="KEYGEN",i[i.LABEL=58]="LABEL",i[i.LI=59]="LI",i[i.LINK=60]="LINK",i[i.LISTING=61]="LISTING",i[i.MAIN=62]="MAIN",i[i.MALIGNMARK=63]="MALIGNMARK",i[i.MARQUEE=64]="MARQUEE",i[i.MATH=65]="MATH",i[i.MENU=66]="MENU",i[i.META=67]="META",i[i.MGLYPH=68]="MGLYPH",i[i.MI=69]="MI",i[i.MO=70]="MO",i[i.MN=71]="MN",i[i.MS=72]="MS",i[i.MTEXT=73]="MTEXT",i[i.NAV=74]="NAV",i[i.NOBR=75]="NOBR",i[i.NOFRAMES=76]="NOFRAMES",i[i.NOEMBED=77]="NOEMBED",i[i.NOSCRIPT=78]="NOSCRIPT",i[i.OBJECT=79]="OBJECT",i[i.OL=80]="OL",i[i.OPTGROUP=81]="OPTGROUP",i[i.OPTION=82]="OPTION",i[i.P=83]="P",i[i.PARAM=84]="PARAM",i[i.PLAINTEXT=85]="PLAINTEXT",i[i.PRE=86]="PRE",i[i.RB=87]="RB",i[i.RP=88]="RP",i[i.RT=89]="RT",i[i.RTC=90]="RTC",i[i.RUBY=91]="RUBY",i[i.S=92]="S",i[i.SCRIPT=93]="SCRIPT",i[i.SEARCH=94]="SEARCH",i[i.SECTION=95]="SECTION",i[i.SELECT=96]="SELECT",i[i.SOURCE=97]="SOURCE",i[i.SMALL=98]="SMALL",i[i.SPAN=99]="SPAN",i[i.STRIKE=100]="STRIKE",i[i.STRONG=101]="STRONG",i[i.STYLE=102]="STYLE",i[i.SUB=103]="SUB",i[i.SUMMARY=104]="SUMMARY",i[i.SUP=105]="SUP",i[i.TABLE=106]="TABLE",i[i.TBODY=107]="TBODY",i[i.TEMPLATE=108]="TEMPLATE",i[i.TEXTAREA=109]="TEXTAREA",i[i.TFOOT=110]="TFOOT",i[i.TD=111]="TD",i[i.TH=112]="TH",i[i.THEAD=113]="THEAD",i[i.TITLE=114]="TITLE",i[i.TR=115]="TR",i[i.TRACK=116]="TRACK",i[i.TT=117]="TT",i[i.U=118]="U",i[i.UL=119]="UL",i[i.SVG=120]="SVG",i[i.VAR=121]="VAR",i[i.WBR=122]="WBR",i[i.XMP=123]="XMP"})(P||(P={}));const wv=new Map([[Be.A,P.A],[Be.ADDRESS,P.ADDRESS],[Be.ANNOTATION_XML,P.ANNOTATION_XML],[Be.APPLET,P.APPLET],[Be.AREA,P.AREA],[Be.ARTICLE,P.ARTICLE],[Be.ASIDE,P.ASIDE],[Be.B,P.B],[Be.BASE,P.BASE],[Be.BASEFONT,P.BASEFONT],[Be.BGSOUND,P.BGSOUND],[Be.BIG,P.BIG],[Be.BLOCKQUOTE,P.BLOCKQUOTE],[Be.BODY,P.BODY],[Be.BR,P.BR],[Be.BUTTON,P.BUTTON],[Be.CAPTION,P.CAPTION],[Be.CENTER,P.CENTER],[Be.CODE,P.CODE],[Be.COL,P.COL],[Be.COLGROUP,P.COLGROUP],[Be.DD,P.DD],[Be.DESC,P.DESC],[Be.DETAILS,P.DETAILS],[Be.DIALOG,P.DIALOG],[Be.DIR,P.DIR],[Be.DIV,P.DIV],[Be.DL,P.DL],[Be.DT,P.DT],[Be.EM,P.EM],[Be.EMBED,P.EMBED],[Be.FIELDSET,P.FIELDSET],[Be.FIGCAPTION,P.FIGCAPTION],[Be.FIGURE,P.FIGURE],[Be.FONT,P.FONT],[Be.FOOTER,P.FOOTER],[Be.FOREIGN_OBJECT,P.FOREIGN_OBJECT],[Be.FORM,P.FORM],[Be.FRAME,P.FRAME],[Be.FRAMESET,P.FRAMESET],[Be.H1,P.H1],[Be.H2,P.H2],[Be.H3,P.H3],[Be.H4,P.H4],[Be.H5,P.H5],[Be.H6,P.H6],[Be.HEAD,P.HEAD],[Be.HEADER,P.HEADER],[Be.HGROUP,P.HGROUP],[Be.HR,P.HR],[Be.HTML,P.HTML],[Be.I,P.I],[Be.IMG,P.IMG],[Be.IMAGE,P.IMAGE],[Be.INPUT,P.INPUT],[Be.IFRAME,P.IFRAME],[Be.KEYGEN,P.KEYGEN],[Be.LABEL,P.LABEL],[Be.LI,P.LI],[Be.LINK,P.LINK],[Be.LISTING,P.LISTING],[Be.MAIN,P.MAIN],[Be.MALIGNMARK,P.MALIGNMARK],[Be.MARQUEE,P.MARQUEE],[Be.MATH,P.MATH],[Be.MENU,P.MENU],[Be.META,P.META],[Be.MGLYPH,P.MGLYPH],[Be.MI,P.MI],[Be.MO,P.MO],[Be.MN,P.MN],[Be.MS,P.MS],[Be.MTEXT,P.MTEXT],[Be.NAV,P.NAV],[Be.NOBR,P.NOBR],[Be.NOFRAMES,P.NOFRAMES],[Be.NOEMBED,P.NOEMBED],[Be.NOSCRIPT,P.NOSCRIPT],[Be.OBJECT,P.OBJECT],[Be.OL,P.OL],[Be.OPTGROUP,P.OPTGROUP],[Be.OPTION,P.OPTION],[Be.P,P.P],[Be.PARAM,P.PARAM],[Be.PLAINTEXT,P.PLAINTEXT],[Be.PRE,P.PRE],[Be.RB,P.RB],[Be.RP,P.RP],[Be.RT,P.RT],[Be.RTC,P.RTC],[Be.RUBY,P.RUBY],[Be.S,P.S],[Be.SCRIPT,P.SCRIPT],[Be.SEARCH,P.SEARCH],[Be.SECTION,P.SECTION],[Be.SELECT,P.SELECT],[Be.SOURCE,P.SOURCE],[Be.SMALL,P.SMALL],[Be.SPAN,P.SPAN],[Be.STRIKE,P.STRIKE],[Be.STRONG,P.STRONG],[Be.STYLE,P.STYLE],[Be.SUB,P.SUB],[Be.SUMMARY,P.SUMMARY],[Be.SUP,P.SUP],[Be.TABLE,P.TABLE],[Be.TBODY,P.TBODY],[Be.TEMPLATE,P.TEMPLATE],[Be.TEXTAREA,P.TEXTAREA],[Be.TFOOT,P.TFOOT],[Be.TD,P.TD],[Be.TH,P.TH],[Be.THEAD,P.THEAD],[Be.TITLE,P.TITLE],[Be.TR,P.TR],[Be.TRACK,P.TRACK],[Be.TT,P.TT],[Be.U,P.U],[Be.UL,P.UL],[Be.SVG,P.SVG],[Be.VAR,P.VAR],[Be.WBR,P.WBR],[Be.XMP,P.XMP]]);function om(i){var o;return(o=wv.get(i))!==null&&o!==void 0?o:P.UNKNOWN}const mt=P,Av={[lt.HTML]:new Set([mt.ADDRESS,mt.APPLET,mt.AREA,mt.ARTICLE,mt.ASIDE,mt.BASE,mt.BASEFONT,mt.BGSOUND,mt.BLOCKQUOTE,mt.BODY,mt.BR,mt.BUTTON,mt.CAPTION,mt.CENTER,mt.COL,mt.COLGROUP,mt.DD,mt.DETAILS,mt.DIR,mt.DIV,mt.DL,mt.DT,mt.EMBED,mt.FIELDSET,mt.FIGCAPTION,mt.FIGURE,mt.FOOTER,mt.FORM,mt.FRAME,mt.FRAMESET,mt.H1,mt.H2,mt.H3,mt.H4,mt.H5,mt.H6,mt.HEAD,mt.HEADER,mt.HGROUP,mt.HR,mt.HTML,mt.IFRAME,mt.IMG,mt.INPUT,mt.LI,mt.LINK,mt.LISTING,mt.MAIN,mt.MARQUEE,mt.MENU,mt.META,mt.NAV,mt.NOEMBED,mt.NOFRAMES,mt.NOSCRIPT,mt.OBJECT,mt.OL,mt.P,mt.PARAM,mt.PLAINTEXT,mt.PRE,mt.SCRIPT,mt.SECTION,mt.SELECT,mt.SOURCE,mt.STYLE,mt.SUMMARY,mt.TABLE,mt.TBODY,mt.TD,mt.TEMPLATE,mt.TEXTAREA,mt.TFOOT,mt.TH,mt.THEAD,mt.TITLE,mt.TR,mt.TRACK,mt.UL,mt.WBR,mt.XMP]),[lt.MATHML]:new Set([mt.MI,mt.MO,mt.MN,mt.MS,mt.MTEXT,mt.ANNOTATION_XML]),[lt.SVG]:new Set([mt.TITLE,mt.FOREIGN_OBJECT,mt.DESC]),[lt.XLINK]:new Set,[lt.XML]:new Set,[lt.XMLNS]:new Set},tg=new Set([mt.H1,mt.H2,mt.H3,mt.H4,mt.H5,mt.H6]),Sv=new Set([Be.STYLE,Be.SCRIPT,Be.XMP,Be.IFRAME,Be.NOEMBED,Be.NOFRAMES,Be.PLAINTEXT]);function Cv(i,o){return Sv.has(i)||o&&i===Be.NOSCRIPT}var ce;(function(i){i[i.DATA=0]="DATA",i[i.RCDATA=1]="RCDATA",i[i.RAWTEXT=2]="RAWTEXT",i[i.SCRIPT_DATA=3]="SCRIPT_DATA",i[i.PLAINTEXT=4]="PLAINTEXT",i[i.TAG_OPEN=5]="TAG_OPEN",i[i.END_TAG_OPEN=6]="END_TAG_OPEN",i[i.TAG_NAME=7]="TAG_NAME",i[i.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",i[i.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",i[i.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",i[i.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",i[i.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",i[i.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",i[i.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",i[i.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",i[i.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",i[i.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",i[i.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",i[i.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",i[i.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",i[i.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",i[i.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",i[i.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",i[i.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",i[i.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",i[i.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",i[i.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",i[i.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",i[i.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",i[i.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",i[i.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",i[i.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",i[i.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",i[i.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",i[i.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",i[i.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",i[i.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",i[i.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",i[i.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",i[i.BOGUS_COMMENT=40]="BOGUS_COMMENT",i[i.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",i[i.COMMENT_START=42]="COMMENT_START",i[i.COMMENT_START_DASH=43]="COMMENT_START_DASH",i[i.COMMENT=44]="COMMENT",i[i.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",i[i.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",i[i.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",i[i.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",i[i.COMMENT_END_DASH=49]="COMMENT_END_DASH",i[i.COMMENT_END=50]="COMMENT_END",i[i.COMMENT_END_BANG=51]="COMMENT_END_BANG",i[i.DOCTYPE=52]="DOCTYPE",i[i.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",i[i.DOCTYPE_NAME=54]="DOCTYPE_NAME",i[i.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",i[i.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",i[i.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",i[i.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",i[i.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",i[i.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",i[i.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",i[i.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",i[i.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",i[i.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",i[i.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",i[i.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",i[i.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",i[i.CDATA_SECTION=68]="CDATA_SECTION",i[i.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",i[i.CDATA_SECTION_END=70]="CDATA_SECTION_END",i[i.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",i[i.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(ce||(ce={}));const Cs={DATA:ce.DATA,RCDATA:ce.RCDATA,RAWTEXT:ce.RAWTEXT,SCRIPT_DATA:ce.SCRIPT_DATA,PLAINTEXT:ce.PLAINTEXT,CDATA_SECTION:ce.CDATA_SECTION};function Mv(i){return i>=se.DIGIT_0&&i<=se.DIGIT_9}function F0(i){return i>=se.LATIN_CAPITAL_A&&i<=se.LATIN_CAPITAL_Z}function Iv(i){return i>=se.LATIN_SMALL_A&&i<=se.LATIN_SMALL_Z}function gh(i){return Iv(i)||F0(i)}function u_(i){return gh(i)||Mv(i)}function zp(i){return i+32}function T1(i){return i===se.SPACE||i===se.LINE_FEED||i===se.TABULATION||i===se.FORM_FEED}function l_(i){return T1(i)||i===se.SOLIDUS||i===se.GREATER_THAN_SIGN}function Dv(i){return i===se.NULL?Ke.nullCharacterReference:i>1114111?Ke.characterReferenceOutsideUnicodeRange:y1(i)?Ke.surrogateCharacterReference:x1(i)?Ke.noncharacterCharacterReference:b1(i)||i===se.CARRIAGE_RETURN?Ke.controlCharacterReference:null}let Rv=class{constructor(o,m){this.options=o,this.handler=m,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=ce.DATA,this.returnState=ce.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new pv(m),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new Tv(mv,(v,C)=>{this.preprocessor.pos=this.entityStartPos+C-1,this._flushCodePointConsumedAsCharacterReference(v)},m.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(Ke.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:v=>{this._err(Ke.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+v)},validateNumericCharacterReference:v=>{const C=Dv(v);C&&this._err(C,1)}}:void 0)}_err(o,m=0){var v,C;(C=(v=this.handler).onParseError)===null||C===void 0||C.call(v,this.preprocessor.getError(o,m))}getCurrentLocation(o){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-o,startOffset:this.preprocessor.offset-o,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const o=this._consume();this._ensureHibernation()||this._callState(o)}this.inLoop=!1}}pause(){this.paused=!0}resume(o){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||o==null||o())}write(o,m,v){this.active=!0,this.preprocessor.write(o,m),this._runParsingLoop(),this.paused||v==null||v()}insertHtmlAtCurrentPos(o){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(o),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(o){this.consumedAfterSnapshot+=o;for(let m=0;m<o;m++)this.preprocessor.advance()}_consumeSequenceIfMatch(o,m){return this.preprocessor.startsWith(o,m)?(this._advanceBy(o.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:zi.START_TAG,tagName:"",tagID:P.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:zi.END_TAG,tagName:"",tagID:P.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(o){this.currentToken={type:zi.COMMENT,data:"",location:this.getCurrentLocation(o)}}_createDoctypeToken(o){this.currentToken={type:zi.DOCTYPE,name:o,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(o,m){this.currentCharacterToken={type:o,chars:m,location:this.currentLocation}}_createAttr(o){this.currentAttr={name:o,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var o,m;const v=this.currentToken;if(v1(v,this.currentAttr.name)===null){if(v.attrs.push(this.currentAttr),v.location&&this.currentLocation){const C=(o=(m=v.location).attrs)!==null&&o!==void 0?o:m.attrs=Object.create(null);C[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(Ke.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(o){this._emitCurrentCharacterToken(o.location),this.currentToken=null,o.location&&(o.location.endLine=this.preprocessor.line,o.location.endCol=this.preprocessor.col+1,o.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const o=this.currentToken;this.prepareToken(o),o.tagID=om(o.tagName),o.type===zi.START_TAG?(this.lastStartTagName=o.tagName,this.handler.onStartTag(o)):(o.attrs.length>0&&this._err(Ke.endTagWithAttributes),o.selfClosing&&this._err(Ke.endTagWithTrailingSolidus),this.handler.onEndTag(o)),this.preprocessor.dropParsedChunk()}emitCurrentComment(o){this.prepareToken(o),this.handler.onComment(o),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(o){this.prepareToken(o),this.handler.onDoctype(o),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(o){if(this.currentCharacterToken){switch(o&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=o.startLine,this.currentCharacterToken.location.endCol=o.startCol,this.currentCharacterToken.location.endOffset=o.startOffset),this.currentCharacterToken.type){case zi.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case zi.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case zi.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const o=this.getCurrentLocation(0);o&&(o.endLine=o.startLine,o.endCol=o.startCol,o.endOffset=o.startOffset),this._emitCurrentCharacterToken(o),this.handler.onEof({type:zi.EOF,location:o}),this.active=!1}_appendCharToCurrentCharacterToken(o,m){if(this.currentCharacterToken)if(this.currentCharacterToken.type===o){this.currentCharacterToken.chars+=m;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(o,m)}_emitCodePoint(o){const m=T1(o)?zi.WHITESPACE_CHARACTER:o===se.NULL?zi.NULL_CHARACTER:zi.CHARACTER;this._appendCharToCurrentCharacterToken(m,String.fromCodePoint(o))}_emitChars(o){this._appendCharToCurrentCharacterToken(zi.CHARACTER,o)}_startCharacterReference(){this.returnState=this.state,this.state=ce.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?pc.Attribute:pc.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===ce.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===ce.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===ce.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(o){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(o):this._emitCodePoint(o)}_callState(o){switch(this.state){case ce.DATA:{this._stateData(o);break}case ce.RCDATA:{this._stateRcdata(o);break}case ce.RAWTEXT:{this._stateRawtext(o);break}case ce.SCRIPT_DATA:{this._stateScriptData(o);break}case ce.PLAINTEXT:{this._statePlaintext(o);break}case ce.TAG_OPEN:{this._stateTagOpen(o);break}case ce.END_TAG_OPEN:{this._stateEndTagOpen(o);break}case ce.TAG_NAME:{this._stateTagName(o);break}case ce.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(o);break}case ce.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(o);break}case ce.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(o);break}case ce.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(o);break}case ce.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(o);break}case ce.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(o);break}case ce.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(o);break}case ce.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(o);break}case ce.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(o);break}case ce.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(o);break}case ce.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(o);break}case ce.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(o);break}case ce.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(o);break}case ce.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(o);break}case ce.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(o);break}case ce.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(o);break}case ce.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(o);break}case ce.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(o);break}case ce.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(o);break}case ce.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(o);break}case ce.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(o);break}case ce.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(o);break}case ce.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(o);break}case ce.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(o);break}case ce.ATTRIBUTE_NAME:{this._stateAttributeName(o);break}case ce.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(o);break}case ce.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(o);break}case ce.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(o);break}case ce.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(o);break}case ce.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(o);break}case ce.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(o);break}case ce.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(o);break}case ce.BOGUS_COMMENT:{this._stateBogusComment(o);break}case ce.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(o);break}case ce.COMMENT_START:{this._stateCommentStart(o);break}case ce.COMMENT_START_DASH:{this._stateCommentStartDash(o);break}case ce.COMMENT:{this._stateComment(o);break}case ce.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(o);break}case ce.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(o);break}case ce.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(o);break}case ce.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(o);break}case ce.COMMENT_END_DASH:{this._stateCommentEndDash(o);break}case ce.COMMENT_END:{this._stateCommentEnd(o);break}case ce.COMMENT_END_BANG:{this._stateCommentEndBang(o);break}case ce.DOCTYPE:{this._stateDoctype(o);break}case ce.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(o);break}case ce.DOCTYPE_NAME:{this._stateDoctypeName(o);break}case ce.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(o);break}case ce.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(o);break}case ce.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(o);break}case ce.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(o);break}case ce.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(o);break}case ce.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(o);break}case ce.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(o);break}case ce.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(o);break}case ce.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(o);break}case ce.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(o);break}case ce.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(o);break}case ce.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(o);break}case ce.BOGUS_DOCTYPE:{this._stateBogusDoctype(o);break}case ce.CDATA_SECTION:{this._stateCdataSection(o);break}case ce.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(o);break}case ce.CDATA_SECTION_END:{this._stateCdataSectionEnd(o);break}case ce.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case ce.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(o);break}default:throw new Error("Unknown state")}}_stateData(o){switch(o){case se.LESS_THAN_SIGN:{this.state=ce.TAG_OPEN;break}case se.AMPERSAND:{this._startCharacterReference();break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this._emitCodePoint(o);break}case se.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(o)}}_stateRcdata(o){switch(o){case se.AMPERSAND:{this._startCharacterReference();break}case se.LESS_THAN_SIGN:{this.state=ce.RCDATA_LESS_THAN_SIGN;break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this._emitChars(ja);break}case se.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(o)}}_stateRawtext(o){switch(o){case se.LESS_THAN_SIGN:{this.state=ce.RAWTEXT_LESS_THAN_SIGN;break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this._emitChars(ja);break}case se.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(o)}}_stateScriptData(o){switch(o){case se.LESS_THAN_SIGN:{this.state=ce.SCRIPT_DATA_LESS_THAN_SIGN;break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this._emitChars(ja);break}case se.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(o)}}_statePlaintext(o){switch(o){case se.NULL:{this._err(Ke.unexpectedNullCharacter),this._emitChars(ja);break}case se.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(o)}}_stateTagOpen(o){if(gh(o))this._createStartTagToken(),this.state=ce.TAG_NAME,this._stateTagName(o);else switch(o){case se.EXCLAMATION_MARK:{this.state=ce.MARKUP_DECLARATION_OPEN;break}case se.SOLIDUS:{this.state=ce.END_TAG_OPEN;break}case se.QUESTION_MARK:{this._err(Ke.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=ce.BOGUS_COMMENT,this._stateBogusComment(o);break}case se.EOF:{this._err(Ke.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(Ke.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=ce.DATA,this._stateData(o)}}_stateEndTagOpen(o){if(gh(o))this._createEndTagToken(),this.state=ce.TAG_NAME,this._stateTagName(o);else switch(o){case se.GREATER_THAN_SIGN:{this._err(Ke.missingEndTagName),this.state=ce.DATA;break}case se.EOF:{this._err(Ke.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(Ke.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=ce.BOGUS_COMMENT,this._stateBogusComment(o)}}_stateTagName(o){const m=this.currentToken;switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:{this.state=ce.BEFORE_ATTRIBUTE_NAME;break}case se.SOLIDUS:{this.state=ce.SELF_CLOSING_START_TAG;break}case se.GREATER_THAN_SIGN:{this.state=ce.DATA,this.emitCurrentTagToken();break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),m.tagName+=ja;break}case se.EOF:{this._err(Ke.eofInTag),this._emitEOFToken();break}default:m.tagName+=String.fromCodePoint(F0(o)?zp(o):o)}}_stateRcdataLessThanSign(o){o===se.SOLIDUS?this.state=ce.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=ce.RCDATA,this._stateRcdata(o))}_stateRcdataEndTagOpen(o){gh(o)?(this.state=ce.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(o)):(this._emitChars("</"),this.state=ce.RCDATA,this._stateRcdata(o))}handleSpecialEndTag(o){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const m=this.currentToken;switch(m.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=ce.BEFORE_ATTRIBUTE_NAME,!1;case se.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=ce.SELF_CLOSING_START_TAG,!1;case se.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=ce.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(o){this.handleSpecialEndTag(o)&&(this._emitChars("</"),this.state=ce.RCDATA,this._stateRcdata(o))}_stateRawtextLessThanSign(o){o===se.SOLIDUS?this.state=ce.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=ce.RAWTEXT,this._stateRawtext(o))}_stateRawtextEndTagOpen(o){gh(o)?(this.state=ce.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(o)):(this._emitChars("</"),this.state=ce.RAWTEXT,this._stateRawtext(o))}_stateRawtextEndTagName(o){this.handleSpecialEndTag(o)&&(this._emitChars("</"),this.state=ce.RAWTEXT,this._stateRawtext(o))}_stateScriptDataLessThanSign(o){switch(o){case se.SOLIDUS:{this.state=ce.SCRIPT_DATA_END_TAG_OPEN;break}case se.EXCLAMATION_MARK:{this.state=ce.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=ce.SCRIPT_DATA,this._stateScriptData(o)}}_stateScriptDataEndTagOpen(o){gh(o)?(this.state=ce.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(o)):(this._emitChars("</"),this.state=ce.SCRIPT_DATA,this._stateScriptData(o))}_stateScriptDataEndTagName(o){this.handleSpecialEndTag(o)&&(this._emitChars("</"),this.state=ce.SCRIPT_DATA,this._stateScriptData(o))}_stateScriptDataEscapeStart(o){o===se.HYPHEN_MINUS?(this.state=ce.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=ce.SCRIPT_DATA,this._stateScriptData(o))}_stateScriptDataEscapeStartDash(o){o===se.HYPHEN_MINUS?(this.state=ce.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=ce.SCRIPT_DATA,this._stateScriptData(o))}_stateScriptDataEscaped(o){switch(o){case se.HYPHEN_MINUS:{this.state=ce.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case se.LESS_THAN_SIGN:{this.state=ce.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this._emitChars(ja);break}case se.EOF:{this._err(Ke.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(o)}}_stateScriptDataEscapedDash(o){switch(o){case se.HYPHEN_MINUS:{this.state=ce.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case se.LESS_THAN_SIGN:{this.state=ce.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this.state=ce.SCRIPT_DATA_ESCAPED,this._emitChars(ja);break}case se.EOF:{this._err(Ke.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=ce.SCRIPT_DATA_ESCAPED,this._emitCodePoint(o)}}_stateScriptDataEscapedDashDash(o){switch(o){case se.HYPHEN_MINUS:{this._emitChars("-");break}case se.LESS_THAN_SIGN:{this.state=ce.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case se.GREATER_THAN_SIGN:{this.state=ce.SCRIPT_DATA,this._emitChars(">");break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this.state=ce.SCRIPT_DATA_ESCAPED,this._emitChars(ja);break}case se.EOF:{this._err(Ke.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=ce.SCRIPT_DATA_ESCAPED,this._emitCodePoint(o)}}_stateScriptDataEscapedLessThanSign(o){o===se.SOLIDUS?this.state=ce.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:gh(o)?(this._emitChars("<"),this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(o)):(this._emitChars("<"),this.state=ce.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(o))}_stateScriptDataEscapedEndTagOpen(o){gh(o)?(this.state=ce.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(o)):(this._emitChars("</"),this.state=ce.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(o))}_stateScriptDataEscapedEndTagName(o){this.handleSpecialEndTag(o)&&(this._emitChars("</"),this.state=ce.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(o))}_stateScriptDataDoubleEscapeStart(o){if(this.preprocessor.startsWith(ws.SCRIPT,!1)&&l_(this.preprocessor.peek(ws.SCRIPT.length))){this._emitCodePoint(o);for(let m=0;m<ws.SCRIPT.length;m++)this._emitCodePoint(this._consume());this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=ce.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(o))}_stateScriptDataDoubleEscaped(o){switch(o){case se.HYPHEN_MINUS:{this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case se.LESS_THAN_SIGN:{this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this._emitChars(ja);break}case se.EOF:{this._err(Ke.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(o)}}_stateScriptDataDoubleEscapedDash(o){switch(o){case se.HYPHEN_MINUS:{this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case se.LESS_THAN_SIGN:{this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(ja);break}case se.EOF:{this._err(Ke.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(o)}}_stateScriptDataDoubleEscapedDashDash(o){switch(o){case se.HYPHEN_MINUS:{this._emitChars("-");break}case se.LESS_THAN_SIGN:{this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case se.GREATER_THAN_SIGN:{this.state=ce.SCRIPT_DATA,this._emitChars(">");break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(ja);break}case se.EOF:{this._err(Ke.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(o)}}_stateScriptDataDoubleEscapedLessThanSign(o){o===se.SOLIDUS?(this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(o))}_stateScriptDataDoubleEscapeEnd(o){if(this.preprocessor.startsWith(ws.SCRIPT,!1)&&l_(this.preprocessor.peek(ws.SCRIPT.length))){this._emitCodePoint(o);for(let m=0;m<ws.SCRIPT.length;m++)this._emitCodePoint(this._consume());this.state=ce.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=ce.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(o))}_stateBeforeAttributeName(o){switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:break;case se.SOLIDUS:case se.GREATER_THAN_SIGN:case se.EOF:{this.state=ce.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(o);break}case se.EQUALS_SIGN:{this._err(Ke.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=ce.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=ce.ATTRIBUTE_NAME,this._stateAttributeName(o)}}_stateAttributeName(o){switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:case se.SOLIDUS:case se.GREATER_THAN_SIGN:case se.EOF:{this._leaveAttrName(),this.state=ce.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(o);break}case se.EQUALS_SIGN:{this._leaveAttrName(),this.state=ce.BEFORE_ATTRIBUTE_VALUE;break}case se.QUOTATION_MARK:case se.APOSTROPHE:case se.LESS_THAN_SIGN:{this._err(Ke.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(o);break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this.currentAttr.name+=ja;break}default:this.currentAttr.name+=String.fromCodePoint(F0(o)?zp(o):o)}}_stateAfterAttributeName(o){switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:break;case se.SOLIDUS:{this.state=ce.SELF_CLOSING_START_TAG;break}case se.EQUALS_SIGN:{this.state=ce.BEFORE_ATTRIBUTE_VALUE;break}case se.GREATER_THAN_SIGN:{this.state=ce.DATA,this.emitCurrentTagToken();break}case se.EOF:{this._err(Ke.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=ce.ATTRIBUTE_NAME,this._stateAttributeName(o)}}_stateBeforeAttributeValue(o){switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:break;case se.QUOTATION_MARK:{this.state=ce.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case se.APOSTROPHE:{this.state=ce.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case se.GREATER_THAN_SIGN:{this._err(Ke.missingAttributeValue),this.state=ce.DATA,this.emitCurrentTagToken();break}default:this.state=ce.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(o)}}_stateAttributeValueDoubleQuoted(o){switch(o){case se.QUOTATION_MARK:{this.state=ce.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case se.AMPERSAND:{this._startCharacterReference();break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this.currentAttr.value+=ja;break}case se.EOF:{this._err(Ke.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(o)}}_stateAttributeValueSingleQuoted(o){switch(o){case se.APOSTROPHE:{this.state=ce.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case se.AMPERSAND:{this._startCharacterReference();break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this.currentAttr.value+=ja;break}case se.EOF:{this._err(Ke.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(o)}}_stateAttributeValueUnquoted(o){switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:{this._leaveAttrValue(),this.state=ce.BEFORE_ATTRIBUTE_NAME;break}case se.AMPERSAND:{this._startCharacterReference();break}case se.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=ce.DATA,this.emitCurrentTagToken();break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),this.currentAttr.value+=ja;break}case se.QUOTATION_MARK:case se.APOSTROPHE:case se.LESS_THAN_SIGN:case se.EQUALS_SIGN:case se.GRAVE_ACCENT:{this._err(Ke.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(o);break}case se.EOF:{this._err(Ke.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(o)}}_stateAfterAttributeValueQuoted(o){switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:{this._leaveAttrValue(),this.state=ce.BEFORE_ATTRIBUTE_NAME;break}case se.SOLIDUS:{this._leaveAttrValue(),this.state=ce.SELF_CLOSING_START_TAG;break}case se.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=ce.DATA,this.emitCurrentTagToken();break}case se.EOF:{this._err(Ke.eofInTag),this._emitEOFToken();break}default:this._err(Ke.missingWhitespaceBetweenAttributes),this.state=ce.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(o)}}_stateSelfClosingStartTag(o){switch(o){case se.GREATER_THAN_SIGN:{const m=this.currentToken;m.selfClosing=!0,this.state=ce.DATA,this.emitCurrentTagToken();break}case se.EOF:{this._err(Ke.eofInTag),this._emitEOFToken();break}default:this._err(Ke.unexpectedSolidusInTag),this.state=ce.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(o)}}_stateBogusComment(o){const m=this.currentToken;switch(o){case se.GREATER_THAN_SIGN:{this.state=ce.DATA,this.emitCurrentComment(m);break}case se.EOF:{this.emitCurrentComment(m),this._emitEOFToken();break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),m.data+=ja;break}default:m.data+=String.fromCodePoint(o)}}_stateMarkupDeclarationOpen(o){this._consumeSequenceIfMatch(ws.DASH_DASH,!0)?(this._createCommentToken(ws.DASH_DASH.length+1),this.state=ce.COMMENT_START):this._consumeSequenceIfMatch(ws.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(ws.DOCTYPE.length+1),this.state=ce.DOCTYPE):this._consumeSequenceIfMatch(ws.CDATA_START,!0)?this.inForeignNode?this.state=ce.CDATA_SECTION:(this._err(Ke.cdataInHtmlContent),this._createCommentToken(ws.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=ce.BOGUS_COMMENT):this._ensureHibernation()||(this._err(Ke.incorrectlyOpenedComment),this._createCommentToken(2),this.state=ce.BOGUS_COMMENT,this._stateBogusComment(o))}_stateCommentStart(o){switch(o){case se.HYPHEN_MINUS:{this.state=ce.COMMENT_START_DASH;break}case se.GREATER_THAN_SIGN:{this._err(Ke.abruptClosingOfEmptyComment),this.state=ce.DATA;const m=this.currentToken;this.emitCurrentComment(m);break}default:this.state=ce.COMMENT,this._stateComment(o)}}_stateCommentStartDash(o){const m=this.currentToken;switch(o){case se.HYPHEN_MINUS:{this.state=ce.COMMENT_END;break}case se.GREATER_THAN_SIGN:{this._err(Ke.abruptClosingOfEmptyComment),this.state=ce.DATA,this.emitCurrentComment(m);break}case se.EOF:{this._err(Ke.eofInComment),this.emitCurrentComment(m),this._emitEOFToken();break}default:m.data+="-",this.state=ce.COMMENT,this._stateComment(o)}}_stateComment(o){const m=this.currentToken;switch(o){case se.HYPHEN_MINUS:{this.state=ce.COMMENT_END_DASH;break}case se.LESS_THAN_SIGN:{m.data+="<",this.state=ce.COMMENT_LESS_THAN_SIGN;break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),m.data+=ja;break}case se.EOF:{this._err(Ke.eofInComment),this.emitCurrentComment(m),this._emitEOFToken();break}default:m.data+=String.fromCodePoint(o)}}_stateCommentLessThanSign(o){const m=this.currentToken;switch(o){case se.EXCLAMATION_MARK:{m.data+="!",this.state=ce.COMMENT_LESS_THAN_SIGN_BANG;break}case se.LESS_THAN_SIGN:{m.data+="<";break}default:this.state=ce.COMMENT,this._stateComment(o)}}_stateCommentLessThanSignBang(o){o===se.HYPHEN_MINUS?this.state=ce.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=ce.COMMENT,this._stateComment(o))}_stateCommentLessThanSignBangDash(o){o===se.HYPHEN_MINUS?this.state=ce.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=ce.COMMENT_END_DASH,this._stateCommentEndDash(o))}_stateCommentLessThanSignBangDashDash(o){o!==se.GREATER_THAN_SIGN&&o!==se.EOF&&this._err(Ke.nestedComment),this.state=ce.COMMENT_END,this._stateCommentEnd(o)}_stateCommentEndDash(o){const m=this.currentToken;switch(o){case se.HYPHEN_MINUS:{this.state=ce.COMMENT_END;break}case se.EOF:{this._err(Ke.eofInComment),this.emitCurrentComment(m),this._emitEOFToken();break}default:m.data+="-",this.state=ce.COMMENT,this._stateComment(o)}}_stateCommentEnd(o){const m=this.currentToken;switch(o){case se.GREATER_THAN_SIGN:{this.state=ce.DATA,this.emitCurrentComment(m);break}case se.EXCLAMATION_MARK:{this.state=ce.COMMENT_END_BANG;break}case se.HYPHEN_MINUS:{m.data+="-";break}case se.EOF:{this._err(Ke.eofInComment),this.emitCurrentComment(m),this._emitEOFToken();break}default:m.data+="--",this.state=ce.COMMENT,this._stateComment(o)}}_stateCommentEndBang(o){const m=this.currentToken;switch(o){case se.HYPHEN_MINUS:{m.data+="--!",this.state=ce.COMMENT_END_DASH;break}case se.GREATER_THAN_SIGN:{this._err(Ke.incorrectlyClosedComment),this.state=ce.DATA,this.emitCurrentComment(m);break}case se.EOF:{this._err(Ke.eofInComment),this.emitCurrentComment(m),this._emitEOFToken();break}default:m.data+="--!",this.state=ce.COMMENT,this._stateComment(o)}}_stateDoctype(o){switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:{this.state=ce.BEFORE_DOCTYPE_NAME;break}case se.GREATER_THAN_SIGN:{this.state=ce.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(o);break}case se.EOF:{this._err(Ke.eofInDoctype),this._createDoctypeToken(null);const m=this.currentToken;m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:this._err(Ke.missingWhitespaceBeforeDoctypeName),this.state=ce.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(o)}}_stateBeforeDoctypeName(o){if(F0(o))this._createDoctypeToken(String.fromCharCode(zp(o))),this.state=ce.DOCTYPE_NAME;else switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:break;case se.NULL:{this._err(Ke.unexpectedNullCharacter),this._createDoctypeToken(ja),this.state=ce.DOCTYPE_NAME;break}case se.GREATER_THAN_SIGN:{this._err(Ke.missingDoctypeName),this._createDoctypeToken(null);const m=this.currentToken;m.forceQuirks=!0,this.emitCurrentDoctype(m),this.state=ce.DATA;break}case se.EOF:{this._err(Ke.eofInDoctype),this._createDoctypeToken(null);const m=this.currentToken;m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(o)),this.state=ce.DOCTYPE_NAME}}_stateDoctypeName(o){const m=this.currentToken;switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:{this.state=ce.AFTER_DOCTYPE_NAME;break}case se.GREATER_THAN_SIGN:{this.state=ce.DATA,this.emitCurrentDoctype(m);break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),m.name+=ja;break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:m.name+=String.fromCodePoint(F0(o)?zp(o):o)}}_stateAfterDoctypeName(o){const m=this.currentToken;switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:break;case se.GREATER_THAN_SIGN:{this.state=ce.DATA,this.emitCurrentDoctype(m);break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(ws.PUBLIC,!1)?this.state=ce.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(ws.SYSTEM,!1)?this.state=ce.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(Ke.invalidCharacterSequenceAfterDoctypeName),m.forceQuirks=!0,this.state=ce.BOGUS_DOCTYPE,this._stateBogusDoctype(o))}}_stateAfterDoctypePublicKeyword(o){const m=this.currentToken;switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:{this.state=ce.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case se.QUOTATION_MARK:{this._err(Ke.missingWhitespaceAfterDoctypePublicKeyword),m.publicId="",this.state=ce.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case se.APOSTROPHE:{this._err(Ke.missingWhitespaceAfterDoctypePublicKeyword),m.publicId="",this.state=ce.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case se.GREATER_THAN_SIGN:{this._err(Ke.missingDoctypePublicIdentifier),m.forceQuirks=!0,this.state=ce.DATA,this.emitCurrentDoctype(m);break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:this._err(Ke.missingQuoteBeforeDoctypePublicIdentifier),m.forceQuirks=!0,this.state=ce.BOGUS_DOCTYPE,this._stateBogusDoctype(o)}}_stateBeforeDoctypePublicIdentifier(o){const m=this.currentToken;switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:break;case se.QUOTATION_MARK:{m.publicId="",this.state=ce.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case se.APOSTROPHE:{m.publicId="",this.state=ce.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case se.GREATER_THAN_SIGN:{this._err(Ke.missingDoctypePublicIdentifier),m.forceQuirks=!0,this.state=ce.DATA,this.emitCurrentDoctype(m);break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:this._err(Ke.missingQuoteBeforeDoctypePublicIdentifier),m.forceQuirks=!0,this.state=ce.BOGUS_DOCTYPE,this._stateBogusDoctype(o)}}_stateDoctypePublicIdentifierDoubleQuoted(o){const m=this.currentToken;switch(o){case se.QUOTATION_MARK:{this.state=ce.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),m.publicId+=ja;break}case se.GREATER_THAN_SIGN:{this._err(Ke.abruptDoctypePublicIdentifier),m.forceQuirks=!0,this.emitCurrentDoctype(m),this.state=ce.DATA;break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:m.publicId+=String.fromCodePoint(o)}}_stateDoctypePublicIdentifierSingleQuoted(o){const m=this.currentToken;switch(o){case se.APOSTROPHE:{this.state=ce.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),m.publicId+=ja;break}case se.GREATER_THAN_SIGN:{this._err(Ke.abruptDoctypePublicIdentifier),m.forceQuirks=!0,this.emitCurrentDoctype(m),this.state=ce.DATA;break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:m.publicId+=String.fromCodePoint(o)}}_stateAfterDoctypePublicIdentifier(o){const m=this.currentToken;switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:{this.state=ce.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case se.GREATER_THAN_SIGN:{this.state=ce.DATA,this.emitCurrentDoctype(m);break}case se.QUOTATION_MARK:{this._err(Ke.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),m.systemId="",this.state=ce.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case se.APOSTROPHE:{this._err(Ke.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),m.systemId="",this.state=ce.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:this._err(Ke.missingQuoteBeforeDoctypeSystemIdentifier),m.forceQuirks=!0,this.state=ce.BOGUS_DOCTYPE,this._stateBogusDoctype(o)}}_stateBetweenDoctypePublicAndSystemIdentifiers(o){const m=this.currentToken;switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:break;case se.GREATER_THAN_SIGN:{this.emitCurrentDoctype(m),this.state=ce.DATA;break}case se.QUOTATION_MARK:{m.systemId="",this.state=ce.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case se.APOSTROPHE:{m.systemId="",this.state=ce.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:this._err(Ke.missingQuoteBeforeDoctypeSystemIdentifier),m.forceQuirks=!0,this.state=ce.BOGUS_DOCTYPE,this._stateBogusDoctype(o)}}_stateAfterDoctypeSystemKeyword(o){const m=this.currentToken;switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:{this.state=ce.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case se.QUOTATION_MARK:{this._err(Ke.missingWhitespaceAfterDoctypeSystemKeyword),m.systemId="",this.state=ce.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case se.APOSTROPHE:{this._err(Ke.missingWhitespaceAfterDoctypeSystemKeyword),m.systemId="",this.state=ce.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case se.GREATER_THAN_SIGN:{this._err(Ke.missingDoctypeSystemIdentifier),m.forceQuirks=!0,this.state=ce.DATA,this.emitCurrentDoctype(m);break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:this._err(Ke.missingQuoteBeforeDoctypeSystemIdentifier),m.forceQuirks=!0,this.state=ce.BOGUS_DOCTYPE,this._stateBogusDoctype(o)}}_stateBeforeDoctypeSystemIdentifier(o){const m=this.currentToken;switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:break;case se.QUOTATION_MARK:{m.systemId="",this.state=ce.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case se.APOSTROPHE:{m.systemId="",this.state=ce.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case se.GREATER_THAN_SIGN:{this._err(Ke.missingDoctypeSystemIdentifier),m.forceQuirks=!0,this.state=ce.DATA,this.emitCurrentDoctype(m);break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:this._err(Ke.missingQuoteBeforeDoctypeSystemIdentifier),m.forceQuirks=!0,this.state=ce.BOGUS_DOCTYPE,this._stateBogusDoctype(o)}}_stateDoctypeSystemIdentifierDoubleQuoted(o){const m=this.currentToken;switch(o){case se.QUOTATION_MARK:{this.state=ce.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),m.systemId+=ja;break}case se.GREATER_THAN_SIGN:{this._err(Ke.abruptDoctypeSystemIdentifier),m.forceQuirks=!0,this.emitCurrentDoctype(m),this.state=ce.DATA;break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:m.systemId+=String.fromCodePoint(o)}}_stateDoctypeSystemIdentifierSingleQuoted(o){const m=this.currentToken;switch(o){case se.APOSTROPHE:{this.state=ce.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case se.NULL:{this._err(Ke.unexpectedNullCharacter),m.systemId+=ja;break}case se.GREATER_THAN_SIGN:{this._err(Ke.abruptDoctypeSystemIdentifier),m.forceQuirks=!0,this.emitCurrentDoctype(m),this.state=ce.DATA;break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:m.systemId+=String.fromCodePoint(o)}}_stateAfterDoctypeSystemIdentifier(o){const m=this.currentToken;switch(o){case se.SPACE:case se.LINE_FEED:case se.TABULATION:case se.FORM_FEED:break;case se.GREATER_THAN_SIGN:{this.emitCurrentDoctype(m),this.state=ce.DATA;break}case se.EOF:{this._err(Ke.eofInDoctype),m.forceQuirks=!0,this.emitCurrentDoctype(m),this._emitEOFToken();break}default:this._err(Ke.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=ce.BOGUS_DOCTYPE,this._stateBogusDoctype(o)}}_stateBogusDoctype(o){const m=this.currentToken;switch(o){case se.GREATER_THAN_SIGN:{this.emitCurrentDoctype(m),this.state=ce.DATA;break}case se.NULL:{this._err(Ke.unexpectedNullCharacter);break}case se.EOF:{this.emitCurrentDoctype(m),this._emitEOFToken();break}}}_stateCdataSection(o){switch(o){case se.RIGHT_SQUARE_BRACKET:{this.state=ce.CDATA_SECTION_BRACKET;break}case se.EOF:{this._err(Ke.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(o)}}_stateCdataSectionBracket(o){o===se.RIGHT_SQUARE_BRACKET?this.state=ce.CDATA_SECTION_END:(this._emitChars("]"),this.state=ce.CDATA_SECTION,this._stateCdataSection(o))}_stateCdataSectionEnd(o){switch(o){case se.GREATER_THAN_SIGN:{this.state=ce.DATA;break}case se.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=ce.CDATA_SECTION,this._stateCdataSection(o)}}_stateCharacterReference(){let o=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(o<0)if(this.preprocessor.lastChunkWritten)o=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}o===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(se.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&u_(this.preprocessor.peek(1))?ce.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(o){u_(o)?this._flushCodePointConsumedAsCharacterReference(o):(o===se.SEMICOLON&&this._err(Ke.unknownNamedCharacterReference),this.state=this.returnState,this._callState(o))}};const E1=new Set([P.DD,P.DT,P.LI,P.OPTGROUP,P.OPTION,P.P,P.RB,P.RP,P.RT,P.RTC]),c_=new Set([...E1,P.CAPTION,P.COLGROUP,P.TBODY,P.TD,P.TFOOT,P.TH,P.THEAD,P.TR]),Wp=new Set([P.APPLET,P.CAPTION,P.HTML,P.MARQUEE,P.OBJECT,P.TABLE,P.TD,P.TEMPLATE,P.TH]),Pv=new Set([...Wp,P.OL,P.UL]),Lv=new Set([...Wp,P.BUTTON]),h_=new Set([P.ANNOTATION_XML,P.MI,P.MN,P.MO,P.MS,P.MTEXT]),d_=new Set([P.DESC,P.FOREIGN_OBJECT,P.TITLE]),Nv=new Set([P.TR,P.TEMPLATE,P.HTML]),Ov=new Set([P.TBODY,P.TFOOT,P.THEAD,P.TEMPLATE,P.HTML]),kv=new Set([P.TABLE,P.TEMPLATE,P.HTML]),Bv=new Set([P.TD,P.TH]);class zv{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(o,m,v){this.treeAdapter=m,this.handler=v,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=P.UNKNOWN,this.current=o}_indexOf(o){return this.items.lastIndexOf(o,this.stackTop)}_isInTemplate(){return this.currentTagId===P.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===lt.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(o,m){this.stackTop++,this.items[this.stackTop]=o,this.current=o,this.tagIDs[this.stackTop]=m,this.currentTagId=m,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(o,m,!0)}pop(){const o=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(o,!0)}replace(o,m){const v=this._indexOf(o);this.items[v]=m,v===this.stackTop&&(this.current=m)}insertAfter(o,m,v){const C=this._indexOf(o)+1;this.items.splice(C,0,m),this.tagIDs.splice(C,0,v),this.stackTop++,C===this.stackTop&&this._updateCurrentElement(),this.current&&this.currentTagId!==void 0&&this.handler.onItemPush(this.current,this.currentTagId,C===this.stackTop)}popUntilTagNamePopped(o){let m=this.stackTop+1;do m=this.tagIDs.lastIndexOf(o,m-1);while(m>0&&this.treeAdapter.getNamespaceURI(this.items[m])!==lt.HTML);this.shortenToLength(Math.max(m,0))}shortenToLength(o){for(;this.stackTop>=o;){const m=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(m,this.stackTop<o)}}popUntilElementPopped(o){const m=this._indexOf(o);this.shortenToLength(Math.max(m,0))}popUntilPopped(o,m){const v=this._indexOfTagNames(o,m);this.shortenToLength(Math.max(v,0))}popUntilNumberedHeaderPopped(){this.popUntilPopped(tg,lt.HTML)}popUntilTableCellPopped(){this.popUntilPopped(Bv,lt.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(o,m){for(let v=this.stackTop;v>=0;v--)if(o.has(this.tagIDs[v])&&this.treeAdapter.getNamespaceURI(this.items[v])===m)return v;return-1}clearBackTo(o,m){const v=this._indexOfTagNames(o,m);this.shortenToLength(v+1)}clearBackToTableContext(){this.clearBackTo(kv,lt.HTML)}clearBackToTableBodyContext(){this.clearBackTo(Ov,lt.HTML)}clearBackToTableRowContext(){this.clearBackTo(Nv,lt.HTML)}remove(o){const m=this._indexOf(o);m>=0&&(m===this.stackTop?this.pop():(this.items.splice(m,1),this.tagIDs.splice(m,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(o,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===P.BODY?this.items[1]:null}contains(o){return this._indexOf(o)>-1}getCommonAncestor(o){const m=this._indexOf(o)-1;return m>=0?this.items[m]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===P.HTML}hasInDynamicScope(o,m){for(let v=this.stackTop;v>=0;v--){const C=this.tagIDs[v];switch(this.treeAdapter.getNamespaceURI(this.items[v])){case lt.HTML:{if(C===o)return!0;if(m.has(C))return!1;break}case lt.SVG:{if(d_.has(C))return!1;break}case lt.MATHML:{if(h_.has(C))return!1;break}}}return!0}hasInScope(o){return this.hasInDynamicScope(o,Wp)}hasInListItemScope(o){return this.hasInDynamicScope(o,Pv)}hasInButtonScope(o){return this.hasInDynamicScope(o,Lv)}hasNumberedHeaderInScope(){for(let o=this.stackTop;o>=0;o--){const m=this.tagIDs[o];switch(this.treeAdapter.getNamespaceURI(this.items[o])){case lt.HTML:{if(tg.has(m))return!0;if(Wp.has(m))return!1;break}case lt.SVG:{if(d_.has(m))return!1;break}case lt.MATHML:{if(h_.has(m))return!1;break}}}return!0}hasInTableScope(o){for(let m=this.stackTop;m>=0;m--)if(this.treeAdapter.getNamespaceURI(this.items[m])===lt.HTML)switch(this.tagIDs[m]){case o:return!0;case P.TABLE:case P.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let o=this.stackTop;o>=0;o--)if(this.treeAdapter.getNamespaceURI(this.items[o])===lt.HTML)switch(this.tagIDs[o]){case P.TBODY:case P.THEAD:case P.TFOOT:return!0;case P.TABLE:case P.HTML:return!1}return!0}hasInSelectScope(o){for(let m=this.stackTop;m>=0;m--)if(this.treeAdapter.getNamespaceURI(this.items[m])===lt.HTML)switch(this.tagIDs[m]){case o:return!0;case P.OPTION:case P.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;this.currentTagId!==void 0&&E1.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;this.currentTagId!==void 0&&c_.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(o){for(;this.currentTagId!==void 0&&this.currentTagId!==o&&c_.has(this.currentTagId);)this.pop()}}const jm=3;var Tl;(function(i){i[i.Marker=0]="Marker",i[i.Element=1]="Element"})(Tl||(Tl={}));const f_={type:Tl.Marker};class Fv{constructor(o){this.treeAdapter=o,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(o,m){const v=[],C=m.length,N=this.treeAdapter.getTagName(o),M=this.treeAdapter.getNamespaceURI(o);for(let d=0;d<this.entries.length;d++){const K=this.entries[d];if(K.type===Tl.Marker)break;const{element:W}=K;if(this.treeAdapter.getTagName(W)===N&&this.treeAdapter.getNamespaceURI(W)===M){const we=this.treeAdapter.getAttrList(W);we.length===C&&v.push({idx:d,attrs:we})}}return v}_ensureNoahArkCondition(o){if(this.entries.length<jm)return;const m=this.treeAdapter.getAttrList(o),v=this._getNoahArkConditionCandidates(o,m);if(v.length<jm)return;const C=new Map(m.map(M=>[M.name,M.value]));let N=0;for(let M=0;M<v.length;M++){const d=v[M];d.attrs.every(K=>C.get(K.name)===K.value)&&(N+=1,N>=jm&&this.entries.splice(d.idx,1))}}insertMarker(){this.entries.unshift(f_)}pushElement(o,m){this._ensureNoahArkCondition(o),this.entries.unshift({type:Tl.Element,element:o,token:m})}insertElementAfterBookmark(o,m){const v=this.entries.indexOf(this.bookmark);this.entries.splice(v,0,{type:Tl.Element,element:o,token:m})}removeEntry(o){const m=this.entries.indexOf(o);m!==-1&&this.entries.splice(m,1)}clearToLastMarker(){const o=this.entries.indexOf(f_);o===-1?this.entries.length=0:this.entries.splice(0,o+1)}getElementEntryInScopeWithTagName(o){const m=this.entries.find(v=>v.type===Tl.Marker||this.treeAdapter.getTagName(v.element)===o);return m&&m.type===Tl.Element?m:null}getElementEntry(o){return this.entries.find(m=>m.type===Tl.Element&&m.element===o)}}const fc={createDocument(){return{nodeName:"#document",mode:no.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(i,o,m){return{nodeName:i,tagName:i,attrs:m,namespaceURI:o,childNodes:[],parentNode:null}},createCommentNode(i){return{nodeName:"#comment",data:i,parentNode:null}},createTextNode(i){return{nodeName:"#text",value:i,parentNode:null}},appendChild(i,o){i.childNodes.push(o),o.parentNode=i},insertBefore(i,o,m){const v=i.childNodes.indexOf(m);i.childNodes.splice(v,0,o),o.parentNode=i},setTemplateContent(i,o){i.content=o},getTemplateContent(i){return i.content},setDocumentType(i,o,m,v){const C=i.childNodes.find(N=>N.nodeName==="#documentType");if(C)C.name=o,C.publicId=m,C.systemId=v;else{const N={nodeName:"#documentType",name:o,publicId:m,systemId:v,parentNode:null};fc.appendChild(i,N)}},setDocumentMode(i,o){i.mode=o},getDocumentMode(i){return i.mode},detachNode(i){if(i.parentNode){const o=i.parentNode.childNodes.indexOf(i);i.parentNode.childNodes.splice(o,1),i.parentNode=null}},insertText(i,o){if(i.childNodes.length>0){const m=i.childNodes[i.childNodes.length-1];if(fc.isTextNode(m)){m.value+=o;return}}fc.appendChild(i,fc.createTextNode(o))},insertTextBefore(i,o,m){const v=i.childNodes[i.childNodes.indexOf(m)-1];v&&fc.isTextNode(v)?v.value+=o:fc.insertBefore(i,fc.createTextNode(o),m)},adoptAttributes(i,o){const m=new Set(i.attrs.map(v=>v.name));for(let v=0;v<o.length;v++)m.has(o[v].name)||i.attrs.push(o[v])},getFirstChild(i){return i.childNodes[0]},getChildNodes(i){return i.childNodes},getParentNode(i){return i.parentNode},getAttrList(i){return i.attrs},getTagName(i){return i.tagName},getNamespaceURI(i){return i.namespaceURI},getTextNodeContent(i){return i.value},getCommentNodeContent(i){return i.data},getDocumentTypeNodeName(i){return i.name},getDocumentTypeNodePublicId(i){return i.publicId},getDocumentTypeNodeSystemId(i){return i.systemId},isTextNode(i){return i.nodeName==="#text"},isCommentNode(i){return i.nodeName==="#comment"},isDocumentTypeNode(i){return i.nodeName==="#documentType"},isElementNode(i){return Object.prototype.hasOwnProperty.call(i,"tagName")},setNodeSourceCodeLocation(i,o){i.sourceCodeLocation=o},getNodeSourceCodeLocation(i){return i.sourceCodeLocation},updateNodeSourceCodeLocation(i,o){i.sourceCodeLocation={...i.sourceCodeLocation,...o}}},w1="html",Uv="about:legacy-compat",Hv="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",A1=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],jv=[...A1,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],qv=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),S1=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],Vv=[...S1,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function p_(i,o){return o.some(m=>i.startsWith(m))}function Gv(i){return i.name===w1&&i.publicId===null&&(i.systemId===null||i.systemId===Uv)}function Zv(i){if(i.name!==w1)return no.QUIRKS;const{systemId:o}=i;if(o&&o.toLowerCase()===Hv)return no.QUIRKS;let{publicId:m}=i;if(m!==null){if(m=m.toLowerCase(),qv.has(m))return no.QUIRKS;let v=o===null?jv:A1;if(p_(m,v))return no.QUIRKS;if(v=o===null?S1:Vv,p_(m,v))return no.LIMITED_QUIRKS}return no.NO_QUIRKS}const m_={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},Yv="definitionurl",$v="definitionURL",Xv=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(i=>[i.toLowerCase(),i])),Qv=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:lt.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:lt.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:lt.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:lt.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:lt.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:lt.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:lt.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:lt.XML}],["xml:space",{prefix:"xml",name:"space",namespace:lt.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:lt.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:lt.XMLNS}]]),Kv=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(i=>[i.toLowerCase(),i])),Wv=new Set([P.B,P.BIG,P.BLOCKQUOTE,P.BODY,P.BR,P.CENTER,P.CODE,P.DD,P.DIV,P.DL,P.DT,P.EM,P.EMBED,P.H1,P.H2,P.H3,P.H4,P.H5,P.H6,P.HEAD,P.HR,P.I,P.IMG,P.LI,P.LISTING,P.MENU,P.META,P.NOBR,P.OL,P.P,P.PRE,P.RUBY,P.S,P.SMALL,P.SPAN,P.STRONG,P.STRIKE,P.SUB,P.SUP,P.TABLE,P.TT,P.U,P.UL,P.VAR]);function Jv(i){const o=i.tagID;return o===P.FONT&&i.attrs.some(({name:v})=>v===pd.COLOR||v===pd.SIZE||v===pd.FACE)||Wv.has(o)}function C1(i){for(let o=0;o<i.attrs.length;o++)if(i.attrs[o].name===Yv){i.attrs[o].name=$v;break}}function M1(i){for(let o=0;o<i.attrs.length;o++){const m=Xv.get(i.attrs[o].name);m!=null&&(i.attrs[o].name=m)}}function Eg(i){for(let o=0;o<i.attrs.length;o++){const m=Qv.get(i.attrs[o].name);m&&(i.attrs[o].prefix=m.prefix,i.attrs[o].name=m.name,i.attrs[o].namespace=m.namespace)}}function eT(i){const o=Kv.get(i.tagName);o!=null&&(i.tagName=o,i.tagID=om(i.tagName))}function tT(i,o){return o===lt.MATHML&&(i===P.MI||i===P.MO||i===P.MN||i===P.MS||i===P.MTEXT)}function iT(i,o,m){if(o===lt.MATHML&&i===P.ANNOTATION_XML){for(let v=0;v<m.length;v++)if(m[v].name===pd.ENCODING){const C=m[v].value.toLowerCase();return C===m_.TEXT_HTML||C===m_.APPLICATION_XML}}return o===lt.SVG&&(i===P.FOREIGN_OBJECT||i===P.DESC||i===P.TITLE)}function aT(i,o,m,v){return(!v||v===lt.HTML)&&iT(i,o,m)||(!v||v===lt.MATHML)&&tT(i,o)}const nT="hidden",rT=8,sT=3;var _e;(function(i){i[i.INITIAL=0]="INITIAL",i[i.BEFORE_HTML=1]="BEFORE_HTML",i[i.BEFORE_HEAD=2]="BEFORE_HEAD",i[i.IN_HEAD=3]="IN_HEAD",i[i.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",i[i.AFTER_HEAD=5]="AFTER_HEAD",i[i.IN_BODY=6]="IN_BODY",i[i.TEXT=7]="TEXT",i[i.IN_TABLE=8]="IN_TABLE",i[i.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",i[i.IN_CAPTION=10]="IN_CAPTION",i[i.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",i[i.IN_TABLE_BODY=12]="IN_TABLE_BODY",i[i.IN_ROW=13]="IN_ROW",i[i.IN_CELL=14]="IN_CELL",i[i.IN_SELECT=15]="IN_SELECT",i[i.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",i[i.IN_TEMPLATE=17]="IN_TEMPLATE",i[i.AFTER_BODY=18]="AFTER_BODY",i[i.IN_FRAMESET=19]="IN_FRAMESET",i[i.AFTER_FRAMESET=20]="AFTER_FRAMESET",i[i.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",i[i.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(_e||(_e={}));const oT={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},I1=new Set([P.TABLE,P.TBODY,P.TFOOT,P.THEAD,P.TR]),g_={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:fc,onParseError:null};let D1=class{constructor(o,m,v=null,C=null){this.fragmentContext=v,this.scriptHandler=C,this.currentToken=null,this.stopped=!1,this.insertionMode=_e.INITIAL,this.originalInsertionMode=_e.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...g_,...o},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=m??this.treeAdapter.createDocument(),this.tokenizer=new Rv(this.options,this),this.activeFormattingElements=new Fv(this.treeAdapter),this.fragmentContextID=v?om(this.treeAdapter.getTagName(v)):P.UNKNOWN,this._setContextModes(v??this.document,this.fragmentContextID),this.openElements=new zv(this.document,this.treeAdapter,this)}static parse(o,m){const v=new this(m);return v.tokenizer.write(o,!0),v.document}static getFragmentParser(o,m){const v={...g_,...m};o??(o=v.treeAdapter.createElement(Be.TEMPLATE,lt.HTML,[]));const C=v.treeAdapter.createElement("documentmock",lt.HTML,[]),N=new this(v,C,o);return N.fragmentContextID===P.TEMPLATE&&N.tmplInsertionModeStack.unshift(_e.IN_TEMPLATE),N._initTokenizerForFragmentParsing(),N._insertFakeRootElement(),N._resetInsertionMode(),N._findFormInFragmentContext(),N}getFragment(){const o=this.treeAdapter.getFirstChild(this.document),m=this.treeAdapter.createDocumentFragment();return this._adoptNodes(o,m),m}_err(o,m,v){var C;if(!this.onParseError)return;const N=(C=o.location)!==null&&C!==void 0?C:oT,M={code:m,startLine:N.startLine,startCol:N.startCol,startOffset:N.startOffset,endLine:v?N.startLine:N.endLine,endCol:v?N.startCol:N.endCol,endOffset:v?N.startOffset:N.endOffset};this.onParseError(M)}onItemPush(o,m,v){var C,N;(N=(C=this.treeAdapter).onItemPush)===null||N===void 0||N.call(C,o),v&&this.openElements.stackTop>0&&this._setContextModes(o,m)}onItemPop(o,m){var v,C;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(o,this.currentToken),(C=(v=this.treeAdapter).onItemPop)===null||C===void 0||C.call(v,o,this.openElements.current),m){let N,M;this.openElements.stackTop===0&&this.fragmentContext?(N=this.fragmentContext,M=this.fragmentContextID):{current:N,currentTagId:M}=this.openElements,this._setContextModes(N,M)}}_setContextModes(o,m){const v=o===this.document||o&&this.treeAdapter.getNamespaceURI(o)===lt.HTML;this.currentNotInHTML=!v,this.tokenizer.inForeignNode=!v&&o!==void 0&&m!==void 0&&!this._isIntegrationPoint(m,o)}_switchToTextParsing(o,m){this._insertElement(o,lt.HTML),this.tokenizer.state=m,this.originalInsertionMode=this.insertionMode,this.insertionMode=_e.TEXT}switchToPlaintextParsing(){this.insertionMode=_e.TEXT,this.originalInsertionMode=_e.IN_BODY,this.tokenizer.state=Cs.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let o=this.fragmentContext;for(;o;){if(this.treeAdapter.getTagName(o)===Be.FORM){this.formElement=o;break}o=this.treeAdapter.getParentNode(o)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==lt.HTML))switch(this.fragmentContextID){case P.TITLE:case P.TEXTAREA:{this.tokenizer.state=Cs.RCDATA;break}case P.STYLE:case P.XMP:case P.IFRAME:case P.NOEMBED:case P.NOFRAMES:case P.NOSCRIPT:{this.tokenizer.state=Cs.RAWTEXT;break}case P.SCRIPT:{this.tokenizer.state=Cs.SCRIPT_DATA;break}case P.PLAINTEXT:{this.tokenizer.state=Cs.PLAINTEXT;break}}}_setDocumentType(o){const m=o.name||"",v=o.publicId||"",C=o.systemId||"";if(this.treeAdapter.setDocumentType(this.document,m,v,C),o.location){const M=this.treeAdapter.getChildNodes(this.document).find(d=>this.treeAdapter.isDocumentTypeNode(d));M&&this.treeAdapter.setNodeSourceCodeLocation(M,o.location)}}_attachElementToTree(o,m){if(this.options.sourceCodeLocationInfo){const v=m&&{...m,startTag:m};this.treeAdapter.setNodeSourceCodeLocation(o,v)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(o);else{const v=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(v??this.document,o)}}_appendElement(o,m){const v=this.treeAdapter.createElement(o.tagName,m,o.attrs);this._attachElementToTree(v,o.location)}_insertElement(o,m){const v=this.treeAdapter.createElement(o.tagName,m,o.attrs);this._attachElementToTree(v,o.location),this.openElements.push(v,o.tagID)}_insertFakeElement(o,m){const v=this.treeAdapter.createElement(o,lt.HTML,[]);this._attachElementToTree(v,null),this.openElements.push(v,m)}_insertTemplate(o){const m=this.treeAdapter.createElement(o.tagName,lt.HTML,o.attrs),v=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(m,v),this._attachElementToTree(m,o.location),this.openElements.push(m,o.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(v,null)}_insertFakeRootElement(){const o=this.treeAdapter.createElement(Be.HTML,lt.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(o,null),this.treeAdapter.appendChild(this.openElements.current,o),this.openElements.push(o,P.HTML)}_appendCommentNode(o,m){const v=this.treeAdapter.createCommentNode(o.data);this.treeAdapter.appendChild(m,v),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(v,o.location)}_insertCharacters(o){let m,v;if(this._shouldFosterParentOnInsertion()?({parent:m,beforeElement:v}=this._findFosterParentingLocation(),v?this.treeAdapter.insertTextBefore(m,o.chars,v):this.treeAdapter.insertText(m,o.chars)):(m=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(m,o.chars)),!o.location)return;const C=this.treeAdapter.getChildNodes(m),N=v?C.lastIndexOf(v):C.length,M=C[N-1];if(this.treeAdapter.getNodeSourceCodeLocation(M)){const{endLine:K,endCol:W,endOffset:we}=o.location;this.treeAdapter.updateNodeSourceCodeLocation(M,{endLine:K,endCol:W,endOffset:we})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(M,o.location)}_adoptNodes(o,m){for(let v=this.treeAdapter.getFirstChild(o);v;v=this.treeAdapter.getFirstChild(o))this.treeAdapter.detachNode(v),this.treeAdapter.appendChild(m,v)}_setEndLocation(o,m){if(this.treeAdapter.getNodeSourceCodeLocation(o)&&m.location){const v=m.location,C=this.treeAdapter.getTagName(o),N=m.type===zi.END_TAG&&C===m.tagName?{endTag:{...v},endLine:v.endLine,endCol:v.endCol,endOffset:v.endOffset}:{endLine:v.startLine,endCol:v.startCol,endOffset:v.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(o,N)}}shouldProcessStartTagTokenInForeignContent(o){if(!this.currentNotInHTML)return!1;let m,v;return this.openElements.stackTop===0&&this.fragmentContext?(m=this.fragmentContext,v=this.fragmentContextID):{current:m,currentTagId:v}=this.openElements,o.tagID===P.SVG&&this.treeAdapter.getTagName(m)===Be.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(m)===lt.MATHML?!1:this.tokenizer.inForeignNode||(o.tagID===P.MGLYPH||o.tagID===P.MALIGNMARK)&&v!==void 0&&!this._isIntegrationPoint(v,m,lt.HTML)}_processToken(o){switch(o.type){case zi.CHARACTER:{this.onCharacter(o);break}case zi.NULL_CHARACTER:{this.onNullCharacter(o);break}case zi.COMMENT:{this.onComment(o);break}case zi.DOCTYPE:{this.onDoctype(o);break}case zi.START_TAG:{this._processStartTag(o);break}case zi.END_TAG:{this.onEndTag(o);break}case zi.EOF:{this.onEof(o);break}case zi.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(o);break}}}_isIntegrationPoint(o,m,v){const C=this.treeAdapter.getNamespaceURI(m),N=this.treeAdapter.getAttrList(m);return aT(o,C,N,v)}_reconstructActiveFormattingElements(){const o=this.activeFormattingElements.entries.length;if(o){const m=this.activeFormattingElements.entries.findIndex(C=>C.type===Tl.Marker||this.openElements.contains(C.element)),v=m===-1?o-1:m-1;for(let C=v;C>=0;C--){const N=this.activeFormattingElements.entries[C];this._insertElement(N.token,this.treeAdapter.getNamespaceURI(N.element)),N.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=_e.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(P.P),this.openElements.popUntilTagNamePopped(P.P)}_resetInsertionMode(){for(let o=this.openElements.stackTop;o>=0;o--)switch(o===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[o]){case P.TR:{this.insertionMode=_e.IN_ROW;return}case P.TBODY:case P.THEAD:case P.TFOOT:{this.insertionMode=_e.IN_TABLE_BODY;return}case P.CAPTION:{this.insertionMode=_e.IN_CAPTION;return}case P.COLGROUP:{this.insertionMode=_e.IN_COLUMN_GROUP;return}case P.TABLE:{this.insertionMode=_e.IN_TABLE;return}case P.BODY:{this.insertionMode=_e.IN_BODY;return}case P.FRAMESET:{this.insertionMode=_e.IN_FRAMESET;return}case P.SELECT:{this._resetInsertionModeForSelect(o);return}case P.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case P.HTML:{this.insertionMode=this.headElement?_e.AFTER_HEAD:_e.BEFORE_HEAD;return}case P.TD:case P.TH:{if(o>0){this.insertionMode=_e.IN_CELL;return}break}case P.HEAD:{if(o>0){this.insertionMode=_e.IN_HEAD;return}break}}this.insertionMode=_e.IN_BODY}_resetInsertionModeForSelect(o){if(o>0)for(let m=o-1;m>0;m--){const v=this.openElements.tagIDs[m];if(v===P.TEMPLATE)break;if(v===P.TABLE){this.insertionMode=_e.IN_SELECT_IN_TABLE;return}}this.insertionMode=_e.IN_SELECT}_isElementCausesFosterParenting(o){return I1.has(o)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this.openElements.currentTagId!==void 0&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let o=this.openElements.stackTop;o>=0;o--){const m=this.openElements.items[o];switch(this.openElements.tagIDs[o]){case P.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(m)===lt.HTML)return{parent:this.treeAdapter.getTemplateContent(m),beforeElement:null};break}case P.TABLE:{const v=this.treeAdapter.getParentNode(m);return v?{parent:v,beforeElement:m}:{parent:this.openElements.items[o-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(o){const m=this._findFosterParentingLocation();m.beforeElement?this.treeAdapter.insertBefore(m.parent,o,m.beforeElement):this.treeAdapter.appendChild(m.parent,o)}_isSpecialElement(o,m){const v=this.treeAdapter.getNamespaceURI(o);return Av[v].has(m)}onCharacter(o){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){BE(this,o);return}switch(this.insertionMode){case _e.INITIAL:{B0(this,o);break}case _e.BEFORE_HTML:{H0(this,o);break}case _e.BEFORE_HEAD:{j0(this,o);break}case _e.IN_HEAD:{q0(this,o);break}case _e.IN_HEAD_NO_SCRIPT:{V0(this,o);break}case _e.AFTER_HEAD:{G0(this,o);break}case _e.IN_BODY:case _e.IN_CAPTION:case _e.IN_CELL:case _e.IN_TEMPLATE:{P1(this,o);break}case _e.TEXT:case _e.IN_SELECT:case _e.IN_SELECT_IN_TABLE:{this._insertCharacters(o);break}case _e.IN_TABLE:case _e.IN_TABLE_BODY:case _e.IN_ROW:{qm(this,o);break}case _e.IN_TABLE_TEXT:{z1(this,o);break}case _e.IN_COLUMN_GROUP:{Jp(this,o);break}case _e.AFTER_BODY:{em(this,o);break}case _e.AFTER_AFTER_BODY:{jp(this,o);break}}}onNullCharacter(o){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){kE(this,o);return}switch(this.insertionMode){case _e.INITIAL:{B0(this,o);break}case _e.BEFORE_HTML:{H0(this,o);break}case _e.BEFORE_HEAD:{j0(this,o);break}case _e.IN_HEAD:{q0(this,o);break}case _e.IN_HEAD_NO_SCRIPT:{V0(this,o);break}case _e.AFTER_HEAD:{G0(this,o);break}case _e.TEXT:{this._insertCharacters(o);break}case _e.IN_TABLE:case _e.IN_TABLE_BODY:case _e.IN_ROW:{qm(this,o);break}case _e.IN_COLUMN_GROUP:{Jp(this,o);break}case _e.AFTER_BODY:{em(this,o);break}case _e.AFTER_AFTER_BODY:{jp(this,o);break}}}onComment(o){if(this.skipNextNewLine=!1,this.currentNotInHTML){ig(this,o);return}switch(this.insertionMode){case _e.INITIAL:case _e.BEFORE_HTML:case _e.BEFORE_HEAD:case _e.IN_HEAD:case _e.IN_HEAD_NO_SCRIPT:case _e.AFTER_HEAD:case _e.IN_BODY:case _e.IN_TABLE:case _e.IN_CAPTION:case _e.IN_COLUMN_GROUP:case _e.IN_TABLE_BODY:case _e.IN_ROW:case _e.IN_CELL:case _e.IN_SELECT:case _e.IN_SELECT_IN_TABLE:case _e.IN_TEMPLATE:case _e.IN_FRAMESET:case _e.AFTER_FRAMESET:{ig(this,o);break}case _e.IN_TABLE_TEXT:{z0(this,o);break}case _e.AFTER_BODY:{pT(this,o);break}case _e.AFTER_AFTER_BODY:case _e.AFTER_AFTER_FRAMESET:{mT(this,o);break}}}onDoctype(o){switch(this.skipNextNewLine=!1,this.insertionMode){case _e.INITIAL:{gT(this,o);break}case _e.BEFORE_HEAD:case _e.IN_HEAD:case _e.IN_HEAD_NO_SCRIPT:case _e.AFTER_HEAD:{this._err(o,Ke.misplacedDoctype);break}case _e.IN_TABLE_TEXT:{z0(this,o);break}}}onStartTag(o){this.skipNextNewLine=!1,this.currentToken=o,this._processStartTag(o),o.selfClosing&&!o.ackSelfClosing&&this._err(o,Ke.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(o){this.shouldProcessStartTagTokenInForeignContent(o)?zE(this,o):this._startTagOutsideForeignContent(o)}_startTagOutsideForeignContent(o){switch(this.insertionMode){case _e.INITIAL:{B0(this,o);break}case _e.BEFORE_HTML:{_T(this,o);break}case _e.BEFORE_HEAD:{bT(this,o);break}case _e.IN_HEAD:{Iu(this,o);break}case _e.IN_HEAD_NO_SCRIPT:{TT(this,o);break}case _e.AFTER_HEAD:{wT(this,o);break}case _e.IN_BODY:{Br(this,o);break}case _e.IN_TABLE:{Nf(this,o);break}case _e.IN_TABLE_TEXT:{z0(this,o);break}case _e.IN_CAPTION:{xE(this,o);break}case _e.IN_COLUMN_GROUP:{Sg(this,o);break}case _e.IN_TABLE_BODY:{cm(this,o);break}case _e.IN_ROW:{hm(this,o);break}case _e.IN_CELL:{EE(this,o);break}case _e.IN_SELECT:{H1(this,o);break}case _e.IN_SELECT_IN_TABLE:{AE(this,o);break}case _e.IN_TEMPLATE:{CE(this,o);break}case _e.AFTER_BODY:{IE(this,o);break}case _e.IN_FRAMESET:{DE(this,o);break}case _e.AFTER_FRAMESET:{PE(this,o);break}case _e.AFTER_AFTER_BODY:{NE(this,o);break}case _e.AFTER_AFTER_FRAMESET:{OE(this,o);break}}}onEndTag(o){this.skipNextNewLine=!1,this.currentToken=o,this.currentNotInHTML?FE(this,o):this._endTagOutsideForeignContent(o)}_endTagOutsideForeignContent(o){switch(this.insertionMode){case _e.INITIAL:{B0(this,o);break}case _e.BEFORE_HTML:{yT(this,o);break}case _e.BEFORE_HEAD:{xT(this,o);break}case _e.IN_HEAD:{vT(this,o);break}case _e.IN_HEAD_NO_SCRIPT:{ET(this,o);break}case _e.AFTER_HEAD:{AT(this,o);break}case _e.IN_BODY:{lm(this,o);break}case _e.TEXT:{cE(this,o);break}case _e.IN_TABLE:{K0(this,o);break}case _e.IN_TABLE_TEXT:{z0(this,o);break}case _e.IN_CAPTION:{vE(this,o);break}case _e.IN_COLUMN_GROUP:{TE(this,o);break}case _e.IN_TABLE_BODY:{ag(this,o);break}case _e.IN_ROW:{U1(this,o);break}case _e.IN_CELL:{wE(this,o);break}case _e.IN_SELECT:{j1(this,o);break}case _e.IN_SELECT_IN_TABLE:{SE(this,o);break}case _e.IN_TEMPLATE:{ME(this,o);break}case _e.AFTER_BODY:{V1(this,o);break}case _e.IN_FRAMESET:{RE(this,o);break}case _e.AFTER_FRAMESET:{LE(this,o);break}case _e.AFTER_AFTER_BODY:{jp(this,o);break}}}onEof(o){switch(this.insertionMode){case _e.INITIAL:{B0(this,o);break}case _e.BEFORE_HTML:{H0(this,o);break}case _e.BEFORE_HEAD:{j0(this,o);break}case _e.IN_HEAD:{q0(this,o);break}case _e.IN_HEAD_NO_SCRIPT:{V0(this,o);break}case _e.AFTER_HEAD:{G0(this,o);break}case _e.IN_BODY:case _e.IN_TABLE:case _e.IN_CAPTION:case _e.IN_COLUMN_GROUP:case _e.IN_TABLE_BODY:case _e.IN_ROW:case _e.IN_CELL:case _e.IN_SELECT:case _e.IN_SELECT_IN_TABLE:{k1(this,o);break}case _e.TEXT:{hE(this,o);break}case _e.IN_TABLE_TEXT:{z0(this,o);break}case _e.IN_TEMPLATE:{q1(this,o);break}case _e.AFTER_BODY:case _e.IN_FRAMESET:case _e.AFTER_FRAMESET:case _e.AFTER_AFTER_BODY:case _e.AFTER_AFTER_FRAMESET:{Ag(this,o);break}}}onWhitespaceCharacter(o){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,o.chars.charCodeAt(0)===se.LINE_FEED)){if(o.chars.length===1)return;o.chars=o.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(o);return}switch(this.insertionMode){case _e.IN_HEAD:case _e.IN_HEAD_NO_SCRIPT:case _e.AFTER_HEAD:case _e.TEXT:case _e.IN_COLUMN_GROUP:case _e.IN_SELECT:case _e.IN_SELECT_IN_TABLE:case _e.IN_FRAMESET:case _e.AFTER_FRAMESET:{this._insertCharacters(o);break}case _e.IN_BODY:case _e.IN_CAPTION:case _e.IN_CELL:case _e.IN_TEMPLATE:case _e.AFTER_BODY:case _e.AFTER_AFTER_BODY:case _e.AFTER_AFTER_FRAMESET:{R1(this,o);break}case _e.IN_TABLE:case _e.IN_TABLE_BODY:case _e.IN_ROW:{qm(this,o);break}case _e.IN_TABLE_TEXT:{B1(this,o);break}}}};function uT(i,o){let m=i.activeFormattingElements.getElementEntryInScopeWithTagName(o.tagName);return m?i.openElements.contains(m.element)?i.openElements.hasInScope(o.tagID)||(m=null):(i.activeFormattingElements.removeEntry(m),m=null):O1(i,o),m}function lT(i,o){let m=null,v=i.openElements.stackTop;for(;v>=0;v--){const C=i.openElements.items[v];if(C===o.element)break;i._isSpecialElement(C,i.openElements.tagIDs[v])&&(m=C)}return m||(i.openElements.shortenToLength(Math.max(v,0)),i.activeFormattingElements.removeEntry(o)),m}function cT(i,o,m){let v=o,C=i.openElements.getCommonAncestor(o);for(let N=0,M=C;M!==m;N++,M=C){C=i.openElements.getCommonAncestor(M);const d=i.activeFormattingElements.getElementEntry(M),K=d&&N>=sT;!d||K?(K&&i.activeFormattingElements.removeEntry(d),i.openElements.remove(M)):(M=hT(i,d),v===o&&(i.activeFormattingElements.bookmark=d),i.treeAdapter.detachNode(v),i.treeAdapter.appendChild(M,v),v=M)}return v}function hT(i,o){const m=i.treeAdapter.getNamespaceURI(o.element),v=i.treeAdapter.createElement(o.token.tagName,m,o.token.attrs);return i.openElements.replace(o.element,v),o.element=v,v}function dT(i,o,m){const v=i.treeAdapter.getTagName(o),C=om(v);if(i._isElementCausesFosterParenting(C))i._fosterParentElement(m);else{const N=i.treeAdapter.getNamespaceURI(o);C===P.TEMPLATE&&N===lt.HTML&&(o=i.treeAdapter.getTemplateContent(o)),i.treeAdapter.appendChild(o,m)}}function fT(i,o,m){const v=i.treeAdapter.getNamespaceURI(m.element),{token:C}=m,N=i.treeAdapter.createElement(C.tagName,v,C.attrs);i._adoptNodes(o,N),i.treeAdapter.appendChild(o,N),i.activeFormattingElements.insertElementAfterBookmark(N,C),i.activeFormattingElements.removeEntry(m),i.openElements.remove(m.element),i.openElements.insertAfter(o,N,C.tagID)}function wg(i,o){for(let m=0;m<rT;m++){const v=uT(i,o);if(!v)break;const C=lT(i,v);if(!C)break;i.activeFormattingElements.bookmark=v;const N=cT(i,C,v.element),M=i.openElements.getCommonAncestor(v.element);i.treeAdapter.detachNode(N),M&&dT(i,M,N),fT(i,C,v)}}function ig(i,o){i._appendCommentNode(o,i.openElements.currentTmplContentOrNode)}function pT(i,o){i._appendCommentNode(o,i.openElements.items[0])}function mT(i,o){i._appendCommentNode(o,i.document)}function Ag(i,o){if(i.stopped=!0,o.location){const m=i.fragmentContext?0:2;for(let v=i.openElements.stackTop;v>=m;v--)i._setEndLocation(i.openElements.items[v],o);if(!i.fragmentContext&&i.openElements.stackTop>=0){const v=i.openElements.items[0],C=i.treeAdapter.getNodeSourceCodeLocation(v);if(C&&!C.endTag&&(i._setEndLocation(v,o),i.openElements.stackTop>=1)){const N=i.openElements.items[1],M=i.treeAdapter.getNodeSourceCodeLocation(N);M&&!M.endTag&&i._setEndLocation(N,o)}}}}function gT(i,o){i._setDocumentType(o);const m=o.forceQuirks?no.QUIRKS:Zv(o);Gv(o)||i._err(o,Ke.nonConformingDoctype),i.treeAdapter.setDocumentMode(i.document,m),i.insertionMode=_e.BEFORE_HTML}function B0(i,o){i._err(o,Ke.missingDoctype,!0),i.treeAdapter.setDocumentMode(i.document,no.QUIRKS),i.insertionMode=_e.BEFORE_HTML,i._processToken(o)}function _T(i,o){o.tagID===P.HTML?(i._insertElement(o,lt.HTML),i.insertionMode=_e.BEFORE_HEAD):H0(i,o)}function yT(i,o){const m=o.tagID;(m===P.HTML||m===P.HEAD||m===P.BODY||m===P.BR)&&H0(i,o)}function H0(i,o){i._insertFakeRootElement(),i.insertionMode=_e.BEFORE_HEAD,i._processToken(o)}function bT(i,o){switch(o.tagID){case P.HTML:{Br(i,o);break}case P.HEAD:{i._insertElement(o,lt.HTML),i.headElement=i.openElements.current,i.insertionMode=_e.IN_HEAD;break}default:j0(i,o)}}function xT(i,o){const m=o.tagID;m===P.HEAD||m===P.BODY||m===P.HTML||m===P.BR?j0(i,o):i._err(o,Ke.endTagWithoutMatchingOpenElement)}function j0(i,o){i._insertFakeElement(Be.HEAD,P.HEAD),i.headElement=i.openElements.current,i.insertionMode=_e.IN_HEAD,i._processToken(o)}function Iu(i,o){switch(o.tagID){case P.HTML:{Br(i,o);break}case P.BASE:case P.BASEFONT:case P.BGSOUND:case P.LINK:case P.META:{i._appendElement(o,lt.HTML),o.ackSelfClosing=!0;break}case P.TITLE:{i._switchToTextParsing(o,Cs.RCDATA);break}case P.NOSCRIPT:{i.options.scriptingEnabled?i._switchToTextParsing(o,Cs.RAWTEXT):(i._insertElement(o,lt.HTML),i.insertionMode=_e.IN_HEAD_NO_SCRIPT);break}case P.NOFRAMES:case P.STYLE:{i._switchToTextParsing(o,Cs.RAWTEXT);break}case P.SCRIPT:{i._switchToTextParsing(o,Cs.SCRIPT_DATA);break}case P.TEMPLATE:{i._insertTemplate(o),i.activeFormattingElements.insertMarker(),i.framesetOk=!1,i.insertionMode=_e.IN_TEMPLATE,i.tmplInsertionModeStack.unshift(_e.IN_TEMPLATE);break}case P.HEAD:{i._err(o,Ke.misplacedStartTagForHeadElement);break}default:q0(i,o)}}function vT(i,o){switch(o.tagID){case P.HEAD:{i.openElements.pop(),i.insertionMode=_e.AFTER_HEAD;break}case P.BODY:case P.BR:case P.HTML:{q0(i,o);break}case P.TEMPLATE:{bd(i,o);break}default:i._err(o,Ke.endTagWithoutMatchingOpenElement)}}function bd(i,o){i.openElements.tmplCount>0?(i.openElements.generateImpliedEndTagsThoroughly(),i.openElements.currentTagId!==P.TEMPLATE&&i._err(o,Ke.closingOfElementWithOpenChildElements),i.openElements.popUntilTagNamePopped(P.TEMPLATE),i.activeFormattingElements.clearToLastMarker(),i.tmplInsertionModeStack.shift(),i._resetInsertionMode()):i._err(o,Ke.endTagWithoutMatchingOpenElement)}function q0(i,o){i.openElements.pop(),i.insertionMode=_e.AFTER_HEAD,i._processToken(o)}function TT(i,o){switch(o.tagID){case P.HTML:{Br(i,o);break}case P.BASEFONT:case P.BGSOUND:case P.HEAD:case P.LINK:case P.META:case P.NOFRAMES:case P.STYLE:{Iu(i,o);break}case P.NOSCRIPT:{i._err(o,Ke.nestedNoscriptInHead);break}default:V0(i,o)}}function ET(i,o){switch(o.tagID){case P.NOSCRIPT:{i.openElements.pop(),i.insertionMode=_e.IN_HEAD;break}case P.BR:{V0(i,o);break}default:i._err(o,Ke.endTagWithoutMatchingOpenElement)}}function V0(i,o){const m=o.type===zi.EOF?Ke.openElementsLeftAfterEof:Ke.disallowedContentInNoscriptInHead;i._err(o,m),i.openElements.pop(),i.insertionMode=_e.IN_HEAD,i._processToken(o)}function wT(i,o){switch(o.tagID){case P.HTML:{Br(i,o);break}case P.BODY:{i._insertElement(o,lt.HTML),i.framesetOk=!1,i.insertionMode=_e.IN_BODY;break}case P.FRAMESET:{i._insertElement(o,lt.HTML),i.insertionMode=_e.IN_FRAMESET;break}case P.BASE:case P.BASEFONT:case P.BGSOUND:case P.LINK:case P.META:case P.NOFRAMES:case P.SCRIPT:case P.STYLE:case P.TEMPLATE:case P.TITLE:{i._err(o,Ke.abandonedHeadElementChild),i.openElements.push(i.headElement,P.HEAD),Iu(i,o),i.openElements.remove(i.headElement);break}case P.HEAD:{i._err(o,Ke.misplacedStartTagForHeadElement);break}default:G0(i,o)}}function AT(i,o){switch(o.tagID){case P.BODY:case P.HTML:case P.BR:{G0(i,o);break}case P.TEMPLATE:{bd(i,o);break}default:i._err(o,Ke.endTagWithoutMatchingOpenElement)}}function G0(i,o){i._insertFakeElement(Be.BODY,P.BODY),i.insertionMode=_e.IN_BODY,um(i,o)}function um(i,o){switch(o.type){case zi.CHARACTER:{P1(i,o);break}case zi.WHITESPACE_CHARACTER:{R1(i,o);break}case zi.COMMENT:{ig(i,o);break}case zi.START_TAG:{Br(i,o);break}case zi.END_TAG:{lm(i,o);break}case zi.EOF:{k1(i,o);break}}}function R1(i,o){i._reconstructActiveFormattingElements(),i._insertCharacters(o)}function P1(i,o){i._reconstructActiveFormattingElements(),i._insertCharacters(o),i.framesetOk=!1}function ST(i,o){i.openElements.tmplCount===0&&i.treeAdapter.adoptAttributes(i.openElements.items[0],o.attrs)}function CT(i,o){const m=i.openElements.tryPeekProperlyNestedBodyElement();m&&i.openElements.tmplCount===0&&(i.framesetOk=!1,i.treeAdapter.adoptAttributes(m,o.attrs))}function MT(i,o){const m=i.openElements.tryPeekProperlyNestedBodyElement();i.framesetOk&&m&&(i.treeAdapter.detachNode(m),i.openElements.popAllUpToHtmlElement(),i._insertElement(o,lt.HTML),i.insertionMode=_e.IN_FRAMESET)}function IT(i,o){i.openElements.hasInButtonScope(P.P)&&i._closePElement(),i._insertElement(o,lt.HTML)}function DT(i,o){i.openElements.hasInButtonScope(P.P)&&i._closePElement(),i.openElements.currentTagId!==void 0&&tg.has(i.openElements.currentTagId)&&i.openElements.pop(),i._insertElement(o,lt.HTML)}function RT(i,o){i.openElements.hasInButtonScope(P.P)&&i._closePElement(),i._insertElement(o,lt.HTML),i.skipNextNewLine=!0,i.framesetOk=!1}function PT(i,o){const m=i.openElements.tmplCount>0;(!i.formElement||m)&&(i.openElements.hasInButtonScope(P.P)&&i._closePElement(),i._insertElement(o,lt.HTML),m||(i.formElement=i.openElements.current))}function LT(i,o){i.framesetOk=!1;const m=o.tagID;for(let v=i.openElements.stackTop;v>=0;v--){const C=i.openElements.tagIDs[v];if(m===P.LI&&C===P.LI||(m===P.DD||m===P.DT)&&(C===P.DD||C===P.DT)){i.openElements.generateImpliedEndTagsWithExclusion(C),i.openElements.popUntilTagNamePopped(C);break}if(C!==P.ADDRESS&&C!==P.DIV&&C!==P.P&&i._isSpecialElement(i.openElements.items[v],C))break}i.openElements.hasInButtonScope(P.P)&&i._closePElement(),i._insertElement(o,lt.HTML)}function NT(i,o){i.openElements.hasInButtonScope(P.P)&&i._closePElement(),i._insertElement(o,lt.HTML),i.tokenizer.state=Cs.PLAINTEXT}function OT(i,o){i.openElements.hasInScope(P.BUTTON)&&(i.openElements.generateImpliedEndTags(),i.openElements.popUntilTagNamePopped(P.BUTTON)),i._reconstructActiveFormattingElements(),i._insertElement(o,lt.HTML),i.framesetOk=!1}function kT(i,o){const m=i.activeFormattingElements.getElementEntryInScopeWithTagName(Be.A);m&&(wg(i,o),i.openElements.remove(m.element),i.activeFormattingElements.removeEntry(m)),i._reconstructActiveFormattingElements(),i._insertElement(o,lt.HTML),i.activeFormattingElements.pushElement(i.openElements.current,o)}function BT(i,o){i._reconstructActiveFormattingElements(),i._insertElement(o,lt.HTML),i.activeFormattingElements.pushElement(i.openElements.current,o)}function zT(i,o){i._reconstructActiveFormattingElements(),i.openElements.hasInScope(P.NOBR)&&(wg(i,o),i._reconstructActiveFormattingElements()),i._insertElement(o,lt.HTML),i.activeFormattingElements.pushElement(i.openElements.current,o)}function FT(i,o){i._reconstructActiveFormattingElements(),i._insertElement(o,lt.HTML),i.activeFormattingElements.insertMarker(),i.framesetOk=!1}function UT(i,o){i.treeAdapter.getDocumentMode(i.document)!==no.QUIRKS&&i.openElements.hasInButtonScope(P.P)&&i._closePElement(),i._insertElement(o,lt.HTML),i.framesetOk=!1,i.insertionMode=_e.IN_TABLE}function L1(i,o){i._reconstructActiveFormattingElements(),i._appendElement(o,lt.HTML),i.framesetOk=!1,o.ackSelfClosing=!0}function N1(i){const o=v1(i,pd.TYPE);return o!=null&&o.toLowerCase()===nT}function HT(i,o){i._reconstructActiveFormattingElements(),i._appendElement(o,lt.HTML),N1(o)||(i.framesetOk=!1),o.ackSelfClosing=!0}function jT(i,o){i._appendElement(o,lt.HTML),o.ackSelfClosing=!0}function qT(i,o){i.openElements.hasInButtonScope(P.P)&&i._closePElement(),i._appendElement(o,lt.HTML),i.framesetOk=!1,o.ackSelfClosing=!0}function VT(i,o){o.tagName=Be.IMG,o.tagID=P.IMG,L1(i,o)}function GT(i,o){i._insertElement(o,lt.HTML),i.skipNextNewLine=!0,i.tokenizer.state=Cs.RCDATA,i.originalInsertionMode=i.insertionMode,i.framesetOk=!1,i.insertionMode=_e.TEXT}function ZT(i,o){i.openElements.hasInButtonScope(P.P)&&i._closePElement(),i._reconstructActiveFormattingElements(),i.framesetOk=!1,i._switchToTextParsing(o,Cs.RAWTEXT)}function YT(i,o){i.framesetOk=!1,i._switchToTextParsing(o,Cs.RAWTEXT)}function __(i,o){i._switchToTextParsing(o,Cs.RAWTEXT)}function $T(i,o){i._reconstructActiveFormattingElements(),i._insertElement(o,lt.HTML),i.framesetOk=!1,i.insertionMode=i.insertionMode===_e.IN_TABLE||i.insertionMode===_e.IN_CAPTION||i.insertionMode===_e.IN_TABLE_BODY||i.insertionMode===_e.IN_ROW||i.insertionMode===_e.IN_CELL?_e.IN_SELECT_IN_TABLE:_e.IN_SELECT}function XT(i,o){i.openElements.currentTagId===P.OPTION&&i.openElements.pop(),i._reconstructActiveFormattingElements(),i._insertElement(o,lt.HTML)}function QT(i,o){i.openElements.hasInScope(P.RUBY)&&i.openElements.generateImpliedEndTags(),i._insertElement(o,lt.HTML)}function KT(i,o){i.openElements.hasInScope(P.RUBY)&&i.openElements.generateImpliedEndTagsWithExclusion(P.RTC),i._insertElement(o,lt.HTML)}function WT(i,o){i._reconstructActiveFormattingElements(),C1(o),Eg(o),o.selfClosing?i._appendElement(o,lt.MATHML):i._insertElement(o,lt.MATHML),o.ackSelfClosing=!0}function JT(i,o){i._reconstructActiveFormattingElements(),M1(o),Eg(o),o.selfClosing?i._appendElement(o,lt.SVG):i._insertElement(o,lt.SVG),o.ackSelfClosing=!0}function y_(i,o){i._reconstructActiveFormattingElements(),i._insertElement(o,lt.HTML)}function Br(i,o){switch(o.tagID){case P.I:case P.S:case P.B:case P.U:case P.EM:case P.TT:case P.BIG:case P.CODE:case P.FONT:case P.SMALL:case P.STRIKE:case P.STRONG:{BT(i,o);break}case P.A:{kT(i,o);break}case P.H1:case P.H2:case P.H3:case P.H4:case P.H5:case P.H6:{DT(i,o);break}case P.P:case P.DL:case P.OL:case P.UL:case P.DIV:case P.DIR:case P.NAV:case P.MAIN:case P.MENU:case P.ASIDE:case P.CENTER:case P.FIGURE:case P.FOOTER:case P.HEADER:case P.HGROUP:case P.DIALOG:case P.DETAILS:case P.ADDRESS:case P.ARTICLE:case P.SEARCH:case P.SECTION:case P.SUMMARY:case P.FIELDSET:case P.BLOCKQUOTE:case P.FIGCAPTION:{IT(i,o);break}case P.LI:case P.DD:case P.DT:{LT(i,o);break}case P.BR:case P.IMG:case P.WBR:case P.AREA:case P.EMBED:case P.KEYGEN:{L1(i,o);break}case P.HR:{qT(i,o);break}case P.RB:case P.RTC:{QT(i,o);break}case P.RT:case P.RP:{KT(i,o);break}case P.PRE:case P.LISTING:{RT(i,o);break}case P.XMP:{ZT(i,o);break}case P.SVG:{JT(i,o);break}case P.HTML:{ST(i,o);break}case P.BASE:case P.LINK:case P.META:case P.STYLE:case P.TITLE:case P.SCRIPT:case P.BGSOUND:case P.BASEFONT:case P.TEMPLATE:{Iu(i,o);break}case P.BODY:{CT(i,o);break}case P.FORM:{PT(i,o);break}case P.NOBR:{zT(i,o);break}case P.MATH:{WT(i,o);break}case P.TABLE:{UT(i,o);break}case P.INPUT:{HT(i,o);break}case P.PARAM:case P.TRACK:case P.SOURCE:{jT(i,o);break}case P.IMAGE:{VT(i,o);break}case P.BUTTON:{OT(i,o);break}case P.APPLET:case P.OBJECT:case P.MARQUEE:{FT(i,o);break}case P.IFRAME:{YT(i,o);break}case P.SELECT:{$T(i,o);break}case P.OPTION:case P.OPTGROUP:{XT(i,o);break}case P.NOEMBED:case P.NOFRAMES:{__(i,o);break}case P.FRAMESET:{MT(i,o);break}case P.TEXTAREA:{GT(i,o);break}case P.NOSCRIPT:{i.options.scriptingEnabled?__(i,o):y_(i,o);break}case P.PLAINTEXT:{NT(i,o);break}case P.COL:case P.TH:case P.TD:case P.TR:case P.HEAD:case P.FRAME:case P.TBODY:case P.TFOOT:case P.THEAD:case P.CAPTION:case P.COLGROUP:break;default:y_(i,o)}}function eE(i,o){if(i.openElements.hasInScope(P.BODY)&&(i.insertionMode=_e.AFTER_BODY,i.options.sourceCodeLocationInfo)){const m=i.openElements.tryPeekProperlyNestedBodyElement();m&&i._setEndLocation(m,o)}}function tE(i,o){i.openElements.hasInScope(P.BODY)&&(i.insertionMode=_e.AFTER_BODY,V1(i,o))}function iE(i,o){const m=o.tagID;i.openElements.hasInScope(m)&&(i.openElements.generateImpliedEndTags(),i.openElements.popUntilTagNamePopped(m))}function aE(i){const o=i.openElements.tmplCount>0,{formElement:m}=i;o||(i.formElement=null),(m||o)&&i.openElements.hasInScope(P.FORM)&&(i.openElements.generateImpliedEndTags(),o?i.openElements.popUntilTagNamePopped(P.FORM):m&&i.openElements.remove(m))}function nE(i){i.openElements.hasInButtonScope(P.P)||i._insertFakeElement(Be.P,P.P),i._closePElement()}function rE(i){i.openElements.hasInListItemScope(P.LI)&&(i.openElements.generateImpliedEndTagsWithExclusion(P.LI),i.openElements.popUntilTagNamePopped(P.LI))}function sE(i,o){const m=o.tagID;i.openElements.hasInScope(m)&&(i.openElements.generateImpliedEndTagsWithExclusion(m),i.openElements.popUntilTagNamePopped(m))}function oE(i){i.openElements.hasNumberedHeaderInScope()&&(i.openElements.generateImpliedEndTags(),i.openElements.popUntilNumberedHeaderPopped())}function uE(i,o){const m=o.tagID;i.openElements.hasInScope(m)&&(i.openElements.generateImpliedEndTags(),i.openElements.popUntilTagNamePopped(m),i.activeFormattingElements.clearToLastMarker())}function lE(i){i._reconstructActiveFormattingElements(),i._insertFakeElement(Be.BR,P.BR),i.openElements.pop(),i.framesetOk=!1}function O1(i,o){const m=o.tagName,v=o.tagID;for(let C=i.openElements.stackTop;C>0;C--){const N=i.openElements.items[C],M=i.openElements.tagIDs[C];if(v===M&&(v!==P.UNKNOWN||i.treeAdapter.getTagName(N)===m)){i.openElements.generateImpliedEndTagsWithExclusion(v),i.openElements.stackTop>=C&&i.openElements.shortenToLength(C);break}if(i._isSpecialElement(N,M))break}}function lm(i,o){switch(o.tagID){case P.A:case P.B:case P.I:case P.S:case P.U:case P.EM:case P.TT:case P.BIG:case P.CODE:case P.FONT:case P.NOBR:case P.SMALL:case P.STRIKE:case P.STRONG:{wg(i,o);break}case P.P:{nE(i);break}case P.DL:case P.UL:case P.OL:case P.DIR:case P.DIV:case P.NAV:case P.PRE:case P.MAIN:case P.MENU:case P.ASIDE:case P.BUTTON:case P.CENTER:case P.FIGURE:case P.FOOTER:case P.HEADER:case P.HGROUP:case P.DIALOG:case P.ADDRESS:case P.ARTICLE:case P.DETAILS:case P.SEARCH:case P.SECTION:case P.SUMMARY:case P.LISTING:case P.FIELDSET:case P.BLOCKQUOTE:case P.FIGCAPTION:{iE(i,o);break}case P.LI:{rE(i);break}case P.DD:case P.DT:{sE(i,o);break}case P.H1:case P.H2:case P.H3:case P.H4:case P.H5:case P.H6:{oE(i);break}case P.BR:{lE(i);break}case P.BODY:{eE(i,o);break}case P.HTML:{tE(i,o);break}case P.FORM:{aE(i);break}case P.APPLET:case P.OBJECT:case P.MARQUEE:{uE(i,o);break}case P.TEMPLATE:{bd(i,o);break}default:O1(i,o)}}function k1(i,o){i.tmplInsertionModeStack.length>0?q1(i,o):Ag(i,o)}function cE(i,o){var m;o.tagID===P.SCRIPT&&((m=i.scriptHandler)===null||m===void 0||m.call(i,i.openElements.current)),i.openElements.pop(),i.insertionMode=i.originalInsertionMode}function hE(i,o){i._err(o,Ke.eofInElementThatCanContainOnlyText),i.openElements.pop(),i.insertionMode=i.originalInsertionMode,i.onEof(o)}function qm(i,o){if(i.openElements.currentTagId!==void 0&&I1.has(i.openElements.currentTagId))switch(i.pendingCharacterTokens.length=0,i.hasNonWhitespacePendingCharacterToken=!1,i.originalInsertionMode=i.insertionMode,i.insertionMode=_e.IN_TABLE_TEXT,o.type){case zi.CHARACTER:{z1(i,o);break}case zi.WHITESPACE_CHARACTER:{B1(i,o);break}}else ip(i,o)}function dE(i,o){i.openElements.clearBackToTableContext(),i.activeFormattingElements.insertMarker(),i._insertElement(o,lt.HTML),i.insertionMode=_e.IN_CAPTION}function fE(i,o){i.openElements.clearBackToTableContext(),i._insertElement(o,lt.HTML),i.insertionMode=_e.IN_COLUMN_GROUP}function pE(i,o){i.openElements.clearBackToTableContext(),i._insertFakeElement(Be.COLGROUP,P.COLGROUP),i.insertionMode=_e.IN_COLUMN_GROUP,Sg(i,o)}function mE(i,o){i.openElements.clearBackToTableContext(),i._insertElement(o,lt.HTML),i.insertionMode=_e.IN_TABLE_BODY}function gE(i,o){i.openElements.clearBackToTableContext(),i._insertFakeElement(Be.TBODY,P.TBODY),i.insertionMode=_e.IN_TABLE_BODY,cm(i,o)}function _E(i,o){i.openElements.hasInTableScope(P.TABLE)&&(i.openElements.popUntilTagNamePopped(P.TABLE),i._resetInsertionMode(),i._processStartTag(o))}function yE(i,o){N1(o)?i._appendElement(o,lt.HTML):ip(i,o),o.ackSelfClosing=!0}function bE(i,o){!i.formElement&&i.openElements.tmplCount===0&&(i._insertElement(o,lt.HTML),i.formElement=i.openElements.current,i.openElements.pop())}function Nf(i,o){switch(o.tagID){case P.TD:case P.TH:case P.TR:{gE(i,o);break}case P.STYLE:case P.SCRIPT:case P.TEMPLATE:{Iu(i,o);break}case P.COL:{pE(i,o);break}case P.FORM:{bE(i,o);break}case P.TABLE:{_E(i,o);break}case P.TBODY:case P.TFOOT:case P.THEAD:{mE(i,o);break}case P.INPUT:{yE(i,o);break}case P.CAPTION:{dE(i,o);break}case P.COLGROUP:{fE(i,o);break}default:ip(i,o)}}function K0(i,o){switch(o.tagID){case P.TABLE:{i.openElements.hasInTableScope(P.TABLE)&&(i.openElements.popUntilTagNamePopped(P.TABLE),i._resetInsertionMode());break}case P.TEMPLATE:{bd(i,o);break}case P.BODY:case P.CAPTION:case P.COL:case P.COLGROUP:case P.HTML:case P.TBODY:case P.TD:case P.TFOOT:case P.TH:case P.THEAD:case P.TR:break;default:ip(i,o)}}function ip(i,o){const m=i.fosterParentingEnabled;i.fosterParentingEnabled=!0,um(i,o),i.fosterParentingEnabled=m}function B1(i,o){i.pendingCharacterTokens.push(o)}function z1(i,o){i.pendingCharacterTokens.push(o),i.hasNonWhitespacePendingCharacterToken=!0}function z0(i,o){let m=0;if(i.hasNonWhitespacePendingCharacterToken)for(;m<i.pendingCharacterTokens.length;m++)ip(i,i.pendingCharacterTokens[m]);else for(;m<i.pendingCharacterTokens.length;m++)i._insertCharacters(i.pendingCharacterTokens[m]);i.insertionMode=i.originalInsertionMode,i._processToken(o)}const F1=new Set([P.CAPTION,P.COL,P.COLGROUP,P.TBODY,P.TD,P.TFOOT,P.TH,P.THEAD,P.TR]);function xE(i,o){const m=o.tagID;F1.has(m)?i.openElements.hasInTableScope(P.CAPTION)&&(i.openElements.generateImpliedEndTags(),i.openElements.popUntilTagNamePopped(P.CAPTION),i.activeFormattingElements.clearToLastMarker(),i.insertionMode=_e.IN_TABLE,Nf(i,o)):Br(i,o)}function vE(i,o){const m=o.tagID;switch(m){case P.CAPTION:case P.TABLE:{i.openElements.hasInTableScope(P.CAPTION)&&(i.openElements.generateImpliedEndTags(),i.openElements.popUntilTagNamePopped(P.CAPTION),i.activeFormattingElements.clearToLastMarker(),i.insertionMode=_e.IN_TABLE,m===P.TABLE&&K0(i,o));break}case P.BODY:case P.COL:case P.COLGROUP:case P.HTML:case P.TBODY:case P.TD:case P.TFOOT:case P.TH:case P.THEAD:case P.TR:break;default:lm(i,o)}}function Sg(i,o){switch(o.tagID){case P.HTML:{Br(i,o);break}case P.COL:{i._appendElement(o,lt.HTML),o.ackSelfClosing=!0;break}case P.TEMPLATE:{Iu(i,o);break}default:Jp(i,o)}}function TE(i,o){switch(o.tagID){case P.COLGROUP:{i.openElements.currentTagId===P.COLGROUP&&(i.openElements.pop(),i.insertionMode=_e.IN_TABLE);break}case P.TEMPLATE:{bd(i,o);break}case P.COL:break;default:Jp(i,o)}}function Jp(i,o){i.openElements.currentTagId===P.COLGROUP&&(i.openElements.pop(),i.insertionMode=_e.IN_TABLE,i._processToken(o))}function cm(i,o){switch(o.tagID){case P.TR:{i.openElements.clearBackToTableBodyContext(),i._insertElement(o,lt.HTML),i.insertionMode=_e.IN_ROW;break}case P.TH:case P.TD:{i.openElements.clearBackToTableBodyContext(),i._insertFakeElement(Be.TR,P.TR),i.insertionMode=_e.IN_ROW,hm(i,o);break}case P.CAPTION:case P.COL:case P.COLGROUP:case P.TBODY:case P.TFOOT:case P.THEAD:{i.openElements.hasTableBodyContextInTableScope()&&(i.openElements.clearBackToTableBodyContext(),i.openElements.pop(),i.insertionMode=_e.IN_TABLE,Nf(i,o));break}default:Nf(i,o)}}function ag(i,o){const m=o.tagID;switch(o.tagID){case P.TBODY:case P.TFOOT:case P.THEAD:{i.openElements.hasInTableScope(m)&&(i.openElements.clearBackToTableBodyContext(),i.openElements.pop(),i.insertionMode=_e.IN_TABLE);break}case P.TABLE:{i.openElements.hasTableBodyContextInTableScope()&&(i.openElements.clearBackToTableBodyContext(),i.openElements.pop(),i.insertionMode=_e.IN_TABLE,K0(i,o));break}case P.BODY:case P.CAPTION:case P.COL:case P.COLGROUP:case P.HTML:case P.TD:case P.TH:case P.TR:break;default:K0(i,o)}}function hm(i,o){switch(o.tagID){case P.TH:case P.TD:{i.openElements.clearBackToTableRowContext(),i._insertElement(o,lt.HTML),i.insertionMode=_e.IN_CELL,i.activeFormattingElements.insertMarker();break}case P.CAPTION:case P.COL:case P.COLGROUP:case P.TBODY:case P.TFOOT:case P.THEAD:case P.TR:{i.openElements.hasInTableScope(P.TR)&&(i.openElements.clearBackToTableRowContext(),i.openElements.pop(),i.insertionMode=_e.IN_TABLE_BODY,cm(i,o));break}default:Nf(i,o)}}function U1(i,o){switch(o.tagID){case P.TR:{i.openElements.hasInTableScope(P.TR)&&(i.openElements.clearBackToTableRowContext(),i.openElements.pop(),i.insertionMode=_e.IN_TABLE_BODY);break}case P.TABLE:{i.openElements.hasInTableScope(P.TR)&&(i.openElements.clearBackToTableRowContext(),i.openElements.pop(),i.insertionMode=_e.IN_TABLE_BODY,ag(i,o));break}case P.TBODY:case P.TFOOT:case P.THEAD:{(i.openElements.hasInTableScope(o.tagID)||i.openElements.hasInTableScope(P.TR))&&(i.openElements.clearBackToTableRowContext(),i.openElements.pop(),i.insertionMode=_e.IN_TABLE_BODY,ag(i,o));break}case P.BODY:case P.CAPTION:case P.COL:case P.COLGROUP:case P.HTML:case P.TD:case P.TH:break;default:K0(i,o)}}function EE(i,o){const m=o.tagID;F1.has(m)?(i.openElements.hasInTableScope(P.TD)||i.openElements.hasInTableScope(P.TH))&&(i._closeTableCell(),hm(i,o)):Br(i,o)}function wE(i,o){const m=o.tagID;switch(m){case P.TD:case P.TH:{i.openElements.hasInTableScope(m)&&(i.openElements.generateImpliedEndTags(),i.openElements.popUntilTagNamePopped(m),i.activeFormattingElements.clearToLastMarker(),i.insertionMode=_e.IN_ROW);break}case P.TABLE:case P.TBODY:case P.TFOOT:case P.THEAD:case P.TR:{i.openElements.hasInTableScope(m)&&(i._closeTableCell(),U1(i,o));break}case P.BODY:case P.CAPTION:case P.COL:case P.COLGROUP:case P.HTML:break;default:lm(i,o)}}function H1(i,o){switch(o.tagID){case P.HTML:{Br(i,o);break}case P.OPTION:{i.openElements.currentTagId===P.OPTION&&i.openElements.pop(),i._insertElement(o,lt.HTML);break}case P.OPTGROUP:{i.openElements.currentTagId===P.OPTION&&i.openElements.pop(),i.openElements.currentTagId===P.OPTGROUP&&i.openElements.pop(),i._insertElement(o,lt.HTML);break}case P.HR:{i.openElements.currentTagId===P.OPTION&&i.openElements.pop(),i.openElements.currentTagId===P.OPTGROUP&&i.openElements.pop(),i._appendElement(o,lt.HTML),o.ackSelfClosing=!0;break}case P.INPUT:case P.KEYGEN:case P.TEXTAREA:case P.SELECT:{i.openElements.hasInSelectScope(P.SELECT)&&(i.openElements.popUntilTagNamePopped(P.SELECT),i._resetInsertionMode(),o.tagID!==P.SELECT&&i._processStartTag(o));break}case P.SCRIPT:case P.TEMPLATE:{Iu(i,o);break}}}function j1(i,o){switch(o.tagID){case P.OPTGROUP:{i.openElements.stackTop>0&&i.openElements.currentTagId===P.OPTION&&i.openElements.tagIDs[i.openElements.stackTop-1]===P.OPTGROUP&&i.openElements.pop(),i.openElements.currentTagId===P.OPTGROUP&&i.openElements.pop();break}case P.OPTION:{i.openElements.currentTagId===P.OPTION&&i.openElements.pop();break}case P.SELECT:{i.openElements.hasInSelectScope(P.SELECT)&&(i.openElements.popUntilTagNamePopped(P.SELECT),i._resetInsertionMode());break}case P.TEMPLATE:{bd(i,o);break}}}function AE(i,o){const m=o.tagID;m===P.CAPTION||m===P.TABLE||m===P.TBODY||m===P.TFOOT||m===P.THEAD||m===P.TR||m===P.TD||m===P.TH?(i.openElements.popUntilTagNamePopped(P.SELECT),i._resetInsertionMode(),i._processStartTag(o)):H1(i,o)}function SE(i,o){const m=o.tagID;m===P.CAPTION||m===P.TABLE||m===P.TBODY||m===P.TFOOT||m===P.THEAD||m===P.TR||m===P.TD||m===P.TH?i.openElements.hasInTableScope(m)&&(i.openElements.popUntilTagNamePopped(P.SELECT),i._resetInsertionMode(),i.onEndTag(o)):j1(i,o)}function CE(i,o){switch(o.tagID){case P.BASE:case P.BASEFONT:case P.BGSOUND:case P.LINK:case P.META:case P.NOFRAMES:case P.SCRIPT:case P.STYLE:case P.TEMPLATE:case P.TITLE:{Iu(i,o);break}case P.CAPTION:case P.COLGROUP:case P.TBODY:case P.TFOOT:case P.THEAD:{i.tmplInsertionModeStack[0]=_e.IN_TABLE,i.insertionMode=_e.IN_TABLE,Nf(i,o);break}case P.COL:{i.tmplInsertionModeStack[0]=_e.IN_COLUMN_GROUP,i.insertionMode=_e.IN_COLUMN_GROUP,Sg(i,o);break}case P.TR:{i.tmplInsertionModeStack[0]=_e.IN_TABLE_BODY,i.insertionMode=_e.IN_TABLE_BODY,cm(i,o);break}case P.TD:case P.TH:{i.tmplInsertionModeStack[0]=_e.IN_ROW,i.insertionMode=_e.IN_ROW,hm(i,o);break}default:i.tmplInsertionModeStack[0]=_e.IN_BODY,i.insertionMode=_e.IN_BODY,Br(i,o)}}function ME(i,o){o.tagID===P.TEMPLATE&&bd(i,o)}function q1(i,o){i.openElements.tmplCount>0?(i.openElements.popUntilTagNamePopped(P.TEMPLATE),i.activeFormattingElements.clearToLastMarker(),i.tmplInsertionModeStack.shift(),i._resetInsertionMode(),i.onEof(o)):Ag(i,o)}function IE(i,o){o.tagID===P.HTML?Br(i,o):em(i,o)}function V1(i,o){var m;if(o.tagID===P.HTML){if(i.fragmentContext||(i.insertionMode=_e.AFTER_AFTER_BODY),i.options.sourceCodeLocationInfo&&i.openElements.tagIDs[0]===P.HTML){i._setEndLocation(i.openElements.items[0],o);const v=i.openElements.items[1];v&&!(!((m=i.treeAdapter.getNodeSourceCodeLocation(v))===null||m===void 0)&&m.endTag)&&i._setEndLocation(v,o)}}else em(i,o)}function em(i,o){i.insertionMode=_e.IN_BODY,um(i,o)}function DE(i,o){switch(o.tagID){case P.HTML:{Br(i,o);break}case P.FRAMESET:{i._insertElement(o,lt.HTML);break}case P.FRAME:{i._appendElement(o,lt.HTML),o.ackSelfClosing=!0;break}case P.NOFRAMES:{Iu(i,o);break}}}function RE(i,o){o.tagID===P.FRAMESET&&!i.openElements.isRootHtmlElementCurrent()&&(i.openElements.pop(),!i.fragmentContext&&i.openElements.currentTagId!==P.FRAMESET&&(i.insertionMode=_e.AFTER_FRAMESET))}function PE(i,o){switch(o.tagID){case P.HTML:{Br(i,o);break}case P.NOFRAMES:{Iu(i,o);break}}}function LE(i,o){o.tagID===P.HTML&&(i.insertionMode=_e.AFTER_AFTER_FRAMESET)}function NE(i,o){o.tagID===P.HTML?Br(i,o):jp(i,o)}function jp(i,o){i.insertionMode=_e.IN_BODY,um(i,o)}function OE(i,o){switch(o.tagID){case P.HTML:{Br(i,o);break}case P.NOFRAMES:{Iu(i,o);break}}}function kE(i,o){o.chars=ja,i._insertCharacters(o)}function BE(i,o){i._insertCharacters(o),i.framesetOk=!1}function G1(i){for(;i.treeAdapter.getNamespaceURI(i.openElements.current)!==lt.HTML&&i.openElements.currentTagId!==void 0&&!i._isIntegrationPoint(i.openElements.currentTagId,i.openElements.current);)i.openElements.pop()}function zE(i,o){if(Jv(o))G1(i),i._startTagOutsideForeignContent(o);else{const m=i._getAdjustedCurrentElement(),v=i.treeAdapter.getNamespaceURI(m);v===lt.MATHML?C1(o):v===lt.SVG&&(eT(o),M1(o)),Eg(o),o.selfClosing?i._appendElement(o,v):i._insertElement(o,v),o.ackSelfClosing=!0}}function FE(i,o){if(o.tagID===P.P||o.tagID===P.BR){G1(i),i._endTagOutsideForeignContent(o);return}for(let m=i.openElements.stackTop;m>0;m--){const v=i.openElements.items[m];if(i.treeAdapter.getNamespaceURI(v)===lt.HTML){i._endTagOutsideForeignContent(o);break}const C=i.treeAdapter.getTagName(v);if(C.toLowerCase()===o.tagName){o.tagName=C,i.openElements.shortenToLength(m);break}}}function Z1(i,o){return function(v){let C,N=0,M="";for(;C=i.exec(v);)N!==C.index&&(M+=v.substring(N,C.index)),M+=o.get(C[0].charCodeAt(0)),N=C.index+1;return M+v.substring(N)}}const UE=Z1(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),HE=Z1(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),jE=new Set([Be.AREA,Be.BASE,Be.BASEFONT,Be.BGSOUND,Be.BR,Be.COL,Be.EMBED,Be.FRAME,Be.HR,Be.IMG,Be.INPUT,Be.KEYGEN,Be.LINK,Be.META,Be.PARAM,Be.SOURCE,Be.TRACK,Be.WBR]);function qE(i,o){return o.treeAdapter.isElementNode(i)&&o.treeAdapter.getNamespaceURI(i)===lt.HTML&&jE.has(o.treeAdapter.getTagName(i))}const VE={treeAdapter:fc,scriptingEnabled:!0};function GE(i,o){const m={...VE,...o};return Y1(i,m)}function ZE(i,o){let m="";const v=o.treeAdapter.isElementNode(i)&&o.treeAdapter.getTagName(i)===Be.TEMPLATE&&o.treeAdapter.getNamespaceURI(i)===lt.HTML?o.treeAdapter.getTemplateContent(i):i,C=o.treeAdapter.getChildNodes(v);if(C)for(const N of C)m+=Y1(N,o);return m}function Y1(i,o){return o.treeAdapter.isElementNode(i)?YE(i,o):o.treeAdapter.isTextNode(i)?XE(i,o):o.treeAdapter.isCommentNode(i)?QE(i,o):o.treeAdapter.isDocumentTypeNode(i)?KE(i,o):""}function YE(i,o){const m=o.treeAdapter.getTagName(i);return`<${m}${$E(i,o)}>${qE(i,o)?"":`${ZE(i,o)}</${m}>`}`}function $E(i,{treeAdapter:o}){let m="";for(const v of o.getAttrList(i)){if(m+=" ",v.namespace)switch(v.namespace){case lt.XML:{m+=`xml:${v.name}`;break}case lt.XMLNS:{v.name!=="xmlns"&&(m+="xmlns:"),m+=v.name;break}case lt.XLINK:{m+=`xlink:${v.name}`;break}default:m+=`${v.prefix}:${v.name}`}else m+=v.name;m+=`="${UE(v.value)}"`}return m}function XE(i,o){const{treeAdapter:m}=o,v=m.getTextNodeContent(i),C=m.getParentNode(i),N=C&&m.isElementNode(C)&&m.getTagName(C);return N&&m.getNamespaceURI(C)===lt.HTML&&Cv(N,o.scriptingEnabled)?v:HE(v)}function QE(i,{treeAdapter:o}){return`<!--${o.getCommentNodeContent(i)}-->`}function KE(i,{treeAdapter:o}){return`<!DOCTYPE ${o.getDocumentTypeNodeName(i)}>`}function WE(i,o){return D1.parse(i,o)}function JE(i,o,m){typeof i=="string"&&(m=o,o=i,i=null);const v=D1.getFragmentParser(i,m);return v.tokenizer.write(o,!0),v.getFragment()}function b_(i){const o=i.includes('"')?"'":'"';return o+i+o}function e3(i,o,m){let v="!DOCTYPE ";return i&&(v+=i),o?v+=` PUBLIC ${b_(o)}`:m&&(v+=" SYSTEM"),m&&(v+=` ${b_(m)}`),v}const _h={isCommentNode:im,isElementNode:oi,isTextNode:Al,createDocument(){const i=new md([]);return i["x-mode"]=no.NO_QUIRKS,i},createDocumentFragment(){return new md([])},createElement(i,o,m){const v=Object.create(null),C=Object.create(null),N=Object.create(null);for(let d=0;d<m.length;d++){const K=m[d].name;v[K]=m[d].value,C[K]=m[d].namespace,N[K]=m[d].prefix}const M=new lg(i,v,[]);return M.namespace=o,M["x-attribsNamespace"]=C,M["x-attribsPrefix"]=N,M},createCommentNode(i){return new sg(i)},createTextNode(i){return new Z0(i)},appendChild(i,o){const m=i.children[i.children.length-1];m&&(m.next=o,o.prev=m),i.children.push(o),o.parent=i},insertBefore(i,o,m){const v=i.children.indexOf(m),{prev:C}=m;C&&(C.next=o,o.prev=C),m.prev=o,o.next=m,i.children.splice(v,0,o),o.parent=i},setTemplateContent(i,o){_h.appendChild(i,o)},getTemplateContent(i){return i.children[0]},setDocumentType(i,o,m,v){const C=e3(o,m,v);let N=i.children.find(M=>Vm(M)&&M.name==="!doctype");N?N.data=C??null:(N=new og("!doctype",C),_h.appendChild(i,N)),N["x-name"]=o,N["x-publicId"]=m,N["x-systemId"]=v},setDocumentMode(i,o){i["x-mode"]=o},getDocumentMode(i){return i["x-mode"]},detachNode(i){if(i.parent){const o=i.parent.children.indexOf(i),{prev:m,next:v}=i;i.prev=null,i.next=null,m&&(m.next=v),v&&(v.prev=m),i.parent.children.splice(o,1),i.parent=null}},insertText(i,o){const m=i.children[i.children.length-1];m&&Al(m)?m.data+=o:_h.appendChild(i,_h.createTextNode(o))},insertTextBefore(i,o,m){const v=i.children[i.children.indexOf(m)-1];v&&Al(v)?v.data+=o:_h.insertBefore(i,_h.createTextNode(o),m)},adoptAttributes(i,o){for(let m=0;m<o.length;m++){const v=o[m].name;i.attribs[v]===void 0&&(i.attribs[v]=o[m].value,i["x-attribsNamespace"][v]=o[m].namespace,i["x-attribsPrefix"][v]=o[m].prefix)}},getFirstChild(i){return i.children[0]},getChildNodes(i){return i.children},getParentNode(i){return i.parent},getAttrList(i){return i.attributes},getTagName(i){return i.name},getNamespaceURI(i){return i.namespace},getTextNodeContent(i){return i.data},getCommentNodeContent(i){return i.data},getDocumentTypeNodeName(i){var o;return(o=i["x-name"])!==null&&o!==void 0?o:""},getDocumentTypeNodePublicId(i){var o;return(o=i["x-publicId"])!==null&&o!==void 0?o:""},getDocumentTypeNodeSystemId(i){var o;return(o=i["x-systemId"])!==null&&o!==void 0?o:""},isDocumentTypeNode(i){return Vm(i)&&i.name==="!doctype"},setNodeSourceCodeLocation(i,o){o&&(i.startIndex=o.startOffset,i.endIndex=o.endOffset),i.sourceCodeLocation=o},getNodeSourceCodeLocation(i){return i.sourceCodeLocation},updateNodeSourceCodeLocation(i,o){o.endOffset!=null&&(i.endIndex=o.endOffset),i.sourceCodeLocation={...i.sourceCodeLocation,...o}}};function t3(i,o,m,v){var C;return(C=o.treeAdapter)!==null&&C!==void 0||(o.treeAdapter=_h),o.scriptingEnabled!==!1&&(o.scriptingEnabled=!0),m?WE(i,o):JE(v,i,o)}const i3={treeAdapter:_h};function a3(i){const o="length"in i?i:[i];for(let v=0;v<o.length;v+=1){const C=o[v];vh(C)&&Array.prototype.splice.call(o,v,1,...C.children)}let m="";for(let v=0;v<o.length;v+=1){const C=o[v];m+=GE(C,i3)}return m}var Kt;(function(i){i[i.Tab=9]="Tab",i[i.NewLine=10]="NewLine",i[i.FormFeed=12]="FormFeed",i[i.CarriageReturn=13]="CarriageReturn",i[i.Space=32]="Space",i[i.ExclamationMark=33]="ExclamationMark",i[i.Number=35]="Number",i[i.Amp=38]="Amp",i[i.SingleQuote=39]="SingleQuote",i[i.DoubleQuote=34]="DoubleQuote",i[i.Dash=45]="Dash",i[i.Slash=47]="Slash",i[i.Zero=48]="Zero",i[i.Nine=57]="Nine",i[i.Semi=59]="Semi",i[i.Lt=60]="Lt",i[i.Eq=61]="Eq",i[i.Gt=62]="Gt",i[i.Questionmark=63]="Questionmark",i[i.UpperA=65]="UpperA",i[i.LowerA=97]="LowerA",i[i.UpperF=70]="UpperF",i[i.LowerF=102]="LowerF",i[i.UpperZ=90]="UpperZ",i[i.LowerZ=122]="LowerZ",i[i.LowerX=120]="LowerX",i[i.OpeningSquareBracket=91]="OpeningSquareBracket"})(Kt||(Kt={}));var dt;(function(i){i[i.Text=1]="Text",i[i.BeforeTagName=2]="BeforeTagName",i[i.InTagName=3]="InTagName",i[i.InSelfClosingTag=4]="InSelfClosingTag",i[i.BeforeClosingTagName=5]="BeforeClosingTagName",i[i.InClosingTagName=6]="InClosingTagName",i[i.AfterClosingTagName=7]="AfterClosingTagName",i[i.BeforeAttributeName=8]="BeforeAttributeName",i[i.InAttributeName=9]="InAttributeName",i[i.AfterAttributeName=10]="AfterAttributeName",i[i.BeforeAttributeValue=11]="BeforeAttributeValue",i[i.InAttributeValueDq=12]="InAttributeValueDq",i[i.InAttributeValueSq=13]="InAttributeValueSq",i[i.InAttributeValueNq=14]="InAttributeValueNq",i[i.BeforeDeclaration=15]="BeforeDeclaration",i[i.InDeclaration=16]="InDeclaration",i[i.InProcessingInstruction=17]="InProcessingInstruction",i[i.BeforeComment=18]="BeforeComment",i[i.CDATASequence=19]="CDATASequence",i[i.InSpecialComment=20]="InSpecialComment",i[i.InCommentLike=21]="InCommentLike",i[i.BeforeSpecialS=22]="BeforeSpecialS",i[i.BeforeSpecialT=23]="BeforeSpecialT",i[i.SpecialStartSequence=24]="SpecialStartSequence",i[i.InSpecialTag=25]="InSpecialTag",i[i.InEntity=26]="InEntity"})(dt||(dt={}));function dc(i){return i===Kt.Space||i===Kt.NewLine||i===Kt.Tab||i===Kt.FormFeed||i===Kt.CarriageReturn}function Fp(i){return i===Kt.Slash||i===Kt.Gt||dc(i)}function n3(i){return i>=Kt.LowerA&&i<=Kt.LowerZ||i>=Kt.UpperA&&i<=Kt.UpperZ}var wl;(function(i){i[i.NoValue=0]="NoValue",i[i.Unquoted=1]="Unquoted",i[i.Single=2]="Single",i[i.Double=3]="Double"})(wl||(wl={}));const Er={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101]),TextareaEnd:new Uint8Array([60,47,116,101,120,116,97,114,101,97])};class r3{constructor({xmlMode:o=!1,decodeEntities:m=!0},v){this.cbs=v,this.state=dt.Text,this.buffer="",this.sectionStart=0,this.index=0,this.entityStart=0,this.baseState=dt.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.xmlMode=o,this.decodeEntities=m,this.entityDecoder=new O_(o?N_:L_,(C,N)=>this.emitCodePoint(C,N))}reset(){this.state=dt.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=dt.Text,this.currentSequence=void 0,this.running=!0,this.offset=0}write(o){this.offset+=this.buffer.length,this.buffer=o,this.parse()}end(){this.running&&this.finish()}pause(){this.running=!1}resume(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()}stateText(o){o===Kt.Lt||!this.decodeEntities&&this.fastForwardTo(Kt.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=dt.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&o===Kt.Amp&&this.startEntity()}stateSpecialStartSequence(o){const m=this.sequenceIndex===this.currentSequence.length;if(!(m?Fp(o):(o|32)===this.currentSequence[this.sequenceIndex]))this.isSpecial=!1;else if(!m){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=dt.InTagName,this.stateInTagName(o)}stateInSpecialTag(o){if(this.sequenceIndex===this.currentSequence.length){if(o===Kt.Gt||dc(o)){const m=this.index-this.currentSequence.length;if(this.sectionStart<m){const v=this.index;this.index=m,this.cbs.ontext(this.sectionStart,m),this.index=v}this.isSpecial=!1,this.sectionStart=m+2,this.stateInClosingTagName(o);return}this.sequenceIndex=0}(o|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===Er.TitleEnd?this.decodeEntities&&o===Kt.Amp&&this.startEntity():this.fastForwardTo(Kt.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(o===Kt.Lt)}stateCDATASequence(o){o===Er.Cdata[this.sequenceIndex]?++this.sequenceIndex===Er.Cdata.length&&(this.state=dt.InCommentLike,this.currentSequence=Er.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=dt.InDeclaration,this.stateInDeclaration(o))}fastForwardTo(o){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===o)return!0;return this.index=this.buffer.length+this.offset-1,!1}stateInCommentLike(o){o===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===Er.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=dt.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):o!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}isTagStartChar(o){return this.xmlMode?!Fp(o):n3(o)}startSpecial(o,m){this.isSpecial=!0,this.currentSequence=o,this.sequenceIndex=m,this.state=dt.SpecialStartSequence}stateBeforeTagName(o){if(o===Kt.ExclamationMark)this.state=dt.BeforeDeclaration,this.sectionStart=this.index+1;else if(o===Kt.Questionmark)this.state=dt.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(o)){const m=o|32;this.sectionStart=this.index,this.xmlMode?this.state=dt.InTagName:m===Er.ScriptEnd[2]?this.state=dt.BeforeSpecialS:m===Er.TitleEnd[2]?this.state=dt.BeforeSpecialT:this.state=dt.InTagName}else o===Kt.Slash?this.state=dt.BeforeClosingTagName:(this.state=dt.Text,this.stateText(o))}stateInTagName(o){Fp(o)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=dt.BeforeAttributeName,this.stateBeforeAttributeName(o))}stateBeforeClosingTagName(o){dc(o)||(o===Kt.Gt?this.state=dt.Text:(this.state=this.isTagStartChar(o)?dt.InClosingTagName:dt.InSpecialComment,this.sectionStart=this.index))}stateInClosingTagName(o){(o===Kt.Gt||dc(o))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=dt.AfterClosingTagName,this.stateAfterClosingTagName(o))}stateAfterClosingTagName(o){(o===Kt.Gt||this.fastForwardTo(Kt.Gt))&&(this.state=dt.Text,this.sectionStart=this.index+1)}stateBeforeAttributeName(o){o===Kt.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=dt.InSpecialTag,this.sequenceIndex=0):this.state=dt.Text,this.sectionStart=this.index+1):o===Kt.Slash?this.state=dt.InSelfClosingTag:dc(o)||(this.state=dt.InAttributeName,this.sectionStart=this.index)}stateInSelfClosingTag(o){o===Kt.Gt?(this.cbs.onselfclosingtag(this.index),this.state=dt.Text,this.sectionStart=this.index+1,this.isSpecial=!1):dc(o)||(this.state=dt.BeforeAttributeName,this.stateBeforeAttributeName(o))}stateInAttributeName(o){(o===Kt.Eq||Fp(o))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=this.index,this.state=dt.AfterAttributeName,this.stateAfterAttributeName(o))}stateAfterAttributeName(o){o===Kt.Eq?this.state=dt.BeforeAttributeValue:o===Kt.Slash||o===Kt.Gt?(this.cbs.onattribend(wl.NoValue,this.sectionStart),this.sectionStart=-1,this.state=dt.BeforeAttributeName,this.stateBeforeAttributeName(o)):dc(o)||(this.cbs.onattribend(wl.NoValue,this.sectionStart),this.state=dt.InAttributeName,this.sectionStart=this.index)}stateBeforeAttributeValue(o){o===Kt.DoubleQuote?(this.state=dt.InAttributeValueDq,this.sectionStart=this.index+1):o===Kt.SingleQuote?(this.state=dt.InAttributeValueSq,this.sectionStart=this.index+1):dc(o)||(this.sectionStart=this.index,this.state=dt.InAttributeValueNq,this.stateInAttributeValueNoQuotes(o))}handleInAttributeValue(o,m){o===m||!this.decodeEntities&&this.fastForwardTo(m)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(m===Kt.DoubleQuote?wl.Double:wl.Single,this.index+1),this.state=dt.BeforeAttributeName):this.decodeEntities&&o===Kt.Amp&&this.startEntity()}stateInAttributeValueDoubleQuotes(o){this.handleInAttributeValue(o,Kt.DoubleQuote)}stateInAttributeValueSingleQuotes(o){this.handleInAttributeValue(o,Kt.SingleQuote)}stateInAttributeValueNoQuotes(o){dc(o)||o===Kt.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(wl.Unquoted,this.index),this.state=dt.BeforeAttributeName,this.stateBeforeAttributeName(o)):this.decodeEntities&&o===Kt.Amp&&this.startEntity()}stateBeforeDeclaration(o){o===Kt.OpeningSquareBracket?(this.state=dt.CDATASequence,this.sequenceIndex=0):this.state=o===Kt.Dash?dt.BeforeComment:dt.InDeclaration}stateInDeclaration(o){(o===Kt.Gt||this.fastForwardTo(Kt.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=dt.Text,this.sectionStart=this.index+1)}stateInProcessingInstruction(o){(o===Kt.Gt||this.fastForwardTo(Kt.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=dt.Text,this.sectionStart=this.index+1)}stateBeforeComment(o){o===Kt.Dash?(this.state=dt.InCommentLike,this.currentSequence=Er.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=dt.InDeclaration}stateInSpecialComment(o){(o===Kt.Gt||this.fastForwardTo(Kt.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=dt.Text,this.sectionStart=this.index+1)}stateBeforeSpecialS(o){const m=o|32;m===Er.ScriptEnd[3]?this.startSpecial(Er.ScriptEnd,4):m===Er.StyleEnd[3]?this.startSpecial(Er.StyleEnd,4):(this.state=dt.InTagName,this.stateInTagName(o))}stateBeforeSpecialT(o){const m=o|32;m===Er.TitleEnd[3]?this.startSpecial(Er.TitleEnd,4):m===Er.TextareaEnd[3]?this.startSpecial(Er.TextareaEnd,4):(this.state=dt.InTagName,this.stateInTagName(o))}startEntity(){this.baseState=this.state,this.state=dt.InEntity,this.entityStart=this.index,this.entityDecoder.startEntity(this.xmlMode?El.Strict:this.baseState===dt.Text||this.baseState===dt.InSpecialTag?El.Legacy:El.Attribute)}stateInEntity(){const o=this.entityDecoder.write(this.buffer,this.index-this.offset);o>=0?(this.state=this.baseState,o===0&&(this.index=this.entityStart)):this.index=this.offset+this.buffer.length-1}cleanup(){this.running&&this.sectionStart!==this.index&&(this.state===dt.Text||this.state===dt.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===dt.InAttributeValueDq||this.state===dt.InAttributeValueSq||this.state===dt.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}shouldContinue(){return this.index<this.buffer.length+this.offset&&this.running}parse(){for(;this.shouldContinue();){const o=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case dt.Text:{this.stateText(o);break}case dt.SpecialStartSequence:{this.stateSpecialStartSequence(o);break}case dt.InSpecialTag:{this.stateInSpecialTag(o);break}case dt.CDATASequence:{this.stateCDATASequence(o);break}case dt.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(o);break}case dt.InAttributeName:{this.stateInAttributeName(o);break}case dt.InCommentLike:{this.stateInCommentLike(o);break}case dt.InSpecialComment:{this.stateInSpecialComment(o);break}case dt.BeforeAttributeName:{this.stateBeforeAttributeName(o);break}case dt.InTagName:{this.stateInTagName(o);break}case dt.InClosingTagName:{this.stateInClosingTagName(o);break}case dt.BeforeTagName:{this.stateBeforeTagName(o);break}case dt.AfterAttributeName:{this.stateAfterAttributeName(o);break}case dt.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(o);break}case dt.BeforeAttributeValue:{this.stateBeforeAttributeValue(o);break}case dt.BeforeClosingTagName:{this.stateBeforeClosingTagName(o);break}case dt.AfterClosingTagName:{this.stateAfterClosingTagName(o);break}case dt.BeforeSpecialS:{this.stateBeforeSpecialS(o);break}case dt.BeforeSpecialT:{this.stateBeforeSpecialT(o);break}case dt.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(o);break}case dt.InSelfClosingTag:{this.stateInSelfClosingTag(o);break}case dt.InDeclaration:{this.stateInDeclaration(o);break}case dt.BeforeDeclaration:{this.stateBeforeDeclaration(o);break}case dt.BeforeComment:{this.stateBeforeComment(o);break}case dt.InProcessingInstruction:{this.stateInProcessingInstruction(o);break}case dt.InEntity:{this.stateInEntity();break}}this.index++}this.cleanup()}finish(){this.state===dt.InEntity&&(this.entityDecoder.end(),this.state=this.baseState),this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){const o=this.buffer.length+this.offset;this.sectionStart>=o||(this.state===dt.InCommentLike?this.currentSequence===Er.CdataEnd?this.cbs.oncdata(this.sectionStart,o,0):this.cbs.oncomment(this.sectionStart,o,0):this.state===dt.InTagName||this.state===dt.BeforeAttributeName||this.state===dt.BeforeAttributeValue||this.state===dt.AfterAttributeName||this.state===dt.InAttributeName||this.state===dt.InAttributeValueSq||this.state===dt.InAttributeValueDq||this.state===dt.InAttributeValueNq||this.state===dt.InClosingTagName||this.cbs.ontext(this.sectionStart,o))}emitCodePoint(o,m){this.baseState!==dt.Text&&this.baseState!==dt.InSpecialTag?(this.sectionStart<this.entityStart&&this.cbs.onattribdata(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+m,this.index=this.sectionStart-1,this.cbs.onattribentity(o)):(this.sectionStart<this.entityStart&&this.cbs.ontext(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+m,this.index=this.sectionStart-1,this.cbs.ontextentity(o,this.sectionStart))}}const Df=new Set(["input","option","optgroup","select","button","datalist","textarea"]),pa=new Set(["p"]),x_=new Set(["thead","tbody"]),v_=new Set(["dd","dt"]),T_=new Set(["rt","rp"]),s3=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",pa],["h1",pa],["h2",pa],["h3",pa],["h4",pa],["h5",pa],["h6",pa],["select",Df],["input",Df],["output",Df],["button",Df],["datalist",Df],["textarea",Df],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",v_],["dt",v_],["address",pa],["article",pa],["aside",pa],["blockquote",pa],["details",pa],["div",pa],["dl",pa],["fieldset",pa],["figcaption",pa],["figure",pa],["footer",pa],["form",pa],["header",pa],["hr",pa],["main",pa],["nav",pa],["ol",pa],["pre",pa],["section",pa],["table",pa],["ul",pa],["rt",T_],["rp",T_],["tbody",x_],["tfoot",x_]]),o3=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),E_=new Set(["math","svg"]),w_=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),u3=/\s|\//;class l3{constructor(o,m={}){var v,C,N,M,d,K;this.options=m,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=o??{},this.htmlMode=!this.options.xmlMode,this.lowerCaseTagNames=(v=m.lowerCaseTags)!==null&&v!==void 0?v:this.htmlMode,this.lowerCaseAttributeNames=(C=m.lowerCaseAttributeNames)!==null&&C!==void 0?C:this.htmlMode,this.recognizeSelfClosing=(N=m.recognizeSelfClosing)!==null&&N!==void 0?N:!this.htmlMode,this.tokenizer=new((M=m.Tokenizer)!==null&&M!==void 0?M:r3)(this.options,this),this.foreignContext=[!this.htmlMode],(K=(d=this.cbs).onparserinit)===null||K===void 0||K.call(d,this)}ontext(o,m){var v,C;const N=this.getSlice(o,m);this.endIndex=m-1,(C=(v=this.cbs).ontext)===null||C===void 0||C.call(v,N),this.startIndex=m}ontextentity(o,m){var v,C;this.endIndex=m-1,(C=(v=this.cbs).ontext)===null||C===void 0||C.call(v,Gm(o)),this.startIndex=m}isVoidElement(o){return this.htmlMode&&o3.has(o)}onopentagname(o,m){this.endIndex=m;let v=this.getSlice(o,m);this.lowerCaseTagNames&&(v=v.toLowerCase()),this.emitOpenTag(v)}emitOpenTag(o){var m,v,C,N;this.openTagStart=this.startIndex,this.tagname=o;const M=this.htmlMode&&s3.get(o);if(M)for(;this.stack.length>0&&M.has(this.stack[0]);){const d=this.stack.shift();(v=(m=this.cbs).onclosetag)===null||v===void 0||v.call(m,d,!0)}this.isVoidElement(o)||(this.stack.unshift(o),this.htmlMode&&(E_.has(o)?this.foreignContext.unshift(!0):w_.has(o)&&this.foreignContext.unshift(!1))),(N=(C=this.cbs).onopentagname)===null||N===void 0||N.call(C,o),this.cbs.onopentag&&(this.attribs={})}endOpenTag(o){var m,v;this.startIndex=this.openTagStart,this.attribs&&((v=(m=this.cbs).onopentag)===null||v===void 0||v.call(m,this.tagname,this.attribs,o),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""}onopentagend(o){this.endIndex=o,this.endOpenTag(!1),this.startIndex=o+1}onclosetag(o,m){var v,C,N,M,d,K,W,we;this.endIndex=m;let Pe=this.getSlice(o,m);if(this.lowerCaseTagNames&&(Pe=Pe.toLowerCase()),this.htmlMode&&(E_.has(Pe)||w_.has(Pe))&&this.foreignContext.shift(),this.isVoidElement(Pe))this.htmlMode&&Pe==="br"&&((M=(N=this.cbs).onopentagname)===null||M===void 0||M.call(N,"br"),(K=(d=this.cbs).onopentag)===null||K===void 0||K.call(d,"br",{},!0),(we=(W=this.cbs).onclosetag)===null||we===void 0||we.call(W,"br",!1));else{const Me=this.stack.indexOf(Pe);if(Me!==-1)for(let fe=0;fe<=Me;fe++){const Qe=this.stack.shift();(C=(v=this.cbs).onclosetag)===null||C===void 0||C.call(v,Qe,fe!==Me)}else this.htmlMode&&Pe==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=m+1}onselfclosingtag(o){this.endIndex=o,this.recognizeSelfClosing||this.foreignContext[0]?(this.closeCurrentTag(!1),this.startIndex=o+1):this.onopentagend(o)}closeCurrentTag(o){var m,v;const C=this.tagname;this.endOpenTag(o),this.stack[0]===C&&((v=(m=this.cbs).onclosetag)===null||v===void 0||v.call(m,C,!o),this.stack.shift())}onattribname(o,m){this.startIndex=o;const v=this.getSlice(o,m);this.attribname=this.lowerCaseAttributeNames?v.toLowerCase():v}onattribdata(o,m){this.attribvalue+=this.getSlice(o,m)}onattribentity(o){this.attribvalue+=Gm(o)}onattribend(o,m){var v,C;this.endIndex=m,(C=(v=this.cbs).onattribute)===null||C===void 0||C.call(v,this.attribname,this.attribvalue,o===wl.Double?'"':o===wl.Single?"'":o===wl.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""}getInstructionName(o){const m=o.search(u3);let v=m<0?o:o.substr(0,m);return this.lowerCaseTagNames&&(v=v.toLowerCase()),v}ondeclaration(o,m){this.endIndex=m;const v=this.getSlice(o,m);if(this.cbs.onprocessinginstruction){const C=this.getInstructionName(v);this.cbs.onprocessinginstruction(`!${C}`,`!${v}`)}this.startIndex=m+1}onprocessinginstruction(o,m){this.endIndex=m;const v=this.getSlice(o,m);if(this.cbs.onprocessinginstruction){const C=this.getInstructionName(v);this.cbs.onprocessinginstruction(`?${C}`,`?${v}`)}this.startIndex=m+1}oncomment(o,m,v){var C,N,M,d;this.endIndex=m,(N=(C=this.cbs).oncomment)===null||N===void 0||N.call(C,this.getSlice(o,m-v)),(d=(M=this.cbs).oncommentend)===null||d===void 0||d.call(M),this.startIndex=m+1}oncdata(o,m,v){var C,N,M,d,K,W,we,Pe,Me,fe;this.endIndex=m;const Qe=this.getSlice(o,m-v);!this.htmlMode||this.options.recognizeCDATA?((N=(C=this.cbs).oncdatastart)===null||N===void 0||N.call(C),(d=(M=this.cbs).ontext)===null||d===void 0||d.call(M,Qe),(W=(K=this.cbs).oncdataend)===null||W===void 0||W.call(K)):((Pe=(we=this.cbs).oncomment)===null||Pe===void 0||Pe.call(we,`[CDATA[${Qe}]]`),(fe=(Me=this.cbs).oncommentend)===null||fe===void 0||fe.call(Me)),this.startIndex=m+1}onend(){var o,m;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(let v=0;v<this.stack.length;v++)this.cbs.onclosetag(this.stack[v],!0)}(m=(o=this.cbs).onend)===null||m===void 0||m.call(o)}reset(){var o,m,v,C;(m=(o=this.cbs).onreset)===null||m===void 0||m.call(o),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(C=(v=this.cbs).onparserinit)===null||C===void 0||C.call(v,this),this.buffers.length=0,this.foreignContext.length=0,this.foreignContext.unshift(!this.htmlMode),this.bufferOffset=0,this.writeIndex=0,this.ended=!1}parseComplete(o){this.reset(),this.end(o)}getSlice(o,m){for(;o-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();let v=this.buffers[0].slice(o-this.bufferOffset,m-this.bufferOffset);for(;m-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),v+=this.buffers[0].slice(0,m-this.bufferOffset);return v}shiftBuffer(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()}write(o){var m,v;if(this.ended){(v=(m=this.cbs).onerror)===null||v===void 0||v.call(m,new Error(".write() after done!"));return}this.buffers.push(o),this.tokenizer.running&&(this.tokenizer.write(o),this.writeIndex++)}end(o){var m,v;if(this.ended){(v=(m=this.cbs).onerror)===null||v===void 0||v.call(m,new Error(".end() after done!"));return}o&&this.write(o),this.ended=!0,this.tokenizer.end()}pause(){this.tokenizer.pause()}resume(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()}parseChunk(o){this.write(o)}done(o){this.end(o)}}function c3(i,o){const m=new Wy(void 0,o);return new l3(m,o).end(i),m.root}const h3=I2((i,o,m,v)=>o._useHtmlParser2?c3(i,o):t3(i,o,m,v)),d3=uv(h3,(i,o)=>o._useHtmlParser2?am(i,o):a3(i));function f3(i,o,m){return i+o/60+m/3600}function p3(i){const o=/(\d+)(\d+)['"](\d+,?\d*)"\s*(\.\.?|\.\.?)/g,m=[...i.matchAll(o)];return m.length===0?null:m.map(v=>{const[C,N,M,d,K]=v;return{decimal:f3(parseInt(N),parseInt(M),parseFloat(d.replace(",","."))),direction:K.includes(".")?"N":"E"}})}const m3=/(?:\d+\.\s*)?(\d+\d+['"][\d,]+"\s*\.\.?\s*\d+\d+['"][\d,]+"\s*\.\.?)/g;function g3(i){return i=i.replace(/\s+/g," ").trim(),[...i.matchAll(m3)].map(m=>m[1]).map((m,v)=>{const C=p3(m);if(!C||C.length!==2)throw console.error("Invalid coordinate",m),new Error("Invalid coordinate");return{index:v+1,lat:C[0].decimal,lon:C[1].decimal,original:m}}).filter(m=>m!==null)}function _3(i){const o=d3(i),m=[],v=o("body").contents().filter(function(){return this.nodeType===1&&o(this).is("p")&&o(this).nextAll("table").length>0}).map(function(){return o(this).text().trim()}).get().join(" ");return o("table").each((C,N)=>{const M={rows:[]};o(N).find("tr").slice(1).each((d,K)=>{const W=[];o(K).find("td").each((we,Pe)=>{const Me=o(Pe).text().trim();W.push(Me)}),W.length>0&&M.rows.push({header:W.join(" "),points:W[1]?g3(W[1]):[]})}),M.rows.length>0&&m.push(M)}),{header:v,rows:m[0].rows}}function y3(){const[i,o]=vt.useState([]),[m,v]=vt.useState(null),[C,N]=vt.useState([]),[M,d]=vt.useState(null),[K,W]=vt.useState({type:"FeatureCollection",features:[]}),[we,Pe]=vt.useState({longitude:37.7333,latitude:55.9833,zoom:11}),[Me,fe]=vt.useState(null),[Qe,ai]=vt.useState(null);vt.useEffect(()=>{fetch("/data/fishing-ban-regions.json").then(ei=>ei.json()).then(ei=>{const Ci=[];ei.regions.forEach(ni=>{ni.documents.forEach(Mt=>{const Et=_3(Mt.content);Mt.header=Et.header,Mt.rows=Et.rows,Mt.region=ni,Mt.header.toLowerCase().includes("")&&Ci.push(Mt)})}),console.log(ei.regions,K),o(ei.regions||[]),N(Ci)}).catch(ei=>{console.error("Error loading regions:",ei)})},[]),vt.useEffect(()=>{const ei={type:"FeatureCollection",features:[]};C.forEach((Ci,ni)=>{Ci.rows.forEach((Mt,Et)=>{!Mt.points||Mt.points.length===0||(Mt.points.length>2?ei.features.push({type:"Feature",geometry:{type:"Polygon",coordinates:[Mt.points.map(Ut=>[Ut.lon,Ut.lat])]},properties:{fillColor:"#ff0000",fillOpacity:.3,strokeColor:"#ff0000",name:Mt.header,documentIndex:ni,rowIndex:Et}}):Mt.points.length===2?ei.features.push({type:"Feature",geometry:{type:"LineString",coordinates:[[Mt.points[0].lon,Mt.points[0].lat],[Mt.points[1].lon,Mt.points[1].lat]]},properties:{color:"#ff0000",width:2,name:Mt.header,documentIndex:ni,rowIndex:Et}}):Mt.points.length===1&&ei.features.push({type:"Feature",geometry:{type:"Point",coordinates:[Mt.points[0].lon,Mt.points[0].lat]},properties:{color:"#ff0000",radius:5,strokeColor:"#ff0000",strokeWidth:2,name:Mt.header,documentIndex:ni,rowIndex:Et}}))})}),W(ei)},[C,i]);const li=ei=>{var Ci,ni;if(((Ci=ei.properties)==null?void 0:Ci.documentIndex)!==void 0&&((ni=ei.properties)==null?void 0:ni.rowIndex)!==void 0){const Mt=C[ei.properties.documentIndex];v(Mt.region||null),d(Mt||null),ai(ei.properties.rowIndex||null)}};return Dt.jsxs("div",{className:"flex h-screen w-screen overflow-hidden",children:[Dt.jsx("div",{className:"w-1/3 h-full border-r border-gray-200 overflow-y-auto bg-white",children:Dt.jsx(hy,{regions:i,selectedRegion:m,onRegionSelect:v,selectedDocuments:C,setSelectedDocuments:N,openedDocument:M,setOpenedDocument:d,map:Me,selectedRow:Qe,setSelectedRow:ai})}),Dt.jsx("div",{className:"flex-1 h-full bg-gray-50",children:Dt.jsx(Hy,{geoJson:K,onFeatureClick:li,viewState:we,setViewState:Pe,onMapLoaded:ei=>fe(ei)})})]})}ay.createRoot(document.getElementById("root")).render(Dt.jsx(vt.StrictMode,{children:Dt.jsx(y3,{})}));
